{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u6b22\u8fce\u6765\u5230\u6211\u7684\u7b14\u8bb0\u672c \u00b6 \u8fd9\u4e2a\u7b14\u8bb0\u672c\u662f\u7531MkDocs\u5de5\u5177\u751f\u6210\u7684\u3002 \u6211\u5b8c\u5168\u4e0d\u61c2\u524d\u7aef\u77e5\u8bc6\uff0c\u53ea\u662f\u627e\u4e00\u4e2a\u5730\u65b9\u653e\u6211\u7684\u7b14\u8bb0\u3002 \u6211\u7528\u4e86\u597d\u591a\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff1aJekyll, Hexo \u548c Hugo\uff0c \u5b83\u4eec\u7684\u4e3b\u9898\u90fd\u4e0d\u5408\u6211\u610f\uff0c\u800c\u4e14\u751f\u6210\u7684\u9879\u76ee\u7ed3\u6784\u590d\u6742\uff08\u8d85\u8fc7\u4e24\u4e2a\u6587\u4ef6\u5939\uff09\uff0c\u8ba9\u6211\u5fc3\u70e6\u610f\u4e71\u3002 \u770b\u6765\u770b\u53bb\uff0c\u53d1\u73b0\u8fd8\u662f McDocs \u6700\u5408\u6211\u610f: \u5982\u679c\u6211\u8981\u5199\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u6211\u5c31\u5199\u6210\u8fd9\u4e2a\u6837\u5b50\u3002 \u8fd9\u672c\u7b14\u8bb0\u6b63\u5904\u4e8e\u524d\u671f\u9ad8\u901f\u65bd\u5de5\u4e2d\uff0c\u6211\u51c6\u5907\u628a\u6211\u7814\u7a76\u751f\u9636\u6bb5\u5404\u79cd\u5f62\u5f0f\u7684\u7b14\u8bb0\u6574\u7406\u90fd\u653e\u5230\u8fd9\u91cc\u6765\u3002 \u6211\u5c3d\u91cf\u505a\u5230\u4e0d\u4eba\u4e91\u4ea6\u4e91\uff0c\u5176\u4e2d\u6b63\u5728\u65bd\u5de5\u4e2d\u7684 \u673a\u5668\u5b66\u4e60 \u7248\u5757\u548c\u51c6\u5907\u8981\u4e0a\u7684 \u5f3a\u5316\u5b66\u4e60 \u7248\u5757 \u5305\u542b\u4e86\u6211\u4e3b\u8981\u7684\u601d\u8003\uff0c\u6709\u4e00\u4e9b\u6bd4\u8f83\u72ec\u7279\u7684\u7406\u89e3\uff0c\u8fd9\u4e9b\u7406\u89e3\u6709\u4e9b\u751a\u81f3\u662f\u6846\u67b6\u6027\u7684\u3002","title":"\u4ecb\u7ecd"},{"location":"#_1","text":"\u8fd9\u4e2a\u7b14\u8bb0\u672c\u662f\u7531MkDocs\u5de5\u5177\u751f\u6210\u7684\u3002 \u6211\u5b8c\u5168\u4e0d\u61c2\u524d\u7aef\u77e5\u8bc6\uff0c\u53ea\u662f\u627e\u4e00\u4e2a\u5730\u65b9\u653e\u6211\u7684\u7b14\u8bb0\u3002 \u6211\u7528\u4e86\u597d\u591a\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff1aJekyll, Hexo \u548c Hugo\uff0c \u5b83\u4eec\u7684\u4e3b\u9898\u90fd\u4e0d\u5408\u6211\u610f\uff0c\u800c\u4e14\u751f\u6210\u7684\u9879\u76ee\u7ed3\u6784\u590d\u6742\uff08\u8d85\u8fc7\u4e24\u4e2a\u6587\u4ef6\u5939\uff09\uff0c\u8ba9\u6211\u5fc3\u70e6\u610f\u4e71\u3002 \u770b\u6765\u770b\u53bb\uff0c\u53d1\u73b0\u8fd8\u662f McDocs \u6700\u5408\u6211\u610f: \u5982\u679c\u6211\u8981\u5199\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u6211\u5c31\u5199\u6210\u8fd9\u4e2a\u6837\u5b50\u3002 \u8fd9\u672c\u7b14\u8bb0\u6b63\u5904\u4e8e\u524d\u671f\u9ad8\u901f\u65bd\u5de5\u4e2d\uff0c\u6211\u51c6\u5907\u628a\u6211\u7814\u7a76\u751f\u9636\u6bb5\u5404\u79cd\u5f62\u5f0f\u7684\u7b14\u8bb0\u6574\u7406\u90fd\u653e\u5230\u8fd9\u91cc\u6765\u3002 \u6211\u5c3d\u91cf\u505a\u5230\u4e0d\u4eba\u4e91\u4ea6\u4e91\uff0c\u5176\u4e2d\u6b63\u5728\u65bd\u5de5\u4e2d\u7684 \u673a\u5668\u5b66\u4e60 \u7248\u5757\u548c\u51c6\u5907\u8981\u4e0a\u7684 \u5f3a\u5316\u5b66\u4e60 \u7248\u5757 \u5305\u542b\u4e86\u6211\u4e3b\u8981\u7684\u601d\u8003\uff0c\u6709\u4e00\u4e9b\u6bd4\u8f83\u72ec\u7279\u7684\u7406\u89e3\uff0c\u8fd9\u4e9b\u7406\u89e3\u6709\u4e9b\u751a\u81f3\u662f\u6846\u67b6\u6027\u7684\u3002","title":"\u6b22\u8fce\u6765\u5230\u6211\u7684\u7b14\u8bb0\u672c"},{"location":"Algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/","text":"\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \u00b6 \u539f\u59cb\u95ee\u9898 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 300 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u4e00\u4e2a\u6570\u7ec4 \\{x_0, x_1, \\ldots, x_n\\} \\{x_0, x_1, \\ldots, x_n\\} , \u6c42\u5b83\u7684\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \uff0c\u6ee1\u8db3 i_0 < i_1 < \\ldots i_k i_0 < i_1 < \\ldots i_k \u5e76\u4e14 x_{i_0} < x_{i_1} < \\ldots < x_{i_k} x_{i_0} < x_{i_1} < \\ldots < x_{i_k} \u3002 \u76ee\u6807 \uff1a\u52a8\u6001\u89c4\u5212\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6 O(n \\log n) O(n \\log n) \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 O(n) O(n) \u3002 \u9996\u5148\uff0c\u7b80\u5355\u7684\u52a8\u6001\u89c4\u5212\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(n^2) O(n^2) \u3002 for ( int i = 1 ; i < n ; ++ i ) { for ( int j = 0 ; j < i ; ++ j ) { if ( dp [ i ] > dp [ j ]) { dp [ i ] = max ( dp [ i ], dp [ j ] + 1 ); } } } \u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684 O(n \\log n) O(n \\log n) \u7b97\u6cd5\u5c31\u6bd4\u8f83\u5f3a\u4e86\uff0c\u7528\u5230\u4e86\u8d2a\u5fc3\u6cd5\u548c\u4e8c\u5206\u67e5\u627e\u6765\u964d\u4f4e\u590d\u6742\u5ea6\u3002 \u5177\u4f53\u6d41\u7a0b\u53ef\u4ee5\u770b \u666e\u6797\u65af\u987f\u5927\u5b66\u7684\u7b97\u6cd5\u8bfe\u7a0b\u7684\u4e00\u4e2appt \u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u7ef4\u62a4\u51e0\u4e2a\u4e0b\u964d\u6808\uff08\u521a\u5f00\u59cb\u662f0\u4e2a\u4e0b\u964d\u6808\uff09\u3002\u4ece\u5de6\u5230\u53f3\u904d\u5386\u6570\u7ec4\uff0c\u6bcf\u4e2a\u6570\u5c3d\u91cf\u538b\u5165\u5de6\u8fb9\u7684\u6808\uff08\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7528\u4e8c\u5206\u6cd5\u627e\u80fd\u538b\u5165\u7684\u6808\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6808\u53ef\u538b\u5165\uff0c\u90a3\u5c31\u65b0\u5efa\u4e00\u4e2a\u6808\u3002 \u5f31\u5bf9\u5076 \uff1a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e\u6808\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u4efb\u4f55\u4e0a\u5347\u5b50\u5e8f\u5217\u6700\u591a\u53ea\u80fd\u5305\u542b\u6bcf\u4e2a\u4e0b\u964d\u6808\u91cc\u7684\u4e00\u4e2a\u5143\u7d20\u3002 \u5f3a\u5bf9\u5076 \uff1a\u6bcf\u4e2a\u6570\u8981\u4e48\u5728\u7b2c\u4e00\u4e2a\u6808\uff0c\u8981\u4e48\u5b83\u524d\u9762\u7684\u6808\u5df2\u7ecf\u5b58\u5728\u6bd4\u5b83\u5c0f\u7684\u6570\u3002\u90a3\u4e48\u5f52\u7eb3\u603b\u7ed3\u6cd5\u53ef\u5f97\uff0c\u6bcf\u4e2a\u6570\u90fd\u6709\u5230\u7b2c\u4e00\u4e2a\u6808\u7684''\u901a\u8def''\uff08\u5f62\u6210\u9012\u589e\u5b50\u5e8f\u5217\uff09\u3002\u90a3\u4e48\uff0c\u8fd9\u4e2a\u6808\u7ec4\u7684\u6570\u636e\u7ed3\u6784\u5b58\u5728\u4e00\u4e2a\u957f\u5ea6\u7b49\u4e8e\u6808\u4e2a\u6570\u7684\u9012\u589e\u5b50\u5e8f\u5217\u3002\u518d\u6839\u636e\u5f31\u5bf9\u5076\u53ef\u77e5\uff0c\u6808\u7684\u4e2a\u6570\u4e5f\u662f\u9012\u589e\u5b50\u5e8f\u5217\u7684\u4e0a\u754c\u3002 class Solution { public : int lengthOfLIS ( vector < int >& nums ) { vector < int > s ; //\u53ea\u9700\u8981\u4fdd\u5b58\u6808\u9876\u7684\u6570\u3002 int n = nums . size (); for ( int i = 0 ; i < n ; ++ i ) { int idx = binary_search_left_bound ( s , nums [ i ]); // \u67e5\u627e\u6700\u5de6\u8fb9\u53ef\u63d2\u5165\u7684\u4e0b\u964d\u6808 if ( idx == s . size ()) { s . push_back ( nums [ i ]); //\u589e\u52a0\u6808 } else { s [ idx ] = nums [ i ]; //\u538b\u5165\u6808 } } return s . size (); } private : int binary_search_left_bound ( vector < int > & s , int target ) { // \u6700\u5de6\u4fa7\u8fb9\u754c int l = 0 , r = s . size (); while ( l < r ) { int m = l + (( r - l ) >> 1 ); if ( s [ m ] >= target ) { r = m ; } else { l = m + 1 ; } } return l ; } }; Python\u4e2d\u6709\u4e00\u4e2a\u4e8c\u5206\u6cd5\u7684\u5b9e\u73b0\u6a21\u5757 bisect : bisect.bisect_left(a, num, lo=0, hi=len(a)) \u548c bisect.bisect_right(a, num, lo=0, hi=len(a)) \u3002 \u5b98\u65b9\u6587\u6863\u94fe\u63a5 \u53d8\u79cd\u95ee\u98981\uff1a\u4fc4\u7f57\u65af\u5957\u5a03\u4fe1\u5c01 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 354 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u6211\u4eec\u62e5\u6709\u4e00\u7cfb\u5217\u4fe1\u5c01 \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} , \u6211\u4eec\u9700\u8981\u627e\u4e00\u4e2a\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \uff0c\u6ee1\u8db3 w_{i_0} < w_{i_1} < \\ldots < w_{i_k} w_{i_0} < w_{i_1} < \\ldots < w_{i_k} \u5e76\u4e14 h_{i_0} < h_{i_1} < \\ldots < h_{i_k} h_{i_0} < h_{i_1} < \\ldots < h_{i_k} \uff0c\u5373\u5b50\u5e8f\u5217\u91cc\u7684\u4fe1\u5c01\u53ef\u4ee5\u4e00\u4e2a\u4e00\u4e2a\u5957\u8d77\u6765\u3002 \u5206\u6790 \uff1a\u8fd9\u4e2a\u95ee\u9898\u548c\u539f\u95ee\u9898\u7684\u5dee\u522b\u5728\u4e8e\uff0c\u5982\u679c\u5c06 h h \u770b\u6210\u539f\u95ee\u9898\u7684 x x , \u90a3\u4e48\u539f\u95ee\u9898\u7684\u4e0b\u6807\u7ea6\u675f\u6362\u6210\u4e86 w w \u7684\u7ea6\u675f\u3002\u4e3a\u4e86\u8f6c\u5316\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636e w w \u5bf9\u6570\u7ec4\u8fdb\u884c \u5347\u5e8f\u6392\u5e8f \u3002\u5f53\u7136\u6211\u4eec\u8fd8\u662f\u9700\u8981\u4e00\u4e2a\u5fae\u5999\u7684\u8c03\u6574\uff1a\u8fd9\u4e2a w w \u4e0d\u540c\u4e8e\u4e0b\u6807\uff0c\u5b83\u662f\u4f1a\u91cd\u590d\u7684\u3002\u5f53 w_i = w_j w_i = w_j \u65f6\uff0c (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u662f\u4e0d\u80fd\u5957\u5728\u4e00\u8d77\u7684\uff0c\u5373\u4e0d\u80fd\u51fa\u73b0\u5728\u540c\u4e00\u4e2a\u5b50\u5e8f\u5217\u4e2d\uff0c\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u4e2a\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u5bf9 (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u6839\u636e h h \u8fdb\u884c \u964d\u5e8f\u6392\u5e8f \u3002 \u6392\u5e8f\u5b8c\u6210\u540e\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u95ee\u9898\u4e86\u3002 int maxEnvelopes ( vector < vector < int >>& envelopes ) { if ( envelopes . empty ()) return 0 ; int n = envelopes . size (); sort ( envelopes . begin (), envelopes . end (), []( vector < int >& a , vector < int >& b ) { if ( a [ 0 ] == b [ 0 ]) { return a [ 1 ] > b [ 1 ]; } return a [ 0 ] < b [ 0 ]; }); return lengthOfLIS ( envelopes ); }","title":"\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217"},{"location":"Algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/#_1","text":"","title":"\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217"},{"location":"Algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/#_2","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 300 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u4e00\u4e2a\u6570\u7ec4 \\{x_0, x_1, \\ldots, x_n\\} \\{x_0, x_1, \\ldots, x_n\\} , \u6c42\u5b83\u7684\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \uff0c\u6ee1\u8db3 i_0 < i_1 < \\ldots i_k i_0 < i_1 < \\ldots i_k \u5e76\u4e14 x_{i_0} < x_{i_1} < \\ldots < x_{i_k} x_{i_0} < x_{i_1} < \\ldots < x_{i_k} \u3002 \u76ee\u6807 \uff1a\u52a8\u6001\u89c4\u5212\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6 O(n \\log n) O(n \\log n) \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 O(n) O(n) \u3002 \u9996\u5148\uff0c\u7b80\u5355\u7684\u52a8\u6001\u89c4\u5212\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(n^2) O(n^2) \u3002 for ( int i = 1 ; i < n ; ++ i ) { for ( int j = 0 ; j < i ; ++ j ) { if ( dp [ i ] > dp [ j ]) { dp [ i ] = max ( dp [ i ], dp [ j ] + 1 ); } } } \u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684 O(n \\log n) O(n \\log n) \u7b97\u6cd5\u5c31\u6bd4\u8f83\u5f3a\u4e86\uff0c\u7528\u5230\u4e86\u8d2a\u5fc3\u6cd5\u548c\u4e8c\u5206\u67e5\u627e\u6765\u964d\u4f4e\u590d\u6742\u5ea6\u3002 \u5177\u4f53\u6d41\u7a0b\u53ef\u4ee5\u770b \u666e\u6797\u65af\u987f\u5927\u5b66\u7684\u7b97\u6cd5\u8bfe\u7a0b\u7684\u4e00\u4e2appt \u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u7ef4\u62a4\u51e0\u4e2a\u4e0b\u964d\u6808\uff08\u521a\u5f00\u59cb\u662f0\u4e2a\u4e0b\u964d\u6808\uff09\u3002\u4ece\u5de6\u5230\u53f3\u904d\u5386\u6570\u7ec4\uff0c\u6bcf\u4e2a\u6570\u5c3d\u91cf\u538b\u5165\u5de6\u8fb9\u7684\u6808\uff08\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7528\u4e8c\u5206\u6cd5\u627e\u80fd\u538b\u5165\u7684\u6808\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6808\u53ef\u538b\u5165\uff0c\u90a3\u5c31\u65b0\u5efa\u4e00\u4e2a\u6808\u3002 \u5f31\u5bf9\u5076 \uff1a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e\u6808\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u4efb\u4f55\u4e0a\u5347\u5b50\u5e8f\u5217\u6700\u591a\u53ea\u80fd\u5305\u542b\u6bcf\u4e2a\u4e0b\u964d\u6808\u91cc\u7684\u4e00\u4e2a\u5143\u7d20\u3002 \u5f3a\u5bf9\u5076 \uff1a\u6bcf\u4e2a\u6570\u8981\u4e48\u5728\u7b2c\u4e00\u4e2a\u6808\uff0c\u8981\u4e48\u5b83\u524d\u9762\u7684\u6808\u5df2\u7ecf\u5b58\u5728\u6bd4\u5b83\u5c0f\u7684\u6570\u3002\u90a3\u4e48\u5f52\u7eb3\u603b\u7ed3\u6cd5\u53ef\u5f97\uff0c\u6bcf\u4e2a\u6570\u90fd\u6709\u5230\u7b2c\u4e00\u4e2a\u6808\u7684''\u901a\u8def''\uff08\u5f62\u6210\u9012\u589e\u5b50\u5e8f\u5217\uff09\u3002\u90a3\u4e48\uff0c\u8fd9\u4e2a\u6808\u7ec4\u7684\u6570\u636e\u7ed3\u6784\u5b58\u5728\u4e00\u4e2a\u957f\u5ea6\u7b49\u4e8e\u6808\u4e2a\u6570\u7684\u9012\u589e\u5b50\u5e8f\u5217\u3002\u518d\u6839\u636e\u5f31\u5bf9\u5076\u53ef\u77e5\uff0c\u6808\u7684\u4e2a\u6570\u4e5f\u662f\u9012\u589e\u5b50\u5e8f\u5217\u7684\u4e0a\u754c\u3002 class Solution { public : int lengthOfLIS ( vector < int >& nums ) { vector < int > s ; //\u53ea\u9700\u8981\u4fdd\u5b58\u6808\u9876\u7684\u6570\u3002 int n = nums . size (); for ( int i = 0 ; i < n ; ++ i ) { int idx = binary_search_left_bound ( s , nums [ i ]); // \u67e5\u627e\u6700\u5de6\u8fb9\u53ef\u63d2\u5165\u7684\u4e0b\u964d\u6808 if ( idx == s . size ()) { s . push_back ( nums [ i ]); //\u589e\u52a0\u6808 } else { s [ idx ] = nums [ i ]; //\u538b\u5165\u6808 } } return s . size (); } private : int binary_search_left_bound ( vector < int > & s , int target ) { // \u6700\u5de6\u4fa7\u8fb9\u754c int l = 0 , r = s . size (); while ( l < r ) { int m = l + (( r - l ) >> 1 ); if ( s [ m ] >= target ) { r = m ; } else { l = m + 1 ; } } return l ; } }; Python\u4e2d\u6709\u4e00\u4e2a\u4e8c\u5206\u6cd5\u7684\u5b9e\u73b0\u6a21\u5757 bisect : bisect.bisect_left(a, num, lo=0, hi=len(a)) \u548c bisect.bisect_right(a, num, lo=0, hi=len(a)) \u3002 \u5b98\u65b9\u6587\u6863\u94fe\u63a5","title":"\u539f\u59cb\u95ee\u9898"},{"location":"Algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/#1","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 354 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u6211\u4eec\u62e5\u6709\u4e00\u7cfb\u5217\u4fe1\u5c01 \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} , \u6211\u4eec\u9700\u8981\u627e\u4e00\u4e2a\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \uff0c\u6ee1\u8db3 w_{i_0} < w_{i_1} < \\ldots < w_{i_k} w_{i_0} < w_{i_1} < \\ldots < w_{i_k} \u5e76\u4e14 h_{i_0} < h_{i_1} < \\ldots < h_{i_k} h_{i_0} < h_{i_1} < \\ldots < h_{i_k} \uff0c\u5373\u5b50\u5e8f\u5217\u91cc\u7684\u4fe1\u5c01\u53ef\u4ee5\u4e00\u4e2a\u4e00\u4e2a\u5957\u8d77\u6765\u3002 \u5206\u6790 \uff1a\u8fd9\u4e2a\u95ee\u9898\u548c\u539f\u95ee\u9898\u7684\u5dee\u522b\u5728\u4e8e\uff0c\u5982\u679c\u5c06 h h \u770b\u6210\u539f\u95ee\u9898\u7684 x x , \u90a3\u4e48\u539f\u95ee\u9898\u7684\u4e0b\u6807\u7ea6\u675f\u6362\u6210\u4e86 w w \u7684\u7ea6\u675f\u3002\u4e3a\u4e86\u8f6c\u5316\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636e w w \u5bf9\u6570\u7ec4\u8fdb\u884c \u5347\u5e8f\u6392\u5e8f \u3002\u5f53\u7136\u6211\u4eec\u8fd8\u662f\u9700\u8981\u4e00\u4e2a\u5fae\u5999\u7684\u8c03\u6574\uff1a\u8fd9\u4e2a w w \u4e0d\u540c\u4e8e\u4e0b\u6807\uff0c\u5b83\u662f\u4f1a\u91cd\u590d\u7684\u3002\u5f53 w_i = w_j w_i = w_j \u65f6\uff0c (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u662f\u4e0d\u80fd\u5957\u5728\u4e00\u8d77\u7684\uff0c\u5373\u4e0d\u80fd\u51fa\u73b0\u5728\u540c\u4e00\u4e2a\u5b50\u5e8f\u5217\u4e2d\uff0c\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u4e2a\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u5bf9 (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u6839\u636e h h \u8fdb\u884c \u964d\u5e8f\u6392\u5e8f \u3002 \u6392\u5e8f\u5b8c\u6210\u540e\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u95ee\u9898\u4e86\u3002 int maxEnvelopes ( vector < vector < int >>& envelopes ) { if ( envelopes . empty ()) return 0 ; int n = envelopes . size (); sort ( envelopes . begin (), envelopes . end (), []( vector < int >& a , vector < int >& b ) { if ( a [ 0 ] == b [ 0 ]) { return a [ 1 ] > b [ 1 ]; } return a [ 0 ] < b [ 0 ]; }); return lengthOfLIS ( envelopes ); }","title":"\u53d8\u79cd\u95ee\u98981\uff1a\u4fc4\u7f57\u65af\u5957\u5a03\u4fe1\u5c01"},{"location":"Algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/","text":"\u533a\u95f4\u8c03\u5ea6\u95ee\u9898 \u00b6 \u539f\u95ee\u9898 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode435 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u6709n\u9879\u5de5\u4f5c \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \uff0c\u5176\u4e2d s s \u8868\u793a\u8d77\u59cb\u8be5\u5de5\u4f5c\u7684\u8d77\u59cb\u65f6\u95f4\uff0c e e \u8868\u793a\u8be5\u5de5\u4f5c\u7684\u7ed3\u675f\u65f6\u95f4\u3002\u9009\u53d6\u4e00\u4e2a\u6700\u957f\u5b50\u5e8f\u5217 \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \uff0c\u6ee1\u8db3\u8fd9\u4e9b\u5de5\u4f5c\u7684\u65f6\u95f4\u4e92\u4e0d\u76f8\u4ea4\u3002 \u76ee\u6807 \uff1a\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217\u6765\u505a\uff0c\u4f46\u662f\u6709\u66f4\u5de7\u5999\u7684\u8d2a\u5fc3\u7b97\u6cd5\u3002\u9664\u53bb\u6392\u5e8f\u7684\u65f6\u95f4\u590d\u6742\u5ea6 O(n\\log n) O(n\\log n) \uff0c\u8d2a\u5fc3\u7b97\u6cd5\u53ef\u4ee5\u5230 O(n) O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u5c06\u8fd9\u4e9b\u5de5\u4f5c\u6309\u7167\u7ed3\u675f\u65f6\u95f4 e e \u505a\u5347\u5e8f\u6392\u5e8f\u3002\u4e0d\u65ad\u9009\u53d6\u5f53\u524d\u5269\u4f59\u5de5\u4f5c\u4e2d\uff0c\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u628a\u4e0e\u8fd9\u4e2a\u5de5\u4f5c\u51b2\u7a81\u7684\u5de5\u4f5c\u53bb\u6389\u3002 \u8bc1\u660e \uff1a \u9996\u5148\uff0c\u4ece\u7b97\u6cd5\u6d41\u7a0b\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u9009\u51fa\u6765\u7684\u5b50\u5e8f\u5217\u4e92\u4e0d\u51b2\u7a81\u3002 \u5176\u6b21\uff1a\u89c4\u5b9a\u8fd9\u4e2a\u8d2a\u5fc3\u6cd5\u6240\u6784\u9020\u7684\u7ed3\u679c\u4e3a \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \uff0c\u4ee5\u53ca\u6700\u4f18\u89e3\u4e3a \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u4efb\u610f\u7684 idx idx , \u6211\u4eec\u53ef\u5f97 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u5f97: idx = 0 idx = 0 \u6ee1\u8db3\u8981\u6c42\uff1b\u5f53 idx > 0 idx > 0 \u65f6\u5047\u8bbe e_{i_{idx - 1}} \\le e_{j_{idx - 1}} e_{i_{idx - 1}} \\le e_{j_{idx - 1}} \u90a3\u4e48 \u6700\u4f18\u89e3\u7684\u5269\u4f59\u53ef\u9009\u533a\u95f4 \u5c11\u4e8e \u8d2a\u5fc3\u6cd5\u7684\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\uff0c\u800c\u8d2a\u5fc3\u6cd5\u53c8\u662f\u5728\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\u4e2d\u9009\u62e9\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u533a\u95f4\uff0c\u90a3\u4e48 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u8bc1\u660e k = m k = m \u3002\u6211\u4eec\u7528\u53cd\u8bc1\u6cd5\uff0c\u5982\u679c k < m k < m \uff0c\u53c8\u7531\u4e8e e_{i_{k}} < e_{j_{k}} e_{i_{k}} < e_{j_{k}} , \u90a3\u4e48 e_{i_{k}} < s_{j_{k+1}} e_{i_{k}} < s_{j_{k+1}} \uff0c\u5373\u6700\u4f18\u89e3\u7684\u5269\u4f59\u533a\u95f4\u53ef\u4ee5\u7eed\u7ed9\u8d2a\u5fc3\u6cd5\u7684\u7ed3\u679c\uff0c\u8fd9\u5c31\u548c\u6211\u4eec\u8d2a\u5fc3\u6cd5\u7684\u6d41\u7a0b\u77db\u76fe\u4e86\u3002 \u53d8\u79cd1\uff1a\u5c04\u6c14\u7403\u95ee\u9898 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode452 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u5927\u5c0f\u4e0d\u540c\u7684\u6c14\u7403\u6392\u5728\u540c\u4e00\u4e2a\u6c34\u5e73\u9762\u4e0a\uff08\u7403\u5fc3\u7684 z z \u5750\u6807\u76f8\u540c\uff09\uff0c\u90a3\u4e48\u5728 x-y x-y \u5e73\u9762\u6bcf\u4e2a\u6c14\u7403\u5c31\u662f\u4e00\u4e2a\u4e2a\u5927\u5c0f\u4e0d\u540c\u4e92\u4e0d\u76f8\u4ea4\u7684\u5706\u3002\u5982\u679c\u6211\u4eec\u5728 x x \u8f74\u4e0a\u5782\u76f4\u4e8e x x \u8f74\u5c04\u51fb\uff0c\u6bcf\u6b21\u5c04\u51fb\u65f6\uff0c\u76f4\u7ebf\u4e0a\u7a7f\u8fc7\u7684\u6c14\u7403\u90fd\u4f1a\u88ab\u5c04\u7206\uff0c\u90a3\u4e48\u6700\u591a\u9700\u8981\u5f00\u51e0\u67aa\u624d\u80fd\u628a\u6240\u6709\u6c14\u7403\u5c04\u7206\u3002 \u5206\u6790 \uff1a\u6bcf\u4e2a\u6c14\u7403\u5728 x x \u8f74\u4e0a\u7684\u6295\u5f71\u662f\u4e00\u4e2a\u533a\u95f4\uff0c\u6709\u91cd\u53e0\u533a\u95f4\u7684\u6c14\u7403\u53ea\u9700\u8981\u4e00\u67aa\u5c31\u53ef\u4ee5\u5168\u90e8\u5c04\u7206\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u662f\u6c42\u6700\u5927\u4e0d\u91cd\u53e0\u533a\u95f4\u7684\u4e2a\u6570\u3002","title":"\u533a\u95f4\u8c03\u5ea6\u95ee\u9898"},{"location":"Algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/#_1","text":"","title":"\u533a\u95f4\u8c03\u5ea6\u95ee\u9898"},{"location":"Algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/#_2","text":"\u8be6\u60c5\u53c2\u8003 LeetCode435 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u6709n\u9879\u5de5\u4f5c \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \uff0c\u5176\u4e2d s s \u8868\u793a\u8d77\u59cb\u8be5\u5de5\u4f5c\u7684\u8d77\u59cb\u65f6\u95f4\uff0c e e \u8868\u793a\u8be5\u5de5\u4f5c\u7684\u7ed3\u675f\u65f6\u95f4\u3002\u9009\u53d6\u4e00\u4e2a\u6700\u957f\u5b50\u5e8f\u5217 \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \uff0c\u6ee1\u8db3\u8fd9\u4e9b\u5de5\u4f5c\u7684\u65f6\u95f4\u4e92\u4e0d\u76f8\u4ea4\u3002 \u76ee\u6807 \uff1a\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217\u6765\u505a\uff0c\u4f46\u662f\u6709\u66f4\u5de7\u5999\u7684\u8d2a\u5fc3\u7b97\u6cd5\u3002\u9664\u53bb\u6392\u5e8f\u7684\u65f6\u95f4\u590d\u6742\u5ea6 O(n\\log n) O(n\\log n) \uff0c\u8d2a\u5fc3\u7b97\u6cd5\u53ef\u4ee5\u5230 O(n) O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u5c06\u8fd9\u4e9b\u5de5\u4f5c\u6309\u7167\u7ed3\u675f\u65f6\u95f4 e e \u505a\u5347\u5e8f\u6392\u5e8f\u3002\u4e0d\u65ad\u9009\u53d6\u5f53\u524d\u5269\u4f59\u5de5\u4f5c\u4e2d\uff0c\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u628a\u4e0e\u8fd9\u4e2a\u5de5\u4f5c\u51b2\u7a81\u7684\u5de5\u4f5c\u53bb\u6389\u3002 \u8bc1\u660e \uff1a \u9996\u5148\uff0c\u4ece\u7b97\u6cd5\u6d41\u7a0b\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u9009\u51fa\u6765\u7684\u5b50\u5e8f\u5217\u4e92\u4e0d\u51b2\u7a81\u3002 \u5176\u6b21\uff1a\u89c4\u5b9a\u8fd9\u4e2a\u8d2a\u5fc3\u6cd5\u6240\u6784\u9020\u7684\u7ed3\u679c\u4e3a \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \uff0c\u4ee5\u53ca\u6700\u4f18\u89e3\u4e3a \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u4efb\u610f\u7684 idx idx , \u6211\u4eec\u53ef\u5f97 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u5f97: idx = 0 idx = 0 \u6ee1\u8db3\u8981\u6c42\uff1b\u5f53 idx > 0 idx > 0 \u65f6\u5047\u8bbe e_{i_{idx - 1}} \\le e_{j_{idx - 1}} e_{i_{idx - 1}} \\le e_{j_{idx - 1}} \u90a3\u4e48 \u6700\u4f18\u89e3\u7684\u5269\u4f59\u53ef\u9009\u533a\u95f4 \u5c11\u4e8e \u8d2a\u5fc3\u6cd5\u7684\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\uff0c\u800c\u8d2a\u5fc3\u6cd5\u53c8\u662f\u5728\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\u4e2d\u9009\u62e9\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u533a\u95f4\uff0c\u90a3\u4e48 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u8bc1\u660e k = m k = m \u3002\u6211\u4eec\u7528\u53cd\u8bc1\u6cd5\uff0c\u5982\u679c k < m k < m \uff0c\u53c8\u7531\u4e8e e_{i_{k}} < e_{j_{k}} e_{i_{k}} < e_{j_{k}} , \u90a3\u4e48 e_{i_{k}} < s_{j_{k+1}} e_{i_{k}} < s_{j_{k+1}} \uff0c\u5373\u6700\u4f18\u89e3\u7684\u5269\u4f59\u533a\u95f4\u53ef\u4ee5\u7eed\u7ed9\u8d2a\u5fc3\u6cd5\u7684\u7ed3\u679c\uff0c\u8fd9\u5c31\u548c\u6211\u4eec\u8d2a\u5fc3\u6cd5\u7684\u6d41\u7a0b\u77db\u76fe\u4e86\u3002","title":"\u539f\u95ee\u9898"},{"location":"Algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/#1","text":"\u8be6\u60c5\u53c2\u8003 LeetCode452 \u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u5927\u5c0f\u4e0d\u540c\u7684\u6c14\u7403\u6392\u5728\u540c\u4e00\u4e2a\u6c34\u5e73\u9762\u4e0a\uff08\u7403\u5fc3\u7684 z z \u5750\u6807\u76f8\u540c\uff09\uff0c\u90a3\u4e48\u5728 x-y x-y \u5e73\u9762\u6bcf\u4e2a\u6c14\u7403\u5c31\u662f\u4e00\u4e2a\u4e2a\u5927\u5c0f\u4e0d\u540c\u4e92\u4e0d\u76f8\u4ea4\u7684\u5706\u3002\u5982\u679c\u6211\u4eec\u5728 x x \u8f74\u4e0a\u5782\u76f4\u4e8e x x \u8f74\u5c04\u51fb\uff0c\u6bcf\u6b21\u5c04\u51fb\u65f6\uff0c\u76f4\u7ebf\u4e0a\u7a7f\u8fc7\u7684\u6c14\u7403\u90fd\u4f1a\u88ab\u5c04\u7206\uff0c\u90a3\u4e48\u6700\u591a\u9700\u8981\u5f00\u51e0\u67aa\u624d\u80fd\u628a\u6240\u6709\u6c14\u7403\u5c04\u7206\u3002 \u5206\u6790 \uff1a\u6bcf\u4e2a\u6c14\u7403\u5728 x x \u8f74\u4e0a\u7684\u6295\u5f71\u662f\u4e00\u4e2a\u533a\u95f4\uff0c\u6709\u91cd\u53e0\u533a\u95f4\u7684\u6c14\u7403\u53ea\u9700\u8981\u4e00\u67aa\u5c31\u53ef\u4ee5\u5168\u90e8\u5c04\u7206\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u662f\u6c42\u6700\u5927\u4e0d\u91cd\u53e0\u533a\u95f4\u7684\u4e2a\u6570\u3002","title":"\u53d8\u79cd1\uff1a\u5c04\u6c14\u7403\u95ee\u9898"},{"location":"Algorithms/03-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/","text":"\u88f4\u8700\u5b9a\u7406 \u00b6 \u9996\u5148\u5b9a\u4e49\u4e00\u4e9b\u7b26\u53f7\uff1a \u6700\u5927\u516c\u7ea6\u6570(Greatest Common Divisor): gcd(a, b) gcd(a, b) ; \u53d6\u4f59\uff1a a \\mod b = a - \\left\\lfloor a/b \\right\\rfloor \\cdot b a \\mod b = a - \\left\\lfloor a/b \\right\\rfloor \\cdot b ; \u6574\u9664\uff1a a \\vert b a \\vert b \u8868\u793a a a \u80fd\u88ab b b \u6574\u9664\u3002 \u6b27\u51e0\u91cc\u5f97\u5b9a\u7406 \u00b6 \u5b9a\u74061 ( \u6b27\u51e0\u91cc\u5f97\u5b9a\u7406 ) \\tag{1} \\label{gcd} gcd(a, b) = gcd(b, a \\bmod b). \\tag{1} \\label{gcd} gcd(a, b) = gcd(b, a \\bmod b). \u8bc1\u660e \u8bbe r = a \\bmod b r = a \\bmod b \uff0c\u90a3\u4e48 \u9700\u8981\u8bc1\u660e gcd(a, b) = gcd(b, r) gcd(a, b) = gcd(b, r) \u3002 \u518d\u8bbe m = gcd(a, b) m = gcd(a, b) \u4ee5\u53ca n = gcd(b, r) n = gcd(b, r) \u3002 \u6b63\u6574\u6570 a = kb + r a = kb + r \uff0c\u5176\u4e2d k k \u4e3a\u6b63\u6574\u6570\uff0c\u5e76\u4e14 r = a - kb r = a - kb \u3002 \u7531 m \\vert a m \\vert a \u4e0e m \\vert b m \\vert b \u53ef\u5f97 m \\vert (a - kb) m \\vert (a - kb) \uff0c\u5373 m \\vert r m \\vert r \u3002 \u6240\u4ee5 m m \u4e5f\u662f b b \u4e0e r r \u7684\u516c\u7ea6\u6570\uff0c\u5e76\u4e14 m \\le n m \\le n \u3002 \u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u7531 n \\vert b n \\vert b , n \\vert r n \\vert r \u53ef\u5f97 n \\vert (kb + r) n \\vert (kb + r) \uff0c\u5373 n \\vert a n \\vert a \u3002 \u6240\u4ee5 n n \u4e5f\u662f a a \u4e0e b b \u7684\u516c\u7ea6\u6570\uff0c\u5e76\u4e14 n \\le m n \\le m \u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u5f97 m = n m = n \u3002 int gcd ( int a , int b ) { return ( b == 0 ) ? a : gcd ( b , a % b );} \u88f4\u8700\u5b9a\u7406 \u00b6 \u5b9a\u74062 ( \u88f4\u8700\u5b9a\u7406 ) \u7ed9\u5b9a\u6574\u6570 a a \u548c b b , \u5bf9\u4e8e ax + by = c ax + by = c \u6709\u6574\u6570\u89e3\u7684\u5145\u8981\u6761\u4ef6\u662f c = k_c \\cdot gcd(a, b) c = k_c \\cdot gcd(a, b) \uff0c k_c k_c \u4e3a\u6574\u6570\u3002 \u8bc1\u660e \u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a a \\ge 0 a \\ge 0 , b \\ge 0 b \\ge 0 , c \\ge 0 c \\ge 0 \u3002 \u5fc5\u8981\u6027 \uff1a\u5047\u8bbe c c \u4e0d\u4e3a gcd(a, b) gcd(a, b) \u7684\u6574\u6570\u500d\u3002 \u8bbe d = gcd(a, b) d = gcd(a, b) , \u90a3\u4e48 a = k_a d a = k_a d , b = k_b d b = k_b d \u4ee5\u53ca c = k_c d + c' c = k_c d + c' \u3002\u5176\u4e2d c' = c \\mod d c' = c \\mod d \uff0c\u5e76\u4e14 c' > 0 c' > 0 \u3002\u90a3\u4e48 k_a x + k_b y = k_c + c'/d, k_a x + k_b y = k_c + c'/d, \u5176\u4e2d c'/d c'/d \u662f\u5c0f\u6570\u3002\u56e0\u4e3a\u5de6\u8fb9\u5fc5\u7136\u662f\u6574\u6570\uff0c\u6240\u4ee5\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\u3002 \u5145\u5206\u6027 : \u7ee7\u627f\u4e0a\u9762\u7684\u7b26\u53f7, \u53ef\u5f97 k_a x + k_b y = k_c. k_a x + k_b y = k_c. \u62bd\u8c61\u53ef\u5f97\uff1a m_0 m_0 , n_0 n_0 \u4e92\u8d28\u65f6\uff0c\u4e0d\u5b9a\u65b9\u7a0b m_0 x_0 + n_0 y_0 = 1 m_0 x_0 + n_0 y_0 = 1 \u4e00\u5b9a\u6709\u89e3\u3002 \\begin{cases} m_0 x_0 + n_0 y_0 = 1;\\\\ m_1 x_1 + n_1 y_1 = 1, &m_1 = n_0, n_1 = m_0 \\bmod n_0;\\\\ \\vdots\\\\ m_t x_t + n_t y_t = 1, &m_t = n_{t-1}, n_t = m_{t-1} \\bmod n_{t-1}. \\end{cases} \\begin{cases} m_0 x_0 + n_0 y_0 = 1;\\\\ m_1 x_1 + n_1 y_1 = 1, &m_1 = n_0, n_1 = m_0 \\bmod n_0;\\\\ \\vdots\\\\ m_t x_t + n_t y_t = 1, &m_t = n_{t-1}, n_t = m_{t-1} \\bmod n_{t-1}. \\end{cases} \u7531\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406\u53ef\u5f97\uff0c\u603b\u80fd\u5199\u5230\u67d0\u4e2a t t \u6ee1\u8db3 m_t = 1, n_t = 0 m_t = 1, n_t = 0 \uff0c\u90a3\u4e48\u7b2ct\u4e2a\u65b9\u7a0b\u5b58\u5728\u67d0\u4e00\u7ec4\u6574\u6570\u89e3 (1, 0) (1, 0) \u3002 \u7531 (i+1) (i+1) th \u65b9\u7a0b\u7684\u89e3\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 i i th \u65b9\u7a0b\u7684\u89e3: \\begin{align*} & m_i x_i + n_i y_i = m_{i+1} x_{i+1} + n_{i+1} y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = n_i x_{i+1} + (m_i - \\lfloor m_i / n_i \\rfloor n_i)y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = m_i y_{i+1} + n_i (x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}) \\\\ \\Rightarrow& \\begin{cases} x_i = y_{i+1}, \\\\ y_i = x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}. \\end{cases} \\end{align*} \\begin{align*} & m_i x_i + n_i y_i = m_{i+1} x_{i+1} + n_{i+1} y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = n_i x_{i+1} + (m_i - \\lfloor m_i / n_i \\rfloor n_i)y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = m_i y_{i+1} + n_i (x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}) \\\\ \\Rightarrow& \\begin{cases} x_i = y_{i+1}, \\\\ y_i = x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}. \\end{cases} \\end{align*} \u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u539f\u65b9\u7a0b\u7684\u89e3 (x_0, y_0) (x_0, y_0) \u3002 Note \u7531\u88f4\u7956\u5b9a\u7406\u7684\u8bc1\u660e\u8fc7\u7a0b\uff0c\u6211\u4eec\u540c\u65f6\u4e5f\u83b7\u5f97\u4e86 \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5 \uff0c\u7528\u6765\u6c42\u89e3\u4e0d\u5b9a\u65b9\u7a0b a_0 x_0 + b_0 y_0 = gcd(a_0, b_0) a_0 x_0 + b_0 y_0 = gcd(a_0, b_0) \u3002 \u552f\u4e00\u4e0d\u540c\u5728\u4e8e\u6211\u4eec\u6784\u9020\u7684\u65b9\u7a0b\u7ec4\u662f\uff1a \\begin{cases} a_0 x_0 + b_0 y_0 = gcd(a_0, b_0);\\\\ a_1 x_1 + b_1 y_1 = gcd(a_1, b_1), &a_1 = b_0, b_1 = a_0 \\bmod b_0;\\\\ \\vdots\\\\ a_t x_t + b_t y_t = gcd(a_t, b_t), &a_t = b_{t-1}, b_t = a_{t-1} \\bmod b_{t-1}. \\end{cases} \\begin{cases} a_0 x_0 + b_0 y_0 = gcd(a_0, b_0);\\\\ a_1 x_1 + b_1 y_1 = gcd(a_1, b_1), &a_1 = b_0, b_1 = a_0 \\bmod b_0;\\\\ \\vdots\\\\ a_t x_t + b_t y_t = gcd(a_t, b_t), &a_t = b_{t-1}, b_t = a_{t-1} \\bmod b_{t-1}. \\end{cases} void exgcd ( int a , int b , int & x , int & y ) { if ( ! b ) { x = 1 , y = 0 ; } else { exgcd ( b , a % b , y , x ); y -= a / b * x ; } } Cite [1] \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u2014\u2014\u88f4\u8700\uff08\u8d1d\u7956\uff09\u5b9a\u7406 [2] \u88f4\u8700\u5b9a\u7406\uff08\u8d1d\u7956\u5b9a\u7406\uff09 \u8bc1\u660e\u4e0e\u5e94\u7528 [3] \u88f4\u8700\u5b9a\u7406(\u8d1d\u7956\u5b9a\u7406)\u53ca\u8bc1\u660e \u5012\u6c34\u95ee\u9898 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 365 . \u95ee\u9898\u63cf\u8ff0 \uff1a\u6709\u5927\u5c0f\u5206\u522b\u4e3a a a \u548c b b \u7684\u4e24\u4e2a\u5bb9\u5668\uff0c\u4ee5\u53ca\u65e0\u9650\u7684\u6c34\uff0c\u95ee\u80fd\u5426\u5012\u51fa\u4f53\u79ef\u4e3a c c \u7684\u6c34\u3002 \u5012\u5165\u4f53\u79ef\u4e3a c c \u7684\u6c34\u610f\u5473\u7740\u67d0\u4e00\u4e2a\u5bb9\u5668\u91cc\u7684\u6c34\u4f53\u79ef\u4e3a c c , \u6216\u8005\u4e24\u4e2a\u5bb9\u5668\u4e2d\u6c34\u7684\u4f53\u79ef\u4e00\u5171\u4e3a c c \u3002\u80fd\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a \u88c5\u6ee1\u67d0\u4e00\u4e2a\u5bb9\u5668\uff1b \u5012\u7a7a\u67d0\u4e00\u4e2a\u5bb9\u5668\uff1b \u5c06\u67d0\u4e00\u4e2a\u5bb9\u5668\u7684\u6c34\u5012\u5230\u53e6\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u76f4\u81f3\u51fa\u73b0\u4e00\u4e2a\u5bb9\u5668\u6ee1\u6216\u4e00\u4e2a\u5bb9\u5668\u7a7a\u3002 \u5206\u6790 \uff1a\u8fd9\u4e2a\u95ee\u9898\u5145\u8981\u6761\u4ef6\u4e3a ax + by = c ax + by = c \u6709\u6574\u6570\u89e3 \u5e76\u4e14 c \\le a + b c \\le a + b \u3002 \u5fc5\u8981\u6027 \uff1a\u4e24\u4e2a\u5bb9\u5668\u4e2d\u6c34\u7684\u603b\u4f53\u79ef\u4e00\u5b9a\u6ee1\u8db3 ax + by ax + by , \u5176\u4e2d x x \u548c y y \u662f\u6574\u6570\u3002 \u4e0d\u53ef\u80fd\u51fa\u73b0\u4e24\u4e2a\u5bb9\u5668\u540c\u65f6\u4e0d\u6ee1\u7684\u65f6\u5019\uff1b \u5f80\u4e0d\u6ee1\u7684\u5bb9\u5668\u91cc\u52a0\u6c34\u6ca1\u6709\u610f\u4e49\uff0c\u7b49\u4ef7\u4e8e\u521d\u59cb\u72b6\u6001\u65f6\u7ed9\u5bf9\u5e94\u5bb9\u5668\u52a0\u6ee1\uff1b \u6e05\u7a7a\u4e0d\u6ee1\u7684\u5bb9\u5668\u6ca1\u6709\u610f\u4e49\uff0c\u7b49\u4ef7\u4e8e\u521d\u59cb\u72b6\u6001\u3002 \u7efc\u4e0a\uff0c\u4e24\u5bb9\u5668\u4e2d\u6c34\u7684\u603b\u4f53\u79ef\u4e00\u5b9a\u6ee1\u8db3 ax + by ax + by \u3002 \u5145\u5206\u6027 \uff1a\u5982\u679c x \\ge 0 x \\ge 0 \u5e76\u4e14 y \\ge 0 y \\ge 0 \uff0c\u8868\u793a\u628a\u5bf9\u5e94\u7684\u5bb9\u5668\u63a5\u6ee1\u5c31\u53ef\u4ee5\u4e86\uff1b\u5982\u679c x < 0 x < 0 \u6216 y < 0 y < 0 \uff0c\u4ee5 y y \u4e3a\u91cf\u676f\u589e\u52a0\u6c34\uff0c\u518d\u4ee5 x x \u4e3a\u91cf\u676f\u51cf\u5c11\u6c34\uff08\u8fd9\u4e2a\u64cd\u4f5c\u9700\u8981\u601d\u8003\u4e00\u4e0b\uff0c\u786e\u5b9e\u80fd\u591f\u505a\u5230\uff09\u3002 \u5b98\u65b9\u9898\u89e3\u9700\u8981\u8003\u8651\u5f88\u591a\u56e0\u7d20\uff1a class Solution { public : bool canMeasureWater ( int x , int y , int z ) { if ( x + y < z ) { return false ; } if ( x == 0 || y == 0 ) { return z == 0 || x + y == z ; } int a = gcd ( x , y ); return z % a == 0 ; } private : int gcd ( int x , int y ) { return ( y == 0 ) ? x : gcd ( y , x % y ); } }; Cite [1] LeetCode 365 [2] LeetCode \u5b98\u65b9\u9898\u89e3","title":"\u88f4\u8700\u5b9a\u7406"},{"location":"Algorithms/03-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/#_1","text":"\u9996\u5148\u5b9a\u4e49\u4e00\u4e9b\u7b26\u53f7\uff1a \u6700\u5927\u516c\u7ea6\u6570(Greatest Common Divisor): gcd(a, b) gcd(a, b) ; \u53d6\u4f59\uff1a a \\mod b = a - \\left\\lfloor a/b \\right\\rfloor \\cdot b a \\mod b = a - \\left\\lfloor a/b \\right\\rfloor \\cdot b ; \u6574\u9664\uff1a a \\vert b a \\vert b \u8868\u793a a a \u80fd\u88ab b b \u6574\u9664\u3002","title":"\u88f4\u8700\u5b9a\u7406"},{"location":"Algorithms/03-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/#_2","text":"\u5b9a\u74061 ( \u6b27\u51e0\u91cc\u5f97\u5b9a\u7406 ) \\tag{1} \\label{gcd} gcd(a, b) = gcd(b, a \\bmod b). \\tag{1} \\label{gcd} gcd(a, b) = gcd(b, a \\bmod b). \u8bc1\u660e \u8bbe r = a \\bmod b r = a \\bmod b \uff0c\u90a3\u4e48 \u9700\u8981\u8bc1\u660e gcd(a, b) = gcd(b, r) gcd(a, b) = gcd(b, r) \u3002 \u518d\u8bbe m = gcd(a, b) m = gcd(a, b) \u4ee5\u53ca n = gcd(b, r) n = gcd(b, r) \u3002 \u6b63\u6574\u6570 a = kb + r a = kb + r \uff0c\u5176\u4e2d k k \u4e3a\u6b63\u6574\u6570\uff0c\u5e76\u4e14 r = a - kb r = a - kb \u3002 \u7531 m \\vert a m \\vert a \u4e0e m \\vert b m \\vert b \u53ef\u5f97 m \\vert (a - kb) m \\vert (a - kb) \uff0c\u5373 m \\vert r m \\vert r \u3002 \u6240\u4ee5 m m \u4e5f\u662f b b \u4e0e r r \u7684\u516c\u7ea6\u6570\uff0c\u5e76\u4e14 m \\le n m \\le n \u3002 \u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u7531 n \\vert b n \\vert b , n \\vert r n \\vert r \u53ef\u5f97 n \\vert (kb + r) n \\vert (kb + r) \uff0c\u5373 n \\vert a n \\vert a \u3002 \u6240\u4ee5 n n \u4e5f\u662f a a \u4e0e b b \u7684\u516c\u7ea6\u6570\uff0c\u5e76\u4e14 n \\le m n \\le m \u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u5f97 m = n m = n \u3002 int gcd ( int a , int b ) { return ( b == 0 ) ? a : gcd ( b , a % b );}","title":"\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406"},{"location":"Algorithms/03-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/#_3","text":"\u5b9a\u74062 ( \u88f4\u8700\u5b9a\u7406 ) \u7ed9\u5b9a\u6574\u6570 a a \u548c b b , \u5bf9\u4e8e ax + by = c ax + by = c \u6709\u6574\u6570\u89e3\u7684\u5145\u8981\u6761\u4ef6\u662f c = k_c \\cdot gcd(a, b) c = k_c \\cdot gcd(a, b) \uff0c k_c k_c \u4e3a\u6574\u6570\u3002 \u8bc1\u660e \u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a a \\ge 0 a \\ge 0 , b \\ge 0 b \\ge 0 , c \\ge 0 c \\ge 0 \u3002 \u5fc5\u8981\u6027 \uff1a\u5047\u8bbe c c \u4e0d\u4e3a gcd(a, b) gcd(a, b) \u7684\u6574\u6570\u500d\u3002 \u8bbe d = gcd(a, b) d = gcd(a, b) , \u90a3\u4e48 a = k_a d a = k_a d , b = k_b d b = k_b d \u4ee5\u53ca c = k_c d + c' c = k_c d + c' \u3002\u5176\u4e2d c' = c \\mod d c' = c \\mod d \uff0c\u5e76\u4e14 c' > 0 c' > 0 \u3002\u90a3\u4e48 k_a x + k_b y = k_c + c'/d, k_a x + k_b y = k_c + c'/d, \u5176\u4e2d c'/d c'/d \u662f\u5c0f\u6570\u3002\u56e0\u4e3a\u5de6\u8fb9\u5fc5\u7136\u662f\u6574\u6570\uff0c\u6240\u4ee5\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\u3002 \u5145\u5206\u6027 : \u7ee7\u627f\u4e0a\u9762\u7684\u7b26\u53f7, \u53ef\u5f97 k_a x + k_b y = k_c. k_a x + k_b y = k_c. \u62bd\u8c61\u53ef\u5f97\uff1a m_0 m_0 , n_0 n_0 \u4e92\u8d28\u65f6\uff0c\u4e0d\u5b9a\u65b9\u7a0b m_0 x_0 + n_0 y_0 = 1 m_0 x_0 + n_0 y_0 = 1 \u4e00\u5b9a\u6709\u89e3\u3002 \\begin{cases} m_0 x_0 + n_0 y_0 = 1;\\\\ m_1 x_1 + n_1 y_1 = 1, &m_1 = n_0, n_1 = m_0 \\bmod n_0;\\\\ \\vdots\\\\ m_t x_t + n_t y_t = 1, &m_t = n_{t-1}, n_t = m_{t-1} \\bmod n_{t-1}. \\end{cases} \\begin{cases} m_0 x_0 + n_0 y_0 = 1;\\\\ m_1 x_1 + n_1 y_1 = 1, &m_1 = n_0, n_1 = m_0 \\bmod n_0;\\\\ \\vdots\\\\ m_t x_t + n_t y_t = 1, &m_t = n_{t-1}, n_t = m_{t-1} \\bmod n_{t-1}. \\end{cases} \u7531\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406\u53ef\u5f97\uff0c\u603b\u80fd\u5199\u5230\u67d0\u4e2a t t \u6ee1\u8db3 m_t = 1, n_t = 0 m_t = 1, n_t = 0 \uff0c\u90a3\u4e48\u7b2ct\u4e2a\u65b9\u7a0b\u5b58\u5728\u67d0\u4e00\u7ec4\u6574\u6570\u89e3 (1, 0) (1, 0) \u3002 \u7531 (i+1) (i+1) th \u65b9\u7a0b\u7684\u89e3\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 i i th \u65b9\u7a0b\u7684\u89e3: \\begin{align*} & m_i x_i + n_i y_i = m_{i+1} x_{i+1} + n_{i+1} y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = n_i x_{i+1} + (m_i - \\lfloor m_i / n_i \\rfloor n_i)y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = m_i y_{i+1} + n_i (x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}) \\\\ \\Rightarrow& \\begin{cases} x_i = y_{i+1}, \\\\ y_i = x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}. \\end{cases} \\end{align*} \\begin{align*} & m_i x_i + n_i y_i = m_{i+1} x_{i+1} + n_{i+1} y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = n_i x_{i+1} + (m_i - \\lfloor m_i / n_i \\rfloor n_i)y_{i+1} \\\\ \\Rightarrow& m_i x_i + n_i y_i = m_i y_{i+1} + n_i (x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}) \\\\ \\Rightarrow& \\begin{cases} x_i = y_{i+1}, \\\\ y_i = x_{i+1} - \\lfloor m_i / n_i \\rfloor y_{i+1}. \\end{cases} \\end{align*} \u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u539f\u65b9\u7a0b\u7684\u89e3 (x_0, y_0) (x_0, y_0) \u3002 Note \u7531\u88f4\u7956\u5b9a\u7406\u7684\u8bc1\u660e\u8fc7\u7a0b\uff0c\u6211\u4eec\u540c\u65f6\u4e5f\u83b7\u5f97\u4e86 \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5 \uff0c\u7528\u6765\u6c42\u89e3\u4e0d\u5b9a\u65b9\u7a0b a_0 x_0 + b_0 y_0 = gcd(a_0, b_0) a_0 x_0 + b_0 y_0 = gcd(a_0, b_0) \u3002 \u552f\u4e00\u4e0d\u540c\u5728\u4e8e\u6211\u4eec\u6784\u9020\u7684\u65b9\u7a0b\u7ec4\u662f\uff1a \\begin{cases} a_0 x_0 + b_0 y_0 = gcd(a_0, b_0);\\\\ a_1 x_1 + b_1 y_1 = gcd(a_1, b_1), &a_1 = b_0, b_1 = a_0 \\bmod b_0;\\\\ \\vdots\\\\ a_t x_t + b_t y_t = gcd(a_t, b_t), &a_t = b_{t-1}, b_t = a_{t-1} \\bmod b_{t-1}. \\end{cases} \\begin{cases} a_0 x_0 + b_0 y_0 = gcd(a_0, b_0);\\\\ a_1 x_1 + b_1 y_1 = gcd(a_1, b_1), &a_1 = b_0, b_1 = a_0 \\bmod b_0;\\\\ \\vdots\\\\ a_t x_t + b_t y_t = gcd(a_t, b_t), &a_t = b_{t-1}, b_t = a_{t-1} \\bmod b_{t-1}. \\end{cases} void exgcd ( int a , int b , int & x , int & y ) { if ( ! b ) { x = 1 , y = 0 ; } else { exgcd ( b , a % b , y , x ); y -= a / b * x ; } } Cite [1] \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u2014\u2014\u88f4\u8700\uff08\u8d1d\u7956\uff09\u5b9a\u7406 [2] \u88f4\u8700\u5b9a\u7406\uff08\u8d1d\u7956\u5b9a\u7406\uff09 \u8bc1\u660e\u4e0e\u5e94\u7528 [3] \u88f4\u8700\u5b9a\u7406(\u8d1d\u7956\u5b9a\u7406)\u53ca\u8bc1\u660e","title":"\u88f4\u8700\u5b9a\u7406"},{"location":"Algorithms/03-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/#_4","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 365 . \u95ee\u9898\u63cf\u8ff0 \uff1a\u6709\u5927\u5c0f\u5206\u522b\u4e3a a a \u548c b b \u7684\u4e24\u4e2a\u5bb9\u5668\uff0c\u4ee5\u53ca\u65e0\u9650\u7684\u6c34\uff0c\u95ee\u80fd\u5426\u5012\u51fa\u4f53\u79ef\u4e3a c c \u7684\u6c34\u3002 \u5012\u5165\u4f53\u79ef\u4e3a c c \u7684\u6c34\u610f\u5473\u7740\u67d0\u4e00\u4e2a\u5bb9\u5668\u91cc\u7684\u6c34\u4f53\u79ef\u4e3a c c , \u6216\u8005\u4e24\u4e2a\u5bb9\u5668\u4e2d\u6c34\u7684\u4f53\u79ef\u4e00\u5171\u4e3a c c \u3002\u80fd\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a \u88c5\u6ee1\u67d0\u4e00\u4e2a\u5bb9\u5668\uff1b \u5012\u7a7a\u67d0\u4e00\u4e2a\u5bb9\u5668\uff1b \u5c06\u67d0\u4e00\u4e2a\u5bb9\u5668\u7684\u6c34\u5012\u5230\u53e6\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u76f4\u81f3\u51fa\u73b0\u4e00\u4e2a\u5bb9\u5668\u6ee1\u6216\u4e00\u4e2a\u5bb9\u5668\u7a7a\u3002 \u5206\u6790 \uff1a\u8fd9\u4e2a\u95ee\u9898\u5145\u8981\u6761\u4ef6\u4e3a ax + by = c ax + by = c \u6709\u6574\u6570\u89e3 \u5e76\u4e14 c \\le a + b c \\le a + b \u3002 \u5fc5\u8981\u6027 \uff1a\u4e24\u4e2a\u5bb9\u5668\u4e2d\u6c34\u7684\u603b\u4f53\u79ef\u4e00\u5b9a\u6ee1\u8db3 ax + by ax + by , \u5176\u4e2d x x \u548c y y \u662f\u6574\u6570\u3002 \u4e0d\u53ef\u80fd\u51fa\u73b0\u4e24\u4e2a\u5bb9\u5668\u540c\u65f6\u4e0d\u6ee1\u7684\u65f6\u5019\uff1b \u5f80\u4e0d\u6ee1\u7684\u5bb9\u5668\u91cc\u52a0\u6c34\u6ca1\u6709\u610f\u4e49\uff0c\u7b49\u4ef7\u4e8e\u521d\u59cb\u72b6\u6001\u65f6\u7ed9\u5bf9\u5e94\u5bb9\u5668\u52a0\u6ee1\uff1b \u6e05\u7a7a\u4e0d\u6ee1\u7684\u5bb9\u5668\u6ca1\u6709\u610f\u4e49\uff0c\u7b49\u4ef7\u4e8e\u521d\u59cb\u72b6\u6001\u3002 \u7efc\u4e0a\uff0c\u4e24\u5bb9\u5668\u4e2d\u6c34\u7684\u603b\u4f53\u79ef\u4e00\u5b9a\u6ee1\u8db3 ax + by ax + by \u3002 \u5145\u5206\u6027 \uff1a\u5982\u679c x \\ge 0 x \\ge 0 \u5e76\u4e14 y \\ge 0 y \\ge 0 \uff0c\u8868\u793a\u628a\u5bf9\u5e94\u7684\u5bb9\u5668\u63a5\u6ee1\u5c31\u53ef\u4ee5\u4e86\uff1b\u5982\u679c x < 0 x < 0 \u6216 y < 0 y < 0 \uff0c\u4ee5 y y \u4e3a\u91cf\u676f\u589e\u52a0\u6c34\uff0c\u518d\u4ee5 x x \u4e3a\u91cf\u676f\u51cf\u5c11\u6c34\uff08\u8fd9\u4e2a\u64cd\u4f5c\u9700\u8981\u601d\u8003\u4e00\u4e0b\uff0c\u786e\u5b9e\u80fd\u591f\u505a\u5230\uff09\u3002 \u5b98\u65b9\u9898\u89e3\u9700\u8981\u8003\u8651\u5f88\u591a\u56e0\u7d20\uff1a class Solution { public : bool canMeasureWater ( int x , int y , int z ) { if ( x + y < z ) { return false ; } if ( x == 0 || y == 0 ) { return z == 0 || x + y == z ; } int a = gcd ( x , y ); return z % a == 0 ; } private : int gcd ( int x , int y ) { return ( y == 0 ) ? x : gcd ( y , x % y ); } }; Cite [1] LeetCode 365 [2] LeetCode \u5b98\u65b9\u9898\u89e3","title":"\u5012\u6c34\u95ee\u9898"},{"location":"Algorithms/04-%E5%89%AA%E7%BB%B3%E5%AD%90%E9%97%AE%E9%A2%98/","text":"\u526a\u7ef3\u5b50\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u4e00\u6bb5\u957f\u5ea6\u4e3an\u7684\u7ef3\u5b50\uff0c\u6211\u4eec\u628a\u5b83\u6210m\u6bb5\uff0c\u5176\u4e2d m > 1 m > 1 \uff0c\u6bcf\u4e00\u6bb5\u7684\u957f\u5ea6\u4e3a\u6b63\u6574\u6570\uff0c\u5373 \\{n_1, n_2, \\ldots, n_m\\} \\{n_1, n_2, \\ldots, n_m\\} \u3002\u6c42\u5982\u4f55\u526a\u7ef3\u5b50\uff0c\u80fd\u591f\u7ef3\u5b50\u6bb5\u7684\u4e58\u79ef \\prod^{m}_{i=1} n_i \\prod^{m}_{i=1} n_i \u6700\u5927\u3002 \u8fd9\u53ef\u4ee5\u7528\u52a8\u6001\u89c4\u5212\u6765\u505a\uff0c\u4f46\u662f\u5982\u679c\u901a\u8fc7\u6570\u5b66\u5206\u6790\uff0c\u90a3\u4e48\u80fd\u591f\u83b7\u5f97\u9ad8\u6548\u7684\u7b97\u6cd5\u3002 \u5206\u6790 \uff1a\u9996\u5148\uff0c\u6211\u4eec\u56fa\u5b9a\u7ef3\u5b50\u7684\u6bb5\u6570 m m \uff0c\u6211\u4eec\u5f97\u5230\u4f18\u5316\u76ee\u6807\uff1a \\tag{1} \\label{objective1} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i}, \\quad s.t. \\sum^{m}_{i=1} n_i = n. \\tag{1} \\label{objective1} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i}, \\quad s.t. \\sum^{m}_{i=1} n_i = n. \u5bf9\u5e94\u7684\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u4e3a \\tag{2} \\label{objective2} \\max_{n_i:i\\in[1,m]}\\min_{\\lambda\\ne 0} \\prod^{m}_{i=1} {n_i} + \\lambda (\\sum^{m}_{i=1} n_i - n). \\tag{2} \\label{objective2} \\max_{n_i:i\\in[1,m]}\\min_{\\lambda\\ne 0} \\prod^{m}_{i=1} {n_i} + \\lambda (\\sum^{m}_{i=1} n_i - n). \u7531\u5f3a\u5bf9\u5076\u6027\u53ef\u5f97\u7b49\u4ef7\u7684\u95ee\u9898\u4e3a \\tag{3} \\label{objective3} \\min_{\\lambda\\ne 0} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i} + \\lambda (n - \\sum^{m}_{i=1} n_i - n). \\tag{3} \\label{objective3} \\min_{\\lambda\\ne 0} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i} + \\lambda (n - \\sum^{m}_{i=1} n_i - n). \u5bf9\u5185\u90e8\u5b50\u95ee\u9898\u6c42\u5bfc\u53ef\u5f97: \\begin{cases} \\tag{4} \\label{step1} \\prod^{m}_{i=1} {n^*_i} / n^*_1 - \\lambda = 0 \\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_2 - \\lambda = 0 \\\\ \\vdots\\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_m - \\lambda = 0 \\end{cases} \\begin{cases} \\tag{4} \\label{step1} \\prod^{m}_{i=1} {n^*_i} / n^*_1 - \\lambda = 0 \\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_2 - \\lambda = 0 \\\\ \\vdots\\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_m - \\lambda = 0 \\end{cases} \u5c06\u6240\u6709\u7b49\u5f0f\u8fde\u4e58\u53ef\u5f97 \\tag{5} \\label{step2} (\\prod^{m}_{i=1} {n^*_i})^{m-1} = \\lambda^m \\Rightarrow \\prod^{m}_{i=1} {n^*_i} = \\lambda^{m / (m - 1)}. \\tag{5} \\label{step2} (\\prod^{m}_{i=1} {n^*_i})^{m-1} = \\lambda^m \\Rightarrow \\prod^{m}_{i=1} {n^*_i} = \\lambda^{m / (m - 1)}. \u6211\u4eec\u53ef\u4ee5\u9884\u89c1\u628a\u4e0a\u5f0f\u5e26\u5165\u95ee\u9898 \\eqref{objective3} \\eqref{objective3} \u53ef\u4ee5\u6c42\u5f97\u4e00\u4e2a\u6700\u4f18\u89e3 \\lambda^* \\lambda^* \uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528\u6c42\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u53ef\u5f97 n^*_1 = n^*_2 = \\ldots = n^*_m n^*_1 = n^*_2 = \\ldots = n^*_m \u3002 \u7efc\u4e0a\uff0c\u5982\u679c\u5206\u7684\u6bb5\u6570\u786e\u5b9a\uff0c\u90a3\u4e48\u6700\u4f18\u7684\u5206\u6cd5\u5c31\u662f\u5747\u7b49\u5206\u3002 \u63a5\u7740\uff0c\u6211\u4eec\u7814\u7a76\u6700\u597d\u5206\u51e0\u6bb5\uff0c\u5bf9\u5e94\u7684\u4f18\u5316\u95ee\u9898\u4e3a \\tag{6} \\label{objective4} \\max_{m} (n / m)^m. \\tag{6} \\label{objective4} \\max_{m} (n / m)^m. \u6211\u4eec\u4e00\u773c\u5c31\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u6700\u4f18\u503c\u53d6\u5230 m^* = n / e m^* = n / e , \u5176\u4e2d e e \u4e3a\u81ea\u7136\u5e95\u6570\u3002 \u63a5\u4e0b\u6765\u9000\u5316\u5230\u6574\u6570\u4f18\u5316\u7684\u73af\u8282\u6709\u4e9b\u4e0d\u90a3\u4e48\u4e25\u8c28\uff0c\u6211\u4eec\u53ef\u5f97\u5e73\u5747\u957f\u5ea6\u6700\u597d\u4e3a e e \uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5c3d\u91cf\u53d6\u5230 3 3 \u6216 2 2 , \u5f53\u7136\u8981\u5c3d\u91cf\u591a\u53d6 3 3 \u3002 \u7531\u88f4\u7956\u5b9a\u7406\u53ef\u5f97 2x + 3y = n 2x + 3y = n \u603b\u6709\u6574\u6570\u89e3\uff0c\u81f3\u4e8e\u6709\u6ca1\u6709\u6b63\u6574\u6570\u89e3\u5c31\u8981\u518d\u5206\u6790\u3002","title":"\u526a\u7ef3\u5b50\u95ee\u9898"},{"location":"Algorithms/04-%E5%89%AA%E7%BB%B3%E5%AD%90%E9%97%AE%E9%A2%98/#_1","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u4e00\u6bb5\u957f\u5ea6\u4e3an\u7684\u7ef3\u5b50\uff0c\u6211\u4eec\u628a\u5b83\u6210m\u6bb5\uff0c\u5176\u4e2d m > 1 m > 1 \uff0c\u6bcf\u4e00\u6bb5\u7684\u957f\u5ea6\u4e3a\u6b63\u6574\u6570\uff0c\u5373 \\{n_1, n_2, \\ldots, n_m\\} \\{n_1, n_2, \\ldots, n_m\\} \u3002\u6c42\u5982\u4f55\u526a\u7ef3\u5b50\uff0c\u80fd\u591f\u7ef3\u5b50\u6bb5\u7684\u4e58\u79ef \\prod^{m}_{i=1} n_i \\prod^{m}_{i=1} n_i \u6700\u5927\u3002 \u8fd9\u53ef\u4ee5\u7528\u52a8\u6001\u89c4\u5212\u6765\u505a\uff0c\u4f46\u662f\u5982\u679c\u901a\u8fc7\u6570\u5b66\u5206\u6790\uff0c\u90a3\u4e48\u80fd\u591f\u83b7\u5f97\u9ad8\u6548\u7684\u7b97\u6cd5\u3002 \u5206\u6790 \uff1a\u9996\u5148\uff0c\u6211\u4eec\u56fa\u5b9a\u7ef3\u5b50\u7684\u6bb5\u6570 m m \uff0c\u6211\u4eec\u5f97\u5230\u4f18\u5316\u76ee\u6807\uff1a \\tag{1} \\label{objective1} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i}, \\quad s.t. \\sum^{m}_{i=1} n_i = n. \\tag{1} \\label{objective1} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i}, \\quad s.t. \\sum^{m}_{i=1} n_i = n. \u5bf9\u5e94\u7684\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u4e3a \\tag{2} \\label{objective2} \\max_{n_i:i\\in[1,m]}\\min_{\\lambda\\ne 0} \\prod^{m}_{i=1} {n_i} + \\lambda (\\sum^{m}_{i=1} n_i - n). \\tag{2} \\label{objective2} \\max_{n_i:i\\in[1,m]}\\min_{\\lambda\\ne 0} \\prod^{m}_{i=1} {n_i} + \\lambda (\\sum^{m}_{i=1} n_i - n). \u7531\u5f3a\u5bf9\u5076\u6027\u53ef\u5f97\u7b49\u4ef7\u7684\u95ee\u9898\u4e3a \\tag{3} \\label{objective3} \\min_{\\lambda\\ne 0} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i} + \\lambda (n - \\sum^{m}_{i=1} n_i - n). \\tag{3} \\label{objective3} \\min_{\\lambda\\ne 0} \\max_{n_i:i\\in[1,m]} \\prod^{m}_{i=1} {n_i} + \\lambda (n - \\sum^{m}_{i=1} n_i - n). \u5bf9\u5185\u90e8\u5b50\u95ee\u9898\u6c42\u5bfc\u53ef\u5f97: \\begin{cases} \\tag{4} \\label{step1} \\prod^{m}_{i=1} {n^*_i} / n^*_1 - \\lambda = 0 \\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_2 - \\lambda = 0 \\\\ \\vdots\\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_m - \\lambda = 0 \\end{cases} \\begin{cases} \\tag{4} \\label{step1} \\prod^{m}_{i=1} {n^*_i} / n^*_1 - \\lambda = 0 \\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_2 - \\lambda = 0 \\\\ \\vdots\\\\ \\prod^{m}_{i=1} {n^*_i} / n^*_m - \\lambda = 0 \\end{cases} \u5c06\u6240\u6709\u7b49\u5f0f\u8fde\u4e58\u53ef\u5f97 \\tag{5} \\label{step2} (\\prod^{m}_{i=1} {n^*_i})^{m-1} = \\lambda^m \\Rightarrow \\prod^{m}_{i=1} {n^*_i} = \\lambda^{m / (m - 1)}. \\tag{5} \\label{step2} (\\prod^{m}_{i=1} {n^*_i})^{m-1} = \\lambda^m \\Rightarrow \\prod^{m}_{i=1} {n^*_i} = \\lambda^{m / (m - 1)}. \u6211\u4eec\u53ef\u4ee5\u9884\u89c1\u628a\u4e0a\u5f0f\u5e26\u5165\u95ee\u9898 \\eqref{objective3} \\eqref{objective3} \u53ef\u4ee5\u6c42\u5f97\u4e00\u4e2a\u6700\u4f18\u89e3 \\lambda^* \\lambda^* \uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528\u6c42\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u53ef\u5f97 n^*_1 = n^*_2 = \\ldots = n^*_m n^*_1 = n^*_2 = \\ldots = n^*_m \u3002 \u7efc\u4e0a\uff0c\u5982\u679c\u5206\u7684\u6bb5\u6570\u786e\u5b9a\uff0c\u90a3\u4e48\u6700\u4f18\u7684\u5206\u6cd5\u5c31\u662f\u5747\u7b49\u5206\u3002 \u63a5\u7740\uff0c\u6211\u4eec\u7814\u7a76\u6700\u597d\u5206\u51e0\u6bb5\uff0c\u5bf9\u5e94\u7684\u4f18\u5316\u95ee\u9898\u4e3a \\tag{6} \\label{objective4} \\max_{m} (n / m)^m. \\tag{6} \\label{objective4} \\max_{m} (n / m)^m. \u6211\u4eec\u4e00\u773c\u5c31\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u6700\u4f18\u503c\u53d6\u5230 m^* = n / e m^* = n / e , \u5176\u4e2d e e \u4e3a\u81ea\u7136\u5e95\u6570\u3002 \u63a5\u4e0b\u6765\u9000\u5316\u5230\u6574\u6570\u4f18\u5316\u7684\u73af\u8282\u6709\u4e9b\u4e0d\u90a3\u4e48\u4e25\u8c28\uff0c\u6211\u4eec\u53ef\u5f97\u5e73\u5747\u957f\u5ea6\u6700\u597d\u4e3a e e \uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5c3d\u91cf\u53d6\u5230 3 3 \u6216 2 2 , \u5f53\u7136\u8981\u5c3d\u91cf\u591a\u53d6 3 3 \u3002 \u7531\u88f4\u7956\u5b9a\u7406\u53ef\u5f97 2x + 3y = n 2x + 3y = n \u603b\u6709\u6574\u6570\u89e3\uff0c\u81f3\u4e8e\u6709\u6ca1\u6709\u6b63\u6574\u6570\u89e3\u5c31\u8981\u518d\u5206\u6790\u3002","title":"\u526a\u7ef3\u5b50\u95ee\u9898"},{"location":"Algorithms/05-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/","text":"\u6b27\u62c9\u51fd\u6570 \u00b6 \u6b27\u62c9\u51fd\u6570 \u00b6 \u5b9a\u4e491 ( Euler's totient function ). \u6b27\u62c9\u51fd\u6570 \\phi(n) \\phi(n) \u8868\u793a\u5c0f\u4e8e\u7b49\u4e8e n n \u7684\u6574\u6570\u4e2d\uff0c\u4e0e n n \u4e92\u8d28\u7684\u6b63\u6574\u6570\u7684\u4e2a\u6570\u3002 \u6ce8\u610f \\phi(1) = 1 \\phi(1) = 1 \uff0c\u5e76\u4e14\u5982\u679c p p \u662f\u8d28\u6570\u7684\u8bdd\uff0c \\phi(n) = n - 1 \\phi(n) = n - 1 \u3002 \u6027\u8d281 ( \u6b27\u62c9\u51fd\u6570\u7684\u79ef\u6027 ). \u5982\u679c p p \u548c q q \u4e92\u8d28\uff0c\u90a3\u4e48 \\phi(p \\times q) = \\phi(p) \\times \\phi(q) \\phi(p \\times q) = \\phi(p) \\times \\phi(q) \u3002 \u6027\u8d282 \u5982\u679c p p \u662f\u8d28\u6570\uff0c\u90a3\u4e48 $\\phi(p^k) = p^{k-1} \\times (p-1). \u8fd9\u4e2a\u6027\u8d28\u5f88\u597d\u8bc1\u660e\uff0c\u6211\u4eec\u53ef\u4ee5\u628a p^k p^k \u5728\u6570\u8f74\u4e0a\u5747\u5206\u6210 p^{k-1} p^{k-1} \u6bb5\uff0c\u90a3\u4e48\u6bcf\u4e00\u6bb5\u90fd\u6709 p-1 p-1 \u4e2a\u6570\u4e0e p^k p^k \u4e92\u8d28\u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u6c42\u6b27\u62c9\u51fd\u6570\u503c\u7684\u5feb\u6377\u65b9\u6cd5\u3002 \u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u62c6\u5206\u76ee\u6807\u503c n = \\prod^{}_{i} p^{k_i}_i n = \\prod^{}_{i} p^{k_i}_i \uff0c\u90a3\u4e48 \\tag{1} \\label{euler} \\phi(n) = n \\prod^{}_{i} \\frac{p_{i} - 1}{p_{i}}. \\tag{1} \\label{euler} \\phi(n) = n \\prod^{}_{i} \\frac{p_{i} - 1}{p_{i}}. \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fb9\u6c42\u89e3 n n \u7684\u8d28\u56e0\u6570\uff0c\u8fb9\u6c42\u89e3 \\phi(n) \\phi(n) : int eulerPhi ( int n ) { int top = sqrt ( n + 0.5 ); // \u9632\u6b62\u8ba1\u7b97\u7cbe\u5ea6\u8bef\u5dee int ans = n ; for ( int i = 2 ; i <= top ; ++ i ) { if ( n % i == 0 ) { ans = ans / i * ( i - 1 ); while ( n % i == 0 ) n /= i ; } } if ( n > 1 ) ans = ans / n * ( n - 1 ); //\u8d28\u6570 return ans ; } \u6269\u5c55\u6b27\u62c9\u5b9a\u7406 \u00b6 a^b\\equiv \\begin{cases} a^{b\\bmod\\varphi(p)},\\,&\\gcd(a,\\,p)=1\\\\ a^b,&\\gcd(a,\\,p)\\ne1,\\,b<\\varphi(p)\\\\ a^{b\\bmod\\varphi(p)+\\varphi(p)},&\\gcd(a,\\,p)\\ne1,\\,b\\ge\\varphi(p) \\end{cases} \\pmod p a^b\\equiv \\begin{cases} a^{b\\bmod\\varphi(p)},\\,&\\gcd(a,\\,p)=1\\\\ a^b,&\\gcd(a,\\,p)\\ne1,\\,b<\\varphi(p)\\\\ a^{b\\bmod\\varphi(p)+\\varphi(p)},&\\gcd(a,\\,p)\\ne1,\\,b\\ge\\varphi(p) \\end{cases} \\pmod p Cite [1] \u6b27\u62c9\u51fd\u6570 [2] \u6b27\u62c9\u5b9a\u7406 \u8d85\u7ea7\u6b21\u65b9 \u00b6 \u9898\u76ee\u63cf\u8ff0 : \u8ba1\u7b97 a^b a^b \u5bf9 1337 \u53d6\u6a21\uff0c\u5176\u4e2d a a \u662f\u6b63\u6574\u6570\uff0c b b \u662f\u8d85\u5927\u6574\u6570\uff0c\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u7ed9\u51fa\u3002 \u5206\u6790 : \u7b2c\u4e00\u6b65\uff1a\u5316\u7b80\u6307\u6570 \\phi(1337) = 1140 \\phi(1337) = 1140 \uff0c\u5bf9\u5927\u6570 b b \u4f7f\u7528 {b \\bmod 1140 + 1140} {b \\bmod 1140 + 1140} \uff1b \u7b2c\u4e8c\u6b65\uff1a\u6c42 a a \u7684\u6307\u6570\uff0c\u4e3a\u4e86\u9632\u6b62\u8d85\u51fa\u6570\u5b57\u7684\u8868\u8fbe\u8303\u56f4\uff0c\u4f7f\u7528\u516c\u5f0f (A \\times B) \\bmod C = [(A \\bmod C) \\times (B \\bmod C)] \\bmod C (A \\times B) \\bmod C = [(A \\bmod C) \\times (B \\bmod C)] \\bmod C \u3002\u5728\u7b2c\u4e00\u6b65\u4e5f\u7528\u5230\u4e86\u8fd9\u4e2a\u516c\u5f0f\u3002","title":"\u6b27\u62c9\u51fd\u6570"},{"location":"Algorithms/05-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/#_1","text":"","title":"\u6b27\u62c9\u51fd\u6570"},{"location":"Algorithms/05-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/#_2","text":"\u5b9a\u4e491 ( Euler's totient function ). \u6b27\u62c9\u51fd\u6570 \\phi(n) \\phi(n) \u8868\u793a\u5c0f\u4e8e\u7b49\u4e8e n n \u7684\u6574\u6570\u4e2d\uff0c\u4e0e n n \u4e92\u8d28\u7684\u6b63\u6574\u6570\u7684\u4e2a\u6570\u3002 \u6ce8\u610f \\phi(1) = 1 \\phi(1) = 1 \uff0c\u5e76\u4e14\u5982\u679c p p \u662f\u8d28\u6570\u7684\u8bdd\uff0c \\phi(n) = n - 1 \\phi(n) = n - 1 \u3002 \u6027\u8d281 ( \u6b27\u62c9\u51fd\u6570\u7684\u79ef\u6027 ). \u5982\u679c p p \u548c q q \u4e92\u8d28\uff0c\u90a3\u4e48 \\phi(p \\times q) = \\phi(p) \\times \\phi(q) \\phi(p \\times q) = \\phi(p) \\times \\phi(q) \u3002 \u6027\u8d282 \u5982\u679c p p \u662f\u8d28\u6570\uff0c\u90a3\u4e48 $\\phi(p^k) = p^{k-1} \\times (p-1). \u8fd9\u4e2a\u6027\u8d28\u5f88\u597d\u8bc1\u660e\uff0c\u6211\u4eec\u53ef\u4ee5\u628a p^k p^k \u5728\u6570\u8f74\u4e0a\u5747\u5206\u6210 p^{k-1} p^{k-1} \u6bb5\uff0c\u90a3\u4e48\u6bcf\u4e00\u6bb5\u90fd\u6709 p-1 p-1 \u4e2a\u6570\u4e0e p^k p^k \u4e92\u8d28\u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u6c42\u6b27\u62c9\u51fd\u6570\u503c\u7684\u5feb\u6377\u65b9\u6cd5\u3002 \u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u62c6\u5206\u76ee\u6807\u503c n = \\prod^{}_{i} p^{k_i}_i n = \\prod^{}_{i} p^{k_i}_i \uff0c\u90a3\u4e48 \\tag{1} \\label{euler} \\phi(n) = n \\prod^{}_{i} \\frac{p_{i} - 1}{p_{i}}. \\tag{1} \\label{euler} \\phi(n) = n \\prod^{}_{i} \\frac{p_{i} - 1}{p_{i}}. \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fb9\u6c42\u89e3 n n \u7684\u8d28\u56e0\u6570\uff0c\u8fb9\u6c42\u89e3 \\phi(n) \\phi(n) : int eulerPhi ( int n ) { int top = sqrt ( n + 0.5 ); // \u9632\u6b62\u8ba1\u7b97\u7cbe\u5ea6\u8bef\u5dee int ans = n ; for ( int i = 2 ; i <= top ; ++ i ) { if ( n % i == 0 ) { ans = ans / i * ( i - 1 ); while ( n % i == 0 ) n /= i ; } } if ( n > 1 ) ans = ans / n * ( n - 1 ); //\u8d28\u6570 return ans ; }","title":"\u6b27\u62c9\u51fd\u6570"},{"location":"Algorithms/05-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/#_3","text":"a^b\\equiv \\begin{cases} a^{b\\bmod\\varphi(p)},\\,&\\gcd(a,\\,p)=1\\\\ a^b,&\\gcd(a,\\,p)\\ne1,\\,b<\\varphi(p)\\\\ a^{b\\bmod\\varphi(p)+\\varphi(p)},&\\gcd(a,\\,p)\\ne1,\\,b\\ge\\varphi(p) \\end{cases} \\pmod p a^b\\equiv \\begin{cases} a^{b\\bmod\\varphi(p)},\\,&\\gcd(a,\\,p)=1\\\\ a^b,&\\gcd(a,\\,p)\\ne1,\\,b<\\varphi(p)\\\\ a^{b\\bmod\\varphi(p)+\\varphi(p)},&\\gcd(a,\\,p)\\ne1,\\,b\\ge\\varphi(p) \\end{cases} \\pmod p Cite [1] \u6b27\u62c9\u51fd\u6570 [2] \u6b27\u62c9\u5b9a\u7406","title":"\u6269\u5c55\u6b27\u62c9\u5b9a\u7406"},{"location":"Algorithms/05-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/#_4","text":"\u9898\u76ee\u63cf\u8ff0 : \u8ba1\u7b97 a^b a^b \u5bf9 1337 \u53d6\u6a21\uff0c\u5176\u4e2d a a \u662f\u6b63\u6574\u6570\uff0c b b \u662f\u8d85\u5927\u6574\u6570\uff0c\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u7ed9\u51fa\u3002 \u5206\u6790 : \u7b2c\u4e00\u6b65\uff1a\u5316\u7b80\u6307\u6570 \\phi(1337) = 1140 \\phi(1337) = 1140 \uff0c\u5bf9\u5927\u6570 b b \u4f7f\u7528 {b \\bmod 1140 + 1140} {b \\bmod 1140 + 1140} \uff1b \u7b2c\u4e8c\u6b65\uff1a\u6c42 a a \u7684\u6307\u6570\uff0c\u4e3a\u4e86\u9632\u6b62\u8d85\u51fa\u6570\u5b57\u7684\u8868\u8fbe\u8303\u56f4\uff0c\u4f7f\u7528\u516c\u5f0f (A \\times B) \\bmod C = [(A \\bmod C) \\times (B \\bmod C)] \\bmod C (A \\times B) \\bmod C = [(A \\bmod C) \\times (B \\bmod C)] \\bmod C \u3002\u5728\u7b2c\u4e00\u6b65\u4e5f\u7528\u5230\u4e86\u8fd9\u4e2a\u516c\u5f0f\u3002","title":"\u8d85\u7ea7\u6b21\u65b9"},{"location":"Algorithms/06-%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7/","text":"\u84c4\u6c34\u6c60\u62bd\u6837 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u7ed9\u5b9a\u4e00\u4e2a\u672a\u77e5\u7684\u6570\u636e\u6d41 [a_1, a_2, \\ldots, a_n] [a_1, a_2, \\ldots, a_n] \uff0c\u5728\u53ea\u904d\u5386\u4e00\u904d\u6570\u636e\u7684\u60c5\u51b5\u4e0b\uff0c\u62bd\u53d6m\u4e2a\u4e0d\u540c\u7684\u6570\uff0c\u8981\u6c42\u5747\u5300\u91c7\u6837\u3002\u8fd9\u91cc\u7684\u4e0d\u540c\uff0c\u6307\u7684\u662f\u6570\u636e\u6d41\u7684\u4f4d\u7f6e\u4e0d\u540c\uff0c\u800c\u4e0d\u662f\u503c\u4e0d\u540c\u3002 \u5206\u6790 \uff1a\u8fd9\u9053\u9898\u7684\u96be\u70b9\u5c31\u662f\u5728\u4e0d\u77e5\u9053\u6570\u636e\u957f\u5ea6\u7684\u60c5\u51b5\u4e0b\uff0c\u5b8c\u6210\u5747\u5300\u91c7\u6837\u3002 \u62bd\u4e00\u4e2a\u6837\u672c \u00b6 \u5148\u7814\u7a76 m = 1 m = 1 \u7684\u60c5\u51b5\uff0c\u6bcf\u589e\u52a0\u4e00\u4e2a\u6570\uff0c\u6211\u4eec\u9700\u8981\u4fee\u6b63\u6982\u7387\uff1a \\begin{cases} n=1: & 1 \\\\ n=2: & 1 \\times \\frac{1}{2} & \\frac{1}{2} \\\\ n=3: & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{3} \\\\ \\vdots \\end{cases} \\begin{cases} n=1: & 1 \\\\ n=2: & 1 \\times \\frac{1}{2} & \\frac{1}{2} \\\\ n=3: & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{3} \\\\ \\vdots \\end{cases} \u5047\u8bbe\uff0c\u6211\u4eec\u5df2\u7ecf\u4ece [a_1, \\ldots, a_{n-1}] [a_1, \\ldots, a_{n-1}] \u7684\u5e8f\u5217\u4e2d\u5747\u5300\u91c7\u6837\u4e00\u4e2a\u6570 b b \u3002 \u73b0\u5728\u8bfb\u5230\u4e86\u7b2c n n \u4e2a\u6570 a_{n} a_{n} , \u90a3\u4e48\u6211\u4eec\u4ee5 \\frac{1}{n} \\frac{1}{n} \u7684\u6982\u7387\u9009\u62e9\u65b0\u7684\u6570 a_{n} a_{n} , \u518d\u4ee5 \\frac{n-1}{n} \\frac{n-1}{n} \u7684\u6982\u7387\u9009 b b \u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b8c\u6210\u4e86 n n \u4e2a\u6570\u7684\u5747\u5300\u91c7\u6837\u3002 \u8fd9\u79cd\u53e0\u52a0\u7684\u9009\u62e9\u64cd\u4f5c\uff0c\u80fd\u591f\u6539\u53d8\u6982\u7387\uff0c\u662f\u8fd9\u4e2a\u7b97\u6cd5\u7684\u6838\u5fc3\u3002 \u62bdm\u4e2a\u4e0d\u540c\u7684\u6837\u672c \u00b6 \u6211\u4eec\u5148\u7814\u7a76 m=2 m=2 \u7684\u60c5\u51b5\uff1a \\begin{cases} n=2: & 1 & 1\\\\ n=3: & 1 \\times \\frac{2}{3} & 1 \\times \\frac{2}{3} & \\frac{2}{3} \\\\ n=4: & \\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{3} \\times \\frac{3}{4} &\\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{4} \\\\ \\vdots \\end{cases} \\begin{cases} n=2: & 1 & 1\\\\ n=3: & 1 \\times \\frac{2}{3} & 1 \\times \\frac{2}{3} & \\frac{2}{3} \\\\ n=4: & \\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{3} \\times \\frac{3}{4} &\\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{4} \\\\ \\vdots \\end{cases} \u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u5047\u8bbe\u5df2\u7ecf\u4ece [a_1, a_2, \\ldots, a_{n-1}] [a_1, a_2, \\ldots, a_{n-1}] \u7684\u5e8f\u5217\u4e2d\u5747\u5300\u91c7\u96c6\u4e86 m m \u4e2a\u6570 [b_1, b_2, \\ldots, b_m] [b_1, b_2, \\ldots, b_m] \u3002\u73b0\u5728\u6211\u4eec\u8bfb\u5230\u4e86\u7b2c n n \u4e2a\u6570 a_{n} a_{n} \uff0c\u6211\u4eec\u9996\u5148\u51b3\u5b9a a_{n} a_{n} \u662f\u5426\u8981\u51fa\u73b0\u5728\u91c7\u6837\u6837\u672c\u4e2d\uff0c\u4fdd\u8bc1\u51fa\u73b0\u7684\u6982\u7387\u4e3a m / n m / n \u3002\u5982\u679c\u8981\u66ff\u6362\uff0c\u90a3\u4e48\u6211\u4eec\u4ece [b_1, b_2, \\ldots, b_m] [b_1, b_2, \\ldots, b_m] \u5747\u5300\u9009\u62e9\u4e00\u4e2a\u6570\u88ab a_{n} a_{n} \u66ff\u6362\u3002 \u5206\u5e03\u5f0f\u84c4\u6c34\u6c60\u62bd\u6837 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u73b0\u5728\u53c8 K K \u53f0\u670d\u52a1\u5668\uff0c\u6bcf\u53f0\u670d\u52a1\u5668\u5df2\u7ecf\u5904\u7406\u7684\u6570\u636e\u91cf\u5206\u522b\u4e3a N_1, N_2, \\ldots, N_K N_1, N_2, \\ldots, N_K \u3002\u9700\u8981\u603b\u4f53\u6837\u672c\u4e2d\u91c7\u96c6 m m \u4e2a\u4e0d\u540c\u7684\u6570\u3002 \u5206\u6790 \uff1a\u6211\u4eec\u80af\u5b9a\u8981\u5148\u8ba9\u5404\u4e2a\u670d\u52a1\u5668\u5404\u81ea\u91c7\u96c6 m m \u4e2a\u4e0d\u540c\u7684\u6570\uff0c\u90a3\u4e48\u5173\u952e\u8fd8\u662f\u8981\u901a\u8fc7\u9009\u62e9\uff0c\u6765\u628a\u6982\u7387\u4fee\u6b63\u56de\u6765\u3002\u5148\u5206\u6790\u5df2\u7ecf\u91c7\u96c6\u5230\u7684\u6570\u636e\u7684\u6982\u7387\uff1a \\begin{cases} site1: &\\frac{m}{N_1}, &\\frac{m}{N_1}, &\\ldots, &\\frac{m}{N_1} \\\\ site2: &\\frac{m}{N_2}, &\\frac{m}{N_2}, &\\ldots, &\\frac{m}{N_2} \\\\ \\vdots \\\\ siteK: &\\frac{m}{N_K}, &\\frac{m}{N_K}, &\\ldots, &\\frac{m}{N_K} \\\\ \\end{cases} \\begin{cases} site1: &\\frac{m}{N_1}, &\\frac{m}{N_1}, &\\ldots, &\\frac{m}{N_1} \\\\ site2: &\\frac{m}{N_2}, &\\frac{m}{N_2}, &\\ldots, &\\frac{m}{N_2} \\\\ \\vdots \\\\ siteK: &\\frac{m}{N_K}, &\\frac{m}{N_K}, &\\ldots, &\\frac{m}{N_K} \\\\ \\end{cases} \u5b9a\u4e49 N = \\sum^K_{i=1} N_i N = \\sum^K_{i=1} N_i \uff0c\u90a3\u4e48\u6211\u4eec\u7684\u76ee\u6807\u662f\u6bcf\u4e2a\u6837\u672c\u51fa\u73b0\u7684\u6982\u7387\u662f \\frac{m}{N} \\frac{m}{N} \u3002 \u6709\u70b9\u91cd\u8981\u6027\u91c7\u6837\u7684\u610f\u5473: \u6211\u4eec\u4ee5 \\frac{N_i}{N} \\frac{N_i}{N} \u7684\u6982\u7387\u9009\u62e9\u96c6\u5408 site_i site_i \uff0c\u7136\u540e\u4ece site_i site_i \u4e0d\u653e\u56de\u5730\u5747\u5300\u91c7\u6837\u4e00\u4e2a\u503c\u653e\u5165\u6700\u7ec8\u7684\u7ed3\u679c\u4e2d\u3002","title":"\u84c4\u6c34\u6c60\u62bd\u6837"},{"location":"Algorithms/06-%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7/#_1","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u7ed9\u5b9a\u4e00\u4e2a\u672a\u77e5\u7684\u6570\u636e\u6d41 [a_1, a_2, \\ldots, a_n] [a_1, a_2, \\ldots, a_n] \uff0c\u5728\u53ea\u904d\u5386\u4e00\u904d\u6570\u636e\u7684\u60c5\u51b5\u4e0b\uff0c\u62bd\u53d6m\u4e2a\u4e0d\u540c\u7684\u6570\uff0c\u8981\u6c42\u5747\u5300\u91c7\u6837\u3002\u8fd9\u91cc\u7684\u4e0d\u540c\uff0c\u6307\u7684\u662f\u6570\u636e\u6d41\u7684\u4f4d\u7f6e\u4e0d\u540c\uff0c\u800c\u4e0d\u662f\u503c\u4e0d\u540c\u3002 \u5206\u6790 \uff1a\u8fd9\u9053\u9898\u7684\u96be\u70b9\u5c31\u662f\u5728\u4e0d\u77e5\u9053\u6570\u636e\u957f\u5ea6\u7684\u60c5\u51b5\u4e0b\uff0c\u5b8c\u6210\u5747\u5300\u91c7\u6837\u3002","title":"\u84c4\u6c34\u6c60\u62bd\u6837"},{"location":"Algorithms/06-%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7/#_2","text":"\u5148\u7814\u7a76 m = 1 m = 1 \u7684\u60c5\u51b5\uff0c\u6bcf\u589e\u52a0\u4e00\u4e2a\u6570\uff0c\u6211\u4eec\u9700\u8981\u4fee\u6b63\u6982\u7387\uff1a \\begin{cases} n=1: & 1 \\\\ n=2: & 1 \\times \\frac{1}{2} & \\frac{1}{2} \\\\ n=3: & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{3} \\\\ \\vdots \\end{cases} \\begin{cases} n=1: & 1 \\\\ n=2: & 1 \\times \\frac{1}{2} & \\frac{1}{2} \\\\ n=3: & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{2} \\times \\frac{2}{3} & \\frac{1}{3} \\\\ \\vdots \\end{cases} \u5047\u8bbe\uff0c\u6211\u4eec\u5df2\u7ecf\u4ece [a_1, \\ldots, a_{n-1}] [a_1, \\ldots, a_{n-1}] \u7684\u5e8f\u5217\u4e2d\u5747\u5300\u91c7\u6837\u4e00\u4e2a\u6570 b b \u3002 \u73b0\u5728\u8bfb\u5230\u4e86\u7b2c n n \u4e2a\u6570 a_{n} a_{n} , \u90a3\u4e48\u6211\u4eec\u4ee5 \\frac{1}{n} \\frac{1}{n} \u7684\u6982\u7387\u9009\u62e9\u65b0\u7684\u6570 a_{n} a_{n} , \u518d\u4ee5 \\frac{n-1}{n} \\frac{n-1}{n} \u7684\u6982\u7387\u9009 b b \u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b8c\u6210\u4e86 n n \u4e2a\u6570\u7684\u5747\u5300\u91c7\u6837\u3002 \u8fd9\u79cd\u53e0\u52a0\u7684\u9009\u62e9\u64cd\u4f5c\uff0c\u80fd\u591f\u6539\u53d8\u6982\u7387\uff0c\u662f\u8fd9\u4e2a\u7b97\u6cd5\u7684\u6838\u5fc3\u3002","title":"\u62bd\u4e00\u4e2a\u6837\u672c"},{"location":"Algorithms/06-%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7/#m","text":"\u6211\u4eec\u5148\u7814\u7a76 m=2 m=2 \u7684\u60c5\u51b5\uff1a \\begin{cases} n=2: & 1 & 1\\\\ n=3: & 1 \\times \\frac{2}{3} & 1 \\times \\frac{2}{3} & \\frac{2}{3} \\\\ n=4: & \\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{3} \\times \\frac{3}{4} &\\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{4} \\\\ \\vdots \\end{cases} \\begin{cases} n=2: & 1 & 1\\\\ n=3: & 1 \\times \\frac{2}{3} & 1 \\times \\frac{2}{3} & \\frac{2}{3} \\\\ n=4: & \\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{3} \\times \\frac{3}{4} &\\frac{2}{3} \\times \\frac{3}{4} & \\frac{2}{4} \\\\ \\vdots \\end{cases} \u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u5047\u8bbe\u5df2\u7ecf\u4ece [a_1, a_2, \\ldots, a_{n-1}] [a_1, a_2, \\ldots, a_{n-1}] \u7684\u5e8f\u5217\u4e2d\u5747\u5300\u91c7\u96c6\u4e86 m m \u4e2a\u6570 [b_1, b_2, \\ldots, b_m] [b_1, b_2, \\ldots, b_m] \u3002\u73b0\u5728\u6211\u4eec\u8bfb\u5230\u4e86\u7b2c n n \u4e2a\u6570 a_{n} a_{n} \uff0c\u6211\u4eec\u9996\u5148\u51b3\u5b9a a_{n} a_{n} \u662f\u5426\u8981\u51fa\u73b0\u5728\u91c7\u6837\u6837\u672c\u4e2d\uff0c\u4fdd\u8bc1\u51fa\u73b0\u7684\u6982\u7387\u4e3a m / n m / n \u3002\u5982\u679c\u8981\u66ff\u6362\uff0c\u90a3\u4e48\u6211\u4eec\u4ece [b_1, b_2, \\ldots, b_m] [b_1, b_2, \\ldots, b_m] \u5747\u5300\u9009\u62e9\u4e00\u4e2a\u6570\u88ab a_{n} a_{n} \u66ff\u6362\u3002","title":"\u62bdm\u4e2a\u4e0d\u540c\u7684\u6837\u672c"},{"location":"Algorithms/06-%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7/#_3","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u73b0\u5728\u53c8 K K \u53f0\u670d\u52a1\u5668\uff0c\u6bcf\u53f0\u670d\u52a1\u5668\u5df2\u7ecf\u5904\u7406\u7684\u6570\u636e\u91cf\u5206\u522b\u4e3a N_1, N_2, \\ldots, N_K N_1, N_2, \\ldots, N_K \u3002\u9700\u8981\u603b\u4f53\u6837\u672c\u4e2d\u91c7\u96c6 m m \u4e2a\u4e0d\u540c\u7684\u6570\u3002 \u5206\u6790 \uff1a\u6211\u4eec\u80af\u5b9a\u8981\u5148\u8ba9\u5404\u4e2a\u670d\u52a1\u5668\u5404\u81ea\u91c7\u96c6 m m \u4e2a\u4e0d\u540c\u7684\u6570\uff0c\u90a3\u4e48\u5173\u952e\u8fd8\u662f\u8981\u901a\u8fc7\u9009\u62e9\uff0c\u6765\u628a\u6982\u7387\u4fee\u6b63\u56de\u6765\u3002\u5148\u5206\u6790\u5df2\u7ecf\u91c7\u96c6\u5230\u7684\u6570\u636e\u7684\u6982\u7387\uff1a \\begin{cases} site1: &\\frac{m}{N_1}, &\\frac{m}{N_1}, &\\ldots, &\\frac{m}{N_1} \\\\ site2: &\\frac{m}{N_2}, &\\frac{m}{N_2}, &\\ldots, &\\frac{m}{N_2} \\\\ \\vdots \\\\ siteK: &\\frac{m}{N_K}, &\\frac{m}{N_K}, &\\ldots, &\\frac{m}{N_K} \\\\ \\end{cases} \\begin{cases} site1: &\\frac{m}{N_1}, &\\frac{m}{N_1}, &\\ldots, &\\frac{m}{N_1} \\\\ site2: &\\frac{m}{N_2}, &\\frac{m}{N_2}, &\\ldots, &\\frac{m}{N_2} \\\\ \\vdots \\\\ siteK: &\\frac{m}{N_K}, &\\frac{m}{N_K}, &\\ldots, &\\frac{m}{N_K} \\\\ \\end{cases} \u5b9a\u4e49 N = \\sum^K_{i=1} N_i N = \\sum^K_{i=1} N_i \uff0c\u90a3\u4e48\u6211\u4eec\u7684\u76ee\u6807\u662f\u6bcf\u4e2a\u6837\u672c\u51fa\u73b0\u7684\u6982\u7387\u662f \\frac{m}{N} \\frac{m}{N} \u3002 \u6709\u70b9\u91cd\u8981\u6027\u91c7\u6837\u7684\u610f\u5473: \u6211\u4eec\u4ee5 \\frac{N_i}{N} \\frac{N_i}{N} \u7684\u6982\u7387\u9009\u62e9\u96c6\u5408 site_i site_i \uff0c\u7136\u540e\u4ece site_i site_i \u4e0d\u653e\u56de\u5730\u5747\u5300\u91c7\u6837\u4e00\u4e2a\u503c\u653e\u5165\u6700\u7ec8\u7684\u7ed3\u679c\u4e2d\u3002","title":"\u5206\u5e03\u5f0f\u84c4\u6c34\u6c60\u62bd\u6837"},{"location":"Algorithms/07-%E9%87%8D%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/","text":"\u91cd\u7f16\u7801\u6280\u5de7 \u00b6 \u6709\u4e00\u7c7b\u7b97\u6cd5\u9898\uff0c\u4f7f\u7528\u91cd\u7f16\u7801\u6280\u5de7\u53ef\u4ee5\u5927\u5927\u7b80\u5316\u95ee\u9898\u3002 \u5bb9\u6211\u901a\u8fc7\u4f8b\u5b50\u6765\u89e3\u91ca\u4e00\u4e0b\u8fd9\u662f\u4ec0\u4e48\u6280\u672f\u3002 \u6d88\u9664\u6e38\u620f \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 390 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u4ece 1 \u5230 n \u6392\u5e8f\u7684\u6574\u6570\u5217\u8868\uff0c\u6211\u4eec\u5148\u4ece\u5de6\u5230\u53f3\uff0c\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\uff0c\u6bcf\u9694\u4e00\u4e2a\u6570\u5b57\u5220\u9664\uff1b\u63a5\u7740\u6211\u4eec\u4ece\u53f3\u5230\u5de6\uff0c\u4ece\u6700\u540e\u4e00\u4e2a\u6570\u5b57\u5f00\u59cb\uff0c\u6bcf\u9694\u4e00\u4e2a\u6570\u5b57\u5220\u9664\u3002\u95ee\u6700\u540e\u5269\u4e0b\u7684\u662f\u54ea\u4e2a\u6570\u5b57\u3002 n = 8 Step 0: 1 2 3 4 5 6 7 8 Step 1: 2 4 6 8 Step 2: 2 6 Step 3: 6 \u5206\u6790 : \u6211\u4eec\u53ea\u9700\u8981\u5bf9\u524d\u4e24\u6b65\u8fdb\u884c\u5206\u6790\u3002 \u539f\u95ee\u9898: 2 4 6 8 \u5b50\u95ee\u9898: 4 3 2 1 Step 1 \u5b8c\u6bd5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6c42\u89e3\u4e00\u4e2a\u5b50\u95ee\u9898 \\left\\lfloor n / 2 \\right\\rfloor \\left\\lfloor n / 2 \\right\\rfloor \u6765\u89e3\u51b3\uff0c\u89e3\u51b3\u7684\u5b50\u95ee\u9898\u662f\u5212\u6570\u7ec4 [1, 2, 3, 4] , \u90a3\u4e48\u6211\u4eec\u9700\u8981\u628a\u5b83\u6620\u5c04\u56de\u539f\u6570\u7ec4 [8, 6, 4, 2] \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a\u51fd\u6570\u6ee1\u8db3 f(1) = 8 f(1) = 8 \u3001 f(2) = 6 f(2) = 6 \u3001 f(3) = 4 f(3) = 4 \u548c f(4) = 2 f(4) = 2 \u3002\u8fd9\u4e2a\u51fd\u6570\u5f88\u7b80\u5355: f(x) = 2 * (\\lfloor n / 2 \\rfloor + 1 - x). f(x) = 2 * (\\lfloor n / 2 \\rfloor + 1 - x). \u90a3\u4e48\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u5f52\u7684\u6c42\u89e3\u7b97\u6cd5: int lastRemaining ( int n ) { if ( n <= 2 ) return n ; return 2 * ( n / 2 + 1 - lastRemaining ( n / 2 )); } \u6d88\u9664\u6e38\u620f2 \u00b6 \u95ee\u9898\u63cf\u8ff0 : 1 \u5230 n \u7684 n \u4e2a\u6570\u987a\u65f6\u9488\u6392\u6210\u4e00\u5708\uff0c\u4ece 1 \u5f00\u59cb\uff0c\u987a\u65f6\u9488\u4f9d\u6b21\u5220\u9664\u7b2c k \u4e2a\u6570\uff0c\u6c42\u6700\u540e\u5269\u4e0b\u7684\u6570\u3002 n = 8, k = 3. Step 0: 1 2 3 4 5 6 7 8 Step 1: 1 2 4 5 6 7 8 Step 2: 1 2 4 5 7 8 Step 3: 2 4 5 7 8 Step 4: 2 4 7 8 Step 5: 4 7 8 Step 6: 4 7 Step 7: 7 \u5206\u6790 : \u6211\u4eec\u8fd8\u662f\u53ea\u9700\u8981\u770b\u524d\u4e24\u6b65\u3002Step 1 \u5b8c\u6bd5\u540e\uff0c\u7b49\u4ef7\u4e8e\u6211\u4eec\u6c42\u89e3\u4e00\u4e2a\u89c4\u6a21\u4e3a n - 1 \u7684\u5b50\u95ee\u9898\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u95ee\u9898\u548c\u539f\u95ee\u9898\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f\u5982\u4e0b\u6240\u793a\uff1a \u539f\u95ee\u9898: 4 5 6 7 8 1 2 \u5b50\u95ee\u9898: 1 2 3 4 5 6 7 \u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u628a\u5b50\u95ee\u9898\u7684\u89e3\u901a\u8fc7\u67d0\u4e2a\u91cd\u7f16\u7801\u51fd\u6570\u6620\u5c04\u56de\u539f\u95ee\u9898\u7684\u89e3\u3002 \u8fd9\u4e2a\u51fd\u6570\u5f88\u7b80\u5355\uff0c\u5373: f(x) = (k - 1 + x) \\bmod n + 1. f(x) = (k - 1 + x) \\bmod n + 1. \u8fd9\u65f6\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u5f52\u7684\u6c42\u89e3\u7b97\u6cd5\u3002 int lastRemaining ( int n , int k ) { return ( n == 1 ) ? 1 : ( k - 1 + lastRemaining ( n - 1 , k )) % n + 1 ; } \u7c7b\u4f3c\u7684\u5212\u6570\u5b57\u7684\u95ee\u9898\u53d8\u79cd\u5f88\u591a\uff0c\u8fd9\u91cc\u53ef\u4ee5\u4e3e\u4e00\u53cd\u4e09\u3002 \u6446\u52a8\u6392\u5e8f \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 324 \u8fd9\u4e2a\u95ee\u9898\u662f\u6211\u89c1\u8fc7\u7684\u6ca1\u4ec0\u4e48\u5b9e\u7528\u4ef7\u503c\uff0c\u4f46\u662f\u5f00\u53d1\u601d\u7ef4\u5f88\u6709\u6548\u7684\u4e00\u9053\u9898\u76ee\u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u5bf9\u4e8e\u4e00\u4e2a\u6570\u7ec4 [a_0, a_1, \\ldots, a_{n-1}] [a_0, a_1, \\ldots, a_{n-1}] \uff0c\u6211\u4eec\u9700\u8981\u8c03\u6574\u987a\u5e8f\uff0c\u4f7f\u5f97\u6570\u7ec4\u6ee1\u8db3 a_{n-1} < a_{n} > a_{n+1} a_{n-1} < a_{n} > a_{n+1} \u6216\u8005 a_{n-1} > a_{n} < a_{n+1} a_{n-1} > a_{n} < a_{n+1} \uff0c\u5373\u628a\u6570\u7ec4\u6392\u5e8f\u5f97\u53c2\u5dee\u4e0d\u9f50\u3002\u6ce8\u610f\uff0c\u6570\u7ec4\u6ca1\u6709\u6392\u5e8f\u8fc7\uff0c\u540c\u65f6\u6709\u53ef\u80fd\u53c8\u91cd\u590d\u7684\u5143\u7d20\u3002 \u5206\u6790 : \u4e00\u4e2a\u5148\u9a8c\u77e5\u8bc6\uff0c\u6211\u4eec\u53ef\u4ee5\u82b1\u8d39 O(n) O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u627e\u5230\u4e00\u4e2a\u6570\u7ec4\u7684\u4e2d\u4f4d\u6570\uff08\u5feb\u6392\u7684\u601d\u60f3\uff09\u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6570\u7ec4\u5206\u6210\u4e09\u4e2a\u90e8\u5206\uff1a a'_0, a'_1, \\ldots, a'_{p-1} < a'_{p} = \\ldots = a'_{q} < a'_{q+1}, \\ldots, a'_{n-1}. a'_0, a'_1, \\ldots, a'_{p-1} < a'_{p} = \\ldots = a'_{q} < a'_{q+1}, \\ldots, a'_{n-1}. \u63a5\u4e0b\u6765\u7684\u91cd\u7f16\u7801\u5c31\u5de7\u5999\u4e86\uff0c\u5047\u8bbe\u6570\u7ec4\u957f\u5ea6\u4e3a10, \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u4e0a\u9762\u6392\u5e8f\u597d\u7684\u6570\u7ec4\u8fdb\u884c\u5982\u4e0b\u7684\u91cd\u7f16\u7801: \u539f\u95ee\u9898\uff1aa''[0] a''[1] a''[2] a''[3] a''[4] a''[5] a''[6] a''[7] a''[8] a''[9] \u5b50\u95ee\u9898\uff1a a'[5] a'[0] a'[6] a'[1] a'[7] a'[2] a'[8] a'[3] a'[9] a'[4] \u4e00\u770b\u5c31\u53ef\u4ee5\u5f97\u5230\uff0c\u6211\u4eec\u6700\u540e\u9700\u8981\u8fd4\u56de\u6570\u7ec4 a'' a'' \u662f\u6ee1\u8db3\u8981\u6c42\u7684\uff1a\u56e0\u4e3a a''[i] a''[i] \u4e0e a''[i+1] a''[i+1] \u5bf9\u5e94\u7684 a'[m] a'[m] \u4e0e a'[n] a'[n] \u81f3\u5c11\u76f8\u5dee n/2 n/2 , \u5373 \\vert m - n \\vert \\ge n/2 \\vert m - n \\vert \\ge n/2 ; \u53e6\u5916\uff0c\u4e2d\u4f4d\u6570\u6700\u591a\u4e5f\u53ea\u6709 n/2 n/2 \u4e2a\uff0c\u5426\u5219\u65e0\u6cd5\u6ee1\u8db3\u9898\u610f\uff0c\u6240\u4ee5 a''[i] a''[i] \u4e0e a''[i+1] a''[i+1] \u4e0d\u53ef\u80fd\u540c\u65f6\u662f\u4e2d\u4f4d\u6570\u3002 \u5728\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u53e6\u5916\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4 a'' a'' \uff0c\u4f46\u662f\u4e3a\u4e86\u907f\u5f00\u989d\u5916\u7684\u5730\u5740\u5f00\u9500\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u865a\u5b9e\u5730\u5740\u7684\u65b9\u5f0f\u3002 \u8fd9\u91cc\u6709\u70b9\u7ed5\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u4e0a\u9762\u7684\u7f16\u7801\u8868\u793a\uff1a\u6211\u4eec\u5e0c\u671b\u6392\u5e8f\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4 a'' a'' \u6ee1\u8db3 a''[0] = a'[5] a''[0] = a'[5] \uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002 \u6211\u4eec\u5e0c\u671b\uff0c a' a' \u7684\u4e0b\u6807\u662f\u865a\u62df\u5730\u5740\uff1a\u6211\u4eec\u5bf9 a'[5] a'[5] \u8fdb\u884c\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\u8bbf\u95ee\u7684\u662f a''[0] a''[0] \u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u51fd\u6570\u6ee1\u8db3 f(5) = 0 f(5) = 0 \u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff0c\u5f53\u6211\u4eec\u5728\u6784\u9020 a' a' \u65f6\uff0c\u771f\u5b9e\u5730\u5740\u7684 a'' a'' \u5df2\u7ecf\u6784\u9020\u597d\u4e86\u3002 \u8fd9\u4e2a\u51fd\u6570\u4e3a: f(x) = \\begin{cases} 2x + 1, & x < n / 2; \\\\ 2x - n + n \\bmod 2, & x >= n / 2; \\end{cases} f(x) = \\begin{cases} 2x + 1, & x < n / 2; \\\\ 2x - n + n \\bmod 2, & x >= n / 2; \\end{cases} \u6216\u8005 f(x) = (2x + 1) \\bmod (n \\vert 1). f(x) = (2x + 1) \\bmod (n \\vert 1). \u6ce8\u610f \uff1a\u8fd9\u91ccLeetCode\u7684\u9898\u76ee\u8981\u6c42 a''[0] < a''[1] > a''[2] \\ldots a''[0] < a''[1] > a''[2] \\ldots \uff0c \u5373 a'[5] < a'[0] > a'[6] \\ldots a'[5] < a'[0] > a'[6] \\ldots \uff0c\u6240\u4ee5\u6211\u4eec\u5bf9 a' a' \u505a Three-Partition Three-Partition \u64cd\u4f5c\u65f6\uff0c\u6bd4\u4e2d\u4f4d\u6570\u5927\u7684\u6570\u653e\u5728\u5de6\u8fb9\uff0c\u6bd4\u4e2d\u4f4d\u6570\u5c0f\u7684\u6570\u653e\u5728\u53f3\u8fb9\u3002 \u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a void wiggleSort ( vector < int > & nums ) { int n = nums . size (); // int mid = findMid(nums); auto midptr = nums . begin () + n / 2 ; nth_element ( nums . begin (), midptr , nums . end ()); int mid = * midptr ; int left = 0 , right = n - 1 ; // Index-rewiring. #define f(i) ((1+2*(i)) % (n|1)) for ( int i = 0 ; i <= right ; ) { if ( nums [ f ( i )] < mid ) { swap ( nums [ f ( i )], nums [ f ( right -- )]); } else if ( nums [ f ( i )] > mid ) { swap ( nums [ f ( i ++ )], nums [ f ( left ++ )]); } else { ++ i ; } } return ; } \u6700\u540e\u518d\u8865\u5145\u4e00\u4e2a\u624b\u5199\u7684\u627e\u4e2d\u4f4d\u6570\u7684\u4ee3\u7801\u3002 \u627e\u4e2d\u4f4d\u6570 int findMid ( vector < int > & nums ) { int n = nums . size (); int left = 0 , right = n - 1 , mid = left + ( right - left ) / 2 ; while ( left < right ) { int num = nums [ left ]; int l = left , r = right ; for ( int i = l ; i <= r ;) { if ( nums [ i ] > num ) { swap ( nums [ i ], nums [ r -- ]); } else if ( nums [ i ] < num ) { swap ( nums [ i ++ ], nums [ l ++ ]); } else { i ++ ; } } if ( l == mid ) { break ; } else if ( l < mid ) { left = l + 1 ; } else { right = l - 1 ; } } return nums [ mid ]; }","title":"\u91cd\u7f16\u7801\u6280\u5de7"},{"location":"Algorithms/07-%E9%87%8D%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/#_1","text":"\u6709\u4e00\u7c7b\u7b97\u6cd5\u9898\uff0c\u4f7f\u7528\u91cd\u7f16\u7801\u6280\u5de7\u53ef\u4ee5\u5927\u5927\u7b80\u5316\u95ee\u9898\u3002 \u5bb9\u6211\u901a\u8fc7\u4f8b\u5b50\u6765\u89e3\u91ca\u4e00\u4e0b\u8fd9\u662f\u4ec0\u4e48\u6280\u672f\u3002","title":"\u91cd\u7f16\u7801\u6280\u5de7"},{"location":"Algorithms/07-%E9%87%8D%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/#_2","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 390 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u4ece 1 \u5230 n \u6392\u5e8f\u7684\u6574\u6570\u5217\u8868\uff0c\u6211\u4eec\u5148\u4ece\u5de6\u5230\u53f3\uff0c\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\uff0c\u6bcf\u9694\u4e00\u4e2a\u6570\u5b57\u5220\u9664\uff1b\u63a5\u7740\u6211\u4eec\u4ece\u53f3\u5230\u5de6\uff0c\u4ece\u6700\u540e\u4e00\u4e2a\u6570\u5b57\u5f00\u59cb\uff0c\u6bcf\u9694\u4e00\u4e2a\u6570\u5b57\u5220\u9664\u3002\u95ee\u6700\u540e\u5269\u4e0b\u7684\u662f\u54ea\u4e2a\u6570\u5b57\u3002 n = 8 Step 0: 1 2 3 4 5 6 7 8 Step 1: 2 4 6 8 Step 2: 2 6 Step 3: 6 \u5206\u6790 : \u6211\u4eec\u53ea\u9700\u8981\u5bf9\u524d\u4e24\u6b65\u8fdb\u884c\u5206\u6790\u3002 \u539f\u95ee\u9898: 2 4 6 8 \u5b50\u95ee\u9898: 4 3 2 1 Step 1 \u5b8c\u6bd5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6c42\u89e3\u4e00\u4e2a\u5b50\u95ee\u9898 \\left\\lfloor n / 2 \\right\\rfloor \\left\\lfloor n / 2 \\right\\rfloor \u6765\u89e3\u51b3\uff0c\u89e3\u51b3\u7684\u5b50\u95ee\u9898\u662f\u5212\u6570\u7ec4 [1, 2, 3, 4] , \u90a3\u4e48\u6211\u4eec\u9700\u8981\u628a\u5b83\u6620\u5c04\u56de\u539f\u6570\u7ec4 [8, 6, 4, 2] \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a\u51fd\u6570\u6ee1\u8db3 f(1) = 8 f(1) = 8 \u3001 f(2) = 6 f(2) = 6 \u3001 f(3) = 4 f(3) = 4 \u548c f(4) = 2 f(4) = 2 \u3002\u8fd9\u4e2a\u51fd\u6570\u5f88\u7b80\u5355: f(x) = 2 * (\\lfloor n / 2 \\rfloor + 1 - x). f(x) = 2 * (\\lfloor n / 2 \\rfloor + 1 - x). \u90a3\u4e48\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u5f52\u7684\u6c42\u89e3\u7b97\u6cd5: int lastRemaining ( int n ) { if ( n <= 2 ) return n ; return 2 * ( n / 2 + 1 - lastRemaining ( n / 2 )); }","title":"\u6d88\u9664\u6e38\u620f"},{"location":"Algorithms/07-%E9%87%8D%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/#2","text":"\u95ee\u9898\u63cf\u8ff0 : 1 \u5230 n \u7684 n \u4e2a\u6570\u987a\u65f6\u9488\u6392\u6210\u4e00\u5708\uff0c\u4ece 1 \u5f00\u59cb\uff0c\u987a\u65f6\u9488\u4f9d\u6b21\u5220\u9664\u7b2c k \u4e2a\u6570\uff0c\u6c42\u6700\u540e\u5269\u4e0b\u7684\u6570\u3002 n = 8, k = 3. Step 0: 1 2 3 4 5 6 7 8 Step 1: 1 2 4 5 6 7 8 Step 2: 1 2 4 5 7 8 Step 3: 2 4 5 7 8 Step 4: 2 4 7 8 Step 5: 4 7 8 Step 6: 4 7 Step 7: 7 \u5206\u6790 : \u6211\u4eec\u8fd8\u662f\u53ea\u9700\u8981\u770b\u524d\u4e24\u6b65\u3002Step 1 \u5b8c\u6bd5\u540e\uff0c\u7b49\u4ef7\u4e8e\u6211\u4eec\u6c42\u89e3\u4e00\u4e2a\u89c4\u6a21\u4e3a n - 1 \u7684\u5b50\u95ee\u9898\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u95ee\u9898\u548c\u539f\u95ee\u9898\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f\u5982\u4e0b\u6240\u793a\uff1a \u539f\u95ee\u9898: 4 5 6 7 8 1 2 \u5b50\u95ee\u9898: 1 2 3 4 5 6 7 \u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u628a\u5b50\u95ee\u9898\u7684\u89e3\u901a\u8fc7\u67d0\u4e2a\u91cd\u7f16\u7801\u51fd\u6570\u6620\u5c04\u56de\u539f\u95ee\u9898\u7684\u89e3\u3002 \u8fd9\u4e2a\u51fd\u6570\u5f88\u7b80\u5355\uff0c\u5373: f(x) = (k - 1 + x) \\bmod n + 1. f(x) = (k - 1 + x) \\bmod n + 1. \u8fd9\u65f6\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u5f52\u7684\u6c42\u89e3\u7b97\u6cd5\u3002 int lastRemaining ( int n , int k ) { return ( n == 1 ) ? 1 : ( k - 1 + lastRemaining ( n - 1 , k )) % n + 1 ; } \u7c7b\u4f3c\u7684\u5212\u6570\u5b57\u7684\u95ee\u9898\u53d8\u79cd\u5f88\u591a\uff0c\u8fd9\u91cc\u53ef\u4ee5\u4e3e\u4e00\u53cd\u4e09\u3002","title":"\u6d88\u9664\u6e38\u620f2"},{"location":"Algorithms/07-%E9%87%8D%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/#_3","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 324 \u8fd9\u4e2a\u95ee\u9898\u662f\u6211\u89c1\u8fc7\u7684\u6ca1\u4ec0\u4e48\u5b9e\u7528\u4ef7\u503c\uff0c\u4f46\u662f\u5f00\u53d1\u601d\u7ef4\u5f88\u6709\u6548\u7684\u4e00\u9053\u9898\u76ee\u3002 \u95ee\u9898\u63cf\u8ff0 \uff1a\u5bf9\u4e8e\u4e00\u4e2a\u6570\u7ec4 [a_0, a_1, \\ldots, a_{n-1}] [a_0, a_1, \\ldots, a_{n-1}] \uff0c\u6211\u4eec\u9700\u8981\u8c03\u6574\u987a\u5e8f\uff0c\u4f7f\u5f97\u6570\u7ec4\u6ee1\u8db3 a_{n-1} < a_{n} > a_{n+1} a_{n-1} < a_{n} > a_{n+1} \u6216\u8005 a_{n-1} > a_{n} < a_{n+1} a_{n-1} > a_{n} < a_{n+1} \uff0c\u5373\u628a\u6570\u7ec4\u6392\u5e8f\u5f97\u53c2\u5dee\u4e0d\u9f50\u3002\u6ce8\u610f\uff0c\u6570\u7ec4\u6ca1\u6709\u6392\u5e8f\u8fc7\uff0c\u540c\u65f6\u6709\u53ef\u80fd\u53c8\u91cd\u590d\u7684\u5143\u7d20\u3002 \u5206\u6790 : \u4e00\u4e2a\u5148\u9a8c\u77e5\u8bc6\uff0c\u6211\u4eec\u53ef\u4ee5\u82b1\u8d39 O(n) O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u627e\u5230\u4e00\u4e2a\u6570\u7ec4\u7684\u4e2d\u4f4d\u6570\uff08\u5feb\u6392\u7684\u601d\u60f3\uff09\u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6570\u7ec4\u5206\u6210\u4e09\u4e2a\u90e8\u5206\uff1a a'_0, a'_1, \\ldots, a'_{p-1} < a'_{p} = \\ldots = a'_{q} < a'_{q+1}, \\ldots, a'_{n-1}. a'_0, a'_1, \\ldots, a'_{p-1} < a'_{p} = \\ldots = a'_{q} < a'_{q+1}, \\ldots, a'_{n-1}. \u63a5\u4e0b\u6765\u7684\u91cd\u7f16\u7801\u5c31\u5de7\u5999\u4e86\uff0c\u5047\u8bbe\u6570\u7ec4\u957f\u5ea6\u4e3a10, \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u4e0a\u9762\u6392\u5e8f\u597d\u7684\u6570\u7ec4\u8fdb\u884c\u5982\u4e0b\u7684\u91cd\u7f16\u7801: \u539f\u95ee\u9898\uff1aa''[0] a''[1] a''[2] a''[3] a''[4] a''[5] a''[6] a''[7] a''[8] a''[9] \u5b50\u95ee\u9898\uff1a a'[5] a'[0] a'[6] a'[1] a'[7] a'[2] a'[8] a'[3] a'[9] a'[4] \u4e00\u770b\u5c31\u53ef\u4ee5\u5f97\u5230\uff0c\u6211\u4eec\u6700\u540e\u9700\u8981\u8fd4\u56de\u6570\u7ec4 a'' a'' \u662f\u6ee1\u8db3\u8981\u6c42\u7684\uff1a\u56e0\u4e3a a''[i] a''[i] \u4e0e a''[i+1] a''[i+1] \u5bf9\u5e94\u7684 a'[m] a'[m] \u4e0e a'[n] a'[n] \u81f3\u5c11\u76f8\u5dee n/2 n/2 , \u5373 \\vert m - n \\vert \\ge n/2 \\vert m - n \\vert \\ge n/2 ; \u53e6\u5916\uff0c\u4e2d\u4f4d\u6570\u6700\u591a\u4e5f\u53ea\u6709 n/2 n/2 \u4e2a\uff0c\u5426\u5219\u65e0\u6cd5\u6ee1\u8db3\u9898\u610f\uff0c\u6240\u4ee5 a''[i] a''[i] \u4e0e a''[i+1] a''[i+1] \u4e0d\u53ef\u80fd\u540c\u65f6\u662f\u4e2d\u4f4d\u6570\u3002 \u5728\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u53e6\u5916\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4 a'' a'' \uff0c\u4f46\u662f\u4e3a\u4e86\u907f\u5f00\u989d\u5916\u7684\u5730\u5740\u5f00\u9500\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u865a\u5b9e\u5730\u5740\u7684\u65b9\u5f0f\u3002 \u8fd9\u91cc\u6709\u70b9\u7ed5\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u4e0a\u9762\u7684\u7f16\u7801\u8868\u793a\uff1a\u6211\u4eec\u5e0c\u671b\u6392\u5e8f\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4 a'' a'' \u6ee1\u8db3 a''[0] = a'[5] a''[0] = a'[5] \uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002 \u6211\u4eec\u5e0c\u671b\uff0c a' a' \u7684\u4e0b\u6807\u662f\u865a\u62df\u5730\u5740\uff1a\u6211\u4eec\u5bf9 a'[5] a'[5] \u8fdb\u884c\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\u8bbf\u95ee\u7684\u662f a''[0] a''[0] \u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u51fd\u6570\u6ee1\u8db3 f(5) = 0 f(5) = 0 \u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff0c\u5f53\u6211\u4eec\u5728\u6784\u9020 a' a' \u65f6\uff0c\u771f\u5b9e\u5730\u5740\u7684 a'' a'' \u5df2\u7ecf\u6784\u9020\u597d\u4e86\u3002 \u8fd9\u4e2a\u51fd\u6570\u4e3a: f(x) = \\begin{cases} 2x + 1, & x < n / 2; \\\\ 2x - n + n \\bmod 2, & x >= n / 2; \\end{cases} f(x) = \\begin{cases} 2x + 1, & x < n / 2; \\\\ 2x - n + n \\bmod 2, & x >= n / 2; \\end{cases} \u6216\u8005 f(x) = (2x + 1) \\bmod (n \\vert 1). f(x) = (2x + 1) \\bmod (n \\vert 1). \u6ce8\u610f \uff1a\u8fd9\u91ccLeetCode\u7684\u9898\u76ee\u8981\u6c42 a''[0] < a''[1] > a''[2] \\ldots a''[0] < a''[1] > a''[2] \\ldots \uff0c \u5373 a'[5] < a'[0] > a'[6] \\ldots a'[5] < a'[0] > a'[6] \\ldots \uff0c\u6240\u4ee5\u6211\u4eec\u5bf9 a' a' \u505a Three-Partition Three-Partition \u64cd\u4f5c\u65f6\uff0c\u6bd4\u4e2d\u4f4d\u6570\u5927\u7684\u6570\u653e\u5728\u5de6\u8fb9\uff0c\u6bd4\u4e2d\u4f4d\u6570\u5c0f\u7684\u6570\u653e\u5728\u53f3\u8fb9\u3002 \u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a void wiggleSort ( vector < int > & nums ) { int n = nums . size (); // int mid = findMid(nums); auto midptr = nums . begin () + n / 2 ; nth_element ( nums . begin (), midptr , nums . end ()); int mid = * midptr ; int left = 0 , right = n - 1 ; // Index-rewiring. #define f(i) ((1+2*(i)) % (n|1)) for ( int i = 0 ; i <= right ; ) { if ( nums [ f ( i )] < mid ) { swap ( nums [ f ( i )], nums [ f ( right -- )]); } else if ( nums [ f ( i )] > mid ) { swap ( nums [ f ( i ++ )], nums [ f ( left ++ )]); } else { ++ i ; } } return ; } \u6700\u540e\u518d\u8865\u5145\u4e00\u4e2a\u624b\u5199\u7684\u627e\u4e2d\u4f4d\u6570\u7684\u4ee3\u7801\u3002 \u627e\u4e2d\u4f4d\u6570 int findMid ( vector < int > & nums ) { int n = nums . size (); int left = 0 , right = n - 1 , mid = left + ( right - left ) / 2 ; while ( left < right ) { int num = nums [ left ]; int l = left , r = right ; for ( int i = l ; i <= r ;) { if ( nums [ i ] > num ) { swap ( nums [ i ], nums [ r -- ]); } else if ( nums [ i ] < num ) { swap ( nums [ i ++ ], nums [ l ++ ]); } else { i ++ ; } } if ( l == mid ) { break ; } else if ( l < mid ) { left = l + 1 ; } else { right = l - 1 ; } } return nums [ mid ]; }","title":"\u6446\u52a8\u6392\u5e8f"},{"location":"Algorithms/08-%E6%94%BE%E6%9D%BE%E6%9D%A1%E4%BB%B6%E6%B3%95/","text":"\u653e\u677e\u6761\u4ef6\u6cd5 \u00b6 \u6709\u4e00\u7c7b\u7b97\u6cd5\u9898\uff0c\u9898\u76ee\u8981\u6c42\u6bd4\u8f83\u591a\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6839\u636e\u4e00\u4e2a\u6bd4\u8f83\u5bb9\u6613\u8ba1\u7b97\u7684\u6761\u4ef6\uff0c\u5f97\u5230\u4e00\u4e2a\u4faf\u9009\u503c\uff0c\u7136\u540e\u5224\u65ad\u8fd9\u4e2a\u4faf\u9009\u503c\u662f\u5426\u6ee1\u8db3\u5176\u4ed6\u6761\u4ef6\u7684\u8981\u6c42\u3002 \u770b\u5230\u8fd9\u91cc\uff0c\u5927\u5bb6\u4f1a\u89c9\u5f97\u5947\u602a\uff0c\u8fd9\u4e5f\u662f\u65b9\u6cd5\uff1f\u9996\u5148\u4e0d\u8981\u5c0f\u77a7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5b83\u5f80\u5f80\u5f88\u6709\u6548\u3002\u53e6\u5916\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\u4f7f\u7528\u7684\uff0c\u56e0\u4e3a\u5bb9\u6613\u5224\u65ad\u7684\u6761\u4ef6\u5f80\u5f80\u662f\u9690\u85cf\u7684\uff0c\u4e0d\u4f1a\u660e\u660e\u767d\u767d\u5730\u5199\u51fa\u6765\u3002 \u5b8c\u7f8e\u77e9\u5f62 \u00b6 \u8be6\u60c5\u53c2\u8003: LeetCode 391 \u9898\u76ee\u63cf\u8ff0 : \u8f93\u5165n\u4e2a\u77e9\u5f62(\u4ee5\u5de6\u4e0a\u89d2\u4e0e\u53f3\u4e0b\u89d2\u8868\u793a, \u5747\u4e3a\u6574\u6570)\uff0c\u6211\u4eec\u9700\u8981\u5224\u65ad\u8fd9\u4e9b\u77e9\u5f62\u662f\u5426\u65e0\u91cd\u53e0\u5730\u62fc\u6210\u4e00\u4e2a\u5b8c\u6574\u5730\u5927\u77e9\u5f62\u3002 \u5206\u6790 : \u9996\u5148\uff0c\u6211\u4eec\u80fd\u5f88\u5bb9\u6613\u77e5\u9053: \u5982\u679c\u80fd\u62fc\u6210\u4e00\u4e2a\u5927\u77e9\u5f62\uff0c\u90a3\u4e48\u77e9\u5f62\u7684\u5de6\u4e0a\u89d2\u4e0e\u53f3\u4e0b\u89d2\u7684\u70b9\u5206\u522b\u5bf9\u5e94\u8fd9\u5806\u5c0f\u77e9\u5f62\u7684\u6700\u5de6\u4e0a\u89d2\u7684\u70b9\uff0c\u6700\u53f3\u4e0b\u89d2\u7684\u70b9\u3002\u8fd9\u4e2a\u77e9\u5f62\u5c31\u662f\u6211\u4eec\u7684\u5019\u9009\u503c\u3002 \u4e00\u4e2a\u5bb9\u6613\u5224\u65ad\u7684\u6761\u4ef6\uff1a\u8fd9\u4e2a\u5927\u77e9\u5f62\u7684\u9762\u79ef\u5e94\u8be5\u662f\u6240\u6709\u5c0f\u77e9\u5f62\u9762\u79ef\u7684\u548c\u3002 \u63a5\u7740\u6211\u4eec\u9700\u8981\u5224\u65ad\u8fd9\u4e9b\u5c0f\u77e9\u5f62\u662f\u5426\u6709\u91cd\u53e0\uff0c\u5982\u679c\u8fd9\u4e9b\u5c0f\u77e9\u5f62\u6ca1\u6709\u91cd\u53e0\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ee1\u8db3\u4e0b\u9762\u7684\u6761\u4ef6\uff1a\u5982\u679c\u77e9\u5f62\u770b\u6210\u56db\u4e2a\u70b9\uff0c\u90a3\u4e48\u9664\u4e86\u4e0e\u5927\u77e9\u5f62\u5bf9\u5e94\u7684\u56db\u4e2a\u70b9\uff0c\u5176\u5b83\u7684\u70b9\u5e94\u8be5\u662f\u4e24\u4e24\u76f8\u62b5\u6d88\u7684\u3002 \u9898\u89e3\u4ee3\u7801 : class Solution { public : bool isRectangleCover ( vector < vector < int >>& rectangles ) { // \u83b7\u5f97\u6700\u5927\u77e9\u5f62, \u987a\u5e26\u7edf\u8ba1\u4e00\u4e0b\u5c0f\u77e9\u9635\u7684\u9762\u79ef\u548c\u3002 long long sum = 0 ; vector < int > largeRec = { INT_MAX , INT_MAX , 0 , 0 }; // \u5b9a\u4e49\u5728 <climits> \u5934\u6587\u4ef6\u4e2d\u3002 for ( auto & rec : rectangles ) { largeRec [ 0 ] = min ( largeRec [ 0 ], rec [ 0 ]); largeRec [ 1 ] = min ( largeRec [ 1 ], rec [ 1 ]); largeRec [ 2 ] = max ( largeRec [ 2 ], rec [ 2 ]); largeRec [ 3 ] = max ( largeRec [ 3 ], rec [ 3 ]); sum += area ( rec ); } if ( sum != area ( largeRec )) { return false ; } // \u5224\u65ad\u662f\u5426\u77e9\u5f62\u6709\u91cd\u53e0\u3002 set < pair < int , int >> s ; // unordered_set \u5bf9 pair \u6ca1\u6709\u5bf9\u5e94\u7684\u54c8\u5e0c\u51fd\u6570\uff0c // \u6240\u4ee5\u9700\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u54c8\u5e0c\u51fd\u6570\u3002 // \u4f46\u662f\u81ea\u5b9a\u4e49\u54c8\u5e0c\u51fd\u6570\u7684 unordered_set \u6548\u7387\u975e\u5e38\u4f4e, // \u8fdc\u8fdc\u4e0d\u53ca set<pari<int, int>>\u3002 rectangles . push_back ( largeRec ); for ( auto & rec : rectangles ) { for ( int i = 0 ; i <= 2 ; i += 2 ) { for ( int j = 1 ; j <= 3 ; j += 2 ) { auto a = make_pair ( rec [ i ], rec [ j ]); if ( s . find ( a ) != s . end ()) { s . erase ( s . find ( a )); } else { s . insert ( a ); } } } } return s . empty (); } private : inline long long area ( vector < int > & rec ) { return ( rec [ 2 ] - rec [ 0 ]) * ( rec [ 3 ] - rec [ 1 ]); } }; \u5206\u77f3\u5b50 \u00b6 \u8fd9\u4e2a\u9898\u76ee\u662f\u6211\u5728\u9762\u8bd5\u7684\u65f6\u5019\u9047\u5230\u7684\u95ee\u9898\u3002 \u9898\u76ee\u63cf\u8ff0 : \u6211\u4eec\u6709 n \u5806\u77f3\u5b50\uff0c\u6bcf\u5806\u77f3\u5b50\u7684\u4e2a\u6570\u5206\u522b\u4e3a a[0], a[1], ..., a[n-1] \u3002\u73b0\u5728\u8981\u6c42\u6211\u4eec\u8fd9 n n \u5806\u77f3\u5b50\u5206\u6210 m m \u5806\u77f3\u5b50 b[0], b[1], ..., b[m-1] , \u8981\u6c42\uff1a\u6bcf\u5806\u77f3\u5b50\u7684\u4e2a\u6570\u5927\u4e8e0\uff0c\u5e76\u4e14\u4e0d\u80fd\u5408\u5e76\u539f\u6765\u7684\u77f3\u5b50\u5806\uff0c\u53ea\u80fd\u62c6\u5206\u77f3\u5b50\u5806\u3002\u95ee\uff1a\u5728\u6240\u6709\u5206\u53d1\u4e2d\uff0c \\min_{i} b[i] \\min_{i} b[i] \u6700\u5927\u53ef\u80fd\u662f\u591a\u5c11\uff1f\u793a\u4f8b\u5982\u4e0b\uff1a \u8f93\u5165\uff1an = 3, m = 5, a = [3, 5, 6]. \u8f93\u51fa\uff1a2 (b = [3, 5, 2, 2, 2]). \u5206\u6790 \uff1a \u6211\u4eec\u53ef\u4ee5\u7528\u653e\u677e\u6761\u4ef6\u6cd5\u6765\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002 \u9996\u5148\u83b7\u5f97\u4e00\u4e2a\u6700\u5927\u7684\u5019\u9009\u503c avg = \\min(\\min_i a[i], \\lfloor\\sum^{n-1}_{i=0} a[i] / m\\rfloor) avg = \\min(\\min_i a[i], \\lfloor\\sum^{n-1}_{i=0} a[i] / m\\rfloor) ; \u6211\u4eec\u4ece\u5019\u9009\u533a\u95f4 [1, avg] [1, avg] \u91c7\u7528\u4e8c\u5206\u6cd5\u6765\u9a8c\u8bc1\u8fd9\u4e9b\u4faf\u9009\u6570\uff1b \u6211\u4eec\u9a8c\u8bc1\u4faf\u9009\u6570 num num \u7684\u65b9\u6cd5\u662f\uff1a\u4ee5\u5019\u9009\u6570\u4f5c\u4e3a\u62c6\u5206\u51fa\u7684 \\min_i b[i] \\min_i b[i] \uff0c\u904d\u5386\u6bcf\u4e2a\u77f3\u5b50\u5806\uff0c\u770b\u770b\u6bcf\u4e2a\u77f3\u5b50\u5806\u6700\u591a\u80fd\u5206\u51fa\u591a\u5c11\u5806\uff0c\u5224\u65ad\u662f\u5426\u80fd\u591f\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002 \u4f8b\u5982\uff1a\u5728\u4e0a\u9762\u8fd9\u4e2a\u7684\u793a\u4f8b\u4e2d\uff0c\u4e00\u4e2a\u53ef\u9009\u7684\u4faf\u9009\u503c\u662f2\u3002\u90a3\u4e48 a[0] = 3 \u4e0d\u80fd\u88ab\u5206\uff0c\u56e0\u4e3a\u5206\u6210\u7684\u5806\u4e3a [1, 2] \u5b58\u5728\u6bd4\u5019\u9009\u6570\u8fd8\u5c0f\u7684\u6570\uff0c\u8fd9\u4e0d\u6ee1\u8db3\u5019\u9009\u6570\u7684\u8981\u6c42; a[1] = 5 \u53ef\u4ee5\u88ab\u5206\u6210\u4e24\u5806 [2, 3] ; \u6700\u540e a[2] = 6 \u53ef\u4ee5\u88ab\u5206\u6210\u4e09\u5806 [2, 2, 2] \u3002\u90a3\u4e48\u4ee5 2 \u62c6\u5206\u77f3\u5b50\u5806\uff0c\u6700\u591a\u53ef\u4ee5\u5206\u51fa 6 \u5806\uff0c\u8d85\u8fc7\u6211\u4eec\u7684\u9700\u6c42 5 \u5806\uff0c\u6240\u4ee5 2 2 \u662f\u53ef\u4ee5\u7684\u3002 \u8fd9\u91cc\u6bcf\u4e2a\u6c42\u62c6\u5206\u5806\u6570\u7684\u516c\u5f0f\u6709 \\max(\\lfloor a[i] / num \\rfloor, 1) \\max(\\lfloor a[i] / num \\rfloor, 1) \u3002","title":"\u653e\u677e\u6761\u4ef6\u6cd5"},{"location":"Algorithms/08-%E6%94%BE%E6%9D%BE%E6%9D%A1%E4%BB%B6%E6%B3%95/#_1","text":"\u6709\u4e00\u7c7b\u7b97\u6cd5\u9898\uff0c\u9898\u76ee\u8981\u6c42\u6bd4\u8f83\u591a\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6839\u636e\u4e00\u4e2a\u6bd4\u8f83\u5bb9\u6613\u8ba1\u7b97\u7684\u6761\u4ef6\uff0c\u5f97\u5230\u4e00\u4e2a\u4faf\u9009\u503c\uff0c\u7136\u540e\u5224\u65ad\u8fd9\u4e2a\u4faf\u9009\u503c\u662f\u5426\u6ee1\u8db3\u5176\u4ed6\u6761\u4ef6\u7684\u8981\u6c42\u3002 \u770b\u5230\u8fd9\u91cc\uff0c\u5927\u5bb6\u4f1a\u89c9\u5f97\u5947\u602a\uff0c\u8fd9\u4e5f\u662f\u65b9\u6cd5\uff1f\u9996\u5148\u4e0d\u8981\u5c0f\u77a7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5b83\u5f80\u5f80\u5f88\u6709\u6548\u3002\u53e6\u5916\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\u4f7f\u7528\u7684\uff0c\u56e0\u4e3a\u5bb9\u6613\u5224\u65ad\u7684\u6761\u4ef6\u5f80\u5f80\u662f\u9690\u85cf\u7684\uff0c\u4e0d\u4f1a\u660e\u660e\u767d\u767d\u5730\u5199\u51fa\u6765\u3002","title":"\u653e\u677e\u6761\u4ef6\u6cd5"},{"location":"Algorithms/08-%E6%94%BE%E6%9D%BE%E6%9D%A1%E4%BB%B6%E6%B3%95/#_2","text":"\u8be6\u60c5\u53c2\u8003: LeetCode 391 \u9898\u76ee\u63cf\u8ff0 : \u8f93\u5165n\u4e2a\u77e9\u5f62(\u4ee5\u5de6\u4e0a\u89d2\u4e0e\u53f3\u4e0b\u89d2\u8868\u793a, \u5747\u4e3a\u6574\u6570)\uff0c\u6211\u4eec\u9700\u8981\u5224\u65ad\u8fd9\u4e9b\u77e9\u5f62\u662f\u5426\u65e0\u91cd\u53e0\u5730\u62fc\u6210\u4e00\u4e2a\u5b8c\u6574\u5730\u5927\u77e9\u5f62\u3002 \u5206\u6790 : \u9996\u5148\uff0c\u6211\u4eec\u80fd\u5f88\u5bb9\u6613\u77e5\u9053: \u5982\u679c\u80fd\u62fc\u6210\u4e00\u4e2a\u5927\u77e9\u5f62\uff0c\u90a3\u4e48\u77e9\u5f62\u7684\u5de6\u4e0a\u89d2\u4e0e\u53f3\u4e0b\u89d2\u7684\u70b9\u5206\u522b\u5bf9\u5e94\u8fd9\u5806\u5c0f\u77e9\u5f62\u7684\u6700\u5de6\u4e0a\u89d2\u7684\u70b9\uff0c\u6700\u53f3\u4e0b\u89d2\u7684\u70b9\u3002\u8fd9\u4e2a\u77e9\u5f62\u5c31\u662f\u6211\u4eec\u7684\u5019\u9009\u503c\u3002 \u4e00\u4e2a\u5bb9\u6613\u5224\u65ad\u7684\u6761\u4ef6\uff1a\u8fd9\u4e2a\u5927\u77e9\u5f62\u7684\u9762\u79ef\u5e94\u8be5\u662f\u6240\u6709\u5c0f\u77e9\u5f62\u9762\u79ef\u7684\u548c\u3002 \u63a5\u7740\u6211\u4eec\u9700\u8981\u5224\u65ad\u8fd9\u4e9b\u5c0f\u77e9\u5f62\u662f\u5426\u6709\u91cd\u53e0\uff0c\u5982\u679c\u8fd9\u4e9b\u5c0f\u77e9\u5f62\u6ca1\u6709\u91cd\u53e0\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ee1\u8db3\u4e0b\u9762\u7684\u6761\u4ef6\uff1a\u5982\u679c\u77e9\u5f62\u770b\u6210\u56db\u4e2a\u70b9\uff0c\u90a3\u4e48\u9664\u4e86\u4e0e\u5927\u77e9\u5f62\u5bf9\u5e94\u7684\u56db\u4e2a\u70b9\uff0c\u5176\u5b83\u7684\u70b9\u5e94\u8be5\u662f\u4e24\u4e24\u76f8\u62b5\u6d88\u7684\u3002 \u9898\u89e3\u4ee3\u7801 : class Solution { public : bool isRectangleCover ( vector < vector < int >>& rectangles ) { // \u83b7\u5f97\u6700\u5927\u77e9\u5f62, \u987a\u5e26\u7edf\u8ba1\u4e00\u4e0b\u5c0f\u77e9\u9635\u7684\u9762\u79ef\u548c\u3002 long long sum = 0 ; vector < int > largeRec = { INT_MAX , INT_MAX , 0 , 0 }; // \u5b9a\u4e49\u5728 <climits> \u5934\u6587\u4ef6\u4e2d\u3002 for ( auto & rec : rectangles ) { largeRec [ 0 ] = min ( largeRec [ 0 ], rec [ 0 ]); largeRec [ 1 ] = min ( largeRec [ 1 ], rec [ 1 ]); largeRec [ 2 ] = max ( largeRec [ 2 ], rec [ 2 ]); largeRec [ 3 ] = max ( largeRec [ 3 ], rec [ 3 ]); sum += area ( rec ); } if ( sum != area ( largeRec )) { return false ; } // \u5224\u65ad\u662f\u5426\u77e9\u5f62\u6709\u91cd\u53e0\u3002 set < pair < int , int >> s ; // unordered_set \u5bf9 pair \u6ca1\u6709\u5bf9\u5e94\u7684\u54c8\u5e0c\u51fd\u6570\uff0c // \u6240\u4ee5\u9700\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u54c8\u5e0c\u51fd\u6570\u3002 // \u4f46\u662f\u81ea\u5b9a\u4e49\u54c8\u5e0c\u51fd\u6570\u7684 unordered_set \u6548\u7387\u975e\u5e38\u4f4e, // \u8fdc\u8fdc\u4e0d\u53ca set<pari<int, int>>\u3002 rectangles . push_back ( largeRec ); for ( auto & rec : rectangles ) { for ( int i = 0 ; i <= 2 ; i += 2 ) { for ( int j = 1 ; j <= 3 ; j += 2 ) { auto a = make_pair ( rec [ i ], rec [ j ]); if ( s . find ( a ) != s . end ()) { s . erase ( s . find ( a )); } else { s . insert ( a ); } } } } return s . empty (); } private : inline long long area ( vector < int > & rec ) { return ( rec [ 2 ] - rec [ 0 ]) * ( rec [ 3 ] - rec [ 1 ]); } };","title":"\u5b8c\u7f8e\u77e9\u5f62"},{"location":"Algorithms/08-%E6%94%BE%E6%9D%BE%E6%9D%A1%E4%BB%B6%E6%B3%95/#_3","text":"\u8fd9\u4e2a\u9898\u76ee\u662f\u6211\u5728\u9762\u8bd5\u7684\u65f6\u5019\u9047\u5230\u7684\u95ee\u9898\u3002 \u9898\u76ee\u63cf\u8ff0 : \u6211\u4eec\u6709 n \u5806\u77f3\u5b50\uff0c\u6bcf\u5806\u77f3\u5b50\u7684\u4e2a\u6570\u5206\u522b\u4e3a a[0], a[1], ..., a[n-1] \u3002\u73b0\u5728\u8981\u6c42\u6211\u4eec\u8fd9 n n \u5806\u77f3\u5b50\u5206\u6210 m m \u5806\u77f3\u5b50 b[0], b[1], ..., b[m-1] , \u8981\u6c42\uff1a\u6bcf\u5806\u77f3\u5b50\u7684\u4e2a\u6570\u5927\u4e8e0\uff0c\u5e76\u4e14\u4e0d\u80fd\u5408\u5e76\u539f\u6765\u7684\u77f3\u5b50\u5806\uff0c\u53ea\u80fd\u62c6\u5206\u77f3\u5b50\u5806\u3002\u95ee\uff1a\u5728\u6240\u6709\u5206\u53d1\u4e2d\uff0c \\min_{i} b[i] \\min_{i} b[i] \u6700\u5927\u53ef\u80fd\u662f\u591a\u5c11\uff1f\u793a\u4f8b\u5982\u4e0b\uff1a \u8f93\u5165\uff1an = 3, m = 5, a = [3, 5, 6]. \u8f93\u51fa\uff1a2 (b = [3, 5, 2, 2, 2]). \u5206\u6790 \uff1a \u6211\u4eec\u53ef\u4ee5\u7528\u653e\u677e\u6761\u4ef6\u6cd5\u6765\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002 \u9996\u5148\u83b7\u5f97\u4e00\u4e2a\u6700\u5927\u7684\u5019\u9009\u503c avg = \\min(\\min_i a[i], \\lfloor\\sum^{n-1}_{i=0} a[i] / m\\rfloor) avg = \\min(\\min_i a[i], \\lfloor\\sum^{n-1}_{i=0} a[i] / m\\rfloor) ; \u6211\u4eec\u4ece\u5019\u9009\u533a\u95f4 [1, avg] [1, avg] \u91c7\u7528\u4e8c\u5206\u6cd5\u6765\u9a8c\u8bc1\u8fd9\u4e9b\u4faf\u9009\u6570\uff1b \u6211\u4eec\u9a8c\u8bc1\u4faf\u9009\u6570 num num \u7684\u65b9\u6cd5\u662f\uff1a\u4ee5\u5019\u9009\u6570\u4f5c\u4e3a\u62c6\u5206\u51fa\u7684 \\min_i b[i] \\min_i b[i] \uff0c\u904d\u5386\u6bcf\u4e2a\u77f3\u5b50\u5806\uff0c\u770b\u770b\u6bcf\u4e2a\u77f3\u5b50\u5806\u6700\u591a\u80fd\u5206\u51fa\u591a\u5c11\u5806\uff0c\u5224\u65ad\u662f\u5426\u80fd\u591f\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002 \u4f8b\u5982\uff1a\u5728\u4e0a\u9762\u8fd9\u4e2a\u7684\u793a\u4f8b\u4e2d\uff0c\u4e00\u4e2a\u53ef\u9009\u7684\u4faf\u9009\u503c\u662f2\u3002\u90a3\u4e48 a[0] = 3 \u4e0d\u80fd\u88ab\u5206\uff0c\u56e0\u4e3a\u5206\u6210\u7684\u5806\u4e3a [1, 2] \u5b58\u5728\u6bd4\u5019\u9009\u6570\u8fd8\u5c0f\u7684\u6570\uff0c\u8fd9\u4e0d\u6ee1\u8db3\u5019\u9009\u6570\u7684\u8981\u6c42; a[1] = 5 \u53ef\u4ee5\u88ab\u5206\u6210\u4e24\u5806 [2, 3] ; \u6700\u540e a[2] = 6 \u53ef\u4ee5\u88ab\u5206\u6210\u4e09\u5806 [2, 2, 2] \u3002\u90a3\u4e48\u4ee5 2 \u62c6\u5206\u77f3\u5b50\u5806\uff0c\u6700\u591a\u53ef\u4ee5\u5206\u51fa 6 \u5806\uff0c\u8d85\u8fc7\u6211\u4eec\u7684\u9700\u6c42 5 \u5806\uff0c\u6240\u4ee5 2 2 \u662f\u53ef\u4ee5\u7684\u3002 \u8fd9\u91cc\u6bcf\u4e2a\u6c42\u62c6\u5206\u5806\u6570\u7684\u516c\u5f0f\u6709 \\max(\\lfloor a[i] / num \\rfloor, 1) \\max(\\lfloor a[i] / num \\rfloor, 1) \u3002","title":"\u5206\u77f3\u5b50"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/","text":"\u5355\u8c03\u6808 \u00b6 \u5355\u8c03\u6808\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6808\uff0c\u53ef\u4ee5\u7528\u6765\u7ef4\u62a4\u67d0\u79cd\u903b\u8f91\u4fe1\u606f\uff0c\u5728\u5f88\u591a\u9898\u76ee\u4e2d\u975e\u5e38\u6709\u6548\u3002 \u8fd9\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u6240\u4ee5\u5b83\u901a\u5e38\u670d\u52a1\u4e8e\u9898\u76ee\u7684\u89e3\u6cd5\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u5148\u5206\u6790\u9898\u610f\uff0c\u8bbe\u8ba1\u51fa\u67d0\u79cd\u89e3\u6cd5\uff0c\u7136\u540e\u8981\u81ea\u884c\u5224\u65ad\u662f\u5426\u9700\u8981\u5355\u8c03\u6808\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u3002 \u4e0b\u9762\u51e0\u9053\u9898\u76ee\u5f88\u9002\u5408\u7528\u89c6\u9891\u6216\u8005\u52a8\u6001gif\u56fe\u6765\u8bb2\u89e3\uff0c\u6587\u5b57\u786e\u5b9e\u6709\u70b9\u5e72\u762a\u3002 \u63a5\u96e8\u6c34 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 42 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a n \u4e2a\u975e\u8d1f\u6574\u6570\u8868\u793a\u6bcf\u4e2a\u5bbd\u5ea6\u4e3a 1 \u7684\u67f1\u5b50\u7684\u9ad8\u5ea6\u56fe\uff0c\u8ba1\u7b97\u6309\u6b64\u6392\u5217\u7684\u67f1\u5b50\uff0c\u4e0b\u96e8\u4e4b\u540e\u80fd\u63a5\u591a\u5c11\u96e8\u6c34\u3002 \u793a\u4f8b : \u8f93\u5165: [0,1,0,2,1,0,1,3,2,1,2,1] \u8f93\u51fa: 6 \u9898\u89e3 \uff1a\u8fd9\u91cc\u9700\u8981\u4e00\u4e2a\u5355\u8c03\u51cf\u6808\uff0c\u9047\u5230\u6bd4\u6808\u9876\u9ad8\u7684\u67f1\u5b50\uff0c\u8bf4\u660e\u53ef\u4ee5\u524d\u9762\u6709\u67f1\u5b50\u53ef\u4ee5\u5b58\u96e8\u6c34, \u6211\u4eec\u5c31\u8981\u8fdb\u5165\u96e8\u6c34\u7684\u8ba1\u7b97\u3002 \u8ba1\u7b97\u96e8\u6c34\u7684\u6838\u5fc3\u662f\u628a\u96e8\u6c34\u5982\u56fe\u5206\u62104\u4e2a\u77e9\u5f62. \u53c2\u8003\u4ee3\u7801 class Solution { public : int trap ( vector < int >& height ) { if ( height . empty ()) return 0 ; int n = height . size (), cnt = 0 ; stack < int > s ; for ( int i = 0 ; i < n ; ++ i ) { int h = height [ i ]; while ( ! s . empty () && height [ s . top ()] < h ) { int j = s . top (); s . pop (); if ( ! s . empty ()) { int distance = i - s . top () - 1 ; int delta_h = min ( height [ s . top ()], h ) - height [ j ]; cnt += distance * delta_h ; } } s . push ( i ); } return cnt ; } }; \u67f1\u72b6\u56fe\u4e2d\u7684\u6700\u5927\u77e9\u5f62 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 84 \u9898\u76ee\u63cf\u8ff0 \uff1a\u7ed9\u5b9a n \u4e2a\u975e\u8d1f\u6574\u6570\uff0c\u7528\u6765\u8868\u793a\u67f1\u72b6\u56fe\u4e2d\u5404\u4e2a\u67f1\u5b50\u7684\u9ad8\u5ea6\u3002\u6bcf\u4e2a\u67f1\u5b50\u5f7c\u6b64\u76f8\u90bb\uff0c\u4e14\u5bbd\u5ea6\u4e3a 1\u3002\u6c42\u5728\u8be5\u67f1\u72b6\u56fe\u4e2d\uff0c\u80fd\u591f\u52fe\u52d2\u51fa\u6765\u7684\u77e9\u5f62\u7684\u6700\u5927\u9762\u79ef\u3002 \u793a\u4f8b \uff1a \u8f93\u5165: [2,1,5,6,2,3] \u8f93\u51fa: 10 \u9898\u89e3 \uff1a\u8fd9\u4e2a\u5355\u8c03\u9012\u589e\u6808\u4e5f\u4e0d\u96be\uff0c\u9047\u5230\u6bd4\u6808\u9876\u4f4e\u7684\u67f1\u5b50\uff0c\u5c31\u8981\u8fdb\u5165\u77e9\u5f62\u9762\u79ef\u7684\u8ba1\u7b97\u3002\u8fd9\u9053\u9898\u7684\u5173\u952e\u5728\u4e8e\u7406\u6e05\u695a\u5982\u4f55\u6c42\u77e9\u5f62\u9762\u79ef\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : int largestRectangleArea ( vector < int >& heights ) { if ( heights . empty ()) return false ; stack < int > s ; heights . push_back ( 0 ); int n = heights . size (), max_area = 0 ; for ( int current_i = 0 ; current_i < n ; ++ current_i ) { int current_h = heights [ current_i ]; while ( ! s . empty () && heights [ s . top ()] > current_h ) { int top_i = s . top (); s . pop (); int distance = ( s . empty ()) ? current_i : current_i - s . top () - 1 ; int area = heights [ top_i ] * distance ; max_area = max ( max_area , area ); } s . push ( current_i ); } return max_area ; } }; \u6700\u5927\u77e9\u5f62 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 85 \u9898\u76ee\u63cf\u8ff0 \uff1a\u7ed9\u5b9a\u4e00\u4e2a\u4ec5\u5305\u542b 0 \u548c 1 \u7684\u4e8c\u7ef4\u4e8c\u8fdb\u5236\u77e9\u9635\uff0c\u627e\u51fa\u53ea\u5305\u542b 1 \u7684\u6700\u5927\u77e9\u5f62\uff0c\u5e76\u8fd4\u56de\u5176\u9762\u79ef\u3002 \u793a\u4f8b \uff1a \u8f93\u5165: [ [\"1\",\"0\",\"1\",\"0\",\"0\"], [\"1\",\"0\",\"1\",\"1\",\"1\"], [\"1\",\"1\",\"1\",\"1\",\"1\"], [\"1\",\"0\",\"0\",\"1\",\"0\"] ] \u8f93\u51fa: 6 \u5206\u6790 \uff1a\u8fd9\u4e2a\u662f\u67f1\u72b6\u56fe\u6700\u5927\u77e9\u5f62\u7684\u6269\u5c55, \u4e0a\u9762\u7684\u77e9\u9635\u5bf9\u5e94\uff1a [ [\"1\",\"0\",\"1\",\"0\",\"0\"], [\"2\",\"0\",\"2\",\"1\",\"1\"], [\"3\",\"1\",\"3\",\"2\",\"2\"], [\"4\",\"0\",\"0\",\"3\",\"0\"] ] \u8fd9\u4e2a\u77e9\u5f62\u6bcf\u4e00\u884c\u90fd\u662f\u4e00\u4e2a\u67f1\u72b6\u4f53\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : int maximalRectangle ( vector < vector < char >>& matrix ) { if ( matrix . empty ()) return 0 ; int n = matrix [ 0 ]. size (), rst = 0 ; vector < int > heights ( n , 0 ); for ( int i = 0 ; i < matrix . size (); ++ i ) { for ( int j = 0 ; j < n ; ++ j ) { if ( matrix [ i ][ j ] == '1' ) { heights [ j ] ++ ; } else { heights [ j ] = 0 ; } } rst = max ( rst , maxMatrix ( heights )); } return rst ; } private : int maxMatrix ( vector < int >& heights ) { if ( heights . empty ()) return 0 ; stack < int > s ; heights . push_back ( 0 ); int n = heights . size (), rst = 0 ; for ( int i = 0 ; i < n ; ++ i ) { int hi = heights [ i ]; while ( ! s . empty () && heights [ s . top ()] > hi ) { int j = s . top (); s . pop (); int distance = ( s . empty ()) ? i : i - s . top () - 1 ; rst = max ( rst , distance * heights [ j ]); } s . push ( i ); } return rst ; } }; \u79fb\u6389K\u4f4d\u6570\u5b57 \u00b6 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u4ee5\u5b57\u7b26\u4e32\u8868\u793a\u7684\u975e\u8d1f\u6574\u6570 num\uff0c\u79fb\u9664\u8fd9\u4e2a\u6570\u4e2d\u7684 k \u4f4d\u6570\u5b57\uff0c\u4f7f\u5f97\u5269\u4e0b\u7684\u6570\u5b57\u6700\u5c0f\u3002 num \u7684\u957f\u5ea6\u5c0f\u4e8e 10002 \u4e14 \u2265 k\u3002 num \u4e0d\u4f1a\u5305\u542b\u4efb\u4f55\u524d\u5bfc\u96f6\u3002 \u793a\u4f8b : \u8f93\u5165: num = \"1432219\", k = 3 \u8f93\u51fa: \"1219\" \u89e3\u91ca: \u79fb\u9664\u6389\u4e09\u4e2a\u6570\u5b57 4, 3, \u548c 2 \u5f62\u6210\u4e00\u4e2a\u65b0\u7684\u6700\u5c0f\u7684\u6570\u5b57 1219\u3002 \u8f93\u5165: num = \"10200\", k = 1 \u8f93\u51fa: \"200\" \u89e3\u91ca: \u79fb\u6389\u9996\u4f4d\u7684 1 \u5269\u4e0b\u7684\u6570\u5b57\u4e3a 200. \u6ce8\u610f\u8f93\u51fa\u4e0d\u80fd\u6709\u4efb\u4f55\u524d\u5bfc\u96f6\u3002 \u8f93\u5165: num = \"10\", k = 2 \u8f93\u51fa: \"0\" \u89e3\u91ca: \u4ece\u539f\u6570\u5b57\u79fb\u9664\u6240\u6709\u7684\u6570\u5b57\uff0c\u5269\u4f59\u4e3a\u7a7a\u5c31\u662f0\u3002 \u89e3\u6790 : \u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u6808\uff1a\u5982\u679c\u5f53\u524d\u5143\u7d20\u6bd4\u6808\u9876\u5143\u7d20\u5c0f\uff0c\u90a3\u5c31\u628a\u6808\u9876\u5143\u7d20\u5f39\u51fa\u3002\u88ab\u5f39\u51fa\u7684\u5143\u7d20\u5c31\u662f\u88ab\u5220\u9664\uff0c\u56e0\u4e3a\u5220\u9664\u6b21\u6570\u6709\u9650\uff0c\u6240\u4ee5\u907f\u514d\u5220\u9664\u8fc7\u591a\u7684\u5143\u7d20\u3002\u53e6\u5916\uff0c\u8981\u6ce8\u610f\u8fb9\u754c\u95ee\u9898\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : string removeKdigits ( string num , int k ) { stack < char > s ; int len = num . size () - k ; for ( auto & digit : num ) { while ( k > 0 && ! s . empty () && digit < s . top ()) { s . pop (); k -- ; } s . push ( digit ); } string rst ; while ( ! s . empty () > 0 ) { rst . push_back ( s . top ()); s . pop (); } rst = string ( rst . end () - len , rst . end ()); for ( int i = rst . size () - 1 ; i >= 0 ; -- i ) { if ( rst [ i ] == '0' ) rst . pop_back (); else break ; } reverse ( rst . begin (), rst . end ()); return rst . empty () ? \"0\" : rst ; } }; 123\u6a21\u5f0f \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u6574\u6570\u5e8f\u5217\uff1aa1, a2, ..., an\uff0c\u4e00\u4e2a132\u6a21\u5f0f\u7684\u5b50\u5e8f\u5217 ai, aj, ak \u88ab\u5b9a\u4e49\u4e3a\uff1a\u5f53 i < j < k \u65f6\uff0cai < ak < aj\u3002\u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\uff0c\u5f53\u7ed9\u5b9a\u6709 n \u4e2a\u6570\u5b57\u7684\u5e8f\u5217\u65f6\uff0c\u9a8c\u8bc1\u8fd9\u4e2a\u5e8f\u5217\u4e2d\u662f\u5426\u542b\u6709132\u6a21\u5f0f\u7684\u5b50\u5e8f\u5217\u3002 \u5206\u6790 : \u8fd9\u4e2a\u95ee\u9898\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\u89e3\u51b3\u7684\u3002 \u9996\u5148\uff0c\u6211\u4eec\u4ece\u5de6\u5230\u53f3\u904d\u5386\u4e00\u904d\u6570\u7ec4\uff0c\u627e\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u5de6\u4fa7\u5143\u7d20\u7684\u6700\u5c0f\u503c\uff0c\u6211\u4eec\u8bb0\u505a premin[i] = min_{j < i} a[j] premin[i] = min_{j < i} a[j] ; \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8981\u5728 a[i] a[i] \u7684\u53f3\u4fa7\uff0c\u627e\u5230\u4e00\u4e2a\u6574\u6570 j > i j > i \u6ee1\u8db3 premin[i] < a[j] < a[i] premin[i] < a[j] < a[i] \u3002 \u5728\u7b2c\u4e8c\u6b65\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230\u5355\u8c03\u9012\u51cf\u6808\u3002\u6211\u4eec\u4ece\u53f3\u5230\u5de6\u904d\u5386\u6570\u7ec4\uff0c\u5f53\u4fbf\u5229\u5230 a[i] a[i] \u65f6\uff0c\u6211\u4eec\u5148\u6839\u636e premin[i] premin[i] \u6765\u5f39\u51fa\u6808\u7684\u5143\u7d20\uff0c\u76f4\u5230\u6808\u9876\u5143\u7d20\u5927\u4e8e premin[i] premin[i] \u3002\u63a5\u7740\u6211\u4eec\u5224\u65ad a[i] a[i] \u662f\u5426\u5927\u4e8e\u6808\u9876\u5143\u7d20\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : bool find132pattern ( vector < int >& nums ) { int n = nums . size (); if ( n < 3 ) return false ; vector < int > premin ( n ); //\u524d\u7f00\u6700\u5c0f\u6570\u7ec4 int mi = nums [ 0 ]; for ( int i = 1 ; i < n - 1 ; ++ i ) { premin [ i ] = mi ; mi = min ( mi , nums [ i ]); } stack < int > s ; //\u5355\u8c03\u9012\u51cf\u6808 s . push ( nums [ n - 1 ]); for ( int i = n - 2 ; i > 0 ; -- i ) { int mi = premin [ i ]; while ( ! s . empty () && mi >= s . top ()) { s . pop (); } if ( ! s . empty () && s . top () < nums [ i ]) { return true ; } if ( s . empty () || nums [ i ] < s . top ()) { s . push ( nums [ i ]); } } return false ; } }; \u6c42\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u5143\u7d20 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u5faa\u73af\u6570\u7ec4\uff08\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\u662f\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u8f93\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u5143\u7d20\u3002\u6570\u5b57 x \u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u5143\u7d20\u662f\u6309\u6570\u7ec4\u904d\u5386\u987a\u5e8f\uff0c\u8fd9\u4e2a\u6570\u5b57\u4e4b\u540e\u7684\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u66f4\u5927\u7684\u6570\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u5e94\u8be5\u5faa\u73af\u5730\u641c\u7d22\u5b83\u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u6570\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u8f93\u51fa -1\u3002 \u5206\u6790 : \u8fd9\u662f\u4e00\u4e2a\u7528\u5355\u8c03\u6808\u7684\u7ecf\u5178\u95ee\u9898\uff0c\u5f88\u591a\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u6210\u8fd9\u4e2a\u95ee\u9898\u6765\u6c42\u89e3\u3002 \u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u5355\u8c03\u9012\u51cf\u6808\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898: \u5982\u679c\u5f53\u524d\u7684\u5143\u7d20\u5927\u4e8e\u6808\u9876\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u6808\u9876\u7684\u5143\u7d20\u5c31\u5df2\u7ecf\u627e\u5230\u4e86\u5b83\u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u5143\u7d20\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : vector < int > nextGreaterElements ( vector < int >& nums ) { if ( nums . empty ()) return {}; int n = nums . size (), index = 1 ; vector < int > rst ( n , - 1 ); stack < int > s ; //\u5355\u8c03\u9012\u589e\u6808 for ( int i = 0 ; i < 2 * n ; ++ i ) { int index = i % n ; while ( ! s . empty () && nums [ s . top ()] < nums [ index ]) { if ( rst [ s . top ()] == - 1 ) rst [ s . top ()] = nums [ index ]; s . pop (); } s . push ( index ); } return rst ; } }; \u53ef\u80fd\u7684\u4e8c\u5206\u6cd5 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 886 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u7ec4\u4eba\u7f16\u53f7\u4e3a 1, 2, ..., N , \u6211\u4eec\u60f3\u628a\u8fd9\u4e9b\u4eba\u5206\u6210\u4e24\u7ec4\uff0c\u8981\u6c42\u4e24\u4e2a\u4e92\u4e0d\u559c\u6b22\u7684\u4eba\u4e0d\u80fd\u5206\u5728\u4e00\u7ec4\u3002\u6211\u4eec\u7528\u6570\u7ec4 dislikes[i] = [a, b] \u6765\u8868\u793a a \u548c b \u4e4b\u95f4\u4e92\u4e0d\u559c\u6b22\u3002\u5224\u65ad\u80fd\u5426\u6210\u529f\u5206\u5272\u3002 \u793a\u4f8b : \u8f93\u5165\uff1aN = 4, dislikes = [[1,2],[1,3],[2,4]] \u8f93\u51fa\uff1atrue \u89e3\u91ca\uff1agroup1 [1,4], group2 [2,3] \u5206\u6790 : 1. \u53ef\u4ee5\u4f7f\u7528\u67d3\u8272\u6cd5\u8868\u793a\u4eba\u88ab\u5206\u5728\u54ea\u4e00\u7ec4; 2. \u4f7f\u7528\u6808\u6765\u5b8c\u6210dfs\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public: bool possibleBipartition(int N, vector<vector<int>>& dislikes) { vector<vector<int>> graph(N+1); vector<int> color(N+1, 0); // \u4f7f\u7528 +1/-1\u8868\u793a\u4e24\u7c7b for(auto edge: dislikes) { graph[edge[0]].push_back(edge[1]); graph[edge[1]].push_back(edge[0]); } for(int i = 1; i <= N; ++i) { if(color[i] != 0) continue; stack<int> s; //\u4f7f\u7528\u6808\u6765\u6a21\u62dfdfs s.push(i); color[i] = 1; // \u9ed8\u8ba4\u7c7b\u578b\u4e3a1 while(!s.empty()) { int node = s.top(); s.pop(); int c = color[node]; for(auto next: graph[node]) { if(color[next] * c > 0) { return false; } else if(color[next] == 0) { s.push(next); color[next] = -c; } } } } return true; } };","title":"\u5355\u8c03\u6808"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#_1","text":"\u5355\u8c03\u6808\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6808\uff0c\u53ef\u4ee5\u7528\u6765\u7ef4\u62a4\u67d0\u79cd\u903b\u8f91\u4fe1\u606f\uff0c\u5728\u5f88\u591a\u9898\u76ee\u4e2d\u975e\u5e38\u6709\u6548\u3002 \u8fd9\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u6240\u4ee5\u5b83\u901a\u5e38\u670d\u52a1\u4e8e\u9898\u76ee\u7684\u89e3\u6cd5\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u5148\u5206\u6790\u9898\u610f\uff0c\u8bbe\u8ba1\u51fa\u67d0\u79cd\u89e3\u6cd5\uff0c\u7136\u540e\u8981\u81ea\u884c\u5224\u65ad\u662f\u5426\u9700\u8981\u5355\u8c03\u6808\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u3002 \u4e0b\u9762\u51e0\u9053\u9898\u76ee\u5f88\u9002\u5408\u7528\u89c6\u9891\u6216\u8005\u52a8\u6001gif\u56fe\u6765\u8bb2\u89e3\uff0c\u6587\u5b57\u786e\u5b9e\u6709\u70b9\u5e72\u762a\u3002","title":"\u5355\u8c03\u6808"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#_2","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 42 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a n \u4e2a\u975e\u8d1f\u6574\u6570\u8868\u793a\u6bcf\u4e2a\u5bbd\u5ea6\u4e3a 1 \u7684\u67f1\u5b50\u7684\u9ad8\u5ea6\u56fe\uff0c\u8ba1\u7b97\u6309\u6b64\u6392\u5217\u7684\u67f1\u5b50\uff0c\u4e0b\u96e8\u4e4b\u540e\u80fd\u63a5\u591a\u5c11\u96e8\u6c34\u3002 \u793a\u4f8b : \u8f93\u5165: [0,1,0,2,1,0,1,3,2,1,2,1] \u8f93\u51fa: 6 \u9898\u89e3 \uff1a\u8fd9\u91cc\u9700\u8981\u4e00\u4e2a\u5355\u8c03\u51cf\u6808\uff0c\u9047\u5230\u6bd4\u6808\u9876\u9ad8\u7684\u67f1\u5b50\uff0c\u8bf4\u660e\u53ef\u4ee5\u524d\u9762\u6709\u67f1\u5b50\u53ef\u4ee5\u5b58\u96e8\u6c34, \u6211\u4eec\u5c31\u8981\u8fdb\u5165\u96e8\u6c34\u7684\u8ba1\u7b97\u3002 \u8ba1\u7b97\u96e8\u6c34\u7684\u6838\u5fc3\u662f\u628a\u96e8\u6c34\u5982\u56fe\u5206\u62104\u4e2a\u77e9\u5f62. \u53c2\u8003\u4ee3\u7801 class Solution { public : int trap ( vector < int >& height ) { if ( height . empty ()) return 0 ; int n = height . size (), cnt = 0 ; stack < int > s ; for ( int i = 0 ; i < n ; ++ i ) { int h = height [ i ]; while ( ! s . empty () && height [ s . top ()] < h ) { int j = s . top (); s . pop (); if ( ! s . empty ()) { int distance = i - s . top () - 1 ; int delta_h = min ( height [ s . top ()], h ) - height [ j ]; cnt += distance * delta_h ; } } s . push ( i ); } return cnt ; } };","title":"\u63a5\u96e8\u6c34"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#_3","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 84 \u9898\u76ee\u63cf\u8ff0 \uff1a\u7ed9\u5b9a n \u4e2a\u975e\u8d1f\u6574\u6570\uff0c\u7528\u6765\u8868\u793a\u67f1\u72b6\u56fe\u4e2d\u5404\u4e2a\u67f1\u5b50\u7684\u9ad8\u5ea6\u3002\u6bcf\u4e2a\u67f1\u5b50\u5f7c\u6b64\u76f8\u90bb\uff0c\u4e14\u5bbd\u5ea6\u4e3a 1\u3002\u6c42\u5728\u8be5\u67f1\u72b6\u56fe\u4e2d\uff0c\u80fd\u591f\u52fe\u52d2\u51fa\u6765\u7684\u77e9\u5f62\u7684\u6700\u5927\u9762\u79ef\u3002 \u793a\u4f8b \uff1a \u8f93\u5165: [2,1,5,6,2,3] \u8f93\u51fa: 10 \u9898\u89e3 \uff1a\u8fd9\u4e2a\u5355\u8c03\u9012\u589e\u6808\u4e5f\u4e0d\u96be\uff0c\u9047\u5230\u6bd4\u6808\u9876\u4f4e\u7684\u67f1\u5b50\uff0c\u5c31\u8981\u8fdb\u5165\u77e9\u5f62\u9762\u79ef\u7684\u8ba1\u7b97\u3002\u8fd9\u9053\u9898\u7684\u5173\u952e\u5728\u4e8e\u7406\u6e05\u695a\u5982\u4f55\u6c42\u77e9\u5f62\u9762\u79ef\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : int largestRectangleArea ( vector < int >& heights ) { if ( heights . empty ()) return false ; stack < int > s ; heights . push_back ( 0 ); int n = heights . size (), max_area = 0 ; for ( int current_i = 0 ; current_i < n ; ++ current_i ) { int current_h = heights [ current_i ]; while ( ! s . empty () && heights [ s . top ()] > current_h ) { int top_i = s . top (); s . pop (); int distance = ( s . empty ()) ? current_i : current_i - s . top () - 1 ; int area = heights [ top_i ] * distance ; max_area = max ( max_area , area ); } s . push ( current_i ); } return max_area ; } };","title":"\u67f1\u72b6\u56fe\u4e2d\u7684\u6700\u5927\u77e9\u5f62"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#_4","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 85 \u9898\u76ee\u63cf\u8ff0 \uff1a\u7ed9\u5b9a\u4e00\u4e2a\u4ec5\u5305\u542b 0 \u548c 1 \u7684\u4e8c\u7ef4\u4e8c\u8fdb\u5236\u77e9\u9635\uff0c\u627e\u51fa\u53ea\u5305\u542b 1 \u7684\u6700\u5927\u77e9\u5f62\uff0c\u5e76\u8fd4\u56de\u5176\u9762\u79ef\u3002 \u793a\u4f8b \uff1a \u8f93\u5165: [ [\"1\",\"0\",\"1\",\"0\",\"0\"], [\"1\",\"0\",\"1\",\"1\",\"1\"], [\"1\",\"1\",\"1\",\"1\",\"1\"], [\"1\",\"0\",\"0\",\"1\",\"0\"] ] \u8f93\u51fa: 6 \u5206\u6790 \uff1a\u8fd9\u4e2a\u662f\u67f1\u72b6\u56fe\u6700\u5927\u77e9\u5f62\u7684\u6269\u5c55, \u4e0a\u9762\u7684\u77e9\u9635\u5bf9\u5e94\uff1a [ [\"1\",\"0\",\"1\",\"0\",\"0\"], [\"2\",\"0\",\"2\",\"1\",\"1\"], [\"3\",\"1\",\"3\",\"2\",\"2\"], [\"4\",\"0\",\"0\",\"3\",\"0\"] ] \u8fd9\u4e2a\u77e9\u5f62\u6bcf\u4e00\u884c\u90fd\u662f\u4e00\u4e2a\u67f1\u72b6\u4f53\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : int maximalRectangle ( vector < vector < char >>& matrix ) { if ( matrix . empty ()) return 0 ; int n = matrix [ 0 ]. size (), rst = 0 ; vector < int > heights ( n , 0 ); for ( int i = 0 ; i < matrix . size (); ++ i ) { for ( int j = 0 ; j < n ; ++ j ) { if ( matrix [ i ][ j ] == '1' ) { heights [ j ] ++ ; } else { heights [ j ] = 0 ; } } rst = max ( rst , maxMatrix ( heights )); } return rst ; } private : int maxMatrix ( vector < int >& heights ) { if ( heights . empty ()) return 0 ; stack < int > s ; heights . push_back ( 0 ); int n = heights . size (), rst = 0 ; for ( int i = 0 ; i < n ; ++ i ) { int hi = heights [ i ]; while ( ! s . empty () && heights [ s . top ()] > hi ) { int j = s . top (); s . pop (); int distance = ( s . empty ()) ? i : i - s . top () - 1 ; rst = max ( rst , distance * heights [ j ]); } s . push ( i ); } return rst ; } };","title":"\u6700\u5927\u77e9\u5f62"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#k","text":"\u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u4ee5\u5b57\u7b26\u4e32\u8868\u793a\u7684\u975e\u8d1f\u6574\u6570 num\uff0c\u79fb\u9664\u8fd9\u4e2a\u6570\u4e2d\u7684 k \u4f4d\u6570\u5b57\uff0c\u4f7f\u5f97\u5269\u4e0b\u7684\u6570\u5b57\u6700\u5c0f\u3002 num \u7684\u957f\u5ea6\u5c0f\u4e8e 10002 \u4e14 \u2265 k\u3002 num \u4e0d\u4f1a\u5305\u542b\u4efb\u4f55\u524d\u5bfc\u96f6\u3002 \u793a\u4f8b : \u8f93\u5165: num = \"1432219\", k = 3 \u8f93\u51fa: \"1219\" \u89e3\u91ca: \u79fb\u9664\u6389\u4e09\u4e2a\u6570\u5b57 4, 3, \u548c 2 \u5f62\u6210\u4e00\u4e2a\u65b0\u7684\u6700\u5c0f\u7684\u6570\u5b57 1219\u3002 \u8f93\u5165: num = \"10200\", k = 1 \u8f93\u51fa: \"200\" \u89e3\u91ca: \u79fb\u6389\u9996\u4f4d\u7684 1 \u5269\u4e0b\u7684\u6570\u5b57\u4e3a 200. \u6ce8\u610f\u8f93\u51fa\u4e0d\u80fd\u6709\u4efb\u4f55\u524d\u5bfc\u96f6\u3002 \u8f93\u5165: num = \"10\", k = 2 \u8f93\u51fa: \"0\" \u89e3\u91ca: \u4ece\u539f\u6570\u5b57\u79fb\u9664\u6240\u6709\u7684\u6570\u5b57\uff0c\u5269\u4f59\u4e3a\u7a7a\u5c31\u662f0\u3002 \u89e3\u6790 : \u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u6808\uff1a\u5982\u679c\u5f53\u524d\u5143\u7d20\u6bd4\u6808\u9876\u5143\u7d20\u5c0f\uff0c\u90a3\u5c31\u628a\u6808\u9876\u5143\u7d20\u5f39\u51fa\u3002\u88ab\u5f39\u51fa\u7684\u5143\u7d20\u5c31\u662f\u88ab\u5220\u9664\uff0c\u56e0\u4e3a\u5220\u9664\u6b21\u6570\u6709\u9650\uff0c\u6240\u4ee5\u907f\u514d\u5220\u9664\u8fc7\u591a\u7684\u5143\u7d20\u3002\u53e6\u5916\uff0c\u8981\u6ce8\u610f\u8fb9\u754c\u95ee\u9898\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : string removeKdigits ( string num , int k ) { stack < char > s ; int len = num . size () - k ; for ( auto & digit : num ) { while ( k > 0 && ! s . empty () && digit < s . top ()) { s . pop (); k -- ; } s . push ( digit ); } string rst ; while ( ! s . empty () > 0 ) { rst . push_back ( s . top ()); s . pop (); } rst = string ( rst . end () - len , rst . end ()); for ( int i = rst . size () - 1 ; i >= 0 ; -- i ) { if ( rst [ i ] == '0' ) rst . pop_back (); else break ; } reverse ( rst . begin (), rst . end ()); return rst . empty () ? \"0\" : rst ; } };","title":"\u79fb\u6389K\u4f4d\u6570\u5b57"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#123","text":"\u8be6\u60c5\u53c2\u8003 LeetCode \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u6574\u6570\u5e8f\u5217\uff1aa1, a2, ..., an\uff0c\u4e00\u4e2a132\u6a21\u5f0f\u7684\u5b50\u5e8f\u5217 ai, aj, ak \u88ab\u5b9a\u4e49\u4e3a\uff1a\u5f53 i < j < k \u65f6\uff0cai < ak < aj\u3002\u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\uff0c\u5f53\u7ed9\u5b9a\u6709 n \u4e2a\u6570\u5b57\u7684\u5e8f\u5217\u65f6\uff0c\u9a8c\u8bc1\u8fd9\u4e2a\u5e8f\u5217\u4e2d\u662f\u5426\u542b\u6709132\u6a21\u5f0f\u7684\u5b50\u5e8f\u5217\u3002 \u5206\u6790 : \u8fd9\u4e2a\u95ee\u9898\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\u89e3\u51b3\u7684\u3002 \u9996\u5148\uff0c\u6211\u4eec\u4ece\u5de6\u5230\u53f3\u904d\u5386\u4e00\u904d\u6570\u7ec4\uff0c\u627e\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u5de6\u4fa7\u5143\u7d20\u7684\u6700\u5c0f\u503c\uff0c\u6211\u4eec\u8bb0\u505a premin[i] = min_{j < i} a[j] premin[i] = min_{j < i} a[j] ; \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8981\u5728 a[i] a[i] \u7684\u53f3\u4fa7\uff0c\u627e\u5230\u4e00\u4e2a\u6574\u6570 j > i j > i \u6ee1\u8db3 premin[i] < a[j] < a[i] premin[i] < a[j] < a[i] \u3002 \u5728\u7b2c\u4e8c\u6b65\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230\u5355\u8c03\u9012\u51cf\u6808\u3002\u6211\u4eec\u4ece\u53f3\u5230\u5de6\u904d\u5386\u6570\u7ec4\uff0c\u5f53\u4fbf\u5229\u5230 a[i] a[i] \u65f6\uff0c\u6211\u4eec\u5148\u6839\u636e premin[i] premin[i] \u6765\u5f39\u51fa\u6808\u7684\u5143\u7d20\uff0c\u76f4\u5230\u6808\u9876\u5143\u7d20\u5927\u4e8e premin[i] premin[i] \u3002\u63a5\u7740\u6211\u4eec\u5224\u65ad a[i] a[i] \u662f\u5426\u5927\u4e8e\u6808\u9876\u5143\u7d20\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : bool find132pattern ( vector < int >& nums ) { int n = nums . size (); if ( n < 3 ) return false ; vector < int > premin ( n ); //\u524d\u7f00\u6700\u5c0f\u6570\u7ec4 int mi = nums [ 0 ]; for ( int i = 1 ; i < n - 1 ; ++ i ) { premin [ i ] = mi ; mi = min ( mi , nums [ i ]); } stack < int > s ; //\u5355\u8c03\u9012\u51cf\u6808 s . push ( nums [ n - 1 ]); for ( int i = n - 2 ; i > 0 ; -- i ) { int mi = premin [ i ]; while ( ! s . empty () && mi >= s . top ()) { s . pop (); } if ( ! s . empty () && s . top () < nums [ i ]) { return true ; } if ( s . empty () || nums [ i ] < s . top ()) { s . push ( nums [ i ]); } } return false ; } };","title":"123\u6a21\u5f0f"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#_5","text":"\u8be6\u60c5\u53c2\u8003 LeetCode \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u5faa\u73af\u6570\u7ec4\uff08\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\u662f\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u8f93\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u5143\u7d20\u3002\u6570\u5b57 x \u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u5143\u7d20\u662f\u6309\u6570\u7ec4\u904d\u5386\u987a\u5e8f\uff0c\u8fd9\u4e2a\u6570\u5b57\u4e4b\u540e\u7684\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u66f4\u5927\u7684\u6570\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u5e94\u8be5\u5faa\u73af\u5730\u641c\u7d22\u5b83\u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u6570\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u8f93\u51fa -1\u3002 \u5206\u6790 : \u8fd9\u662f\u4e00\u4e2a\u7528\u5355\u8c03\u6808\u7684\u7ecf\u5178\u95ee\u9898\uff0c\u5f88\u591a\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u6210\u8fd9\u4e2a\u95ee\u9898\u6765\u6c42\u89e3\u3002 \u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u5355\u8c03\u9012\u51cf\u6808\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898: \u5982\u679c\u5f53\u524d\u7684\u5143\u7d20\u5927\u4e8e\u6808\u9876\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u6808\u9876\u7684\u5143\u7d20\u5c31\u5df2\u7ecf\u627e\u5230\u4e86\u5b83\u7684\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u5143\u7d20\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : vector < int > nextGreaterElements ( vector < int >& nums ) { if ( nums . empty ()) return {}; int n = nums . size (), index = 1 ; vector < int > rst ( n , - 1 ); stack < int > s ; //\u5355\u8c03\u9012\u589e\u6808 for ( int i = 0 ; i < 2 * n ; ++ i ) { int index = i % n ; while ( ! s . empty () && nums [ s . top ()] < nums [ index ]) { if ( rst [ s . top ()] == - 1 ) rst [ s . top ()] = nums [ index ]; s . pop (); } s . push ( index ); } return rst ; } };","title":"\u6c42\u4e0b\u4e00\u4e2a\u66f4\u5927\u7684\u5143\u7d20"},{"location":"Algorithms/09-%E5%8D%95%E8%B0%83%E6%A0%88/#_6","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 886 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u7ec4\u4eba\u7f16\u53f7\u4e3a 1, 2, ..., N , \u6211\u4eec\u60f3\u628a\u8fd9\u4e9b\u4eba\u5206\u6210\u4e24\u7ec4\uff0c\u8981\u6c42\u4e24\u4e2a\u4e92\u4e0d\u559c\u6b22\u7684\u4eba\u4e0d\u80fd\u5206\u5728\u4e00\u7ec4\u3002\u6211\u4eec\u7528\u6570\u7ec4 dislikes[i] = [a, b] \u6765\u8868\u793a a \u548c b \u4e4b\u95f4\u4e92\u4e0d\u559c\u6b22\u3002\u5224\u65ad\u80fd\u5426\u6210\u529f\u5206\u5272\u3002 \u793a\u4f8b : \u8f93\u5165\uff1aN = 4, dislikes = [[1,2],[1,3],[2,4]] \u8f93\u51fa\uff1atrue \u89e3\u91ca\uff1agroup1 [1,4], group2 [2,3] \u5206\u6790 : 1. \u53ef\u4ee5\u4f7f\u7528\u67d3\u8272\u6cd5\u8868\u793a\u4eba\u88ab\u5206\u5728\u54ea\u4e00\u7ec4; 2. \u4f7f\u7528\u6808\u6765\u5b8c\u6210dfs\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public: bool possibleBipartition(int N, vector<vector<int>>& dislikes) { vector<vector<int>> graph(N+1); vector<int> color(N+1, 0); // \u4f7f\u7528 +1/-1\u8868\u793a\u4e24\u7c7b for(auto edge: dislikes) { graph[edge[0]].push_back(edge[1]); graph[edge[1]].push_back(edge[0]); } for(int i = 1; i <= N; ++i) { if(color[i] != 0) continue; stack<int> s; //\u4f7f\u7528\u6808\u6765\u6a21\u62dfdfs s.push(i); color[i] = 1; // \u9ed8\u8ba4\u7c7b\u578b\u4e3a1 while(!s.empty()) { int node = s.top(); s.pop(); int c = color[node]; for(auto next: graph[node]) { if(color[next] * c > 0) { return false; } else if(color[next] == 0) { s.push(next); color[next] = -c; } } } } return true; } };","title":"\u53ef\u80fd\u7684\u4e8c\u5206\u6cd5"},{"location":"Algorithms/10-%E6%9C%80%E9%95%BF%E5%85%A8%E6%8E%92%E5%88%97/","text":"\u6700\u957f\u5168\u6392\u5217 \u00b6 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u8282\u70b9\u6570\u4e3a N \u5168\u8fde\u63a5\u56fe\uff0c\u6bcf\u6761\u8fb9\u4e0a\u5bf9\u5e94\u4e00\u4e2a\u5956\u52b1\u503c\u3002\u90a3\u4e48\uff0c\u5bf9\u4e8e\u8282\u70b9\u7684\u6bcf\u4e00\u4e2a\u5168\u6392\u5217\uff08\u5982\uff1a\u5f53 N=5 \u65f6\uff0c\u5b83\u7684\u4e00\u4e2a\u5168\u6392\u5217\u662f [1, 3, 2, 4, 5] )\uff0c\u90fd\u6709\u4e00\u4e2a\u603b\u5956\u52b1\u503c\u3002\u90a3\u4e48, \u6c42\u5b83\u7684\u5956\u52b1\u6700\u5927\u7684\u5168\u6392\u5217\u3002( 1 <= N <= 12 ) \u793a\u4f8b :\u5982\u4e0b\u56fe\u8868\u793a\u4e86\u4ecei\u884c\u5230j\u5217\u7684\u8def\u5f84\u82b1\u8d39\uff0c\u90a3\u4e48\u6700\u957f\u8def\u5f84\u4e3a 2->1->3->0->4 \u3002 0 1 2 3 4 0 | -1, 0, 1, 0, 3 1 | 0,-1, 0, 1, 0 2 | 0, 3,-1, 0, 1 3 | 2, 0, 0,-1, 1 4 | 1, 1, 0, 0,-1 \u5206\u6790 : \u4e0d\u8981\u60f3\u7740 O(N) O(N) \u7684\u7b97\u6cd5\u4e86\uff1b \u5168\u6392\u5217\u6709 N! N! \u79cd\uff0c\u6700\u597d\u7684\u7b97\u6cd5\u662f O(N^2 2^N + M) O(N^2 2^N + M) ; \u52a8\u6001\u89c4\u5212\u7684\u72b6\u6001\u5f88\u5947\u5999 dp[2^N][N] dp[2^N][N] \uff0c\u5176\u4e2d\u884c\u5750\u6807 s \u4e2d1\u6240\u5728\u7684\u4f4d\u7f6e\u8868\u793a\u5df2\u7ecf\u88ab\u9009\u62e9\u7684\u8282\u70b9\uff0c\u5217\u5750\u6807 i \u8868\u793a\u5df2\u7ecf\u88ab\u9009\u62e9\u7684\u8282\u70b9\u4e2d\uff0c\u7ec4\u6210\u7684\u6392\u5217\u662f\u4ee5 i \u7ed3\u5c3e\u7684; \u9a6c\u5c14\u79d1\u592b\u6027\uff1a\u63a5\u4e0b\u6765\u7684\u6392\u5217\u53ea\u548c\u5df2\u9009\u62e9\u7684\u8282\u70b9\u96c6\u5408\uff08\u5bf9\u5e94 s ) \u4ee5\u53ca\u6392\u5217\u7684\u672b\u5c3e\u6570 i \u6709\u5173\u3002 \u5c0f\u6280\u5de7\uff1a\u6700\u5916\u5c42\u5faa\u73af\u53ef\u4ee5\u662f for s = 1 to 2^N \uff0c\u56e0\u4e3a\u6bcf\u6b21\u65b0\u52a0\u4e00\u4e2a\u6570\uff0c\u4e00\u5b9a\u4f7f\u5f97 s s \u53d8\u5927\uff0c\u6240\u4ee5\u904d\u5386\u7684\u65f6\u5019\u4e0d\u4f1a\u51fa\u73b0\u9700\u8981\u7684\u8282\u70b9\u8fd8\u6ca1\u6709\u88ab\u4fbf\u5229\u3002 \u6700\u77ed\u8d85\u7ea7\u4e32 \u00b6 \u8be6\u60c5\u53c2\u8003 LeetCode 943 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4 A\uff0c\u627e\u5230\u4ee5 A \u4e2d\u6bcf\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u5b50\u5b57\u7b26\u4e32\u7684\u6700\u77ed\u5b57\u7b26\u4e32\u3002 \u6211\u4eec\u53ef\u4ee5\u5047\u8bbe A \u4e2d\u6ca1\u6709\u5b57\u7b26\u4e32\u662f A \u4e2d\u53e6\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002 \u793a\u4f8b : \u8f93\u5165\uff1a[\"alex\",\"loves\",\"leetcode\"] \u8f93\u51fa\uff1a\"alexlovesleetcode\" \u89e3\u91ca\uff1a\"alex\"\uff0c\"loves\"\uff0c\"leetcode\" \u7684\u6240\u6709\u6392\u5217\u90fd\u4f1a\u88ab\u63a5\u53d7\u3002 \u5206\u6790 : \u8fd9\u91cc\u6211\u4eec\u9996\u5148\u9700\u8981\u6784\u9020\u5956\u52b1\u56fe\uff0c\u7136\u540e\u6c42\u6700\u957f\u5168\u6392\u5217\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : string shortestSuperstring ( vector < string >& A ) { if ( A . empty ()) return \"\" ; int n = A . size (); if ( n == 1 ) return A [ 0 ]; vector < vector < int >> reward ( n , vector < int > ( n , - 1 )); // \u9996\u5148\u6784\u9020Reward Function. for ( int i = 0 ; i < n ; ++ i ) { for ( int j = i + 1 ; j < n ; ++ j ) { reward [ i ][ j ] = getReward ( A [ i ], A [ j ]); reward [ j ][ i ] = getReward ( A [ j ], A [ i ]); } } //\u4ece\u6570\u7ec4\u7684\u5168\u6392\u5e8f\uff08full permutation)\u91cc\u627ereward\u6700\u5927\u7684\u6392\u5e8f\u3002 int S = 1 << n ; vector < vector < int >> dp ( S , vector < int > ( n , 0 )); vector < vector < pair < int , int >>> prev ( S , vector < pair < int , int >> ( n )); for ( int s = 1 ; s < S ; ++ s ) { // \u8fd9\u91cc\u7684\u5173\u952e\u662f s|(1<<j) \u4e00\u5b9a\u5927\u4e8e s,\u6240\u4ee5s\u4e00\u5b9a\u88ab\u904d\u5386\u8fc7\uff0c\u6240\u4ee5dp[s]\u662f\u5bf9\u7684\u3002 for ( int i = 0 ; i < n ; ++ i ) { if ((( s >> i ) & 1 ) == 0 ) continue ; for ( int j = 0 ; j < n ; ++ j ) { if (( s >> j ) & 1 ) continue ; int sj = s | ( 1 << j ); if ( dp [ sj ][ j ] <= dp [ s ][ i ] + reward [ i ][ j ]) { dp [ sj ][ j ] = dp [ s ][ i ] + reward [ i ][ j ]; prev [ sj ][ j ] = make_pair ( s , i ); } } } } // \u6784\u5efa\u5b57\u7b26\u4e32 int end = 0 ; int s = S - 1 ; for ( int i = 0 ; i < n ; ++ i ) { if ( dp [ s ][ end ] < dp [ s ][ i ]) end = i ; } string rst = A [ end ]; for ( int i = 0 ; i < n - 1 ; ++ i ) { auto p = prev [ s ][ end ]; rst = A [ p . second ] + rst . substr ( reward [ p . second ][ end ]); s = p . first ; end = p . second ; } return rst ; } private : int getReward ( string & t , string & p ) { int idx_p = 0 ; // Knuth-Morris-Pratt \u7b97\u6cd5 vector < int > next = getNext ( p ); for ( int i = 0 , j = 0 ; i < t . size (); ++ i ) { while ( idx_p >= 0 && t [ i ] != p [ idx_p ]) { idx_p = next [ idx_p ]; } idx_p ++ ; } return idx_p ; } vector < int > getNext ( string & s ) { if ( s . empty ()) return {}; int n = s . size (); vector < int > next ( n , - 1 ); for ( int i = 1 ; i < n ; ++ i ) { int pre = next [ i - 1 ]; while ( pre >= 0 && s [ pre ] != s [ i ]) { pre = next [ pre ]; } next [ i ] = pre + 1 ; } return next ; } };","title":"\u6700\u957f\u5168\u6392\u5217"},{"location":"Algorithms/10-%E6%9C%80%E9%95%BF%E5%85%A8%E6%8E%92%E5%88%97/#_1","text":"\u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u8282\u70b9\u6570\u4e3a N \u5168\u8fde\u63a5\u56fe\uff0c\u6bcf\u6761\u8fb9\u4e0a\u5bf9\u5e94\u4e00\u4e2a\u5956\u52b1\u503c\u3002\u90a3\u4e48\uff0c\u5bf9\u4e8e\u8282\u70b9\u7684\u6bcf\u4e00\u4e2a\u5168\u6392\u5217\uff08\u5982\uff1a\u5f53 N=5 \u65f6\uff0c\u5b83\u7684\u4e00\u4e2a\u5168\u6392\u5217\u662f [1, 3, 2, 4, 5] )\uff0c\u90fd\u6709\u4e00\u4e2a\u603b\u5956\u52b1\u503c\u3002\u90a3\u4e48, \u6c42\u5b83\u7684\u5956\u52b1\u6700\u5927\u7684\u5168\u6392\u5217\u3002( 1 <= N <= 12 ) \u793a\u4f8b :\u5982\u4e0b\u56fe\u8868\u793a\u4e86\u4ecei\u884c\u5230j\u5217\u7684\u8def\u5f84\u82b1\u8d39\uff0c\u90a3\u4e48\u6700\u957f\u8def\u5f84\u4e3a 2->1->3->0->4 \u3002 0 1 2 3 4 0 | -1, 0, 1, 0, 3 1 | 0,-1, 0, 1, 0 2 | 0, 3,-1, 0, 1 3 | 2, 0, 0,-1, 1 4 | 1, 1, 0, 0,-1 \u5206\u6790 : \u4e0d\u8981\u60f3\u7740 O(N) O(N) \u7684\u7b97\u6cd5\u4e86\uff1b \u5168\u6392\u5217\u6709 N! N! \u79cd\uff0c\u6700\u597d\u7684\u7b97\u6cd5\u662f O(N^2 2^N + M) O(N^2 2^N + M) ; \u52a8\u6001\u89c4\u5212\u7684\u72b6\u6001\u5f88\u5947\u5999 dp[2^N][N] dp[2^N][N] \uff0c\u5176\u4e2d\u884c\u5750\u6807 s \u4e2d1\u6240\u5728\u7684\u4f4d\u7f6e\u8868\u793a\u5df2\u7ecf\u88ab\u9009\u62e9\u7684\u8282\u70b9\uff0c\u5217\u5750\u6807 i \u8868\u793a\u5df2\u7ecf\u88ab\u9009\u62e9\u7684\u8282\u70b9\u4e2d\uff0c\u7ec4\u6210\u7684\u6392\u5217\u662f\u4ee5 i \u7ed3\u5c3e\u7684; \u9a6c\u5c14\u79d1\u592b\u6027\uff1a\u63a5\u4e0b\u6765\u7684\u6392\u5217\u53ea\u548c\u5df2\u9009\u62e9\u7684\u8282\u70b9\u96c6\u5408\uff08\u5bf9\u5e94 s ) \u4ee5\u53ca\u6392\u5217\u7684\u672b\u5c3e\u6570 i \u6709\u5173\u3002 \u5c0f\u6280\u5de7\uff1a\u6700\u5916\u5c42\u5faa\u73af\u53ef\u4ee5\u662f for s = 1 to 2^N \uff0c\u56e0\u4e3a\u6bcf\u6b21\u65b0\u52a0\u4e00\u4e2a\u6570\uff0c\u4e00\u5b9a\u4f7f\u5f97 s s \u53d8\u5927\uff0c\u6240\u4ee5\u904d\u5386\u7684\u65f6\u5019\u4e0d\u4f1a\u51fa\u73b0\u9700\u8981\u7684\u8282\u70b9\u8fd8\u6ca1\u6709\u88ab\u4fbf\u5229\u3002","title":"\u6700\u957f\u5168\u6392\u5217"},{"location":"Algorithms/10-%E6%9C%80%E9%95%BF%E5%85%A8%E6%8E%92%E5%88%97/#_2","text":"\u8be6\u60c5\u53c2\u8003 LeetCode 943 \u9898\u76ee\u63cf\u8ff0 : \u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4 A\uff0c\u627e\u5230\u4ee5 A \u4e2d\u6bcf\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u5b50\u5b57\u7b26\u4e32\u7684\u6700\u77ed\u5b57\u7b26\u4e32\u3002 \u6211\u4eec\u53ef\u4ee5\u5047\u8bbe A \u4e2d\u6ca1\u6709\u5b57\u7b26\u4e32\u662f A \u4e2d\u53e6\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002 \u793a\u4f8b : \u8f93\u5165\uff1a[\"alex\",\"loves\",\"leetcode\"] \u8f93\u51fa\uff1a\"alexlovesleetcode\" \u89e3\u91ca\uff1a\"alex\"\uff0c\"loves\"\uff0c\"leetcode\" \u7684\u6240\u6709\u6392\u5217\u90fd\u4f1a\u88ab\u63a5\u53d7\u3002 \u5206\u6790 : \u8fd9\u91cc\u6211\u4eec\u9996\u5148\u9700\u8981\u6784\u9020\u5956\u52b1\u56fe\uff0c\u7136\u540e\u6c42\u6700\u957f\u5168\u6392\u5217\u3002 \u53c2\u8003\u4ee3\u7801 class Solution { public : string shortestSuperstring ( vector < string >& A ) { if ( A . empty ()) return \"\" ; int n = A . size (); if ( n == 1 ) return A [ 0 ]; vector < vector < int >> reward ( n , vector < int > ( n , - 1 )); // \u9996\u5148\u6784\u9020Reward Function. for ( int i = 0 ; i < n ; ++ i ) { for ( int j = i + 1 ; j < n ; ++ j ) { reward [ i ][ j ] = getReward ( A [ i ], A [ j ]); reward [ j ][ i ] = getReward ( A [ j ], A [ i ]); } } //\u4ece\u6570\u7ec4\u7684\u5168\u6392\u5e8f\uff08full permutation)\u91cc\u627ereward\u6700\u5927\u7684\u6392\u5e8f\u3002 int S = 1 << n ; vector < vector < int >> dp ( S , vector < int > ( n , 0 )); vector < vector < pair < int , int >>> prev ( S , vector < pair < int , int >> ( n )); for ( int s = 1 ; s < S ; ++ s ) { // \u8fd9\u91cc\u7684\u5173\u952e\u662f s|(1<<j) \u4e00\u5b9a\u5927\u4e8e s,\u6240\u4ee5s\u4e00\u5b9a\u88ab\u904d\u5386\u8fc7\uff0c\u6240\u4ee5dp[s]\u662f\u5bf9\u7684\u3002 for ( int i = 0 ; i < n ; ++ i ) { if ((( s >> i ) & 1 ) == 0 ) continue ; for ( int j = 0 ; j < n ; ++ j ) { if (( s >> j ) & 1 ) continue ; int sj = s | ( 1 << j ); if ( dp [ sj ][ j ] <= dp [ s ][ i ] + reward [ i ][ j ]) { dp [ sj ][ j ] = dp [ s ][ i ] + reward [ i ][ j ]; prev [ sj ][ j ] = make_pair ( s , i ); } } } } // \u6784\u5efa\u5b57\u7b26\u4e32 int end = 0 ; int s = S - 1 ; for ( int i = 0 ; i < n ; ++ i ) { if ( dp [ s ][ end ] < dp [ s ][ i ]) end = i ; } string rst = A [ end ]; for ( int i = 0 ; i < n - 1 ; ++ i ) { auto p = prev [ s ][ end ]; rst = A [ p . second ] + rst . substr ( reward [ p . second ][ end ]); s = p . first ; end = p . second ; } return rst ; } private : int getReward ( string & t , string & p ) { int idx_p = 0 ; // Knuth-Morris-Pratt \u7b97\u6cd5 vector < int > next = getNext ( p ); for ( int i = 0 , j = 0 ; i < t . size (); ++ i ) { while ( idx_p >= 0 && t [ i ] != p [ idx_p ]) { idx_p = next [ idx_p ]; } idx_p ++ ; } return idx_p ; } vector < int > getNext ( string & s ) { if ( s . empty ()) return {}; int n = s . size (); vector < int > next ( n , - 1 ); for ( int i = 1 ; i < n ; ++ i ) { int pre = next [ i - 1 ]; while ( pre >= 0 && s [ pre ] != s [ i ]) { pre = next [ pre ]; } next [ i ] = pre + 1 ; } return next ; } };","title":"\u6700\u77ed\u8d85\u7ea7\u4e32"},{"location":"ML/01-EM/","text":"EM \u7b97\u6cd5 \u00b6 \u901a\u5e38\u4ecb\u7ecdEM\u7b97\u6cd5\u90fd\u4f1a\u5148\u4ecb\u7ecd\u4e00\u4e2a\u7279\u6b8a\u7684\u95ee\u9898\uff1a\u5982\u4f55\u5c06\u4e00\u5806\u6837\u672c\u62df\u5408\u6210\u67d0\u4e2a\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09\u3002\u56e0\u4e3a\u76f4\u63a5\u8bb2EM\u7b97\u6cd5\u6240\u89e3\u51b3\u7684\u62bd\u8c61\u95ee\u9898\uff0c\u521d\u5b66\u8005\u4f1a\u975e\u5e38\u5947\u602a\uff0c\u73b0\u5b9e\u4e2d\u600e\u4e48\u4f1a\u6709\u8fd9\u79cd\u5f62\u5f0f\u7684\u95ee\u9898\u3002\u4f46\u662f\u6211\u89c9\u5f97\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u5f88\u4f18\u96c5\uff0c\u6240\u4ee5\u6211\u5c31\u5e72\u8106\u5148\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u3002 \u76ee\u6807\u95ee\u9898 \u00b6 \u9996\u5148\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \u3002 \u73b0\u5728\u7ed9\u6211\u4eec\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u4e2d\u72ec\u7acb\u91c7\u96c6\u4e00\u5806\u6837\u672c \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \uff0c \u6211\u4eec\u5e0c\u671b\u786e\u5b9a\u54ea\u4e2a \\mathcal{P}_{\\theta}(x) \\mathcal{P}_{\\theta}(x) \u66f4\u63a5\u8fd1\u8fd9\u7ec4\u6570\u636e\u7684\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u635f\u5931\u51fd\u6570\u6765\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u7684\u63a5\u8fd1\u7a0b\u5ea6\u3002\u8fd9\u91cc\u6211\u4eec\u7528\u7684\u662fKL\u8ddd\u79bb\uff0c\u6765\u6784\u9020\u771f\u5b9e\u8bef\u5dee\u51fd\u6570\uff1a \\tag{0} \\label{trueloss} L_{\\mathcal{D}}(p_{\\theta}) = \\mathbb{E}_{p_\\mathcal{D}(\\mathbf{x})}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\mathbf{x})}{p_{\\theta}(\\mathbf{x})} \\right)\\right]. \\tag{0} \\label{trueloss} L_{\\mathcal{D}}(p_{\\theta}) = \\mathbb{E}_{p_\\mathcal{D}(\\mathbf{x})}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\mathbf{x})}{p_{\\theta}(\\mathbf{x})} \\right)\\right]. \u90a3\u4e48\uff0c\u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a\uff1a L_{\\mathcal{S}}(\\theta) =-\\frac{1}{m}\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} L_{\\mathcal{S}}(\\theta) =-\\frac{1}{m}\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} \u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff08\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff09\uff0c \\mathcal{P}_\\theta(x) \\mathcal{P}_\\theta(x) \u8fd8\u548c\u53e6\u4e00\u4e2a \u9690\u968f\u673a\u53d8\u91cf \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \u6709\u5173\uff1a \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \u5f53\u6211\u4eec\u88ab\u9650\u5236\u53ea\u80fd\u83b7\u5f97 \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u548c \\mathcal{P}_\\theta(x \\vert z_j) \\mathcal{P}_\\theta(x \\vert z_j) \u65f6\uff0c \u76ee\u6807\u51fd\u6570\u7684\u4f18\u5316\u5c31\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u4e86: L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} \u8fd9\u91cc \u6982\u7387 \u8fd8\u662f \u6982\u7387\u5bc6\u5ea6 \u5728\u5f88\u591a\u8d44\u6599\u91cc\u975e\u5e38\u5bb9\u6613\u641e\u6df7\u3002 EM\u7b97\u6cd5 \u00b6 \u6211\u4eec\u5148\u4ecb\u7ecd\u53e6\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff0c\u4e4d\u4e00\u770b\u548c\u524d\u9762\u95ee\u9898\u6beb\u65e0\u5173\u7cfb\uff0c \u5176\u5b9e\u6709\u975e\u5e38\u5de7\u5999\u7684\u8054\u7cfb: G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} EM\u7b97\u6cd5\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \u8981\u4e86\u89e3 G_{\\mathcal{S}}(Q, \\theta) G_{\\mathcal{S}}(Q, \\theta) \u4e0e L_{\\mathcal{S}}(\\theta) L_{\\mathcal{S}}(\\theta) \u6211\u4eec\u9700\u8981\u7814\u7a76\u4f18\u5316\u8fc7\u7a0b\u4e2d\u7684\u7b2c\u4e00\u6b65\u3002 \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \u5f53 Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) \u65f6\uff0c \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \u7efc\u4e0a\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u7b2c\u4e00\u6b65\u4f18\u5316\u5b58\u5728\u95ed\u89e3\uff1a Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) , \u5e76\u4e14 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) . \u8fd9\u4e00\u6b65\u662f\u6c42\u671f\u671b\uff0c\u6240\u4ee5\u88ab\u79f0\u4e3a Expectation Step \u3002 \u8fd9\u4e00\u6b65\u540c\u65f6\u9700\u8981\u7528\u5230\u8d1d\u53f6\u65af\u516c\u5f0f Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. \u53c8\u56e0\u4e3a\u7b2c\u4e8c\u6b65\uff08 Maximization Step \uff09\u6700\u5c0f\u5316 \\theta \\theta \u65f6\u4fdd\u8bc1 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) , \u6240\u4ee5\u6211\u4eec\u53ef\u5f97 L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}). L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}). \u9ad8\u65af\u6df7\u5408\u6a21\u578b \u00b6 k\u4e2a\u9ad8\u65af\u5206\u5e03\u7684\u6df7\u5408\u6a21\u578b\u5bf9\u5e94\u7684hypothesis\u96c6\u5982\u4e0b\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \u53ef\u4ee5\u7b80\u5316 \\mathcal{P}_{\\theta}(z_j) = \\pi_j \\mathcal{P}_{\\theta}(z_j) = \\pi_j , \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) , \u90a3\u4e48hypothesis\u96c6\u5c31\u53d8\u6210\u6211\u4eec\u6bd4\u8f83\u5e38\u89c1\u7684\u5f62\u5f0f\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \u4ece\u8fd9\u4e2a\u7279\u4f8b\u6211\u4eec\u53ef\u4ee5\u611f\u53d7\u5230\uff1a \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u5f88\u5bb9\u6613\u83b7\u5f97; \u8fd9\u91cc\u7684 x x \u662f\u8fde\u7eed\u51fd\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u5f88\u5bb9\u6613\u83b7\u5f97\u6761\u4ef6\u6982\u7387\u5bc6\u5ea6\u51fd\u6570 p_{\\theta}(x \\vert z) p_{\\theta}(x \\vert z) \uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6781\u5c0f\u503c\u91cf \\Delta x \\Delta x \uff0c\u90a3\u4e48 \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x . \u9996\u5148\u662f Expectation Step : Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. \u90a3\u4e48\uff0c Maximumization Step \u9700\u8981\u6c42\u89e3\u7684\u95ee\u9898\u662f\uff1a \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \u9996\u5148\u663e\u7136 \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} , \u5176\u6b21 \u56e0\u4e3a \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \u6240\u4ee5\u4e5f\u663e\u7136\u53ef\u5f97 \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \u3002 \u6709\u70b9\u590d\u6742\u7684\u662f\u6c42\u89e3 \\Sigma_j \\Sigma_j : \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \u6211\u4eec\u9700\u8981\u7528\u5230\u4e24\u4e2a\u77e9\u9635\u5bfc\u6570 \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \u548c \\frac{\\partial}{\\partial A}Tr(A^T B) = B \\frac{\\partial}{\\partial A}Tr(A^T B) = B \uff0c\u5148\u5bf9 \\Sigma^{-1} \\Sigma^{-1} \u6c42\u5bfc\u53ef\u5f97\uff1a \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T . \u975e\u5e38\u6709\u610f\u601d\u7684\u662f\uff0cK-means\u7b97\u6cd5\u53ef\u4ee5\u770b\u6210GMM\u7b97\u6cd5\u9650\u5236\u5728 \\Sigma \\rightarrow 0 \\Sigma \\rightarrow 0 \u7684\u7b97\u6cd5\u3002","title":"EM"},{"location":"ML/01-EM/#em","text":"\u901a\u5e38\u4ecb\u7ecdEM\u7b97\u6cd5\u90fd\u4f1a\u5148\u4ecb\u7ecd\u4e00\u4e2a\u7279\u6b8a\u7684\u95ee\u9898\uff1a\u5982\u4f55\u5c06\u4e00\u5806\u6837\u672c\u62df\u5408\u6210\u67d0\u4e2a\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09\u3002\u56e0\u4e3a\u76f4\u63a5\u8bb2EM\u7b97\u6cd5\u6240\u89e3\u51b3\u7684\u62bd\u8c61\u95ee\u9898\uff0c\u521d\u5b66\u8005\u4f1a\u975e\u5e38\u5947\u602a\uff0c\u73b0\u5b9e\u4e2d\u600e\u4e48\u4f1a\u6709\u8fd9\u79cd\u5f62\u5f0f\u7684\u95ee\u9898\u3002\u4f46\u662f\u6211\u89c9\u5f97\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u5f88\u4f18\u96c5\uff0c\u6240\u4ee5\u6211\u5c31\u5e72\u8106\u5148\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u3002","title":"EM \u7b97\u6cd5"},{"location":"ML/01-EM/#_1","text":"\u9996\u5148\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \u3002 \u73b0\u5728\u7ed9\u6211\u4eec\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u4e2d\u72ec\u7acb\u91c7\u96c6\u4e00\u5806\u6837\u672c \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \uff0c \u6211\u4eec\u5e0c\u671b\u786e\u5b9a\u54ea\u4e2a \\mathcal{P}_{\\theta}(x) \\mathcal{P}_{\\theta}(x) \u66f4\u63a5\u8fd1\u8fd9\u7ec4\u6570\u636e\u7684\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u635f\u5931\u51fd\u6570\u6765\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u7684\u63a5\u8fd1\u7a0b\u5ea6\u3002\u8fd9\u91cc\u6211\u4eec\u7528\u7684\u662fKL\u8ddd\u79bb\uff0c\u6765\u6784\u9020\u771f\u5b9e\u8bef\u5dee\u51fd\u6570\uff1a \\tag{0} \\label{trueloss} L_{\\mathcal{D}}(p_{\\theta}) = \\mathbb{E}_{p_\\mathcal{D}(\\mathbf{x})}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\mathbf{x})}{p_{\\theta}(\\mathbf{x})} \\right)\\right]. \\tag{0} \\label{trueloss} L_{\\mathcal{D}}(p_{\\theta}) = \\mathbb{E}_{p_\\mathcal{D}(\\mathbf{x})}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\mathbf{x})}{p_{\\theta}(\\mathbf{x})} \\right)\\right]. \u90a3\u4e48\uff0c\u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a\uff1a L_{\\mathcal{S}}(\\theta) =-\\frac{1}{m}\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} L_{\\mathcal{S}}(\\theta) =-\\frac{1}{m}\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} \u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff08\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff09\uff0c \\mathcal{P}_\\theta(x) \\mathcal{P}_\\theta(x) \u8fd8\u548c\u53e6\u4e00\u4e2a \u9690\u968f\u673a\u53d8\u91cf \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \u6709\u5173\uff1a \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \u5f53\u6211\u4eec\u88ab\u9650\u5236\u53ea\u80fd\u83b7\u5f97 \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u548c \\mathcal{P}_\\theta(x \\vert z_j) \\mathcal{P}_\\theta(x \\vert z_j) \u65f6\uff0c \u76ee\u6807\u51fd\u6570\u7684\u4f18\u5316\u5c31\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u4e86: L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} \u8fd9\u91cc \u6982\u7387 \u8fd8\u662f \u6982\u7387\u5bc6\u5ea6 \u5728\u5f88\u591a\u8d44\u6599\u91cc\u975e\u5e38\u5bb9\u6613\u641e\u6df7\u3002","title":"\u76ee\u6807\u95ee\u9898"},{"location":"ML/01-EM/#em_1","text":"\u6211\u4eec\u5148\u4ecb\u7ecd\u53e6\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff0c\u4e4d\u4e00\u770b\u548c\u524d\u9762\u95ee\u9898\u6beb\u65e0\u5173\u7cfb\uff0c \u5176\u5b9e\u6709\u975e\u5e38\u5de7\u5999\u7684\u8054\u7cfb: G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} EM\u7b97\u6cd5\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \u8981\u4e86\u89e3 G_{\\mathcal{S}}(Q, \\theta) G_{\\mathcal{S}}(Q, \\theta) \u4e0e L_{\\mathcal{S}}(\\theta) L_{\\mathcal{S}}(\\theta) \u6211\u4eec\u9700\u8981\u7814\u7a76\u4f18\u5316\u8fc7\u7a0b\u4e2d\u7684\u7b2c\u4e00\u6b65\u3002 \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \u5f53 Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) \u65f6\uff0c \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \u7efc\u4e0a\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u7b2c\u4e00\u6b65\u4f18\u5316\u5b58\u5728\u95ed\u89e3\uff1a Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) , \u5e76\u4e14 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) . \u8fd9\u4e00\u6b65\u662f\u6c42\u671f\u671b\uff0c\u6240\u4ee5\u88ab\u79f0\u4e3a Expectation Step \u3002 \u8fd9\u4e00\u6b65\u540c\u65f6\u9700\u8981\u7528\u5230\u8d1d\u53f6\u65af\u516c\u5f0f Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. \u53c8\u56e0\u4e3a\u7b2c\u4e8c\u6b65\uff08 Maximization Step \uff09\u6700\u5c0f\u5316 \\theta \\theta \u65f6\u4fdd\u8bc1 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) , \u6240\u4ee5\u6211\u4eec\u53ef\u5f97 L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}). L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}).","title":"EM\u7b97\u6cd5"},{"location":"ML/01-EM/#_2","text":"k\u4e2a\u9ad8\u65af\u5206\u5e03\u7684\u6df7\u5408\u6a21\u578b\u5bf9\u5e94\u7684hypothesis\u96c6\u5982\u4e0b\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \u53ef\u4ee5\u7b80\u5316 \\mathcal{P}_{\\theta}(z_j) = \\pi_j \\mathcal{P}_{\\theta}(z_j) = \\pi_j , \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) , \u90a3\u4e48hypothesis\u96c6\u5c31\u53d8\u6210\u6211\u4eec\u6bd4\u8f83\u5e38\u89c1\u7684\u5f62\u5f0f\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \u4ece\u8fd9\u4e2a\u7279\u4f8b\u6211\u4eec\u53ef\u4ee5\u611f\u53d7\u5230\uff1a \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u5f88\u5bb9\u6613\u83b7\u5f97; \u8fd9\u91cc\u7684 x x \u662f\u8fde\u7eed\u51fd\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u5f88\u5bb9\u6613\u83b7\u5f97\u6761\u4ef6\u6982\u7387\u5bc6\u5ea6\u51fd\u6570 p_{\\theta}(x \\vert z) p_{\\theta}(x \\vert z) \uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6781\u5c0f\u503c\u91cf \\Delta x \\Delta x \uff0c\u90a3\u4e48 \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x . \u9996\u5148\u662f Expectation Step : Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. \u90a3\u4e48\uff0c Maximumization Step \u9700\u8981\u6c42\u89e3\u7684\u95ee\u9898\u662f\uff1a \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \u9996\u5148\u663e\u7136 \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} , \u5176\u6b21 \u56e0\u4e3a \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \u6240\u4ee5\u4e5f\u663e\u7136\u53ef\u5f97 \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \u3002 \u6709\u70b9\u590d\u6742\u7684\u662f\u6c42\u89e3 \\Sigma_j \\Sigma_j : \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \u6211\u4eec\u9700\u8981\u7528\u5230\u4e24\u4e2a\u77e9\u9635\u5bfc\u6570 \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \u548c \\frac{\\partial}{\\partial A}Tr(A^T B) = B \\frac{\\partial}{\\partial A}Tr(A^T B) = B \uff0c\u5148\u5bf9 \\Sigma^{-1} \\Sigma^{-1} \u6c42\u5bfc\u53ef\u5f97\uff1a \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T . \u975e\u5e38\u6709\u610f\u601d\u7684\u662f\uff0cK-means\u7b97\u6cd5\u53ef\u4ee5\u770b\u6210GMM\u7b97\u6cd5\u9650\u5236\u5728 \\Sigma \\rightarrow 0 \\Sigma \\rightarrow 0 \u7684\u7b97\u6cd5\u3002","title":"\u9ad8\u65af\u6df7\u5408\u6a21\u578b"},{"location":"ML/02-SVM/","text":"SVM\u7b97\u6cd5 \u00b6 SVM\u7b97\u6cd5\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u56e0\u4e3a\u5f88\u591a\u6269\u5c55\u800c\u53d8\u5f97\u590d\u6742\u8d77\u6765\u3002 \u5b66\u8fc7\u4f18\u5316\u7684\u8bdd\u5c31\u5f88\u597d\u7406\u89e3\u4e86\uff1a SVM\u7b97\u6cd5\u672c\u8d28\u662f\u5c06\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\u5efa\u6a21\u6210\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u5b83\u521a\u597d\u53c8\u95ed\u89e3\uff0c\u95ed\u89e3\u7684\u63a8\u5bfc\u5e94\u8be5\u662f\u5c5e\u4e8e\u4f18\u5316\u7684\u9886\u57df\u3002 \u76ee\u6807\u95ee\u9898 \u00b6 \u5728\u4e00\u5207\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u8981\u5148\u786e\u5b9a\u4e00\u4e2ahypothesis\u96c6 \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \u3002 \u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \uff0c\u5176\u4e2d \\mathbf{x} \\in \\mathbb{R}^{d} \\mathbf{x} \\in \\mathbb{R}^{d} \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \u3002\u6211\u4eec\u5e0c\u671b\u5728 \\mathcal{H} \\mathcal{H} \u4e2d\u627e\u5230\u4e00\u4e2a\u5206\u7c7b\u51fd\u6570 h_\\theta(\\mathbf{x}) h_\\theta(\\mathbf{x}) \u80fd\u628a\u6837\u672c \\mathcal{S} \\mathcal{S} \u5206\u5f97\u6700\u5f00\u3002 \u4ec0\u4e48\u53eb\u505a\u5206\u5f97\u6700\u5f00\u5462\uff1f\u6211\u4eec\u8fd9\u91cc\u7528\u6837\u672c\u4e0e\u5206\u7c7b\u9762\u7684\u8ddd\u79bb\u6765\u8bc4\u4ef7\u5206\u5f00\u7684\u7a0b\u5ea6\u3002 \u6211\u4eec\u6784\u5efa\u7684hypothesis\u96c6\u662f\u7ebf\u6027\u51fd\u6570\u7684\u96c6\u5408\uff1a \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \u90a3\u4e48\uff0c\u6837\u672c\u70b9 (\\mathbf{x}, y) (\\mathbf{x}, y) \u4e0e\u8d85\u5e73\u9762\u7684\u6b27\u5f0f\u8ddd\u79bb\u6709\u95ed\u89e3\uff1a d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} \u90a3\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u635f\u5931\u51fd\u6570\u662f\uff1a L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} \u5f53\u6709\u5206\u7c7b\u9519\u7684\u70b9\uff0c\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u4e3a\u6b63\uff0c\u9519\u8bef\u70b9\u8ddd\u79bb\u8d85\u5e73\u9762\u8fdc\uff0c\u9519\u5f97\u8d8a\u79bb\u8c31\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5927\u3002\u5f53\u5206\u7c7b\u5168\u90e8\u6b63\u786e\u65f6\uff0c\u8d85\u5e73\u9762\u5c06\u70b9\u5206\u5f97\u8d8a\u5f00\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5c0f\u3002 \u8fd9\u91cc\u6211\u4eec\u7528\u8ddd\u79bb\u7684\u4e0b\u754c\u6765\u5f53\u4f5c\u635f\u5931\u51fd\u6570\uff0c\u76f8\u5f53\u4e8e\u5168\u6c11\u5954\u5c0f\u5eb7\u3002\u5982\u679c\u7528\u5e73\u5747\u8ddd\u79bb\uff0c\u4f1a\u5bfc\u81f4\u5206\u7c7b\u9519\u8bef\u7387\u9ad8\uff0c\u4f46\u662f\u5e73\u5747\u8ddd\u79bb\u5c0f\u7684\u5206\u7c7b\u5668\u88ab\u9009\u62e9\uff0c\u76f8\u5f53\u4e8e\u52a3\u5e01\u9a71\u9010\u826f\u5e01\u3002\u6211\u4eec\u5b66\u4e60\u5206\u7c7b\u5668\u7684\u672c\u8d28\u8fd8\u662f\u7528\u6765\u5206\u7c7b\u7684\uff0c\u4e0d\u80fd\u5fd8\u4e86\u521d\u5fc3\u3002 Hard SVM\u7b97\u6cd5 \u00b6 \u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u4e0a\u9762\u7684\u635f\u5931\u51fd\u6570\u4e0d\u5bb9\u8bb8\u4efb\u4f55\u4e00\u4e2a\u70b9\u5206\u7c7b\u9519\u8bef\uff0c\u6240\u4ee5\u5bf9\u5e94\u7684\u7b97\u6cd5\u53eb\u505a Hard SVM\u7b97\u6cd5\u3002 \u9996\u5148\u6211\u4eec\u5199\u51fa\u6211\u4eec\u4f18\u5316\u76ee\u6807\uff1a \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u6709\u65e0\u9650\u591a\u7ec4\uff1a\u5982\u679c (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) \u662f\u89e3\uff0c\u90a3\u4e48\u5bf9\u4efb\u610f k > 0 k > 0 , (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) \u90fd\u662f\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u3002 \u6211\u4eec\u53ea\u60f3\u6c42\u5230\u4e00\u4e2a\u89e3\u5c31\u597d\u4e86:\u5982\u679c\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u6bcd\u4e0a \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 , \u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86: \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \u8fd9\u4e2a\u95ee\u9898\u7b49\u4ef7\u7684\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u5f88\u96be\u89e3\uff1a \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u7b49\u4ef7\u7684\u539f\u56e0\u662f\uff1a\u5982\u679c \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \uff0c\u90a3\u4e48\u5185\u5c42\u7684\u4f18\u5316 \\min_{\\alpha \\ne 0} \\min_{\\alpha \\ne 0} \u5c31\u4f1a\u7b49\u4e8e\u65e0\u7a77\u5c0f\uff0c\u5373 \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \u662f\u65e0\u7a77\u5c0f\uff0c\u80af\u5b9a\u5c0f\u4e8e \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \u7684\u503c\u3002 \u8fd9\u91cc\u5c31\u8981\u7528\u5230\u8fd9\u4e00\u5c0f\u8282\u5f00\u5934\u7684\u5047\u8bbe\uff0c\u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u5b50\u4e0a\uff0c\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86\uff1a \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \u8fd9\u91cc\u7684\u53d8\u5f62\u5c31\u5dee\u6700\u540e\u4e00\u6b65\u4e86\uff0c\u6211\u4eec\u60f3\u53bb\u6389 \\min_{i\\in[1,m]} \\min_{i\\in[1,m]} \u64cd\u4f5c\uff0c\u5373\u628a\u4f18\u5316\u76ee\u6807\u8fd8\u53ef\u4ee5\u7b80\u5316\u6210\uff1a \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \u8fd9\u4e00\u6b65\u7684\u7b49\u4ef7\u539f\u56e0\u662f\uff1a \u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u7684\u6700\u4f18\u89e3 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u5bfc\u81f4 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 , \u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u89e3 (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) \u6bd4 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u66f4\u4f18\u3002 \u5bf9\u5e94\u7684\u65e0\u7ea6\u675f\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u662f \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \u73b0\u5728\u6765\u6c42\u89e3\u4e00\u4e0b\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\u3002 \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \u5176\u4e2d \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \uff0c \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \u56e0\u6b64\u53ef\u5f97\uff1a \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \u5176\u4e2d \\mathbf{b}^*_\\theta \\mathbf{b}^*_\\theta \u6d89\u53ca\u5230support\u96c6 \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \uff0c \u4e0d\u5728\u8fd9\u4e2a\u96c6\u5408\u4e0a\u7684\u70b9 (\\mathbf{x}_i, y_i) (\\mathbf{x}_i, y_i) \u6ee1\u8db3 \\alpha_i = 0 \\alpha_i = 0 \uff0c\u4e5f\u5c31\u662f\u8bf4 (\\mathbf{w}^*_\\theta, b^*) (\\mathbf{w}^*_\\theta, b^*) \u53ea\u662fsupport\u96c6\u5143\u7d20\u7684\u653e\u5c04\u7ec4\u5408\uff0c\u4e0e\u4e0d\u5728supoort\u96c6\u4e0a\u7684\u6837\u672c\u65e0\u5173\u3002 Soft SVM\u7b97\u6cd5 \u00b6 \u5728\u4e0a\u4e00\u5c0f\u8282\uff0c\u7b97\u6cd5\u7684\u8981\u6c42\u592a\u5f3a\u4e86\uff0c\u6837\u672c\u6570\u636e\u9700\u8981\u4e25\u683c\u7ebf\u6027\u53ef\u5206\u3002 \u6211\u4eec\u53ef\u4ee5\u5f15\u5165\u4e00\u4e2a\u677e\u5f1b\u56e0\u5b50 \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} , \u5c06\u4f18\u5316\u76ee\u6807\u4fee\u6539\u6210\uff1a \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \u8fd9\u91cc \\xi_i \\xi_i \u53ef\u4ee5\u89c2\u5bdf\u5f97\u5230\u6700\u5c0f\u503c\u4e3a \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \u3002 \u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \u56e0\u4e3a l_{hinge}(x) = max(0, 1- x) l_{hinge}(x) = max(0, 1- x) , \u6240\u4ee5\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u4e5f\u53ef\u4ee5\u770b\u6210\u662fhinge\u635f\u5931\u51fd\u6570\u52a0\u4e8c\u8303\u6570\u6b63\u5219\u9879\u3002 \u56de\u5230\u4f18\u5316\u95ee\u9898(10)\u3002 p=1 p=1 \u65f6\uff0c\u6211\u4eec\u5199\u51fa\u5b83\u7684\u7b49\u4ef7\u62c9\u683c\u6717\u65e5\u65e0\u7ea6\u675f\u5f62\u5f0f\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \u6574\u7406\u4e00\u4e0b\u53ef\u5f97\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898: \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} SMO\u4f18\u5316\u7b97\u6cd5\u6765\u6c42\u89e3\u8be5\u95ee\u9898\u3002","title":"SVM"},{"location":"ML/02-SVM/#svm","text":"SVM\u7b97\u6cd5\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u56e0\u4e3a\u5f88\u591a\u6269\u5c55\u800c\u53d8\u5f97\u590d\u6742\u8d77\u6765\u3002 \u5b66\u8fc7\u4f18\u5316\u7684\u8bdd\u5c31\u5f88\u597d\u7406\u89e3\u4e86\uff1a SVM\u7b97\u6cd5\u672c\u8d28\u662f\u5c06\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\u5efa\u6a21\u6210\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u5b83\u521a\u597d\u53c8\u95ed\u89e3\uff0c\u95ed\u89e3\u7684\u63a8\u5bfc\u5e94\u8be5\u662f\u5c5e\u4e8e\u4f18\u5316\u7684\u9886\u57df\u3002","title":"SVM\u7b97\u6cd5"},{"location":"ML/02-SVM/#_1","text":"\u5728\u4e00\u5207\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u8981\u5148\u786e\u5b9a\u4e00\u4e2ahypothesis\u96c6 \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \u3002 \u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \uff0c\u5176\u4e2d \\mathbf{x} \\in \\mathbb{R}^{d} \\mathbf{x} \\in \\mathbb{R}^{d} \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \u3002\u6211\u4eec\u5e0c\u671b\u5728 \\mathcal{H} \\mathcal{H} \u4e2d\u627e\u5230\u4e00\u4e2a\u5206\u7c7b\u51fd\u6570 h_\\theta(\\mathbf{x}) h_\\theta(\\mathbf{x}) \u80fd\u628a\u6837\u672c \\mathcal{S} \\mathcal{S} \u5206\u5f97\u6700\u5f00\u3002 \u4ec0\u4e48\u53eb\u505a\u5206\u5f97\u6700\u5f00\u5462\uff1f\u6211\u4eec\u8fd9\u91cc\u7528\u6837\u672c\u4e0e\u5206\u7c7b\u9762\u7684\u8ddd\u79bb\u6765\u8bc4\u4ef7\u5206\u5f00\u7684\u7a0b\u5ea6\u3002 \u6211\u4eec\u6784\u5efa\u7684hypothesis\u96c6\u662f\u7ebf\u6027\u51fd\u6570\u7684\u96c6\u5408\uff1a \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \u90a3\u4e48\uff0c\u6837\u672c\u70b9 (\\mathbf{x}, y) (\\mathbf{x}, y) \u4e0e\u8d85\u5e73\u9762\u7684\u6b27\u5f0f\u8ddd\u79bb\u6709\u95ed\u89e3\uff1a d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} \u90a3\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u635f\u5931\u51fd\u6570\u662f\uff1a L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} \u5f53\u6709\u5206\u7c7b\u9519\u7684\u70b9\uff0c\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u4e3a\u6b63\uff0c\u9519\u8bef\u70b9\u8ddd\u79bb\u8d85\u5e73\u9762\u8fdc\uff0c\u9519\u5f97\u8d8a\u79bb\u8c31\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5927\u3002\u5f53\u5206\u7c7b\u5168\u90e8\u6b63\u786e\u65f6\uff0c\u8d85\u5e73\u9762\u5c06\u70b9\u5206\u5f97\u8d8a\u5f00\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5c0f\u3002 \u8fd9\u91cc\u6211\u4eec\u7528\u8ddd\u79bb\u7684\u4e0b\u754c\u6765\u5f53\u4f5c\u635f\u5931\u51fd\u6570\uff0c\u76f8\u5f53\u4e8e\u5168\u6c11\u5954\u5c0f\u5eb7\u3002\u5982\u679c\u7528\u5e73\u5747\u8ddd\u79bb\uff0c\u4f1a\u5bfc\u81f4\u5206\u7c7b\u9519\u8bef\u7387\u9ad8\uff0c\u4f46\u662f\u5e73\u5747\u8ddd\u79bb\u5c0f\u7684\u5206\u7c7b\u5668\u88ab\u9009\u62e9\uff0c\u76f8\u5f53\u4e8e\u52a3\u5e01\u9a71\u9010\u826f\u5e01\u3002\u6211\u4eec\u5b66\u4e60\u5206\u7c7b\u5668\u7684\u672c\u8d28\u8fd8\u662f\u7528\u6765\u5206\u7c7b\u7684\uff0c\u4e0d\u80fd\u5fd8\u4e86\u521d\u5fc3\u3002","title":"\u76ee\u6807\u95ee\u9898"},{"location":"ML/02-SVM/#hard-svm","text":"\u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u4e0a\u9762\u7684\u635f\u5931\u51fd\u6570\u4e0d\u5bb9\u8bb8\u4efb\u4f55\u4e00\u4e2a\u70b9\u5206\u7c7b\u9519\u8bef\uff0c\u6240\u4ee5\u5bf9\u5e94\u7684\u7b97\u6cd5\u53eb\u505a Hard SVM\u7b97\u6cd5\u3002 \u9996\u5148\u6211\u4eec\u5199\u51fa\u6211\u4eec\u4f18\u5316\u76ee\u6807\uff1a \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u6709\u65e0\u9650\u591a\u7ec4\uff1a\u5982\u679c (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) \u662f\u89e3\uff0c\u90a3\u4e48\u5bf9\u4efb\u610f k > 0 k > 0 , (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) \u90fd\u662f\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u3002 \u6211\u4eec\u53ea\u60f3\u6c42\u5230\u4e00\u4e2a\u89e3\u5c31\u597d\u4e86:\u5982\u679c\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u6bcd\u4e0a \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 , \u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86: \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \u8fd9\u4e2a\u95ee\u9898\u7b49\u4ef7\u7684\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u5f88\u96be\u89e3\uff1a \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u7b49\u4ef7\u7684\u539f\u56e0\u662f\uff1a\u5982\u679c \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \uff0c\u90a3\u4e48\u5185\u5c42\u7684\u4f18\u5316 \\min_{\\alpha \\ne 0} \\min_{\\alpha \\ne 0} \u5c31\u4f1a\u7b49\u4e8e\u65e0\u7a77\u5c0f\uff0c\u5373 \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \u662f\u65e0\u7a77\u5c0f\uff0c\u80af\u5b9a\u5c0f\u4e8e \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \u7684\u503c\u3002 \u8fd9\u91cc\u5c31\u8981\u7528\u5230\u8fd9\u4e00\u5c0f\u8282\u5f00\u5934\u7684\u5047\u8bbe\uff0c\u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u5b50\u4e0a\uff0c\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86\uff1a \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \u8fd9\u91cc\u7684\u53d8\u5f62\u5c31\u5dee\u6700\u540e\u4e00\u6b65\u4e86\uff0c\u6211\u4eec\u60f3\u53bb\u6389 \\min_{i\\in[1,m]} \\min_{i\\in[1,m]} \u64cd\u4f5c\uff0c\u5373\u628a\u4f18\u5316\u76ee\u6807\u8fd8\u53ef\u4ee5\u7b80\u5316\u6210\uff1a \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \u8fd9\u4e00\u6b65\u7684\u7b49\u4ef7\u539f\u56e0\u662f\uff1a \u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u7684\u6700\u4f18\u89e3 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u5bfc\u81f4 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 , \u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u89e3 (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) \u6bd4 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u66f4\u4f18\u3002 \u5bf9\u5e94\u7684\u65e0\u7ea6\u675f\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u662f \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \u73b0\u5728\u6765\u6c42\u89e3\u4e00\u4e0b\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\u3002 \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \u5176\u4e2d \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \uff0c \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \u56e0\u6b64\u53ef\u5f97\uff1a \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \u5176\u4e2d \\mathbf{b}^*_\\theta \\mathbf{b}^*_\\theta \u6d89\u53ca\u5230support\u96c6 \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \uff0c \u4e0d\u5728\u8fd9\u4e2a\u96c6\u5408\u4e0a\u7684\u70b9 (\\mathbf{x}_i, y_i) (\\mathbf{x}_i, y_i) \u6ee1\u8db3 \\alpha_i = 0 \\alpha_i = 0 \uff0c\u4e5f\u5c31\u662f\u8bf4 (\\mathbf{w}^*_\\theta, b^*) (\\mathbf{w}^*_\\theta, b^*) \u53ea\u662fsupport\u96c6\u5143\u7d20\u7684\u653e\u5c04\u7ec4\u5408\uff0c\u4e0e\u4e0d\u5728supoort\u96c6\u4e0a\u7684\u6837\u672c\u65e0\u5173\u3002","title":"Hard SVM\u7b97\u6cd5"},{"location":"ML/02-SVM/#soft-svm","text":"\u5728\u4e0a\u4e00\u5c0f\u8282\uff0c\u7b97\u6cd5\u7684\u8981\u6c42\u592a\u5f3a\u4e86\uff0c\u6837\u672c\u6570\u636e\u9700\u8981\u4e25\u683c\u7ebf\u6027\u53ef\u5206\u3002 \u6211\u4eec\u53ef\u4ee5\u5f15\u5165\u4e00\u4e2a\u677e\u5f1b\u56e0\u5b50 \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} , \u5c06\u4f18\u5316\u76ee\u6807\u4fee\u6539\u6210\uff1a \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \u8fd9\u91cc \\xi_i \\xi_i \u53ef\u4ee5\u89c2\u5bdf\u5f97\u5230\u6700\u5c0f\u503c\u4e3a \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \u3002 \u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \u56e0\u4e3a l_{hinge}(x) = max(0, 1- x) l_{hinge}(x) = max(0, 1- x) , \u6240\u4ee5\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u4e5f\u53ef\u4ee5\u770b\u6210\u662fhinge\u635f\u5931\u51fd\u6570\u52a0\u4e8c\u8303\u6570\u6b63\u5219\u9879\u3002 \u56de\u5230\u4f18\u5316\u95ee\u9898(10)\u3002 p=1 p=1 \u65f6\uff0c\u6211\u4eec\u5199\u51fa\u5b83\u7684\u7b49\u4ef7\u62c9\u683c\u6717\u65e5\u65e0\u7ea6\u675f\u5f62\u5f0f\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \u6574\u7406\u4e00\u4e0b\u53ef\u5f97\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898: \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} SMO\u4f18\u5316\u7b97\u6cd5\u6765\u6c42\u89e3\u8be5\u95ee\u9898\u3002","title":"Soft SVM\u7b97\u6cd5"},{"location":"ML/03-Rademacher/","text":"Rademacher\u590d\u6742\u5ea6 \u00b6 \u524d\u7f6e\u77e5\u8bc6 \u00b6 \u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 $(x, y) \\sim \\mathcal{D} $\u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u6211\u4eec\u4eba\u4e3a\u5730\u6784\u9020\u67d0\u4e2a\u7279\u5b9a\u6761\u4ef6\u5206\u5e03\u7684\u96c6\u5408(Hypothesis Set): \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \uff0c\u8fd9\u4e9b\u6761\u4ef6\u5206\u5e03\u88ab \\theta \\theta \u53c2\u6570\u5316\u3002 \u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u76ee\u6807\u5c31\u662f\u6839\u636e\u6837\u672c\u4ece\u5019\u9009\u96c6\u4e2d\u9009\u62e9\u6700\u63a5\u8fd1\u771f\u5b9e\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u7684\u5206\u5e03 P_{\\theta}(y \\vert x) P_{\\theta}(y \\vert x) \u3002 \u8bb2\u5230\u8fd9\u91cc\u5c31\u592a\u62bd\u8c61\u4e86\uff0c\u5fc5\u987b\u8981\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u4e00\u4e0b\u4e86\u3002 \u4f8b\u5b501\uff1a\u4e00\u4e2a\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u4e2d\uff0c\u5047\u8bbe\u96c6\u662f\u67d0\u4e2a\u7a7a\u95f4\u8d85\u5e73\u9762\u7684\u96c6\u5408 \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} , \u8fd9\u91cc\u7684\u6761\u4ef6\u5206\u5e03\u5bf9\u5e94\u7684\u662f P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 \u3002\u6211\u4eec\u53ef\u4ee5\u9009\u53d6\u67d0\u4e2a\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u5dee\u5f02\u7684\u8ddd\u79bb\u6765\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u6c42\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u7684\u6700\u5c0f\u503c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5728\u8fd9\u4e2a\u8ddd\u79bb\u4e0b\uff0c\u6700\u63a5\u8fd1\u771f\u5b9e\u6761\u4ef6\u5206\u5e03\u7684\u53c2\u6570\u5316\u6761\u4ef6\u5206\u5e03, \u5373\u4f18\u5316\u76ee\u6807\u4e3a\uff1a \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \u8fd9\u91cc\u5982\u679c\u4f7f\u7528Wasserstein Distance, \u5e76\u4e14\u4f7f\u7528\u82b1\u8d39\u51fd\u6570 c(a, b) = \\Vert a - b\\Vert^2 c(a, b) = \\Vert a - b\\Vert^2 , \u90a3\u4e48\u5c31\u662f\u53ef\u4ee5\u5f97\u5230\u7ecf\u5178\u56de\u5f52\u95ee\u9898\u7684\u4f18\u5316\u76ee\u6807\uff1a \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \u5982\u679c y \\in \\{0, 1\\} y \\in \\{0, 1\\} , \u4e5f\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u4f18\u5316\u76ee\u6807\u7b49\u4ef7\u4e8e0-1\u635f\u5931\uff1a \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u90fd\u662f\u56f4\u7ed50-1\u5206\u7c7b\u95ee\u9898\u800c\u8fdb\u884c\u7684\u3002\u975e\u5e38\u4e0d\u5e78\u7684\u662f\uff0c\u4e0a\u9762\u63d0\u5230\u7684\u771f\u5b9e\u635f\u5931\u51fd\u6570\u6211\u4eec\u90fd\u6ca1\u529e\u6cd5\u76f4\u63a5\u8fdb\u884c\u4f18\u5316\uff0c\u6211\u4eec\u80fd\u505a\u7684\u662f\u4f18\u5316\u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\uff1a \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \u5176\u4e2d l^{0-1}(h(x), y) = 1_{h(x) = y} l^{0-1}(h(x), y) = 1_{h(x) = y} . \u4e0a\u9762\u8fd9\u79cd\u4f18\u5316\u76ee\u6807\u6709\u4e00\u4e2a\u540d\u5b57\u53eb\u505a\u7ecf\u9a8c\u98ce\u9669\u6700\u5c0f\u5316(Empirical Risk Minimization, ERM)\uff0c(4)\u5f0f\u5bf9\u5e94\u7684\u6700\u4f18\u5206\u7c7b\u5668 h^* h^* \u53ef\u4ee5\u5199\u6210 ERM_{\\mathcal{H}}(S) ERM_{\\mathcal{H}}(S) \u3002 Representativeness \u00b6 \u9996\u5148\u5f15\u5165\u4e00\u4e2a\u8bc4\u4ef7\u6837\u672c\u7684\u6807\u51c6: \u5b9a\u4e491\uff1a \\mathcal{S} \\mathcal{S} \u88ab\u79f0\u4e3a \\epsilon-representative \\epsilon-representative \uff0c\u5982\u679c \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \u5982\u679c \u6837\u672c S S \u662f \\epsilon-representative \\epsilon-representative \uff0c \u90a3\u4e48 \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \u5373 L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u901a\u8fc7ERM\u6807\u51c6\u6c42\u5230\u7684\u5206\u7c7b\u5668\u662f\u80fd\u591f\u63a5\u8fd1\u6700\u4f18\u503c\u7684\uff0c\u5e76\u4e14 \\epsilon \\epsilon \u80fd\u591f\u4f53\u73b0\u4e24\u8005\u7684\u63a5\u8fd1\u7a0b\u5ea6\u3002\u5982\u679c \\epsilon \\epsilon \u8db3\u591f\u5c0f\uff0c\u90a3\u4e48 S S \u8db3\u4ee5\u4ee3\u8868\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u63a5\u4e0b\u6765\u540c\u6837\u662f\u7eaf\u6570\u5b66\u7684\u4e1c\u897f\u3002\u6211\u4eec\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff1a\u7ed9\u5b9a\u4efb\u610f\u4e00\u4e2a\u6837\u672c S S , \u6211\u4eec\u8981\u4f30\u8ba1\u5b83\u7684\u4ee3\u8868\u7a0b\u5ea6(representiveness)\u3002 \u4e3a\u4e86\u8ba8\u8bba\u65b9\u4fbf\uff0c\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u96c6\u5408: \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \u8fd9\u6837\uff0c\u771f\u5b9e\u8bef\u5dee\u53ef\u5199\u6210 L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] \uff0c\u7ecf\u9a8c\u8bef\u5dee\u53ef\u4ee5\u5199\u6210 L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) \u3002\u90a3\u4e48\u6837\u672c S S \u7684\u4ee3\u8868\u6027\u53ef\u4ee5\u91cd\u65b0\u5199\u6210 Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} \u5176\u5b9e(6)\u5f0f\u53ea\u662f\u5b9a\u4e491\u6362\u4e86\u4e00\u79cd\u5199\u6cd5\uff0c\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u771f\u7684\u8ba1\u7b97\u5b83\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b83\u5bf9\u5e94\u5730\u7ecf\u9a8c\u516c\u5f0f\uff0c\u4ee5\u53ca\u7ecf\u9a8c\u516c\u5f0f\u548c(6)\u5f0f\u7684gap\u3002 \u6837\u672c\u96c6\u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1: Rademacher\u590d\u6742\u5ea6 \u00b6 \u9996\u5148\u4ecb\u7ecd\u4e00\u4e2a\u76f4\u89c9\u4e0a\u7684\u7ecf\u9a8c\u4f30\u8ba1\uff1a\u5c06 S S \u5747\u5206\u6210\u4e24\u4e2a\u6837\u672c\u96c6 S_1 S_1 \u4e0e S_2 S_2 \u3002\u5747\u5206\u7684\u610f\u601d\u662f S S \u4e2d\u7684\u6837\u672c (x, y) (x, y) \u53ea\u4f1a\u51fa\u73b0\u5728 S_1 S_1 \u4e0e S_2 S_2 \u4e2d\u7684\u4e00\u4e2a, \u800c\u4e14\u4e00\u5b9a\u4f1a\u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u4e2a\u6837\u672c\u96c6\u4e2d\u3002 \u90a3\u4e48\uff0c S S \u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1\u662f\uff1a \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \u8fd9\u4e2a\u7ecf\u9a8c\u4f30\u8ba1\u5e76\u4e0d\u662f\u7b26\u5408\u6240\u6709\u4eba\u7684\u76f4\u89c9\u7684\uff0c\u6240\u4ee5\u4f60\u5982\u679c\u611f\u89c9\u83ab\u540d\u5176\u5999\uff0c\u4e5f\u4e0d\u8981\u614c\uff0c\u8ddf\u7740\u6211\u7ee7\u7eed\u3002 \u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u968f\u673a\u53d8\u91cf \\sigma \\in \\{-1, 1\\} \\sigma \\in \\{-1, 1\\} \uff0c\u5b83\u67090.5\u7684\u6982\u7387\u53d6 1 1 , \u67090.5\u7684\u6982\u7387\u53d6 -1 -1 \uff0c\u90a3\u4e48\u4e00\u4e2a\u66f4\u597d\u7684\u7ecf\u9a8c\u4f30\u8ba1\u53ef\u4ee5\u5199\u6210 R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53eb\u505a Rademacher\u590d\u6742\u5ea6\u3002\u8fd9\u4e2a\u4f30\u8ba1\u6bd4(7)\u5f0f\u590d\u6742\u5f97\u591a\uff0c\u662f 2^m 2^m \u6307\u6570\u500d\uff0c\u8ba1\u7b97\u590d\u6742\u7684\u95ee\u9898\u6211\u4eec\u653e\u5230\u540e\u9762\u89e3\u51b3\u3002\u6211\u4eec\u5148\u6765\u89e3\u51b3\u4e00\u4e0b\u8fd9\u4e2aRademacher\u590d\u6742\u5ea6\u548c\u6837\u672c\u8868\u8fbe\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u5b9a\u74061\uff1a \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \u8bc1\u660e\u5f88\u5de7\u5999\uff0c\u4e66\u4e0a\u6709\u3002 \u6839\u636e\u5b9a\u74061\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u51e0\u4e2a\u5f15\u7406\uff1a \u9996\u5148 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ; \u5176\u6b21 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ,\u5176\u4e2d h^* = \\min L_{\\mathcal{D}}(h) h^* = \\min L_{\\mathcal{D}}(h) ; \u6700\u540e P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta \u3002(\u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f) \u4e3a\u4e86\u63a5\u4e0b\u6765\u7684\u5206\u6790\uff0c\u9700\u8981\u5148\u4ecb\u7ecd\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff1aMcDiarmid's Inequality\u3002 \u5b9a\u74062\uff1a(McDiarmid's Inequality)\u3002 \u5982\u679c i \\in [1, m] i \\in [1, m] , \u5e76\u4e14 f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], \u90a3\u4e48 P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. \u5b9a\u74063\uff1a(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \u5bf9\u4e8em\u4e2a\u968f\u673a\u53d8\u91cf X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] , \u5b83\u4eec\u5747\u503c\u7684\u968f\u673a\u53d8\u91cf \\bar X \\bar X \u6ee1\u8db3 P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). \u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e0e\u6570\u636e\u76f4\u63a5\u6709\u5173\u7684\u8fb9\u754c\uff0c\u800c\u4e0d\u53ea\u662f\u671f\u671b\u3002 \u5b9a\u74064\uff1a(\u6570\u636e\u76f8\u5173\u754c)\u3002\u5982\u679c l(h(x), y) \\in [a, b] l(h(x), y) \\in [a, b] \uff0c\u90a3\u4e48 P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta \u8bc1\u660e\uff1a \u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff0c\u76f4\u63a5\u4f7f\u7528McDiarmid's Inequality, \u6ce8\u610f\u5bf9\u5e94\u7684\u4e0d\u662f l(h(x), y) l(h(x), y) \u7684\u754c\u800c\u662f\u662f [(a - b)/m, (b - a)/m] [(a - b)/m, (b - a)/m] \uff1b \u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u5f0f\uff0c \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u4e0d\u7b49\u5f0f, \u9996\u5148\u5b9a\u4e49 h_S = ERM_{\\mathcal{H}}(S) h_S = ERM_{\\mathcal{H}}(S) \uff0c \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \u8fd9\u4e09\u4e2a\u4e0d\u7b49\u5f0f\u5c42\u5c42\u9012\u8fdb\uff0c\u5176\u4e2d\u7b2c\u4e09\u4e2a\u7b49\u5f0f\u662f\u6211\u4eec\u6700\u60f3\u5f97\u5230\u7684\u7ed3\u679c\u3002 \u8ba1\u7b97Rademacher\u590d\u6742\u5ea6 \u00b6 \u5bf9\u4e8eRademacher\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u62bd\u8c61\u7684\u8ba4\u4e3a\u662f\u8861\u91cf\u4e00\u4e2a\u5411\u91cf\u96c6\u5408\u7684\u590d\u6742\u5ea6\u7684\uff1a A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} \u5f15\u74061\uff1a\u5bf9\u4e8e\u96c6\u5408 A A , \u5e38\u6570 c c \u548c \u67d0\u4e2a\u5411\u91cf \\mathbf{a}_0 \\mathbf{a}_0 \uff0c\u90a3\u4e48 R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). \u5f15\u74062\uff1a\u5bf9\u4e8e\u96c6\u5408A\uff0c\u5bf9\u5e94\u7684\u4e00\u4e2a\u96c6\u5408 A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} , \u90a3\u4e48 R(A') = R(A) R(A') = R(A) \u3002 \u5f15\u74063\uff1a(Massart Lemma). \u5982\u679c A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} \uff0c\u5b9a\u4e49 \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i , \u90a3\u4e48 R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. \u8bc1\u660e\uff1a\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe \\bar{\\mathbf{a}} = 0 \\bar{\\mathbf{a}} = 0 , \u5e76\u4e14 A' = \\lambda A(\\lambda > 0) A' = \\lambda A(\\lambda > 0) , \u90a3\u4e48 \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \u53c8\u56e0\u4e3a R(A') = \\lambda R(A) R(A') = \\lambda R(A) , \u6240\u4ee5 mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. \u5f15\u74064\uff1a\u6536\u7f29\u6027\u3002 \u4ee4 \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) , \u5e76\u4e14 \\phi_i \\phi_i \u90fd\u662f \\rho \\rho -Lipshcitz \u8fde\u7eed\u51fd\u6570\uff0c\u90a3\u4e48 R(\\phi\\circ A) \\le \\rho R(A) R(\\phi\\circ A) \\le \\rho R(A) . \u7ebf\u6027\u5047\u8bbe\u96c6\u7684Rademacher\u590d\u6742\u5ea6 \u00b6 \u4f8b2\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} \u8bc1\u660e\uff1a \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \u4f8b3\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. \u8fd9\u4e2a\u8bc1\u660e\u6709\u70b9\u5de7\u5999\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u6709\u70b9\u7ed5\uff0c\u5927\u5bb6\u5c0f\u5fc3\u4e86\u3002 \u8bc1\u660e\uff1a \u9996\u5148\u6784\u9020\u96c6\u5408 V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} . \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*} \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*} SVM\u7b97\u6cd5\u7684\u754c \u00b6 \u5b9a\u74065\uff1a\u5bf9\u4e8eSVM\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u6211\u4eec\u589e\u52a0\u9650\u5b9a \\Vert \\mathbf{x} \\Vert_2 \\le R \\Vert \\mathbf{x} \\Vert_2 \\le R \u4ee5\u53ca\u5047\u8bbe\u96c6\u7684\u9650\u5b9a \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} , \u6837\u672c\u70b9\u635f\u5931\u51fd\u6570 l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} , l(a, y) l(a, y) \u5173\u4e8ea\u662f \\rho \\rho -Lipschitz\u8fde\u7eed\uff0c\u5e76\u4e14 l(a, y)\\in[0, c] l(a, y)\\in[0, c] , \u90a3\u4e48 P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. \u8bc1\u660e\uff1a \u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} \u3002\u524d\u9762\u7684\u6bd4\u4f8b\u4e0d\u53d8\u6027\u3001\u4f8b\u5b502\u8bc1\u660e\u4e86\u8fd9\u4e9b\u4e8b\u60c5\u3002 \u53ef\u4ee5\u5c06 \\mathbf{x} \\mathbf{x} \u7ef4\u5ea6\u589e\u52a0\u4e00\u7ef4\uff0c\u90a3\u4e48Hard-SVM\u95ee\u9898\u53ef\u4ee5\u7b80\u5316\u6210 \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \u5982\u679c\u5b58\u5728\u4e00\u4e2a \\mathbf{w}_0 \\mathbf{w}_0 \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 , \u5e76\u4e14 \\Vert \\mathbf{x} \\Vert \\le R \\Vert \\mathbf{x} \\Vert \\le R \uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7\u7ecf\u9a8c\u8bef\u5dee\u6700\u5c0f\u5316\u6c42\u5f97\u7684 \\mathbf{w}_S \\mathbf{w}_S \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} \u4e0a\u9762\u8fd9\u4e2a\u754c\u8fd8\u9700\u8981\u77e5\u9053 \\mathbf{w}_0 \\mathbf{w}_0 , \u6700\u597d\u80fd\u77e5\u9053\u771f\u5b9e\u7684\u6700\u4f18\u5206\u7c7b\u5668 \\mathbf{w}^* \\mathbf{w}^* \u4f46\u662f\u8fd9\u4e9b\u90fd\u662f\u4e0d\u80fd\u5f97\u5230\u7684\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u65b0\u7684\u754c\u3002\u8fd9\u4e2a\u754c\u7528\u5230\u4e86\u7ed3\u6784\u98ce\u9669\u6700\u5c0f\u5316\u7684\u601d\u60f3\u3002 \u5bf9\u4e8e\u6b63\u6574\u6570i\uff0c\u6784\u9020 B_i = 2^8 B_i = 2^8 , \u4ee5\u53ca\u5bf9\u5e94\u5047\u8bbe\u96c6 \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} , \u5e76\u4e14 \\delta_i = \\frac{\\delta}{2 i^2} \\delta_i = \\frac{\\delta}{2 i^2} \u3002\u90a3\u4e48\uff0c\u6709 P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. \u90a3\u4e48\uff0c\u548c\u4e8b\u4ef6\u7684\u6982\u7387\u662f 1 - \\delta 1 - \\delta \u3002 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a \\mathbf{w} \\mathbf{w} \uff0c\u5b83\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u7f16\u53f7\u662f i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil , B_i\\le 2\\Vert \\mathbf{w} \\Vert B_i\\le 2\\Vert \\mathbf{w} \\Vert , \u5e76\u4e14 \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} , \u90a3\u4e48 L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}. L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}.","title":"Rademacher"},{"location":"ML/03-Rademacher/#rademacher","text":"","title":"Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#_1","text":"\u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 $(x, y) \\sim \\mathcal{D} $\u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u6211\u4eec\u4eba\u4e3a\u5730\u6784\u9020\u67d0\u4e2a\u7279\u5b9a\u6761\u4ef6\u5206\u5e03\u7684\u96c6\u5408(Hypothesis Set): \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \uff0c\u8fd9\u4e9b\u6761\u4ef6\u5206\u5e03\u88ab \\theta \\theta \u53c2\u6570\u5316\u3002 \u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u76ee\u6807\u5c31\u662f\u6839\u636e\u6837\u672c\u4ece\u5019\u9009\u96c6\u4e2d\u9009\u62e9\u6700\u63a5\u8fd1\u771f\u5b9e\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u7684\u5206\u5e03 P_{\\theta}(y \\vert x) P_{\\theta}(y \\vert x) \u3002 \u8bb2\u5230\u8fd9\u91cc\u5c31\u592a\u62bd\u8c61\u4e86\uff0c\u5fc5\u987b\u8981\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u4e00\u4e0b\u4e86\u3002 \u4f8b\u5b501\uff1a\u4e00\u4e2a\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u4e2d\uff0c\u5047\u8bbe\u96c6\u662f\u67d0\u4e2a\u7a7a\u95f4\u8d85\u5e73\u9762\u7684\u96c6\u5408 \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} , \u8fd9\u91cc\u7684\u6761\u4ef6\u5206\u5e03\u5bf9\u5e94\u7684\u662f P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 \u3002\u6211\u4eec\u53ef\u4ee5\u9009\u53d6\u67d0\u4e2a\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u5dee\u5f02\u7684\u8ddd\u79bb\u6765\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u6c42\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u7684\u6700\u5c0f\u503c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5728\u8fd9\u4e2a\u8ddd\u79bb\u4e0b\uff0c\u6700\u63a5\u8fd1\u771f\u5b9e\u6761\u4ef6\u5206\u5e03\u7684\u53c2\u6570\u5316\u6761\u4ef6\u5206\u5e03, \u5373\u4f18\u5316\u76ee\u6807\u4e3a\uff1a \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \u8fd9\u91cc\u5982\u679c\u4f7f\u7528Wasserstein Distance, \u5e76\u4e14\u4f7f\u7528\u82b1\u8d39\u51fd\u6570 c(a, b) = \\Vert a - b\\Vert^2 c(a, b) = \\Vert a - b\\Vert^2 , \u90a3\u4e48\u5c31\u662f\u53ef\u4ee5\u5f97\u5230\u7ecf\u5178\u56de\u5f52\u95ee\u9898\u7684\u4f18\u5316\u76ee\u6807\uff1a \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \u5982\u679c y \\in \\{0, 1\\} y \\in \\{0, 1\\} , \u4e5f\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u4f18\u5316\u76ee\u6807\u7b49\u4ef7\u4e8e0-1\u635f\u5931\uff1a \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u90fd\u662f\u56f4\u7ed50-1\u5206\u7c7b\u95ee\u9898\u800c\u8fdb\u884c\u7684\u3002\u975e\u5e38\u4e0d\u5e78\u7684\u662f\uff0c\u4e0a\u9762\u63d0\u5230\u7684\u771f\u5b9e\u635f\u5931\u51fd\u6570\u6211\u4eec\u90fd\u6ca1\u529e\u6cd5\u76f4\u63a5\u8fdb\u884c\u4f18\u5316\uff0c\u6211\u4eec\u80fd\u505a\u7684\u662f\u4f18\u5316\u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\uff1a \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \u5176\u4e2d l^{0-1}(h(x), y) = 1_{h(x) = y} l^{0-1}(h(x), y) = 1_{h(x) = y} . \u4e0a\u9762\u8fd9\u79cd\u4f18\u5316\u76ee\u6807\u6709\u4e00\u4e2a\u540d\u5b57\u53eb\u505a\u7ecf\u9a8c\u98ce\u9669\u6700\u5c0f\u5316(Empirical Risk Minimization, ERM)\uff0c(4)\u5f0f\u5bf9\u5e94\u7684\u6700\u4f18\u5206\u7c7b\u5668 h^* h^* \u53ef\u4ee5\u5199\u6210 ERM_{\\mathcal{H}}(S) ERM_{\\mathcal{H}}(S) \u3002","title":"\u524d\u7f6e\u77e5\u8bc6"},{"location":"ML/03-Rademacher/#representativeness","text":"\u9996\u5148\u5f15\u5165\u4e00\u4e2a\u8bc4\u4ef7\u6837\u672c\u7684\u6807\u51c6: \u5b9a\u4e491\uff1a \\mathcal{S} \\mathcal{S} \u88ab\u79f0\u4e3a \\epsilon-representative \\epsilon-representative \uff0c\u5982\u679c \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \u5982\u679c \u6837\u672c S S \u662f \\epsilon-representative \\epsilon-representative \uff0c \u90a3\u4e48 \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \u5373 L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u901a\u8fc7ERM\u6807\u51c6\u6c42\u5230\u7684\u5206\u7c7b\u5668\u662f\u80fd\u591f\u63a5\u8fd1\u6700\u4f18\u503c\u7684\uff0c\u5e76\u4e14 \\epsilon \\epsilon \u80fd\u591f\u4f53\u73b0\u4e24\u8005\u7684\u63a5\u8fd1\u7a0b\u5ea6\u3002\u5982\u679c \\epsilon \\epsilon \u8db3\u591f\u5c0f\uff0c\u90a3\u4e48 S S \u8db3\u4ee5\u4ee3\u8868\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u63a5\u4e0b\u6765\u540c\u6837\u662f\u7eaf\u6570\u5b66\u7684\u4e1c\u897f\u3002\u6211\u4eec\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff1a\u7ed9\u5b9a\u4efb\u610f\u4e00\u4e2a\u6837\u672c S S , \u6211\u4eec\u8981\u4f30\u8ba1\u5b83\u7684\u4ee3\u8868\u7a0b\u5ea6(representiveness)\u3002 \u4e3a\u4e86\u8ba8\u8bba\u65b9\u4fbf\uff0c\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u96c6\u5408: \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \u8fd9\u6837\uff0c\u771f\u5b9e\u8bef\u5dee\u53ef\u5199\u6210 L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] \uff0c\u7ecf\u9a8c\u8bef\u5dee\u53ef\u4ee5\u5199\u6210 L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) \u3002\u90a3\u4e48\u6837\u672c S S \u7684\u4ee3\u8868\u6027\u53ef\u4ee5\u91cd\u65b0\u5199\u6210 Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} \u5176\u5b9e(6)\u5f0f\u53ea\u662f\u5b9a\u4e491\u6362\u4e86\u4e00\u79cd\u5199\u6cd5\uff0c\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u771f\u7684\u8ba1\u7b97\u5b83\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b83\u5bf9\u5e94\u5730\u7ecf\u9a8c\u516c\u5f0f\uff0c\u4ee5\u53ca\u7ecf\u9a8c\u516c\u5f0f\u548c(6)\u5f0f\u7684gap\u3002","title":"Representativeness"},{"location":"ML/03-Rademacher/#rademacher_1","text":"\u9996\u5148\u4ecb\u7ecd\u4e00\u4e2a\u76f4\u89c9\u4e0a\u7684\u7ecf\u9a8c\u4f30\u8ba1\uff1a\u5c06 S S \u5747\u5206\u6210\u4e24\u4e2a\u6837\u672c\u96c6 S_1 S_1 \u4e0e S_2 S_2 \u3002\u5747\u5206\u7684\u610f\u601d\u662f S S \u4e2d\u7684\u6837\u672c (x, y) (x, y) \u53ea\u4f1a\u51fa\u73b0\u5728 S_1 S_1 \u4e0e S_2 S_2 \u4e2d\u7684\u4e00\u4e2a, \u800c\u4e14\u4e00\u5b9a\u4f1a\u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u4e2a\u6837\u672c\u96c6\u4e2d\u3002 \u90a3\u4e48\uff0c S S \u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1\u662f\uff1a \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \u8fd9\u4e2a\u7ecf\u9a8c\u4f30\u8ba1\u5e76\u4e0d\u662f\u7b26\u5408\u6240\u6709\u4eba\u7684\u76f4\u89c9\u7684\uff0c\u6240\u4ee5\u4f60\u5982\u679c\u611f\u89c9\u83ab\u540d\u5176\u5999\uff0c\u4e5f\u4e0d\u8981\u614c\uff0c\u8ddf\u7740\u6211\u7ee7\u7eed\u3002 \u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u968f\u673a\u53d8\u91cf \\sigma \\in \\{-1, 1\\} \\sigma \\in \\{-1, 1\\} \uff0c\u5b83\u67090.5\u7684\u6982\u7387\u53d6 1 1 , \u67090.5\u7684\u6982\u7387\u53d6 -1 -1 \uff0c\u90a3\u4e48\u4e00\u4e2a\u66f4\u597d\u7684\u7ecf\u9a8c\u4f30\u8ba1\u53ef\u4ee5\u5199\u6210 R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53eb\u505a Rademacher\u590d\u6742\u5ea6\u3002\u8fd9\u4e2a\u4f30\u8ba1\u6bd4(7)\u5f0f\u590d\u6742\u5f97\u591a\uff0c\u662f 2^m 2^m \u6307\u6570\u500d\uff0c\u8ba1\u7b97\u590d\u6742\u7684\u95ee\u9898\u6211\u4eec\u653e\u5230\u540e\u9762\u89e3\u51b3\u3002\u6211\u4eec\u5148\u6765\u89e3\u51b3\u4e00\u4e0b\u8fd9\u4e2aRademacher\u590d\u6742\u5ea6\u548c\u6837\u672c\u8868\u8fbe\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u5b9a\u74061\uff1a \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \u8bc1\u660e\u5f88\u5de7\u5999\uff0c\u4e66\u4e0a\u6709\u3002 \u6839\u636e\u5b9a\u74061\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u51e0\u4e2a\u5f15\u7406\uff1a \u9996\u5148 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ; \u5176\u6b21 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ,\u5176\u4e2d h^* = \\min L_{\\mathcal{D}}(h) h^* = \\min L_{\\mathcal{D}}(h) ; \u6700\u540e P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta \u3002(\u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f) \u4e3a\u4e86\u63a5\u4e0b\u6765\u7684\u5206\u6790\uff0c\u9700\u8981\u5148\u4ecb\u7ecd\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff1aMcDiarmid's Inequality\u3002 \u5b9a\u74062\uff1a(McDiarmid's Inequality)\u3002 \u5982\u679c i \\in [1, m] i \\in [1, m] , \u5e76\u4e14 f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], \u90a3\u4e48 P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. \u5b9a\u74063\uff1a(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \u5bf9\u4e8em\u4e2a\u968f\u673a\u53d8\u91cf X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] , \u5b83\u4eec\u5747\u503c\u7684\u968f\u673a\u53d8\u91cf \\bar X \\bar X \u6ee1\u8db3 P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). \u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e0e\u6570\u636e\u76f4\u63a5\u6709\u5173\u7684\u8fb9\u754c\uff0c\u800c\u4e0d\u53ea\u662f\u671f\u671b\u3002 \u5b9a\u74064\uff1a(\u6570\u636e\u76f8\u5173\u754c)\u3002\u5982\u679c l(h(x), y) \\in [a, b] l(h(x), y) \\in [a, b] \uff0c\u90a3\u4e48 P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta \u8bc1\u660e\uff1a \u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff0c\u76f4\u63a5\u4f7f\u7528McDiarmid's Inequality, \u6ce8\u610f\u5bf9\u5e94\u7684\u4e0d\u662f l(h(x), y) l(h(x), y) \u7684\u754c\u800c\u662f\u662f [(a - b)/m, (b - a)/m] [(a - b)/m, (b - a)/m] \uff1b \u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u5f0f\uff0c \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u4e0d\u7b49\u5f0f, \u9996\u5148\u5b9a\u4e49 h_S = ERM_{\\mathcal{H}}(S) h_S = ERM_{\\mathcal{H}}(S) \uff0c \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \u8fd9\u4e09\u4e2a\u4e0d\u7b49\u5f0f\u5c42\u5c42\u9012\u8fdb\uff0c\u5176\u4e2d\u7b2c\u4e09\u4e2a\u7b49\u5f0f\u662f\u6211\u4eec\u6700\u60f3\u5f97\u5230\u7684\u7ed3\u679c\u3002","title":"\u6837\u672c\u96c6\u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1: Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#rademacher_2","text":"\u5bf9\u4e8eRademacher\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u62bd\u8c61\u7684\u8ba4\u4e3a\u662f\u8861\u91cf\u4e00\u4e2a\u5411\u91cf\u96c6\u5408\u7684\u590d\u6742\u5ea6\u7684\uff1a A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} \u5f15\u74061\uff1a\u5bf9\u4e8e\u96c6\u5408 A A , \u5e38\u6570 c c \u548c \u67d0\u4e2a\u5411\u91cf \\mathbf{a}_0 \\mathbf{a}_0 \uff0c\u90a3\u4e48 R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). \u5f15\u74062\uff1a\u5bf9\u4e8e\u96c6\u5408A\uff0c\u5bf9\u5e94\u7684\u4e00\u4e2a\u96c6\u5408 A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} , \u90a3\u4e48 R(A') = R(A) R(A') = R(A) \u3002 \u5f15\u74063\uff1a(Massart Lemma). \u5982\u679c A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} \uff0c\u5b9a\u4e49 \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i , \u90a3\u4e48 R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. \u8bc1\u660e\uff1a\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe \\bar{\\mathbf{a}} = 0 \\bar{\\mathbf{a}} = 0 , \u5e76\u4e14 A' = \\lambda A(\\lambda > 0) A' = \\lambda A(\\lambda > 0) , \u90a3\u4e48 \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \u53c8\u56e0\u4e3a R(A') = \\lambda R(A) R(A') = \\lambda R(A) , \u6240\u4ee5 mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. \u5f15\u74064\uff1a\u6536\u7f29\u6027\u3002 \u4ee4 \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) , \u5e76\u4e14 \\phi_i \\phi_i \u90fd\u662f \\rho \\rho -Lipshcitz \u8fde\u7eed\u51fd\u6570\uff0c\u90a3\u4e48 R(\\phi\\circ A) \\le \\rho R(A) R(\\phi\\circ A) \\le \\rho R(A) .","title":"\u8ba1\u7b97Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#rademacher_3","text":"\u4f8b2\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} \u8bc1\u660e\uff1a \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \u4f8b3\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. \u8fd9\u4e2a\u8bc1\u660e\u6709\u70b9\u5de7\u5999\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u6709\u70b9\u7ed5\uff0c\u5927\u5bb6\u5c0f\u5fc3\u4e86\u3002 \u8bc1\u660e\uff1a \u9996\u5148\u6784\u9020\u96c6\u5408 V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} . \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*} \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*}","title":"\u7ebf\u6027\u5047\u8bbe\u96c6\u7684Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#svm","text":"\u5b9a\u74065\uff1a\u5bf9\u4e8eSVM\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u6211\u4eec\u589e\u52a0\u9650\u5b9a \\Vert \\mathbf{x} \\Vert_2 \\le R \\Vert \\mathbf{x} \\Vert_2 \\le R \u4ee5\u53ca\u5047\u8bbe\u96c6\u7684\u9650\u5b9a \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} , \u6837\u672c\u70b9\u635f\u5931\u51fd\u6570 l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} , l(a, y) l(a, y) \u5173\u4e8ea\u662f \\rho \\rho -Lipschitz\u8fde\u7eed\uff0c\u5e76\u4e14 l(a, y)\\in[0, c] l(a, y)\\in[0, c] , \u90a3\u4e48 P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. \u8bc1\u660e\uff1a \u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} \u3002\u524d\u9762\u7684\u6bd4\u4f8b\u4e0d\u53d8\u6027\u3001\u4f8b\u5b502\u8bc1\u660e\u4e86\u8fd9\u4e9b\u4e8b\u60c5\u3002 \u53ef\u4ee5\u5c06 \\mathbf{x} \\mathbf{x} \u7ef4\u5ea6\u589e\u52a0\u4e00\u7ef4\uff0c\u90a3\u4e48Hard-SVM\u95ee\u9898\u53ef\u4ee5\u7b80\u5316\u6210 \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \u5982\u679c\u5b58\u5728\u4e00\u4e2a \\mathbf{w}_0 \\mathbf{w}_0 \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 , \u5e76\u4e14 \\Vert \\mathbf{x} \\Vert \\le R \\Vert \\mathbf{x} \\Vert \\le R \uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7\u7ecf\u9a8c\u8bef\u5dee\u6700\u5c0f\u5316\u6c42\u5f97\u7684 \\mathbf{w}_S \\mathbf{w}_S \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} \u4e0a\u9762\u8fd9\u4e2a\u754c\u8fd8\u9700\u8981\u77e5\u9053 \\mathbf{w}_0 \\mathbf{w}_0 , \u6700\u597d\u80fd\u77e5\u9053\u771f\u5b9e\u7684\u6700\u4f18\u5206\u7c7b\u5668 \\mathbf{w}^* \\mathbf{w}^* \u4f46\u662f\u8fd9\u4e9b\u90fd\u662f\u4e0d\u80fd\u5f97\u5230\u7684\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u65b0\u7684\u754c\u3002\u8fd9\u4e2a\u754c\u7528\u5230\u4e86\u7ed3\u6784\u98ce\u9669\u6700\u5c0f\u5316\u7684\u601d\u60f3\u3002 \u5bf9\u4e8e\u6b63\u6574\u6570i\uff0c\u6784\u9020 B_i = 2^8 B_i = 2^8 , \u4ee5\u53ca\u5bf9\u5e94\u5047\u8bbe\u96c6 \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} , \u5e76\u4e14 \\delta_i = \\frac{\\delta}{2 i^2} \\delta_i = \\frac{\\delta}{2 i^2} \u3002\u90a3\u4e48\uff0c\u6709 P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. \u90a3\u4e48\uff0c\u548c\u4e8b\u4ef6\u7684\u6982\u7387\u662f 1 - \\delta 1 - \\delta \u3002 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a \\mathbf{w} \\mathbf{w} \uff0c\u5b83\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u7f16\u53f7\u662f i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil , B_i\\le 2\\Vert \\mathbf{w} \\Vert B_i\\le 2\\Vert \\mathbf{w} \\Vert , \u5e76\u4e14 \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} , \u90a3\u4e48 L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}. L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}.","title":"SVM\u7b97\u6cd5\u7684\u754c"},{"location":"ML/04-Regression/","text":"\u7ebf\u6027\u56de\u5f52\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 (x, y) \\sim \\mathcal{D} (x, y) \\sim \\mathcal{D} \u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u5982\u679c y \\in \\mathbb{R} y \\in \\mathbb{R} , \u90a3\u4e48\u6c42\u89e3 P_\\mathcal{D}(y\\vert x) P_\\mathcal{D}(y\\vert x) \u7684\u95ee\u9898\u4e5f\u53eb\u505a\u56de\u5f52\u95ee\u9898\u3002 \u901a\u5e38\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} , \u6211\u4eec\u4ece\u5047\u8bbe\u96c6\u4e2d\u9009\u4e00\u4e2a\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u96c6\u5408 P_{\\theta^*}(y \\vert x) P_{\\theta^*}(y \\vert x) \u3002\u5bf9\u5e94\u7684\u4f18\u5316\u76ee\u6807\u662f \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \u786e\u5b9a\u6027\u7684\u7ebf\u6027\u56de\u5f52 \u00b6 \u6211\u4eec\u53ef\u4ee5\u7b80\u5316\u8fd9\u4e2a\u95ee\u9898\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u503c\u540e\uff0c\u7ed9\u5b9a\u4e00\u4e2a x x , \u6211\u4eec\u901a\u5e38\u9884\u6d4b y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u9700\u8981\u6c42\u89e3\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u6761\u4ef6\u5206\u5e03\uff0c\u6211\u4eec\u53ef\u4ee5\u8f6c\u800c\u6c42\u89e3\u5206\u5e03\u6ee1\u8db3 \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u66f4\u6fc0\u8fdb\u7684\u5019\u9009\u96c6\u6765\u7b80\u5316\u95ee\u9898: \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \u6211\u4eec\u4f7f\u7528Wasserstein\u8ddd\u79bb(\u8f93\u8fd0\u82b1\u8d39\u51fd\u6570\u4e3a c(a, b) c(a, b) )\uff0c\u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \u5982\u679c c(a, b) = \\Vert a - b \\Vert^2_2 c(a, b) = \\Vert a - b \\Vert^2_2 , \u90a3\u4e48\u5c31\u662f\u5927\u5bb6\u719f\u77e5\u7684\u5e73\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} \u6ce8\u610f\uff1a\u6211\u6ca1\u6709\u63d0\u5230\u9ad8\u65af\u5206\u5e03\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u63d0\u5230\u9ad8\u65af\u5206\u5e03\u7684\u5047\u8bbe\u3002 \u968f\u673a\u6027\u7684\u7ebf\u6027\u56de\u5f52 \u00b6 \u5982\u679c\u6211\u4eec\u5e0c\u671b\u4e0d\u8981\u90a3\u4e48\u6fc0\u8fdb\uff0c\u90a3\u4e48\u53ef\u4ee5\u6784\u9020\u5176\u4ed6\u5047\u8bbe\u96c6, \u4f8b\u5982\uff1a \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \u8fd9\u4e2a\u96c6\u5408\u600e\u4e48\u6765\u7684\u5462\uff1f\u5176\u5b9e\u548c\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u6709\u5173\u7cfb\u3002\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u5c31\u662f\u7ed9\u53c2\u6570 \\mathbf{w} \\mathbf{w} (b\u88ab\u5305\u542b\u5728 \\mathbf{w} \\mathbf{w} \u4e2d)\u6dfb\u52a0\u4e00\u4e2a\u5148\u9a8c\u5206\u5e03\uff0c\u901a\u5e38\u7ed9 \\mathbf{w} \\mathbf{w} \u5148\u9a8c\u5206\u5e03\u4e3a\u67d0\u4e2a\u53c2\u6570\u5316\u7684\u9ad8\u65af\u5206\u5e03 \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \uff0c\u5373\u5047\u8bbe\u96c6\u4e3a \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \\label{linearhypothesis} \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \\label{linearhypothesis} \u90a3\u4e48\uff0c \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} , \u5e76\u4e14 Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} \u3002 \u8fd9\u65f6\uff0c\u635f\u5931\u51fd\u6570\u662f\u6709\u70b9\u9ebb\u70e6\u4e86: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ec0\u4e48\u8ddd\u79bb\u51fd\u6570\u53ef\u4ee5\u6c42\u5462\uff1f\u90a3\u5c31\u662fKullback-Leibler\u8ddd\u79bb\uff1a L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} \u6211\u4eec\u7565\u53bb\u4e0e \\theta \\theta \u65e0\u5173\u7684\u9879\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u7b80\u5316\u8fc7\u7684\u635f\u5931\u51fd\u6570\u5c31\u662f\u4ea4\u53c9\u71b5\uff1a L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} \u5e26\u5165\u9ad8\u65af\u5206\u5e03\u7684\u6982\u7387\u5bc6\u5ea6\u516c\u5f0f\u53ef\u5f97\uff1a \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \u7ecf\u9a8c\u516c\u5f0f\u4e5f\u53ef\u4ee5\u5199\u6210 L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. \u6c42\u89e3\uff1a \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*} \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*} \u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52 \u00b6 \u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u7684\u5047\u8bbe\u96c6\u6b63\u5982\u4e0a\u9762 \\eqref{linearhypothesis} \\eqref{linearhypothesis} \u5f0f\u6240\u63cf\u8ff0\u7684\u3002 \u4e0d\u8fc7\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u505a\u7684\u662f\u5728\u6211\u4eec\u6c42\u51fa\u6700\u4f18\u7684 \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \u540e\uff0c \u6211\u4eec\u600e\u4e48\u6837\u80fd\u505a\u5f97\u66f4\u597d\u3002\u5f53\u7136 \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \u901a\u5e38\u76f4\u63a5\u88ab\u8ba4\u4e3a\u7ed9\u5b9a\u4e00\u4e2a\u5206\u5e03\uff0c \u4eba\u4eec\u53eb\u5b83\u5148\u9a8c\u77e5\u8bc6\u3002\u6211\u89c9\u5f97\u52a0\u5165\u4e0a\u4e00\u8282 \u968f\u673a\u7ebf\u6027\u56de\u5f52 \u7684\u5148\u9a8c\u6a21\u578b\u5b66\u4e60\u66f4\u5408\u7406\u3002 \u6211\u4eec\u5728\u8d1d\u53f6\u65af\u56de\u5f52\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u505a\u4ec0\u4e48\uff1f \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u5206\u5e03 p(\\mathbf{w}) p(\\mathbf{w}) \u548c p(y \\vert \\mathbf{x}, \\mathbf{w}) p(y \\vert \\mathbf{x}, \\mathbf{w}) \uff0c\u5728\u8d1d\u53f6\u65af\u6846\u67b6\u4e2d\u76f8\u5f53\u4e8e\u6211\u4eec\u5df2\u7ecf\u83b7\u5f97\u4e86\u5168\u90e8\u7684 \u548c\u6982\u7387\u76f8\u5173\u7684\u4fe1\u606f\u3002\u73b0\u5728\u6211\u4eec\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u6211\u4eec\u5e0c\u671b\u6c42\u5f97\u6761\u4ef6\u6982\u7387 p(\\mathbf{w} \\vert S) p(\\mathbf{w} \\vert S) , \u6765\u6307\u5bfc\u6211\u4eec\u9009\u62e9\u53c2\u6570 \\mathbf{w} \\mathbf{w} \u3002 \u4ee4 \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T , \u6211\u4eec\u5df2\u77e5 \\begin{cases} \\tag{11} \\label{step1} p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0)\\\\ p({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) \\end{cases} \\begin{cases} \\tag{11} \\label{step1} p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0)\\\\ p({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) \\end{cases} \u8981\u6c42\u89e3 p(\\mathbf{w} \\vert \\mathbf{X}, \\mathbf{y}) p(\\mathbf{w} \\vert \\mathbf{X}, \\mathbf{y}) , \u6211\u4eec\u9700\u8981\u5f15\u5165\u4e0b\u9762\u8fd9\u4e2a\u7ed3\u8bba\uff1a \u591a\u5143\u9ad8\u65af\u5206\u5e03\u7684\u8fb9\u7f18\u5206\u5e03\u4e0e\u6761\u4ef6\u5206\u5e03 \uff1a \u5df2\u77e5\u5206\u5e03\uff1a \\begin{cases} \\tag{12} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \\begin{cases} \\tag{12} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \u6211\u4eec\u53ef\u5f97\uff1a \\begin{cases} \\tag{13} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} \\begin{cases} \\tag{13} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} (\u53c2\u8003\u81ea\uff1aPRML(2006\u5e74\u51fa\u7248)\u7b2c93\u9875) \u5e26\u5165\u4e0a\u9762\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u5f97\uff1a \\tag{14} \\label{step5} p(\\mathbf{w} \\vert {\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}), \\tag{14} \\label{step5} p(\\mathbf{w} \\vert {\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}), \u5176\u4e2d \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \uff0c \u5e76\u4e14 \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \u3002 \u8fd9\u4e2a\u516c\u5f0f\u8fd8\u4e0d\u591f\u7b80\u7ec3\uff0c\u6c42\u9006\u7684\u64cd\u4f5c\u6bd4\u8f83\u591a\uff0c\u6211\u53c2\u8003\u4e86 \u5361\u5c14\u66fc\u6ee4\u6ce2 \u7684\u516c\u5f0f\u6765\u5316\u7b80\u8fd9\u4e2a\u6c42\u89e3\u3002 \u6211\u62bd\u8c61\u4e86\u4e00\u4e0b\u5361\u5c14\u66fc\u6ee4\u6ce2\u4e2d\u7684\u4e00\u4e2a\u7ed3\u8bba\u3002 \u5df2\u77e5\u5206\u5e03 p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \u548c p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\mathbf{C}) p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\mathbf{C}) \uff0c\u6211\u4eec\u53ef\u5f97: p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\mu}_1, \\pmb{\\Sigma}_1) p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\mu}_1, \\pmb{\\Sigma}_1) \uff0c\u6ee1\u8db3 \\begin{cases} \\tag{15} \\label{kalmanfilter} \\mathbf{K} = \\pmb{\\Sigma}_0 \\mathbf{A}^T (\\mathbf{A} \\pmb{\\Sigma}_0 \\mathbf{A}^T + \\mathbf{C})^{-1};\\\\ \\pmb{\\Sigma}_1 = (\\mathbf{I} - \\mathbf{K} \\mathbf{A}) \\mathbf{\\Sigma}_0;\\\\ \\pmb{\\mu}_1 = \\pmb{\\mu}_0 + \\mathbf{K} [(\\mathbf{y} - \\mathbf{b}) - \\mathbf{A} \\pmb{\\mu}_0] \\end{cases} \\begin{cases} \\tag{15} \\label{kalmanfilter} \\mathbf{K} = \\pmb{\\Sigma}_0 \\mathbf{A}^T (\\mathbf{A} \\pmb{\\Sigma}_0 \\mathbf{A}^T + \\mathbf{C})^{-1};\\\\ \\pmb{\\Sigma}_1 = (\\mathbf{I} - \\mathbf{K} \\mathbf{A}) \\mathbf{\\Sigma}_0;\\\\ \\pmb{\\mu}_1 = \\pmb{\\mu}_0 + \\mathbf{K} [(\\mathbf{y} - \\mathbf{b}) - \\mathbf{A} \\pmb{\\mu}_0] \\end{cases} \u6700\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u7684\u6c42\u89e3\u516c\u5f0f\uff1a \\begin{cases} \\tag{16} \\label{step6} \\pmb{K} = {\\pmb{\\Sigma}}_0 \\mathbf{X}(2 \\mathbf{X}^{T} {\\pmb{\\Sigma}}_0 \\mathbf{X})^{-1};\\\\ \\pmb{\\Sigma} = (\\mathbf{I} - \\mathbf{K} \\mathbf{X}^T) {\\mathbf{\\Sigma}}_0;\\\\ \\pmb{\\mu} = {\\pmb{\\mu}}_{0} + \\mathbf{K}[\\mathbf{y} - \\mathbf{X}^{T} {\\pmb{\\mu}}_0]. \\\\ \\end{cases} \\begin{cases} \\tag{16} \\label{step6} \\pmb{K} = {\\pmb{\\Sigma}}_0 \\mathbf{X}(2 \\mathbf{X}^{T} {\\pmb{\\Sigma}}_0 \\mathbf{X})^{-1};\\\\ \\pmb{\\Sigma} = (\\mathbf{I} - \\mathbf{K} \\mathbf{X}^T) {\\mathbf{\\Sigma}}_0;\\\\ \\pmb{\\mu} = {\\pmb{\\mu}}_{0} + \\mathbf{K}[\\mathbf{y} - \\mathbf{X}^{T} {\\pmb{\\mu}}_0]. \\\\ \\end{cases}","title":"Regression"},{"location":"ML/04-Regression/#_1","text":"","title":"\u7ebf\u6027\u56de\u5f52\u95ee\u9898"},{"location":"ML/04-Regression/#_2","text":"\u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 (x, y) \\sim \\mathcal{D} (x, y) \\sim \\mathcal{D} \u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u5982\u679c y \\in \\mathbb{R} y \\in \\mathbb{R} , \u90a3\u4e48\u6c42\u89e3 P_\\mathcal{D}(y\\vert x) P_\\mathcal{D}(y\\vert x) \u7684\u95ee\u9898\u4e5f\u53eb\u505a\u56de\u5f52\u95ee\u9898\u3002 \u901a\u5e38\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} , \u6211\u4eec\u4ece\u5047\u8bbe\u96c6\u4e2d\u9009\u4e00\u4e2a\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u96c6\u5408 P_{\\theta^*}(y \\vert x) P_{\\theta^*}(y \\vert x) \u3002\u5bf9\u5e94\u7684\u4f18\u5316\u76ee\u6807\u662f \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1}","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"ML/04-Regression/#_3","text":"\u6211\u4eec\u53ef\u4ee5\u7b80\u5316\u8fd9\u4e2a\u95ee\u9898\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u503c\u540e\uff0c\u7ed9\u5b9a\u4e00\u4e2a x x , \u6211\u4eec\u901a\u5e38\u9884\u6d4b y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u9700\u8981\u6c42\u89e3\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u6761\u4ef6\u5206\u5e03\uff0c\u6211\u4eec\u53ef\u4ee5\u8f6c\u800c\u6c42\u89e3\u5206\u5e03\u6ee1\u8db3 \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u66f4\u6fc0\u8fdb\u7684\u5019\u9009\u96c6\u6765\u7b80\u5316\u95ee\u9898: \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \u6211\u4eec\u4f7f\u7528Wasserstein\u8ddd\u79bb(\u8f93\u8fd0\u82b1\u8d39\u51fd\u6570\u4e3a c(a, b) c(a, b) )\uff0c\u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \u5982\u679c c(a, b) = \\Vert a - b \\Vert^2_2 c(a, b) = \\Vert a - b \\Vert^2_2 , \u90a3\u4e48\u5c31\u662f\u5927\u5bb6\u719f\u77e5\u7684\u5e73\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} \u6ce8\u610f\uff1a\u6211\u6ca1\u6709\u63d0\u5230\u9ad8\u65af\u5206\u5e03\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u63d0\u5230\u9ad8\u65af\u5206\u5e03\u7684\u5047\u8bbe\u3002","title":"\u786e\u5b9a\u6027\u7684\u7ebf\u6027\u56de\u5f52"},{"location":"ML/04-Regression/#_4","text":"\u5982\u679c\u6211\u4eec\u5e0c\u671b\u4e0d\u8981\u90a3\u4e48\u6fc0\u8fdb\uff0c\u90a3\u4e48\u53ef\u4ee5\u6784\u9020\u5176\u4ed6\u5047\u8bbe\u96c6, \u4f8b\u5982\uff1a \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \u8fd9\u4e2a\u96c6\u5408\u600e\u4e48\u6765\u7684\u5462\uff1f\u5176\u5b9e\u548c\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u6709\u5173\u7cfb\u3002\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u5c31\u662f\u7ed9\u53c2\u6570 \\mathbf{w} \\mathbf{w} (b\u88ab\u5305\u542b\u5728 \\mathbf{w} \\mathbf{w} \u4e2d)\u6dfb\u52a0\u4e00\u4e2a\u5148\u9a8c\u5206\u5e03\uff0c\u901a\u5e38\u7ed9 \\mathbf{w} \\mathbf{w} \u5148\u9a8c\u5206\u5e03\u4e3a\u67d0\u4e2a\u53c2\u6570\u5316\u7684\u9ad8\u65af\u5206\u5e03 \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \uff0c\u5373\u5047\u8bbe\u96c6\u4e3a \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \\label{linearhypothesis} \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \\label{linearhypothesis} \u90a3\u4e48\uff0c \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} , \u5e76\u4e14 Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} \u3002 \u8fd9\u65f6\uff0c\u635f\u5931\u51fd\u6570\u662f\u6709\u70b9\u9ebb\u70e6\u4e86: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ec0\u4e48\u8ddd\u79bb\u51fd\u6570\u53ef\u4ee5\u6c42\u5462\uff1f\u90a3\u5c31\u662fKullback-Leibler\u8ddd\u79bb\uff1a L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} \u6211\u4eec\u7565\u53bb\u4e0e \\theta \\theta \u65e0\u5173\u7684\u9879\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u7b80\u5316\u8fc7\u7684\u635f\u5931\u51fd\u6570\u5c31\u662f\u4ea4\u53c9\u71b5\uff1a L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} \u5e26\u5165\u9ad8\u65af\u5206\u5e03\u7684\u6982\u7387\u5bc6\u5ea6\u516c\u5f0f\u53ef\u5f97\uff1a \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \u7ecf\u9a8c\u516c\u5f0f\u4e5f\u53ef\u4ee5\u5199\u6210 L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. \u6c42\u89e3\uff1a \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*} \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*}","title":"\u968f\u673a\u6027\u7684\u7ebf\u6027\u56de\u5f52"},{"location":"ML/04-Regression/#_5","text":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u7684\u5047\u8bbe\u96c6\u6b63\u5982\u4e0a\u9762 \\eqref{linearhypothesis} \\eqref{linearhypothesis} \u5f0f\u6240\u63cf\u8ff0\u7684\u3002 \u4e0d\u8fc7\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u505a\u7684\u662f\u5728\u6211\u4eec\u6c42\u51fa\u6700\u4f18\u7684 \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \u540e\uff0c \u6211\u4eec\u600e\u4e48\u6837\u80fd\u505a\u5f97\u66f4\u597d\u3002\u5f53\u7136 \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \u901a\u5e38\u76f4\u63a5\u88ab\u8ba4\u4e3a\u7ed9\u5b9a\u4e00\u4e2a\u5206\u5e03\uff0c \u4eba\u4eec\u53eb\u5b83\u5148\u9a8c\u77e5\u8bc6\u3002\u6211\u89c9\u5f97\u52a0\u5165\u4e0a\u4e00\u8282 \u968f\u673a\u7ebf\u6027\u56de\u5f52 \u7684\u5148\u9a8c\u6a21\u578b\u5b66\u4e60\u66f4\u5408\u7406\u3002 \u6211\u4eec\u5728\u8d1d\u53f6\u65af\u56de\u5f52\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u505a\u4ec0\u4e48\uff1f \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u5206\u5e03 p(\\mathbf{w}) p(\\mathbf{w}) \u548c p(y \\vert \\mathbf{x}, \\mathbf{w}) p(y \\vert \\mathbf{x}, \\mathbf{w}) \uff0c\u5728\u8d1d\u53f6\u65af\u6846\u67b6\u4e2d\u76f8\u5f53\u4e8e\u6211\u4eec\u5df2\u7ecf\u83b7\u5f97\u4e86\u5168\u90e8\u7684 \u548c\u6982\u7387\u76f8\u5173\u7684\u4fe1\u606f\u3002\u73b0\u5728\u6211\u4eec\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u6211\u4eec\u5e0c\u671b\u6c42\u5f97\u6761\u4ef6\u6982\u7387 p(\\mathbf{w} \\vert S) p(\\mathbf{w} \\vert S) , \u6765\u6307\u5bfc\u6211\u4eec\u9009\u62e9\u53c2\u6570 \\mathbf{w} \\mathbf{w} \u3002 \u4ee4 \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T , \u6211\u4eec\u5df2\u77e5 \\begin{cases} \\tag{11} \\label{step1} p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0)\\\\ p({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) \\end{cases} \\begin{cases} \\tag{11} \\label{step1} p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0)\\\\ p({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) \\end{cases} \u8981\u6c42\u89e3 p(\\mathbf{w} \\vert \\mathbf{X}, \\mathbf{y}) p(\\mathbf{w} \\vert \\mathbf{X}, \\mathbf{y}) , \u6211\u4eec\u9700\u8981\u5f15\u5165\u4e0b\u9762\u8fd9\u4e2a\u7ed3\u8bba\uff1a \u591a\u5143\u9ad8\u65af\u5206\u5e03\u7684\u8fb9\u7f18\u5206\u5e03\u4e0e\u6761\u4ef6\u5206\u5e03 \uff1a \u5df2\u77e5\u5206\u5e03\uff1a \\begin{cases} \\tag{12} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \\begin{cases} \\tag{12} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \u6211\u4eec\u53ef\u5f97\uff1a \\begin{cases} \\tag{13} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} \\begin{cases} \\tag{13} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} (\u53c2\u8003\u81ea\uff1aPRML(2006\u5e74\u51fa\u7248)\u7b2c93\u9875) \u5e26\u5165\u4e0a\u9762\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u5f97\uff1a \\tag{14} \\label{step5} p(\\mathbf{w} \\vert {\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}), \\tag{14} \\label{step5} p(\\mathbf{w} \\vert {\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}), \u5176\u4e2d \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \uff0c \u5e76\u4e14 \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \u3002 \u8fd9\u4e2a\u516c\u5f0f\u8fd8\u4e0d\u591f\u7b80\u7ec3\uff0c\u6c42\u9006\u7684\u64cd\u4f5c\u6bd4\u8f83\u591a\uff0c\u6211\u53c2\u8003\u4e86 \u5361\u5c14\u66fc\u6ee4\u6ce2 \u7684\u516c\u5f0f\u6765\u5316\u7b80\u8fd9\u4e2a\u6c42\u89e3\u3002 \u6211\u62bd\u8c61\u4e86\u4e00\u4e0b\u5361\u5c14\u66fc\u6ee4\u6ce2\u4e2d\u7684\u4e00\u4e2a\u7ed3\u8bba\u3002 \u5df2\u77e5\u5206\u5e03 p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) \u548c p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\mathbf{C}) p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\mathbf{C}) \uff0c\u6211\u4eec\u53ef\u5f97: p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\mu}_1, \\pmb{\\Sigma}_1) p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\mu}_1, \\pmb{\\Sigma}_1) \uff0c\u6ee1\u8db3 \\begin{cases} \\tag{15} \\label{kalmanfilter} \\mathbf{K} = \\pmb{\\Sigma}_0 \\mathbf{A}^T (\\mathbf{A} \\pmb{\\Sigma}_0 \\mathbf{A}^T + \\mathbf{C})^{-1};\\\\ \\pmb{\\Sigma}_1 = (\\mathbf{I} - \\mathbf{K} \\mathbf{A}) \\mathbf{\\Sigma}_0;\\\\ \\pmb{\\mu}_1 = \\pmb{\\mu}_0 + \\mathbf{K} [(\\mathbf{y} - \\mathbf{b}) - \\mathbf{A} \\pmb{\\mu}_0] \\end{cases} \\begin{cases} \\tag{15} \\label{kalmanfilter} \\mathbf{K} = \\pmb{\\Sigma}_0 \\mathbf{A}^T (\\mathbf{A} \\pmb{\\Sigma}_0 \\mathbf{A}^T + \\mathbf{C})^{-1};\\\\ \\pmb{\\Sigma}_1 = (\\mathbf{I} - \\mathbf{K} \\mathbf{A}) \\mathbf{\\Sigma}_0;\\\\ \\pmb{\\mu}_1 = \\pmb{\\mu}_0 + \\mathbf{K} [(\\mathbf{y} - \\mathbf{b}) - \\mathbf{A} \\pmb{\\mu}_0] \\end{cases} \u6700\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u7684\u6c42\u89e3\u516c\u5f0f\uff1a \\begin{cases} \\tag{16} \\label{step6} \\pmb{K} = {\\pmb{\\Sigma}}_0 \\mathbf{X}(2 \\mathbf{X}^{T} {\\pmb{\\Sigma}}_0 \\mathbf{X})^{-1};\\\\ \\pmb{\\Sigma} = (\\mathbf{I} - \\mathbf{K} \\mathbf{X}^T) {\\mathbf{\\Sigma}}_0;\\\\ \\pmb{\\mu} = {\\pmb{\\mu}}_{0} + \\mathbf{K}[\\mathbf{y} - \\mathbf{X}^{T} {\\pmb{\\mu}}_0]. \\\\ \\end{cases} \\begin{cases} \\tag{16} \\label{step6} \\pmb{K} = {\\pmb{\\Sigma}}_0 \\mathbf{X}(2 \\mathbf{X}^{T} {\\pmb{\\Sigma}}_0 \\mathbf{X})^{-1};\\\\ \\pmb{\\Sigma} = (\\mathbf{I} - \\mathbf{K} \\mathbf{X}^T) {\\mathbf{\\Sigma}}_0;\\\\ \\pmb{\\mu} = {\\pmb{\\mu}}_{0} + \\mathbf{K}[\\mathbf{y} - \\mathbf{X}^{T} {\\pmb{\\mu}}_0]. \\\\ \\end{cases}","title":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52"},{"location":"ML/05-AdaBoost/","text":"Boosting \u00b6 \u5f31\u5206\u7c7b\u5668\u5230\u5f3a\u5206\u7c7b\u5668\uff0c\u8fd9\u91cc\u6709\u8da3\u7684\u4e1c\u897f\u53ef\u592a\u591a\u4e86\uff0c\u6211\u5148\u628a\u4e3b\u5e72\u7b97\u6cd5Adaboost\u6574\u7406\u4e00\u4e0b\u3002 Adaboost \u00b6 \u5b9a\u4e491\uff1a( Weak hypothesis class ). We call a hypothesis class is a weak hypothesis class of data (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} we means that \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \u8fd9\u91cc\u7684 \\mathbf{p}_k \\mathbf{p}_k \u662f\u5728\u6837\u672c\u4e0a\u7684\u67d0\u4e2a\u5206\u5e03\uff0c\u5728\u540e\u9762\u4f1a\u6709\u63d0\u5230, \u67d0\u4e00\u79cd\u8bbe\u5b9a\u65b9\u5f0f\u3002 \u8fd9\u91cc\u6307\u7684\u662f\u67d0\u4e00\u7c7b\u5206\u7c7b\u7b97\u6cd5\u7ed9\u51fa\u4efb\u610f\u7684\u8f93\u5165\u6837\u672c\uff0c \u53ea\u80fd\u8fd4\u56de\u4e00\u4e2a\u6bd4\u8f83\u5f31\u7684\u5206\u7c7b\u5668\u3002\u9519\u8bef\u7387\u5c0f\u4e8e50%\u3002 Adaboost \u5047\u8bbe\u6211\u4eec\u88ab\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668\u7684\u96c6\u5408 \\mathcal{H}_{weak} \\mathcal{H}_{weak} , \u6211\u4eec\u5c06\u4ece\u4e0b\u9762\u8fd9\u4e2a\u5047\u8bbe\u96c6\u4e2d\u5b66\u4e60\u4e00\u4e2a\u5f3a\u5206\u7c7b\u5668\uff1a \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} Adaboot\u89e3\u51b3\u7684\u95ee\u9898\u662f: \u6570\u636e\u5728 (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} , \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \uff0c h_i(\\mathbf{x}) \\in\\{-1, 1\\} h_i(\\mathbf{x}) \\in\\{-1, 1\\} \u3002 \u6211\u4eec\u8981\u4ece \\mathcal{H}_{ada} \\mathcal{H}_{ada} \u4e2d\u9009\u51fa\u4e00\u4e2a\u6700\u597d\u7684\u5206\u7c7b\u5668\uff0c\u80fd\u591f\u66f4\u597d\u5730\u62df\u5408\u771f\u5b9e\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u3002 \u8fd9\u91cc\u4f7f\u7528\u7684\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u5462\uff1f\u56e0\u4e3a\u5b83\u6709\u5f88\u597d\u7684\u6570\u5b66\u6027\u8d28\u3002 \u6211\u4eec\u53ef\u4ee5\u7528\u5750\u6807\u68af\u5ea6\u4e0b\u964d\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\uff0c\u5e76\u4e14\u8bbe\u5b9a\u6bcf\u4e00\u6b65\u7684\u6b65\u957f\u4e3a\u6700\u4f18\u6b65\u957f\u3002 \u4e5f\u5c31\u662f\u6bcf\u4e00\u6b65\u7684\u4f18\u5316\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u4e00\u4e2a\u5b50\u95ee\u9898\u6765\u6c42\u89e3\u5f53\u524d\u7684\u6700\u4f18\u6b65\u957f: \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \u4ee4 L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u67d0\u4e00\u4e2a\u6837\u672c\u96c6 S S \u4e0a\u7684\u5206\u5e03 \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} , \u6ee1\u8db3 \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u4ee5\u53ca \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \u90a3\u4e48 \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \u7efc\u4e0a\u6240\u8ff0\uff0cAdaboost\u7b97\u6cd5\u7684\u6d41\u7a0b\u662f\uff1a Step1: \u521d\u59cb\u5316 \\pmb{\\alpha} = \\pmb{0} \\pmb{\\alpha} = \\pmb{0} , k = 1 k = 1 , \\mathcal{H}_{weak} = \\{\\} \\mathcal{H}_{weak} = \\{\\} ; Step2: \u6c42\u89e3 \\mathbf{p}_{k}(S) \\mathbf{p}_{k}(S) , \u4ece\u6837\u672c \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \u4e2d\u5b66\u4e60\u51fa\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668 h_k h_k , \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} ; \u5f31\u5206\u7c7b\u5668\u7684\u5b66\u4e60\u65b9\u5f0f\u5f88\u91cd\u8981\uff0c\u8fd9\u4e2a\u5728\u8bc1\u660e\u91cc\u4f1a\u4f53\u73b0; Step3: \u6c42\u89e3 \\epsilon_k \\epsilon_k , \\eta_k \\eta_k ; Step4: \u66f4\u65b0 \\pmb{\\alpha} \\pmb{\\alpha} \u548c k k , \u8fd4\u56de\u5230\u7b2c\u4e8c\u6b65\u3002 \u8bef\u5dee\u5206\u6790 \u00b6 \u9996\u5148 \\epsilon_k \\le \\frac{1}{2} - \\gamma \\epsilon_k \\le \\frac{1}{2} - \\gamma , \u90a3\u4e48 \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \u5982\u679c\u53d6 \\pmb{\\alpha}_0 = \\pmb{0} \\pmb{\\alpha}_0 = \\pmb{0} \uff0c\u90a3\u4e48 L_{S}(\\pmb{\\alpha}_0) = 1 L_{S}(\\pmb{\\alpha}_0) = 1 \u3002 \u6240\u4ee5\uff0c L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) \u3002 \u6211\u4eec\u5f53\u7136\u6bd4\u8f83\u5173\u5fc3 0-1 0-1 \u8bef\u5dee\u51fd\u6570\uff1a l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} , \u5b83\u5c0f\u4e8e\u7b49\u4e8e\u8bef\u5dee\u51fd\u6570 l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) , \u6240\u4ee5 \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align} \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align}","title":"AdaBoost"},{"location":"ML/05-AdaBoost/#boosting","text":"\u5f31\u5206\u7c7b\u5668\u5230\u5f3a\u5206\u7c7b\u5668\uff0c\u8fd9\u91cc\u6709\u8da3\u7684\u4e1c\u897f\u53ef\u592a\u591a\u4e86\uff0c\u6211\u5148\u628a\u4e3b\u5e72\u7b97\u6cd5Adaboost\u6574\u7406\u4e00\u4e0b\u3002","title":"Boosting"},{"location":"ML/05-AdaBoost/#adaboost","text":"\u5b9a\u4e491\uff1a( Weak hypothesis class ). We call a hypothesis class is a weak hypothesis class of data (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} we means that \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \u8fd9\u91cc\u7684 \\mathbf{p}_k \\mathbf{p}_k \u662f\u5728\u6837\u672c\u4e0a\u7684\u67d0\u4e2a\u5206\u5e03\uff0c\u5728\u540e\u9762\u4f1a\u6709\u63d0\u5230, \u67d0\u4e00\u79cd\u8bbe\u5b9a\u65b9\u5f0f\u3002 \u8fd9\u91cc\u6307\u7684\u662f\u67d0\u4e00\u7c7b\u5206\u7c7b\u7b97\u6cd5\u7ed9\u51fa\u4efb\u610f\u7684\u8f93\u5165\u6837\u672c\uff0c \u53ea\u80fd\u8fd4\u56de\u4e00\u4e2a\u6bd4\u8f83\u5f31\u7684\u5206\u7c7b\u5668\u3002\u9519\u8bef\u7387\u5c0f\u4e8e50%\u3002 Adaboost \u5047\u8bbe\u6211\u4eec\u88ab\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668\u7684\u96c6\u5408 \\mathcal{H}_{weak} \\mathcal{H}_{weak} , \u6211\u4eec\u5c06\u4ece\u4e0b\u9762\u8fd9\u4e2a\u5047\u8bbe\u96c6\u4e2d\u5b66\u4e60\u4e00\u4e2a\u5f3a\u5206\u7c7b\u5668\uff1a \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} Adaboot\u89e3\u51b3\u7684\u95ee\u9898\u662f: \u6570\u636e\u5728 (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} , \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \uff0c h_i(\\mathbf{x}) \\in\\{-1, 1\\} h_i(\\mathbf{x}) \\in\\{-1, 1\\} \u3002 \u6211\u4eec\u8981\u4ece \\mathcal{H}_{ada} \\mathcal{H}_{ada} \u4e2d\u9009\u51fa\u4e00\u4e2a\u6700\u597d\u7684\u5206\u7c7b\u5668\uff0c\u80fd\u591f\u66f4\u597d\u5730\u62df\u5408\u771f\u5b9e\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u3002 \u8fd9\u91cc\u4f7f\u7528\u7684\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u5462\uff1f\u56e0\u4e3a\u5b83\u6709\u5f88\u597d\u7684\u6570\u5b66\u6027\u8d28\u3002 \u6211\u4eec\u53ef\u4ee5\u7528\u5750\u6807\u68af\u5ea6\u4e0b\u964d\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\uff0c\u5e76\u4e14\u8bbe\u5b9a\u6bcf\u4e00\u6b65\u7684\u6b65\u957f\u4e3a\u6700\u4f18\u6b65\u957f\u3002 \u4e5f\u5c31\u662f\u6bcf\u4e00\u6b65\u7684\u4f18\u5316\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u4e00\u4e2a\u5b50\u95ee\u9898\u6765\u6c42\u89e3\u5f53\u524d\u7684\u6700\u4f18\u6b65\u957f: \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \u4ee4 L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u67d0\u4e00\u4e2a\u6837\u672c\u96c6 S S \u4e0a\u7684\u5206\u5e03 \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} , \u6ee1\u8db3 \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u4ee5\u53ca \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \u90a3\u4e48 \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \u7efc\u4e0a\u6240\u8ff0\uff0cAdaboost\u7b97\u6cd5\u7684\u6d41\u7a0b\u662f\uff1a Step1: \u521d\u59cb\u5316 \\pmb{\\alpha} = \\pmb{0} \\pmb{\\alpha} = \\pmb{0} , k = 1 k = 1 , \\mathcal{H}_{weak} = \\{\\} \\mathcal{H}_{weak} = \\{\\} ; Step2: \u6c42\u89e3 \\mathbf{p}_{k}(S) \\mathbf{p}_{k}(S) , \u4ece\u6837\u672c \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \u4e2d\u5b66\u4e60\u51fa\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668 h_k h_k , \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} ; \u5f31\u5206\u7c7b\u5668\u7684\u5b66\u4e60\u65b9\u5f0f\u5f88\u91cd\u8981\uff0c\u8fd9\u4e2a\u5728\u8bc1\u660e\u91cc\u4f1a\u4f53\u73b0; Step3: \u6c42\u89e3 \\epsilon_k \\epsilon_k , \\eta_k \\eta_k ; Step4: \u66f4\u65b0 \\pmb{\\alpha} \\pmb{\\alpha} \u548c k k , \u8fd4\u56de\u5230\u7b2c\u4e8c\u6b65\u3002","title":"Adaboost"},{"location":"ML/05-AdaBoost/#_1","text":"\u9996\u5148 \\epsilon_k \\le \\frac{1}{2} - \\gamma \\epsilon_k \\le \\frac{1}{2} - \\gamma , \u90a3\u4e48 \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \u5982\u679c\u53d6 \\pmb{\\alpha}_0 = \\pmb{0} \\pmb{\\alpha}_0 = \\pmb{0} \uff0c\u90a3\u4e48 L_{S}(\\pmb{\\alpha}_0) = 1 L_{S}(\\pmb{\\alpha}_0) = 1 \u3002 \u6240\u4ee5\uff0c L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) \u3002 \u6211\u4eec\u5f53\u7136\u6bd4\u8f83\u5173\u5fc3 0-1 0-1 \u8bef\u5dee\u51fd\u6570\uff1a l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} , \u5b83\u5c0f\u4e8e\u7b49\u4e8e\u8bef\u5dee\u51fd\u6570 l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) , \u6240\u4ee5 \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align} \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align}","title":"\u8bef\u5dee\u5206\u6790"},{"location":"ML/06-PAC/","text":"PAC: Principal Component Analysis \u00b6 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5728\u96c6\u5408 \\mathbb{R}^{d} \\mathbb{R}^{d} \u5b58\u5728\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} , \u5b83\u7684\u6837\u672c\u7528\u7b26\u53f7 \\mathbf{x} \\mathbf{x} \u8868\u793a\u3002 \u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u5728 \\mathbb{R}^{k} \\mathbb{R}^{k} \u4e0a\u7684\u5206\u5e03 p(\\mathbf{y}) p(\\mathbf{y}) \u6700\u63a5\u8fd1\u5206\u5e03 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \uff0c \u8fd9\u91cc\u7684\u6700\u63a5\u8fd1\uff0c\u6307\u7684\u662f p(\\mathbf{y}) p(\\mathbf{y}) \u5305\u542b\u6700\u591a p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u7684 \u4fe1\u606f \u3002 \u4ec0\u4e48\u53eb\u505a\u4fdd\u7559\u6700\u591a\u7684\u4fe1\u606f\u5462\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u7f16\u7801\u5668 E:\\mathbf{x} \\rightarrow \\mathbf{y} E:\\mathbf{x} \\rightarrow \\mathbf{y} (\u5176\u4e2d y \\in \\mathbb{R}^k y \\in \\mathbb{R}^k \u4ee5\u53ca k < d k < d ), \u4ee5\u53ca\u4e00\u4e2a\u89e3\u7801\u5668 D:\\mathbf{y} \\rightarrow \\mathbf{x} D:\\mathbf{y} \\rightarrow \\mathbf{x} , \u4f7f\u5f97 D(E(\\mathbf{x})) D(E(\\mathbf{x})) \u6700\u63a5\u8fd1 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) : \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \u8fd9\u4e2a\u95ee\u9898\u63cf\u8ff0\u8fd8\u4e0d\u662f\u5f88\u5408\u9002\uff0c\u6211\u9700\u8981\u518d\u601d\u8003\u4e00\u4e0b\u3002 PAC \u00b6 \u5bf9\u4e8e\u6837\u672c \\mathbf{x} \\in \\mathbb{R}^d \\mathbf{x} \\in \\mathbb{R}^d , \u670d\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c PAC\u7684\u4f18\u5316\u76ee\u6807\u662f \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \u5176\u4e2d \\mathbf{U} \\in \\mathbb{R}^{d\\times k} \\mathbf{U} \\in \\mathbb{R}^{d\\times k} , \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \u5e76\u4e14 k \\le d k \\le d \u3002 \u7ed9\u5b9a\u6837\u672c\u96c6 S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} \uff0c\u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. PAC\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u6c42\u89e3\u4e0a\u9762\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898 \\eqref{pac_empirical_loss} \\eqref{pac_empirical_loss} \uff0c\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u5c31\u662f\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u7684\u6c42\u89e3\u65b9\u6cd5\u3002 \u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635 \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \uff0c\u5e76\u4e14 \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \uff0c \u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u7684\u77e9\u9635 \\mathbf{U} \\mathbf{U} , \u6ee1\u8db3 \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \u3002 \u5e76\u4e14\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u5411\u91cf \\mathbf{x} \\mathbf{x} , \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \u7684\u6700\u4f18\u89e3\u4e3a \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \u3002 \u7efc\u5408\u4e0a\u9762\u8fd9\u4e24\u6761\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \u56e0\u4e3a \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \u662f\u5b9e\u5bf9\u79f0\u77e9\u9635\uff0c\u6240\u4ee5\u80fd\u591f\u6b63\u4ea4\u5206\u89e3\u4e3a \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e09\u4e2a\u77e9\u9635\u7684\u4e58\u79ef\uff0c\u5176\u4e2d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \u4ee5\u53ca \\mathbf{D} \\mathbf{D} \u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5e76\u4e14 D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} \u3002\u6240\u4ee5\u539f\u95ee\u9898\u7b49\u4ef7\u4e8e\u4f18\u5316\u4e0b\u9762\u8fd9\u4e2a\u95ee\u9898\uff1a \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \u63a5\u4e0b\u6765\u662f\u4e00\u4e2a\u77e9\u9635\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u6269\u5c55\u77e9\u9635 \\mathbf{H} \\mathbf{H} \u7684\u5217\uff0c\u5f62\u6210\u65b0\u7684\u77e9\u9635 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}} , \u6ee1\u8db3 \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \u3002\u90a3\u4e48 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d , \u5373 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \u3002\u518d\u6709\uff0c \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \u3002 \u7efc\u4e0a \\eqref{proof_step2} \\eqref{proof_step2} \u5f0f\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8f6c\u5316\u4e3a \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \u5f53 \\mathbf{E} \\mathbf{E} \u7531 \\mathbf{F} \\mathbf{F} \u524d k k \u5217\u7ec4\u6210\uff0c\u90a3\u4e48 \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \u5373\u95ee\u9898 \\eqref{proof_step2} \\eqref{proof_step2} \u7684\u6700\u503c\u4e3a \\sum^{k}_{i=1} D_{ii} \\sum^{k}_{i=1} D_{ii} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u53d1\u73b0 \\mathbf{E} \\mathbf{E} \u6070\u597d\u662f\u77e9\u9635 \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \u7684\u6700\u5927 k k \u4e2a\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\u3002\u7279\u5f81\u503c\u5927\uff0c\u5728 \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e2d\u5f71\u54cd\u4e5f\u5927\uff0c\u5373\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u539f\u77e9\u9635\u7684\u4e3b\u6210\u5206\u3002\u6240\u4ee5\u6211\u4eec\u4e5f\u53eb\u8fd9\u79cd\u65b9\u6cd5\u4e3a \u4e3b\u6210\u5206\u5206\u6790 \u3002","title":"PAC"},{"location":"ML/06-PAC/#pac-principal-component-analysis","text":"","title":"PAC: Principal Component Analysis"},{"location":"ML/06-PAC/#_1","text":"\u5728\u96c6\u5408 \\mathbb{R}^{d} \\mathbb{R}^{d} \u5b58\u5728\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} , \u5b83\u7684\u6837\u672c\u7528\u7b26\u53f7 \\mathbf{x} \\mathbf{x} \u8868\u793a\u3002 \u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u5728 \\mathbb{R}^{k} \\mathbb{R}^{k} \u4e0a\u7684\u5206\u5e03 p(\\mathbf{y}) p(\\mathbf{y}) \u6700\u63a5\u8fd1\u5206\u5e03 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \uff0c \u8fd9\u91cc\u7684\u6700\u63a5\u8fd1\uff0c\u6307\u7684\u662f p(\\mathbf{y}) p(\\mathbf{y}) \u5305\u542b\u6700\u591a p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u7684 \u4fe1\u606f \u3002 \u4ec0\u4e48\u53eb\u505a\u4fdd\u7559\u6700\u591a\u7684\u4fe1\u606f\u5462\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u7f16\u7801\u5668 E:\\mathbf{x} \\rightarrow \\mathbf{y} E:\\mathbf{x} \\rightarrow \\mathbf{y} (\u5176\u4e2d y \\in \\mathbb{R}^k y \\in \\mathbb{R}^k \u4ee5\u53ca k < d k < d ), \u4ee5\u53ca\u4e00\u4e2a\u89e3\u7801\u5668 D:\\mathbf{y} \\rightarrow \\mathbf{x} D:\\mathbf{y} \\rightarrow \\mathbf{x} , \u4f7f\u5f97 D(E(\\mathbf{x})) D(E(\\mathbf{x})) \u6700\u63a5\u8fd1 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) : \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \u8fd9\u4e2a\u95ee\u9898\u63cf\u8ff0\u8fd8\u4e0d\u662f\u5f88\u5408\u9002\uff0c\u6211\u9700\u8981\u518d\u601d\u8003\u4e00\u4e0b\u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"ML/06-PAC/#pac","text":"\u5bf9\u4e8e\u6837\u672c \\mathbf{x} \\in \\mathbb{R}^d \\mathbf{x} \\in \\mathbb{R}^d , \u670d\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c PAC\u7684\u4f18\u5316\u76ee\u6807\u662f \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \u5176\u4e2d \\mathbf{U} \\in \\mathbb{R}^{d\\times k} \\mathbf{U} \\in \\mathbb{R}^{d\\times k} , \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \u5e76\u4e14 k \\le d k \\le d \u3002 \u7ed9\u5b9a\u6837\u672c\u96c6 S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} \uff0c\u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. PAC\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u6c42\u89e3\u4e0a\u9762\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898 \\eqref{pac_empirical_loss} \\eqref{pac_empirical_loss} \uff0c\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u5c31\u662f\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u7684\u6c42\u89e3\u65b9\u6cd5\u3002 \u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635 \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \uff0c\u5e76\u4e14 \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \uff0c \u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u7684\u77e9\u9635 \\mathbf{U} \\mathbf{U} , \u6ee1\u8db3 \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \u3002 \u5e76\u4e14\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u5411\u91cf \\mathbf{x} \\mathbf{x} , \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \u7684\u6700\u4f18\u89e3\u4e3a \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \u3002 \u7efc\u5408\u4e0a\u9762\u8fd9\u4e24\u6761\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \u56e0\u4e3a \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \u662f\u5b9e\u5bf9\u79f0\u77e9\u9635\uff0c\u6240\u4ee5\u80fd\u591f\u6b63\u4ea4\u5206\u89e3\u4e3a \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e09\u4e2a\u77e9\u9635\u7684\u4e58\u79ef\uff0c\u5176\u4e2d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \u4ee5\u53ca \\mathbf{D} \\mathbf{D} \u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5e76\u4e14 D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} \u3002\u6240\u4ee5\u539f\u95ee\u9898\u7b49\u4ef7\u4e8e\u4f18\u5316\u4e0b\u9762\u8fd9\u4e2a\u95ee\u9898\uff1a \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \u63a5\u4e0b\u6765\u662f\u4e00\u4e2a\u77e9\u9635\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u6269\u5c55\u77e9\u9635 \\mathbf{H} \\mathbf{H} \u7684\u5217\uff0c\u5f62\u6210\u65b0\u7684\u77e9\u9635 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}} , \u6ee1\u8db3 \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \u3002\u90a3\u4e48 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d , \u5373 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \u3002\u518d\u6709\uff0c \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \u3002 \u7efc\u4e0a \\eqref{proof_step2} \\eqref{proof_step2} \u5f0f\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8f6c\u5316\u4e3a \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \u5f53 \\mathbf{E} \\mathbf{E} \u7531 \\mathbf{F} \\mathbf{F} \u524d k k \u5217\u7ec4\u6210\uff0c\u90a3\u4e48 \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \u5373\u95ee\u9898 \\eqref{proof_step2} \\eqref{proof_step2} \u7684\u6700\u503c\u4e3a \\sum^{k}_{i=1} D_{ii} \\sum^{k}_{i=1} D_{ii} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u53d1\u73b0 \\mathbf{E} \\mathbf{E} \u6070\u597d\u662f\u77e9\u9635 \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \u7684\u6700\u5927 k k \u4e2a\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\u3002\u7279\u5f81\u503c\u5927\uff0c\u5728 \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e2d\u5f71\u54cd\u4e5f\u5927\uff0c\u5373\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u539f\u77e9\u9635\u7684\u4e3b\u6210\u5206\u3002\u6240\u4ee5\u6211\u4eec\u4e5f\u53eb\u8fd9\u79cd\u65b9\u6cd5\u4e3a \u4e3b\u6210\u5206\u5206\u6790 \u3002","title":"PAC"},{"location":"ML/07-KalmanFilter/","text":"\u5361\u5c14\u66fc\u6ee4\u6ce2 \u00b6 \u9690\u9a6c\u5c14\u53ef\u592b\u94fe \u00b6 \u7b80\u5355\u5b9a\u4e49\u4e00\u4e0b\u9690\u9a6c\u5c14\u53ef\u592b\u94fe\uff1a \\tag{1} \\label{HMM} \\xrightarrow[]{p(\\mathbf{x}_0)}(\\mathbf{x}_0 \\xrightarrow[]{p(\\mathbf{z}_0 \\vert \\mathbf{x}_0)}\\mathbf{z}_0) \\xrightarrow[]{p(\\mathbf{x}_1 \\vert \\mathbf{x}_0)} (\\mathbf{x}_1 \\xrightarrow[]{p(\\mathbf{z}_1 \\vert \\mathbf{x}_1)} \\mathbf{z}_1) \\rightarrow \\cdots . \\tag{1} \\label{HMM} \\xrightarrow[]{p(\\mathbf{x}_0)}(\\mathbf{x}_0 \\xrightarrow[]{p(\\mathbf{z}_0 \\vert \\mathbf{x}_0)}\\mathbf{z}_0) \\xrightarrow[]{p(\\mathbf{x}_1 \\vert \\mathbf{x}_0)} (\\mathbf{x}_1 \\xrightarrow[]{p(\\mathbf{z}_1 \\vert \\mathbf{x}_1)} \\mathbf{z}_1) \\rightarrow \\cdots . \u5176\u4e2d p(\\mathbf{x}_0) p(\\mathbf{x}_0) \u8868\u793a\u521d\u59cb\u72b6\u6001\u6982\u7387\uff0c p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_t) p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_t) \u8868\u793a\u9690\u53d8\u91cf\u72b6\u6001\u8f6c\u79fb\u6982\u7387\uff0c p(\\mathbf{z}\\vert \\mathbf{x}) p(\\mathbf{z}\\vert \\mathbf{x}) \u8868\u793a\u5b9e\u53d8\u91cf\u6761\u4ef6\u6982\u7387\u3002 \u5728\u9690\u9a6c\u5c14\u53ef\u592b\u94fe\u4e2d\uff0c\u6211\u4eec\u53ea\u80fd\u89c2\u6d4b\u5230\u53d8\u91cf (\\mathbf{z}_0 , \\mathbf{z}_1,\\ldots) (\\mathbf{z}_0 , \\mathbf{z}_1,\\ldots) \u7684\u503c\uff0c\u800c\u65e0\u6cd5\u83b7\u5f97\u9690\u53d8\u91cf\u7684\u503c\u3002 \u8fd9\u4e2a\u6a21\u578b\u6709\u975e\u5e38\u5f3a\u7684\u73b0\u5b9e\u610f\u4e49\uff0c\u901a\u5e38\u52a8\u529b\u5b66\u7cfb\u7edf\u7684\u8fd0\u52a8\u662f\u4e00\u4e2a\u9a6c\u5c14\u53ef\u592b\u94fe\uff0c\u800c\u6211\u4eec\u65e0\u6cd5\u83b7\u5f97\u51c6\u786e\u7684\u52a8\u529b\u5b66\u6a21\u578b\u7684\u72b6\u6001 \\mathbf{x} \\mathbf{x} \uff0c\u53ea\u80fd\u4f7f\u7528\u4f20\u611f\u5668\u6765\u6d4b\u91cf\u76f8\u5e94\u72b6\u6001\u7684\u4e00\u4e2a\u76f8\u5173\u91cf \\mathbf{z} \\mathbf{z} \u3002 \u9a6c\u5c14\u53ef\u592b\u6a21\u578b\u5efa\u6a21 \u00b6 \u5bf9\u4e8e\u968f\u673a\u8fc7\u7a0b\u7684\u5047\u8bbe\u96c6\uff0c\u6211\u4eec\u901a\u5e38\u8bbe\u5b9a\u4e3a\u9ad8\u65af\u5206\u5e03\uff1a \\tag{2} \\label{hmm_hypothesis} \\mathcal{H} = \\left\\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\pmb{\\mu}_1(\\mathbf{x}_t), \\pmb{\\Sigma}_1(\\mathbf{x}_t)), p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_2(\\mathbf{x}), \\pmb{\\Sigma}_2)(\\mathbf{x})) \\right\\}. \\tag{2} \\label{hmm_hypothesis} \\mathcal{H} = \\left\\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\pmb{\\mu}_1(\\mathbf{x}_t), \\pmb{\\Sigma}_1(\\mathbf{x}_t)), p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_2(\\mathbf{x}), \\pmb{\\Sigma}_2)(\\mathbf{x})) \\right\\}. \u6211\u4eec\u5e0c\u671b\u4ece\u5047\u8bbe\u96c6\u4e2d\u627e\u51fa\u4e00\u4e2a\u5143\u7ec4\u6700\u63a5\u8fd1\u771f\u5b9e\u7684\u72b6\u6001\u8f6c\u79fb (p_{\\mathcal{D}}(\\mathbf{x}_0), p_{\\mathcal{D}}(\\mathbf{x}_{t+1}\\vert \\mathbf{x}_{t}), p_{\\mathcal{D}}(\\mathbf{z} \\vert \\mathbf{x})) (p_{\\mathcal{D}}(\\mathbf{x}_0), p_{\\mathcal{D}}(\\mathbf{x}_{t+1}\\vert \\mathbf{x}_{t}), p_{\\mathcal{D}}(\\mathbf{z} \\vert \\mathbf{x})) \u3002 \u91c7\u6837\u4e00\u6761\u6837\u672c \\tau = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t) \\tau = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t) , \u90a3\u4e48\uff1a \\tag{3} \\label{trueprobability} p_{\\mathcal{D}}(\\tau) = \\int p_{\\mathcal{D}}(\\mathbf{x}_0) p_{\\mathcal{D}}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\mathcal{D}}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\mathcal{D}}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\mathcal{D}}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \\tag{3} \\label{trueprobability} p_{\\mathcal{D}}(\\tau) = \\int p_{\\mathcal{D}}(\\mathbf{x}_0) p_{\\mathcal{D}}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\mathcal{D}}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\mathcal{D}}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\mathcal{D}}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \\tag{4} \\label{modelprobability} p_{\\theta}(\\tau) = \\int p_{\\theta}(\\mathbf{x}_0) p_{\\theta}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\theta}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\theta}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\theta}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \\tag{4} \\label{modelprobability} p_{\\theta}(\\tau) = \\int p_{\\theta}(\\mathbf{x}_0) p_{\\theta}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\theta}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\theta}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\theta}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \u5b9a\u4e49\u635f\u5931\u51fd\u6570\u4e3a\uff1a \\tag{5} \\label{trueloss} L_{D}(\\theta) = \\mathbb{E}_{\\tau\\sim\\mathcal{D}}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\tau)}{p_{\\theta}(\\tau)} \\right)\\right]. \\tag{5} \\label{trueloss} L_{D}(\\theta) = \\mathbb{E}_{\\tau\\sim\\mathcal{D}}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\tau)}{p_{\\theta}(\\tau)} \\right)\\right]. \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u4e3a\uff1a \\tag{6} \\label{empirical} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1}\\ln\\left( {p_{\\theta}(\\tau)} \\right). \\tag{6} \\label{empirical} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1}\\ln\\left( {p_{\\theta}(\\tau)} \\right). \u8fd9\u4e2a\u51fd\u6570\u5f88\u96be\u4f18\u5316\uff0c\u6240\u4ee5\u9700\u8981\u5176\u4ed6\u65b9\u6cd5\uff0c\u8fd9\u91cc\u8d85\u51fa\u4e86\u6211\u7684\u77e5\u8bc6\u8303\u56f4\uff0c\u6240\u4ee5\u5148\u653e\u5230\u4e00\u8fb9\u3002 \u5361\u5c14\u66fc\u6ee4\u6ce2 \u00b6 \u5361\u5c14\u66fc\u6ee4\u6ce2\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\uff1a \\tag{7} \\label{kalman_hypothesis} \\mathcal{H} = \\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\pmb{\\Sigma}_1), \\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x}_t + \\mathbf{d}, \\pmb{\\Sigma}_2)) \\}. \\tag{7} \\label{kalman_hypothesis} \\mathcal{H} = \\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\pmb{\\Sigma}_1), \\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x}_t + \\mathbf{d}, \\pmb{\\Sigma}_2)) \\}. \u800c\u4e14\u6211\u4eec\u5df2\u7ecf\u627e\u5230\u4e86\u5bf9\u5e94\u7684\u6700\u4f18\u6a21\u578b: \\begin{cases} \\tag{8} \\label{kalman_model} p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0),\\\\ p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\mathbf{Q}),\\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x} + \\mathbf{d}, \\mathbf{R}). \\end{cases} \\begin{cases} \\tag{8} \\label{kalman_model} p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0),\\\\ p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\mathbf{Q}),\\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x} + \\mathbf{d}, \\mathbf{R}). \\end{cases} \u5361\u5c14\u66fc\u6ee4\u6ce2\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f \uff1a\u7ed9\u5b9a\u4e00\u6761\u91c7\u6837 (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t, \\ldots) (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t, \\ldots) , \u4f30\u8ba1\u5206\u5e03 p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) \u3002 \u8fd9\u540c\u6837\u4e5f\u662f\u5bf9 \u6ee4\u6ce2 \u505a\u7684\u975e\u5e38\u4f18\u96c5\u7684 \u6570\u5b66\u5b9a\u4e49 \uff0c\u5373\u7ed9\u5b9a\u4e00\u7cfb\u5217''\u89c2\u6d4b''\uff0c\u4f30\u8ba1\u5f53\u524d\u7cfb\u7edf\u7684''\u771f\u5b9e\u72b6\u6001''\u3002 \u8fd9\u91cc\u7684\u7b26\u53f7\u786e\u5b9e\u6709\u70b9\u95ee\u9898\uff0c\u4f1a\u8ba9\u4eba\u4ea7\u751f\u5de8\u5927\u7684\u7591\u95ee\uff1a \\mathbf{z} \\mathbf{z} \u7a76\u7adf\u6307\u7684\u662f\u6837\u672c\u7684\u503c \u548c \u8fd8\u662f\u503c\u80cc\u540e\u7684\u968f\u673a\u53d8\u91cf\u3002\u8fd9\u91cc\u6211\u5e0c\u671b\u8868\u8ff0\u6210\u62bd\u8c61\u7684\u968f\u673a\u53d8\u91cf\u3002\u5bb9\u8bb8\u6211\u518d\u5570\u55e6\u4e00\u4e0b\u3002 HMM\u6a21\u578b\u53ef\u4ee5\u8ba4\u4e3a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6982\u7387\u6d4b\u5ea6\u7a7a\u95f4 HMM = \\{\\tau = (\\mathbf{x}_0, \\mathbf{z}_0, \\mathbf{x}_1, \\mathbf{z}_1, \\ldots) \\sim p(\\tau)\\}, HMM = \\{\\tau = (\\mathbf{x}_0, \\mathbf{z}_0, \\mathbf{x}_1, \\mathbf{z}_1, \\ldots) \\sim p(\\tau)\\}, \u6bcf\u4e2a\u5143\u7d20\u662f\u4e00\u6761\u968f\u673a\u53d8\u91cf\u7684\u5e8f\u5217\uff0c\u8fd9\u4e2a\u5e8f\u5217\u7684\u6982\u7387\u7531\u521d\u59cb\u72b6\u6001\u6982\u7387\u5206\u5e03\u3001\u9690\u53d8\u91cf\u72b6\u6001\u8f6c\u79fb\u6982\u7387\u5206\u5e03\u548c\u5b9e\u53d8\u91cf\u6761\u4ef6\u6982\u7387\u5206\u5e03\u51b3\u5b9a\u3002 \u73b0\u5728\u6211\u4eec\u5bf9\u8fd9\u4e2a\u6982\u7387\u6d4b\u5ea6\u7a7a\u95f4\u505a\u805a\u5408\u7b80\u5316 HMM_t = \\{\\tau_t = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{x}_t, \\mathbf{z}_t), \\tau_t \\sim p(\\tau)\\}. HMM_t = \\{\\tau_t = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{x}_t, \\mathbf{z}_t), \\tau_t \\sim p(\\tau)\\}. \u4e0a\u9762\u5361\u5c14\u66fc\u6ee4\u6ce2\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f\u6c42\u89e3\u8fd9\u4e2a\u6982\u7387\u6d4b\u5ea6\u7a7a\u95f4 HMM_t HMM_t \u5bf9\u5e94\u7684\u67d0\u4e2a\u6761\u4ef6\u6982\u7387\u5206\u5e03 p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) \u3002\u8fd9\u91cc\u53ef\u4ee5\u7528\u5f88\u591a\u76d1\u7763\u5b66\u4e60\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u5361\u5c14\u66fc\u6ee4\u6ce2\u544a\u8bc9\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u9a6c\u5c14\u53ef\u592b\u94fe\u548c\u9ad8\u65af\u5206\u5e03\u7684\u6027\u8d28\uff0c\u7528\u4e00\u79cd\u66f4\u7b80\u5355\u7684\u8fed\u4ee3\u66f4\u65b0\u7684\u65b9\u5f0f\u6765\u6c42\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002 \u9996\u5148\uff0c\u6211\u4eec\u4f7f\u7528\u8d1d\u53f6\u65af\u516c\u5f0f\u53ef\u5f97\uff1a \\begin{align*} \\tag{9} \\label{step1} &p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\frac{p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)} {\\int p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d}\\mathbf{x}_t}. \\end{align*} \\begin{align*} \\tag{9} \\label{step1} &p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\frac{p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)} {\\int p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d}\\mathbf{x}_t}. \\end{align*} \u9996\u5148\u5229\u7528\u9ad8\u65af\u5206\u5e03\u7684 \u5171\u8f6d\u6027\u8d28 \uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u76ee\u6807\u6761\u4ef6\u5206\u5e03\u4e5f\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u6211\u4eec\u4e0d\u59a8\u5b9a\u4e3a \\mathcal{N}(\\pmb{\\mu}_t, \\pmb{\\Sigma}_t) \\mathcal{N}(\\pmb{\\mu}_t, \\pmb{\\Sigma}_t) \u3002\u6211\u4eec\u518d\u6765\u7814\u7a76\u8fd9\u4e2a \\eqref{step1} \\eqref{step1} \u5f0f\uff0c\u6211\u4eec\u5df2\u7ecf\u6709\u4e86 p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{z}_t \\vert \\mathbf{x}_t) \uff0c\u6240\u4ee5\u6211\u4eec\u9762\u5bf9\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u6c42\u89e3\u6761\u4ef6\u5206\u5e03 p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \uff0c\u6211\u4eec\u4f7f\u7528\u6982\u7387\u5bc6\u5ea6\u7684\u6027\u8d28\u53ef\u5f97 \\begin{align*} \\tag{10} \\label{step2} & p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\int p(\\mathbf{x}_t \\vert \\mathbf{x}_{t-1}) p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d} \\mathbf{x}_{t-1}. \\end{align*} \\begin{align*} \\tag{10} \\label{step2} & p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\int p(\\mathbf{x}_t \\vert \\mathbf{x}_{t-1}) p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d} \\mathbf{x}_{t-1}. \\end{align*} \u8fd9\u91cc\u6211\u4eec\u53d1\u73b0 p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \u9012\u5f52\u4e86\uff0c\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u6765\u4e86\u8fd9\u4e2a\u6761\u4ef6\u6982\u7387\u670d\u4ece \\mathcal{N}(\\pmb{\\mu}_{t-1}, \\pmb{\\Sigma}_{t-1}) \\mathcal{N}(\\pmb{\\mu}_{t-1}, \\pmb{\\Sigma}_{t-1}) , \u6211\u4eec\u53c8\u5df2\u77e5 p(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) \\sim \\mathcal{N}(\\mathbf{A}\\mathbf{x}_{t-1}+\\mathbf{b}, \\mathbf{Q}) p(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) \\sim \\mathcal{N}(\\mathbf{A}\\mathbf{x}_{t-1}+\\mathbf{b}, \\mathbf{Q}) \uff0c\u90a3\u4e48\u4f7f\u7528\u9ad8\u65af\u5206\u5e03\u7684\u4e00\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u6c42\u5f97 \\eqref{step2} \\eqref{step2} \u5f0f\u3002 \u591a\u5143\u9ad8\u65af\u5206\u5e03\u7684\u8fb9\u7f18\u5206\u5e03\u4e0e\u6761\u4ef6\u5206\u5e03 \u5df2\u77e5\u5206\u5e03\uff1a \\begin{cases} \\tag{11} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \\begin{cases} \\tag{11} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \u6211\u4eec\u53ef\u5f97\uff1a \\begin{cases} \\tag{12} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} \\begin{cases} \\tag{12} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} (\u53c2\u8003\u81ea\uff1aPRML(2006\u5e74\u51fa\u7248)\u7b2c93\u9875) \u90a3\u4e48\u6211\u4eec\u6c42\u89e3\u5f97\u5230 \\eqref{step2} \\eqref{step2} : \\tag{13} \\label{step5} p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathcal{N}(\\mathbf{A}\\mu_{t-1} + \\mathbf{b}, \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q}). \\tag{13} \\label{step5} p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathcal{N}(\\mathbf{A}\\mu_{t-1} + \\mathbf{b}, \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q}). \u56de\u5230\u6c42\u89e3 \\eqref{step1} \\eqref{step1} , \u6211\u4eec\u5df2\u77e5 p(\\mathbf{z} \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\mathbf{C}\\mathbf{x} + \\mathbf{d}, \\mathbf{R}) p(\\mathbf{z} \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\mathbf{C}\\mathbf{x} + \\mathbf{d}, \\mathbf{R}) , \u6211\u4eec\u518d\u89c4\u5b9a p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathbf{N}(\\hat{\\pmb{\\mu_t}}, \\hat{\\pmb{\\Sigma}_t}) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathbf{N}(\\hat{\\pmb{\\mu_t}}, \\hat{\\pmb{\\Sigma}_t}) , \u90a3\u4e48\u6211\u4eec\u5e26\u5165\u516c\u5f0f\u53ef\u5f97\uff1a \\tag{14} \\label{step6} p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_{0}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{C}^{T}\\mathbf{R}^{-1}(\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_t], \\pmb{\\Sigma}), \\tag{14} \\label{step6} p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_{0}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{C}^{T}\\mathbf{R}^{-1}(\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_t], \\pmb{\\Sigma}), \u5176\u4e2d \\pmb{\\Sigma} = (\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C})^{-1} \\pmb{\\Sigma} = (\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C})^{-1} \u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u8981\u4e00\u4e2a\u5361\u5c14\u66fc\u6ee4\u6ce2\u7684\u516c\u5f0f\uff1a\u8d77\u59cb\u65f6 \\pmb{\\mu}_0, \\pmb{\\Sigma}_0 \\pmb{\\mu}_0, \\pmb{\\Sigma}_0 \uff0c\u63a5\u7740\u6bcf\u83b7\u5f97\u4e00\u4e2a\u89c2\u6d4b\u503c z_t z_t \u6211\u4eec\u4f7f\u7528\u4e0b\u9762\u7684\u8fed\u4ee3\u516c\u5f0f \\begin{cases} \\tag{15} \\label{kalmanfilter} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{\\Sigma}_t = (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1};\\\\ \\pmb{\\mu}_t = \\pmb{\\Sigma} [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}]. \\\\ \\end{cases} \\begin{cases} \\tag{15} \\label{kalmanfilter} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{\\Sigma}_t = (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1};\\\\ \\pmb{\\mu}_t = \\pmb{\\Sigma} [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}]. \\\\ \\end{cases} \u8fd9\u91cc\u8fd9\u4e2a\u516c\u5f0f\u662f\u76f4\u63a5\u5e26\u5165PRML\u4e66\u4e2d\u7684\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5316\u7b80\u4e00\u4e0b\uff0c\u5c31\u6210\u4e86\u6211\u4eec\u5e38\u89c1\u7684\u5361\u5c14\u66fc\u6ee4\u6ce2\u7684\u516c\u5f0f\u4e86\u3002 \\begin{align*} \\tag{16} \\label{step7} &\\pmb{\\mu}_t = \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t} - \\pmb{\\Sigma}^{-1} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C}^{T} \\mathbf{R}^{-1} \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t \\mathbf{C}^{T} \\mathbf{R}^{-1} [(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ \\end{align*} \\begin{align*} \\tag{16} \\label{step7} &\\pmb{\\mu}_t = \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t} - \\pmb{\\Sigma}^{-1} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C}^{T} \\mathbf{R}^{-1} \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t \\mathbf{C}^{T} \\mathbf{R}^{-1} [(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ \\end{align*} \u73b0\u5728\u8fd8\u662f\u53c8\u591a\u6b21\u6c42\u9006\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u7ee7\u7eed\u7b80\u5316\u3002 \u4ee4 K_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} K_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} , \u63a5\u7740\u6211\u4eec\u5316\u7b80 K_t K_t \u7684\u8ba1\u7b97(\u6211\u4e5f\u662f\u6839\u636e\u7ed3\u679c\u51d1\u51fa\u6765\u7684\uff0c\u5361\u5c14\u66fc\u592a\u5389\u5bb3\u4e86): \\begin{align*} \\tag{17} \\label{step8} & \\mathbf{K}_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ & \\cdot (\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\\\ & \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T + \\mathbf{C}^T)(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1} \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} + \\hat{\\pmb{\\Sigma}}^{-1}_{t})\\\\ & \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}. \\end{align*} \\begin{align*} \\tag{17} \\label{step8} & \\mathbf{K}_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ & \\cdot (\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\\\ & \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T + \\mathbf{C}^T)(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1} \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} + \\hat{\\pmb{\\Sigma}}^{-1}_{t})\\\\ & \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}. \\end{align*} \u6211\u4eec\u5df2\u7ecf\u83b7\u5f97\u4e86 \\mathbf{K}_t \\mathbf{K}_t \u6211\u4eec\u5982\u4f55\u4e0d\u7528\u77e9\u9635\u6c42\u9006\u64cd\u4f5c\u5c31\u6c42\u51fa \\pmb{\\Sigma}_t \\pmb{\\Sigma}_t \u5462\uff1f \\begin{align*} \\tag{18} \\label{step9} &\\pmb{\\Sigma}_t = \\pmb{\\Sigma}_t \\hat{\\pmb{\\Sigma}}_t^{-1} \\hat{\\pmb{\\Sigma}}_t \\\\ =& \\pmb{\\Sigma}[\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} - \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}) \\hat{\\pmb{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t. \\end{align*} \\begin{align*} \\tag{18} \\label{step9} &\\pmb{\\Sigma}_t = \\pmb{\\Sigma}_t \\hat{\\pmb{\\Sigma}}_t^{-1} \\hat{\\pmb{\\Sigma}}_t \\\\ =& \\pmb{\\Sigma}[\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} - \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}) \\hat{\\pmb{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t. \\end{align*} \u7efc\u4e0a\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u6700\u4f20\u7edf\u7684\u5361\u5c14\u66fc\u6ee4\u6ce2\u7684\u66f4\u65b0\u516c\u5f0f\uff1a \\begin{cases} \\tag{19} \\label{kalmanfilter2} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{K}_t = \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1};\\\\ \\pmb{\\Sigma}_t = (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t;\\\\ \\pmb{\\mu}_t = \\hat{\\pmb{\\mu}}_{t} + \\mathbf{K}_t[(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t]. \\\\ \\end{cases} \\begin{cases} \\tag{19} \\label{kalmanfilter2} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{K}_t = \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1};\\\\ \\pmb{\\Sigma}_t = (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t;\\\\ \\pmb{\\mu}_t = \\hat{\\pmb{\\mu}}_{t} + \\mathbf{K}_t[(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t]. \\\\ \\end{cases}","title":"Kalman Filter"},{"location":"ML/07-KalmanFilter/#_1","text":"","title":"\u5361\u5c14\u66fc\u6ee4\u6ce2"},{"location":"ML/07-KalmanFilter/#_2","text":"\u7b80\u5355\u5b9a\u4e49\u4e00\u4e0b\u9690\u9a6c\u5c14\u53ef\u592b\u94fe\uff1a \\tag{1} \\label{HMM} \\xrightarrow[]{p(\\mathbf{x}_0)}(\\mathbf{x}_0 \\xrightarrow[]{p(\\mathbf{z}_0 \\vert \\mathbf{x}_0)}\\mathbf{z}_0) \\xrightarrow[]{p(\\mathbf{x}_1 \\vert \\mathbf{x}_0)} (\\mathbf{x}_1 \\xrightarrow[]{p(\\mathbf{z}_1 \\vert \\mathbf{x}_1)} \\mathbf{z}_1) \\rightarrow \\cdots . \\tag{1} \\label{HMM} \\xrightarrow[]{p(\\mathbf{x}_0)}(\\mathbf{x}_0 \\xrightarrow[]{p(\\mathbf{z}_0 \\vert \\mathbf{x}_0)}\\mathbf{z}_0) \\xrightarrow[]{p(\\mathbf{x}_1 \\vert \\mathbf{x}_0)} (\\mathbf{x}_1 \\xrightarrow[]{p(\\mathbf{z}_1 \\vert \\mathbf{x}_1)} \\mathbf{z}_1) \\rightarrow \\cdots . \u5176\u4e2d p(\\mathbf{x}_0) p(\\mathbf{x}_0) \u8868\u793a\u521d\u59cb\u72b6\u6001\u6982\u7387\uff0c p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_t) p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_t) \u8868\u793a\u9690\u53d8\u91cf\u72b6\u6001\u8f6c\u79fb\u6982\u7387\uff0c p(\\mathbf{z}\\vert \\mathbf{x}) p(\\mathbf{z}\\vert \\mathbf{x}) \u8868\u793a\u5b9e\u53d8\u91cf\u6761\u4ef6\u6982\u7387\u3002 \u5728\u9690\u9a6c\u5c14\u53ef\u592b\u94fe\u4e2d\uff0c\u6211\u4eec\u53ea\u80fd\u89c2\u6d4b\u5230\u53d8\u91cf (\\mathbf{z}_0 , \\mathbf{z}_1,\\ldots) (\\mathbf{z}_0 , \\mathbf{z}_1,\\ldots) \u7684\u503c\uff0c\u800c\u65e0\u6cd5\u83b7\u5f97\u9690\u53d8\u91cf\u7684\u503c\u3002 \u8fd9\u4e2a\u6a21\u578b\u6709\u975e\u5e38\u5f3a\u7684\u73b0\u5b9e\u610f\u4e49\uff0c\u901a\u5e38\u52a8\u529b\u5b66\u7cfb\u7edf\u7684\u8fd0\u52a8\u662f\u4e00\u4e2a\u9a6c\u5c14\u53ef\u592b\u94fe\uff0c\u800c\u6211\u4eec\u65e0\u6cd5\u83b7\u5f97\u51c6\u786e\u7684\u52a8\u529b\u5b66\u6a21\u578b\u7684\u72b6\u6001 \\mathbf{x} \\mathbf{x} \uff0c\u53ea\u80fd\u4f7f\u7528\u4f20\u611f\u5668\u6765\u6d4b\u91cf\u76f8\u5e94\u72b6\u6001\u7684\u4e00\u4e2a\u76f8\u5173\u91cf \\mathbf{z} \\mathbf{z} \u3002","title":"\u9690\u9a6c\u5c14\u53ef\u592b\u94fe"},{"location":"ML/07-KalmanFilter/#_3","text":"\u5bf9\u4e8e\u968f\u673a\u8fc7\u7a0b\u7684\u5047\u8bbe\u96c6\uff0c\u6211\u4eec\u901a\u5e38\u8bbe\u5b9a\u4e3a\u9ad8\u65af\u5206\u5e03\uff1a \\tag{2} \\label{hmm_hypothesis} \\mathcal{H} = \\left\\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\pmb{\\mu}_1(\\mathbf{x}_t), \\pmb{\\Sigma}_1(\\mathbf{x}_t)), p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_2(\\mathbf{x}), \\pmb{\\Sigma}_2)(\\mathbf{x})) \\right\\}. \\tag{2} \\label{hmm_hypothesis} \\mathcal{H} = \\left\\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\pmb{\\mu}_1(\\mathbf{x}_t), \\pmb{\\Sigma}_1(\\mathbf{x}_t)), p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}_2(\\mathbf{x}), \\pmb{\\Sigma}_2)(\\mathbf{x})) \\right\\}. \u6211\u4eec\u5e0c\u671b\u4ece\u5047\u8bbe\u96c6\u4e2d\u627e\u51fa\u4e00\u4e2a\u5143\u7ec4\u6700\u63a5\u8fd1\u771f\u5b9e\u7684\u72b6\u6001\u8f6c\u79fb (p_{\\mathcal{D}}(\\mathbf{x}_0), p_{\\mathcal{D}}(\\mathbf{x}_{t+1}\\vert \\mathbf{x}_{t}), p_{\\mathcal{D}}(\\mathbf{z} \\vert \\mathbf{x})) (p_{\\mathcal{D}}(\\mathbf{x}_0), p_{\\mathcal{D}}(\\mathbf{x}_{t+1}\\vert \\mathbf{x}_{t}), p_{\\mathcal{D}}(\\mathbf{z} \\vert \\mathbf{x})) \u3002 \u91c7\u6837\u4e00\u6761\u6837\u672c \\tau = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t) \\tau = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t) , \u90a3\u4e48\uff1a \\tag{3} \\label{trueprobability} p_{\\mathcal{D}}(\\tau) = \\int p_{\\mathcal{D}}(\\mathbf{x}_0) p_{\\mathcal{D}}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\mathcal{D}}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\mathcal{D}}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\mathcal{D}}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \\tag{3} \\label{trueprobability} p_{\\mathcal{D}}(\\tau) = \\int p_{\\mathcal{D}}(\\mathbf{x}_0) p_{\\mathcal{D}}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\mathcal{D}}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\mathcal{D}}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\mathcal{D}}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \\tag{4} \\label{modelprobability} p_{\\theta}(\\tau) = \\int p_{\\theta}(\\mathbf{x}_0) p_{\\theta}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\theta}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\theta}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\theta}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \\tag{4} \\label{modelprobability} p_{\\theta}(\\tau) = \\int p_{\\theta}(\\mathbf{x}_0) p_{\\theta}(\\mathbf{z}_{0}\\vert \\mathbf{x}_0)p_{\\theta}(\\mathbf{x}_{1}\\vert\\mathbf{x}_0)\\cdots p_{\\theta}(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) p_{\\theta}(\\mathbf{z}_t \\vert \\mathbf{x}_t) \\mathrm{d}\\mathbf{x}_0\\mathrm{d}\\mathbf{x}_1\\ldots\\mathrm{d}\\mathbf{x}_t \u5b9a\u4e49\u635f\u5931\u51fd\u6570\u4e3a\uff1a \\tag{5} \\label{trueloss} L_{D}(\\theta) = \\mathbb{E}_{\\tau\\sim\\mathcal{D}}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\tau)}{p_{\\theta}(\\tau)} \\right)\\right]. \\tag{5} \\label{trueloss} L_{D}(\\theta) = \\mathbb{E}_{\\tau\\sim\\mathcal{D}}\\left[\\ln\\left( \\frac{p_{\\mathcal{D}}(\\tau)}{p_{\\theta}(\\tau)} \\right)\\right]. \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u4e3a\uff1a \\tag{6} \\label{empirical} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1}\\ln\\left( {p_{\\theta}(\\tau)} \\right). \\tag{6} \\label{empirical} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1}\\ln\\left( {p_{\\theta}(\\tau)} \\right). \u8fd9\u4e2a\u51fd\u6570\u5f88\u96be\u4f18\u5316\uff0c\u6240\u4ee5\u9700\u8981\u5176\u4ed6\u65b9\u6cd5\uff0c\u8fd9\u91cc\u8d85\u51fa\u4e86\u6211\u7684\u77e5\u8bc6\u8303\u56f4\uff0c\u6240\u4ee5\u5148\u653e\u5230\u4e00\u8fb9\u3002","title":"\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\u5efa\u6a21"},{"location":"ML/07-KalmanFilter/#_4","text":"\u5361\u5c14\u66fc\u6ee4\u6ce2\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\uff1a \\tag{7} \\label{kalman_hypothesis} \\mathcal{H} = \\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\pmb{\\Sigma}_1), \\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x}_t + \\mathbf{d}, \\pmb{\\Sigma}_2)) \\}. \\tag{7} \\label{kalman_hypothesis} \\mathcal{H} = \\{ (p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0), p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\pmb{\\Sigma}_1), \\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x}_t + \\mathbf{d}, \\pmb{\\Sigma}_2)) \\}. \u800c\u4e14\u6211\u4eec\u5df2\u7ecf\u627e\u5230\u4e86\u5bf9\u5e94\u7684\u6700\u4f18\u6a21\u578b: \\begin{cases} \\tag{8} \\label{kalman_model} p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0),\\\\ p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\mathbf{Q}),\\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x} + \\mathbf{d}, \\mathbf{R}). \\end{cases} \\begin{cases} \\tag{8} \\label{kalman_model} p(\\mathbf{x}_0) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0),\\\\ p(\\mathbf{x}_{t+1} \\vert \\mathbf{x}_{t}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x}_t + \\mathbf{b}, \\mathbf{Q}),\\\\ p(\\mathbf{z}\\vert\\mathbf{x}) = \\mathcal{N}(\\mathbf{C} \\mathbf{x} + \\mathbf{d}, \\mathbf{R}). \\end{cases} \u5361\u5c14\u66fc\u6ee4\u6ce2\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f \uff1a\u7ed9\u5b9a\u4e00\u6761\u91c7\u6837 (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t, \\ldots) (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{z}_t, \\ldots) , \u4f30\u8ba1\u5206\u5e03 p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) \u3002 \u8fd9\u540c\u6837\u4e5f\u662f\u5bf9 \u6ee4\u6ce2 \u505a\u7684\u975e\u5e38\u4f18\u96c5\u7684 \u6570\u5b66\u5b9a\u4e49 \uff0c\u5373\u7ed9\u5b9a\u4e00\u7cfb\u5217''\u89c2\u6d4b''\uff0c\u4f30\u8ba1\u5f53\u524d\u7cfb\u7edf\u7684''\u771f\u5b9e\u72b6\u6001''\u3002 \u8fd9\u91cc\u7684\u7b26\u53f7\u786e\u5b9e\u6709\u70b9\u95ee\u9898\uff0c\u4f1a\u8ba9\u4eba\u4ea7\u751f\u5de8\u5927\u7684\u7591\u95ee\uff1a \\mathbf{z} \\mathbf{z} \u7a76\u7adf\u6307\u7684\u662f\u6837\u672c\u7684\u503c \u548c \u8fd8\u662f\u503c\u80cc\u540e\u7684\u968f\u673a\u53d8\u91cf\u3002\u8fd9\u91cc\u6211\u5e0c\u671b\u8868\u8ff0\u6210\u62bd\u8c61\u7684\u968f\u673a\u53d8\u91cf\u3002\u5bb9\u8bb8\u6211\u518d\u5570\u55e6\u4e00\u4e0b\u3002 HMM\u6a21\u578b\u53ef\u4ee5\u8ba4\u4e3a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6982\u7387\u6d4b\u5ea6\u7a7a\u95f4 HMM = \\{\\tau = (\\mathbf{x}_0, \\mathbf{z}_0, \\mathbf{x}_1, \\mathbf{z}_1, \\ldots) \\sim p(\\tau)\\}, HMM = \\{\\tau = (\\mathbf{x}_0, \\mathbf{z}_0, \\mathbf{x}_1, \\mathbf{z}_1, \\ldots) \\sim p(\\tau)\\}, \u6bcf\u4e2a\u5143\u7d20\u662f\u4e00\u6761\u968f\u673a\u53d8\u91cf\u7684\u5e8f\u5217\uff0c\u8fd9\u4e2a\u5e8f\u5217\u7684\u6982\u7387\u7531\u521d\u59cb\u72b6\u6001\u6982\u7387\u5206\u5e03\u3001\u9690\u53d8\u91cf\u72b6\u6001\u8f6c\u79fb\u6982\u7387\u5206\u5e03\u548c\u5b9e\u53d8\u91cf\u6761\u4ef6\u6982\u7387\u5206\u5e03\u51b3\u5b9a\u3002 \u73b0\u5728\u6211\u4eec\u5bf9\u8fd9\u4e2a\u6982\u7387\u6d4b\u5ea6\u7a7a\u95f4\u505a\u805a\u5408\u7b80\u5316 HMM_t = \\{\\tau_t = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{x}_t, \\mathbf{z}_t), \\tau_t \\sim p(\\tau)\\}. HMM_t = \\{\\tau_t = (\\mathbf{z}_0, \\mathbf{z}_1, \\ldots, \\mathbf{x}_t, \\mathbf{z}_t), \\tau_t \\sim p(\\tau)\\}. \u4e0a\u9762\u5361\u5c14\u66fc\u6ee4\u6ce2\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f\u6c42\u89e3\u8fd9\u4e2a\u6982\u7387\u6d4b\u5ea6\u7a7a\u95f4 HMM_t HMM_t \u5bf9\u5e94\u7684\u67d0\u4e2a\u6761\u4ef6\u6982\u7387\u5206\u5e03 p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_0) \u3002\u8fd9\u91cc\u53ef\u4ee5\u7528\u5f88\u591a\u76d1\u7763\u5b66\u4e60\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u5361\u5c14\u66fc\u6ee4\u6ce2\u544a\u8bc9\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u9a6c\u5c14\u53ef\u592b\u94fe\u548c\u9ad8\u65af\u5206\u5e03\u7684\u6027\u8d28\uff0c\u7528\u4e00\u79cd\u66f4\u7b80\u5355\u7684\u8fed\u4ee3\u66f4\u65b0\u7684\u65b9\u5f0f\u6765\u6c42\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002 \u9996\u5148\uff0c\u6211\u4eec\u4f7f\u7528\u8d1d\u53f6\u65af\u516c\u5f0f\u53ef\u5f97\uff1a \\begin{align*} \\tag{9} \\label{step1} &p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\frac{p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)} {\\int p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d}\\mathbf{x}_t}. \\end{align*} \\begin{align*} \\tag{9} \\label{step1} &p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\frac{p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)} {\\int p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d}\\mathbf{x}_t}. \\end{align*} \u9996\u5148\u5229\u7528\u9ad8\u65af\u5206\u5e03\u7684 \u5171\u8f6d\u6027\u8d28 \uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u76ee\u6807\u6761\u4ef6\u5206\u5e03\u4e5f\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u6211\u4eec\u4e0d\u59a8\u5b9a\u4e3a \\mathcal{N}(\\pmb{\\mu}_t, \\pmb{\\Sigma}_t) \\mathcal{N}(\\pmb{\\mu}_t, \\pmb{\\Sigma}_t) \u3002\u6211\u4eec\u518d\u6765\u7814\u7a76\u8fd9\u4e2a \\eqref{step1} \\eqref{step1} \u5f0f\uff0c\u6211\u4eec\u5df2\u7ecf\u6709\u4e86 p(\\mathbf{z}_t \\vert \\mathbf{x}_t) p(\\mathbf{z}_t \\vert \\mathbf{x}_t) \uff0c\u6240\u4ee5\u6211\u4eec\u9762\u5bf9\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u6c42\u89e3\u6761\u4ef6\u5206\u5e03 p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \uff0c\u6211\u4eec\u4f7f\u7528\u6982\u7387\u5bc6\u5ea6\u7684\u6027\u8d28\u53ef\u5f97 \\begin{align*} \\tag{10} \\label{step2} & p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\int p(\\mathbf{x}_t \\vert \\mathbf{x}_{t-1}) p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d} \\mathbf{x}_{t-1}. \\end{align*} \\begin{align*} \\tag{10} \\label{step2} & p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0)\\\\ =& \\int p(\\mathbf{x}_t \\vert \\mathbf{x}_{t-1}) p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \\mathrm{d} \\mathbf{x}_{t-1}. \\end{align*} \u8fd9\u91cc\u6211\u4eec\u53d1\u73b0 p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) p(\\mathbf{x}_{t-1} \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) \u9012\u5f52\u4e86\uff0c\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u6765\u4e86\u8fd9\u4e2a\u6761\u4ef6\u6982\u7387\u670d\u4ece \\mathcal{N}(\\pmb{\\mu}_{t-1}, \\pmb{\\Sigma}_{t-1}) \\mathcal{N}(\\pmb{\\mu}_{t-1}, \\pmb{\\Sigma}_{t-1}) , \u6211\u4eec\u53c8\u5df2\u77e5 p(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) \\sim \\mathcal{N}(\\mathbf{A}\\mathbf{x}_{t-1}+\\mathbf{b}, \\mathbf{Q}) p(\\mathbf{x}_{t} \\vert \\mathbf{x}_{t-1}) \\sim \\mathcal{N}(\\mathbf{A}\\mathbf{x}_{t-1}+\\mathbf{b}, \\mathbf{Q}) \uff0c\u90a3\u4e48\u4f7f\u7528\u9ad8\u65af\u5206\u5e03\u7684\u4e00\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u6c42\u5f97 \\eqref{step2} \\eqref{step2} \u5f0f\u3002 \u591a\u5143\u9ad8\u65af\u5206\u5e03\u7684\u8fb9\u7f18\u5206\u5e03\u4e0e\u6761\u4ef6\u5206\u5e03 \u5df2\u77e5\u5206\u5e03\uff1a \\begin{cases} \\tag{11} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \\begin{cases} \\tag{11} \\label{step3} p(\\mathbf{x}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Lambda}^{-1}), \\\\ p(\\mathbf{y} \\vert \\mathbf{x}) = \\mathcal{N}(\\mathbf{A}\\mathbf{x} + \\mathbf{b}, \\pmb{L}^{-1}), \\end{cases} \u6211\u4eec\u53ef\u5f97\uff1a \\begin{cases} \\tag{12} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} \\begin{cases} \\tag{12} \\label{step4} p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{A}\\pmb{\\mu} + \\mathbf{b}, \\mathbf{L}^{-1} + \\mathbf{A}\\pmb{\\Lambda}^{-1}\\mathbf{A}^T), \\\\ p(\\mathbf{x} \\vert \\mathbf{y}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{A}^T \\mathbf{L}(\\mathbf{y} - \\mathbf{b}) + \\pmb{\\Lambda\\mu}], \\pmb{\\Sigma}),\\\\ \\pmb{\\Sigma} = (\\pmb{\\Lambda} + \\mathbf{A}^T \\mathbf{L} \\mathbf{A})^{-1}. \\end{cases} (\u53c2\u8003\u81ea\uff1aPRML(2006\u5e74\u51fa\u7248)\u7b2c93\u9875) \u90a3\u4e48\u6211\u4eec\u6c42\u89e3\u5f97\u5230 \\eqref{step2} \\eqref{step2} : \\tag{13} \\label{step5} p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathcal{N}(\\mathbf{A}\\mu_{t-1} + \\mathbf{b}, \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q}). \\tag{13} \\label{step5} p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathcal{N}(\\mathbf{A}\\mu_{t-1} + \\mathbf{b}, \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q}). \u56de\u5230\u6c42\u89e3 \\eqref{step1} \\eqref{step1} , \u6211\u4eec\u5df2\u77e5 p(\\mathbf{z} \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\mathbf{C}\\mathbf{x} + \\mathbf{d}, \\mathbf{R}) p(\\mathbf{z} \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\mathbf{C}\\mathbf{x} + \\mathbf{d}, \\mathbf{R}) , \u6211\u4eec\u518d\u89c4\u5b9a p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathbf{N}(\\hat{\\pmb{\\mu_t}}, \\hat{\\pmb{\\Sigma}_t}) p(\\mathbf{x}_t \\vert \\mathbf{z}_{t-1},\\ldots, \\mathbf{z}_0) = \\mathbf{N}(\\hat{\\pmb{\\mu_t}}, \\hat{\\pmb{\\Sigma}_t}) , \u90a3\u4e48\u6211\u4eec\u5e26\u5165\u516c\u5f0f\u53ef\u5f97\uff1a \\tag{14} \\label{step6} p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_{0}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{C}^{T}\\mathbf{R}^{-1}(\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_t], \\pmb{\\Sigma}), \\tag{14} \\label{step6} p(\\mathbf{x}_t \\vert \\mathbf{z}_t, \\mathbf{z}_{t-1}, \\ldots, \\mathbf{z}_{0}) = \\mathcal{N}(\\pmb{\\Sigma}[\\mathbf{C}^{T}\\mathbf{R}^{-1}(\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_t], \\pmb{\\Sigma}), \u5176\u4e2d \\pmb{\\Sigma} = (\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C})^{-1} \\pmb{\\Sigma} = (\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C})^{-1} \u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u8981\u4e00\u4e2a\u5361\u5c14\u66fc\u6ee4\u6ce2\u7684\u516c\u5f0f\uff1a\u8d77\u59cb\u65f6 \\pmb{\\mu}_0, \\pmb{\\Sigma}_0 \\pmb{\\mu}_0, \\pmb{\\Sigma}_0 \uff0c\u63a5\u7740\u6bcf\u83b7\u5f97\u4e00\u4e2a\u89c2\u6d4b\u503c z_t z_t \u6211\u4eec\u4f7f\u7528\u4e0b\u9762\u7684\u8fed\u4ee3\u516c\u5f0f \\begin{cases} \\tag{15} \\label{kalmanfilter} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{\\Sigma}_t = (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1};\\\\ \\pmb{\\mu}_t = \\pmb{\\Sigma} [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}]. \\\\ \\end{cases} \\begin{cases} \\tag{15} \\label{kalmanfilter} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{\\Sigma}_t = (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1};\\\\ \\pmb{\\mu}_t = \\pmb{\\Sigma} [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}]. \\\\ \\end{cases} \u8fd9\u91cc\u8fd9\u4e2a\u516c\u5f0f\u662f\u76f4\u63a5\u5e26\u5165PRML\u4e66\u4e2d\u7684\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5316\u7b80\u4e00\u4e0b\uff0c\u5c31\u6210\u4e86\u6211\u4eec\u5e38\u89c1\u7684\u5361\u5c14\u66fc\u6ee4\u6ce2\u7684\u516c\u5f0f\u4e86\u3002 \\begin{align*} \\tag{16} \\label{step7} &\\pmb{\\mu}_t = \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t} - \\pmb{\\Sigma}^{-1} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C}^{T} \\mathbf{R}^{-1} \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t \\mathbf{C}^{T} \\mathbf{R}^{-1} [(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ \\end{align*} \\begin{align*} \\tag{16} \\label{step7} &\\pmb{\\mu}_t = \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t}] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) + \\hat{\\pmb{\\Sigma}}^{-1}_{t}\\hat{\\pmb{\\mu}}_{t} - \\pmb{\\Sigma}^{-1} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t [\\mathbf{C}^{T} \\mathbf{R}^{-1} (\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C}^{T} \\mathbf{R}^{-1} \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ =& \\hat{\\pmb{\\mu}}_{t} + \\pmb{\\Sigma}_t \\mathbf{C}^{T} \\mathbf{R}^{-1} [(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t] \\\\ \\end{align*} \u73b0\u5728\u8fd8\u662f\u53c8\u591a\u6b21\u6c42\u9006\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u7ee7\u7eed\u7b80\u5316\u3002 \u4ee4 K_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} K_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} , \u63a5\u7740\u6211\u4eec\u5316\u7b80 K_t K_t \u7684\u8ba1\u7b97(\u6211\u4e5f\u662f\u6839\u636e\u7ed3\u679c\u51d1\u51fa\u6765\u7684\uff0c\u5361\u5c14\u66fc\u592a\u5389\u5bb3\u4e86): \\begin{align*} \\tag{17} \\label{step8} & \\mathbf{K}_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ & \\cdot (\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\\\ & \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T + \\mathbf{C}^T)(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1} \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} + \\hat{\\pmb{\\Sigma}}^{-1}_{t})\\\\ & \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}. \\end{align*} \\begin{align*} \\tag{17} \\label{step8} & \\mathbf{K}_t = \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\mathbf{C}^T \\mathbf{R}^{-1}\\\\ & \\cdot (\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1}\\\\ & \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T + \\mathbf{C}^T)(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& (\\hat{\\pmb{\\Sigma}}^{-1}_{t} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C})^{-1} \\cdot (\\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} + \\hat{\\pmb{\\Sigma}}^{-1}_{t})\\\\ & \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}\\\\ =& \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1}. \\end{align*} \u6211\u4eec\u5df2\u7ecf\u83b7\u5f97\u4e86 \\mathbf{K}_t \\mathbf{K}_t \u6211\u4eec\u5982\u4f55\u4e0d\u7528\u77e9\u9635\u6c42\u9006\u64cd\u4f5c\u5c31\u6c42\u51fa \\pmb{\\Sigma}_t \\pmb{\\Sigma}_t \u5462\uff1f \\begin{align*} \\tag{18} \\label{step9} &\\pmb{\\Sigma}_t = \\pmb{\\Sigma}_t \\hat{\\pmb{\\Sigma}}_t^{-1} \\hat{\\pmb{\\Sigma}}_t \\\\ =& \\pmb{\\Sigma}[\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} - \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}) \\hat{\\pmb{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t. \\end{align*} \\begin{align*} \\tag{18} \\label{step9} &\\pmb{\\Sigma}_t = \\pmb{\\Sigma}_t \\hat{\\pmb{\\Sigma}}_t^{-1} \\hat{\\pmb{\\Sigma}}_t \\\\ =& \\pmb{\\Sigma}[\\hat{\\pmb{\\Sigma}}_t^{-1} + \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C} - \\mathbf{C}^T \\mathbf{R}^{-1}\\mathbf{C}) \\hat{\\pmb{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\pmb{\\Sigma}_t \\mathbf{C}^T \\mathbf{R}^{-1} \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t \\\\ =& (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t. \\end{align*} \u7efc\u4e0a\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u6700\u4f20\u7edf\u7684\u5361\u5c14\u66fc\u6ee4\u6ce2\u7684\u66f4\u65b0\u516c\u5f0f\uff1a \\begin{cases} \\tag{19} \\label{kalmanfilter2} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{K}_t = \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1};\\\\ \\pmb{\\Sigma}_t = (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t;\\\\ \\pmb{\\mu}_t = \\hat{\\pmb{\\mu}}_{t} + \\mathbf{K}_t[(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t]. \\\\ \\end{cases} \\begin{cases} \\tag{19} \\label{kalmanfilter2} \\hat{\\pmb{\\Sigma}}_t = \\mathbf{A} \\pmb{\\Sigma}_{t-1} \\mathbf{A}^T + \\mathbf{Q};\\\\ \\hat{\\pmb{\\mu}_t} = \\mathbf{A} \\pmb{\\mu}_{t-1} + \\mathbf{b}; \\\\ \\pmb{K}_t = \\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T(\\mathbf{C}\\hat{\\pmb{\\Sigma}}_t \\mathbf{C}^T +\\mathbf{R})^{-1};\\\\ \\pmb{\\Sigma}_t = (\\mathbf{I} - \\mathbf{K}_t \\mathbf{C}) \\hat{\\mathbf{\\Sigma}}_t;\\\\ \\pmb{\\mu}_t = \\hat{\\pmb{\\mu}}_{t} + \\mathbf{K}_t[(\\mathbf{z}_t - \\mathbf{d}) - \\mathbf{C} \\hat{\\pmb{\\mu}}_t]. \\\\ \\end{cases}","title":"\u5361\u5c14\u66fc\u6ee4\u6ce2"},{"location":"ML/08-Classification/","text":"\u5206\u7c7b\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m) \\right\\} \u3002 \u5176\u4e2d \\mathbf{x} \\in \\mathbb{R}^d \\mathbf{x} \\in \\mathbb{R}^d \u5e76\u4e14 y y \u5c5e\u4e8e\u67d0\u4e2a\u6709\u9650\u7684\u79bb\u6563\u96c6\u5408\uff0c\u4f8b\u5982\uff1a y \\in \\{0, 1\\} y \\in \\{0, 1\\} , y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \u6216\u8005 y \\in \\{1, 2, 3, \\ldots, k\\} y \\in \\{1, 2, 3, \\ldots, k\\} \u3002\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03, \u5373 (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} \u3002\u6211\u4eec\u5e0c\u671b\u5f97\u5230\u5bf9\u5e94\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}} (y \\vert \\mathbf{x}) P_{\\mathcal{D}} (y \\vert \\mathbf{x}) , \u7528\u6765\u6307\u5bfc\u6211\u4eec\u5728\u77e5\u9053 \\mathbf{x} \\mathbf{x} \u7684\u60c5\u51b5\u4e0b\u9884\u6d4b y y \u503c\u3002\u5982\u679c y y \u6240\u5728\u96c6\u5408\u7684\u5927\u5c0f\u4e3a2\uff0c\u90a3\u6211\u4eec\u5c31\u79f0\u8fd9\u4e2a\u95ee\u9898\u4e3a\u4e8c\u5206\u7c7b\u95ee\u9898\u3002 \u901a\u5e38\u6211\u4eec\u4f1a\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6\uff1a \\tag{1} \\label{hypothesis1} \\mathcal{H} = \\left\\{ p_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. \\tag{1} \\label{hypothesis1} \\mathcal{H} = \\left\\{ p_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. SVM \u5c31\u662f\u7528\u6765\u89e3\u51b3\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u65b9\u6cd5\uff0c\u5b83\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u4e3a \\tag{2} \\label{svmhypothesis} \\mathcal{H}_{\\theta} = \\left\\{ h(\\mathbf{x}) = sign(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}) \\right\\}, \\tag{2} \\label{svmhypothesis} \\mathcal{H}_{\\theta} = \\left\\{ h(\\mathbf{x}) = sign(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}) \\right\\}, \u8fd9\u91cc\u5bf9\u5e94\u7684\u5206\u5e03\u662f P\\{y = h(\\mathbf{x}) \\} = 1 P\\{y = h(\\mathbf{x}) \\} = 1 \u3002 \u903b\u8f91\u56de\u5f52 \u00b6 \u903b\u8f91\u56de\u5f52\u89e3\u51b3\u7684\u95ee\u9898\u662f y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} . \u5b83\u4f7f\u7528\u7684\u5047\u8bbe\u96c6\u590d\u5408\u4e86\u7ebf\u6027\u51fd\u6570\u4e0esigmoid\u51fd\u6570: \\tag{3} \\label{logichypothesis} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(y = 1 \\vert \\mathbf{x}) = \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\right\\}. \\tag{3} \\label{logichypothesis} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(y = 1 \\vert \\mathbf{x}) = \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\right\\}. \u6211\u4eec\u4f9d\u65e7\u7528KL\u8ddd\u79bb\u6765\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u4e4b\u95f4\u7684\u8ddd\u79bb\uff1a \\tag{4} \\label{trueLossOfLogic} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{P_{\\mathcal{D}}(\\mathbf{x})}\\left\\{\\mathbb{E}_{P_\\mathcal{D}(y \\vert \\mathbf{x})}\\left[\\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})}\\right]\\right\\}. \\tag{4} \\label{trueLossOfLogic} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{P_{\\mathcal{D}}(\\mathbf{x})}\\left\\{\\mathbb{E}_{P_\\mathcal{D}(y \\vert \\mathbf{x})}\\left[\\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})}\\right]\\right\\}. \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570: \\tag{5} \\label{empiricalLossOfLogic} L_{S}(\\theta) = - \\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \\tag{5} \\label{empiricalLossOfLogic} L_{S}(\\theta) = - \\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \u56e0\u4e3asigmoid\u51fd\u6570\u6709\u4e00\u4e2a\u7279\u522b\u7684\u6027\u8d28\uff0c\u6240\u4ee5\u6bd4\u8f83\u6d41\u884c\u5427\uff1a \\begin{align*} &P_{\\theta}(y = -1 \\vert \\mathbf{x}) \\\\ =& 1 - \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{1}{1 + exp[-(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]}\\\\ \\tag{6} \\end{align*} \\begin{align*} &P_{\\theta}(y = -1 \\vert \\mathbf{x}) \\\\ =& 1 - \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{1}{1 + exp[-(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]}\\\\ \\tag{6} \\end{align*} \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u6539\u5199\u6210\uff1a \\tag{7} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} \\ln \\{1 + exp[y(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]\\}. \\tag{7} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} \\ln \\{1 + exp[y(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]\\}. \u6211\u8fd9\u91cc\u4e0d\u7ea0\u7ed3\u6b63\u8d1f\u53f7\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u4e0d\u6d89\u53ca\u672c\u8d28\u3002\u6211\u8981\u5410\u69fd\u7684\u662f\uff0c\u53ea\u662f\u56e0\u4e3a Sigmoid \u51fd\u6570\u7684\u7279\u522b\u6027\uff0c\u800c\u4e14\u53ea\u662f\u80fd\u591f\u7b80\u5316\u635f\u5931\u51fd\u6570\uff0c\u5c31\u53d7\u5230\u5f88\u591a\u7684\u5173\u6ce8\uff0c\u8fd9\u79cd\u4e8b\u60c5\u5c31\u5f88\u79bb\u8c31\u3002\u5bf9\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u7ebf\u6027\u51fd\u6570\u52a0 Sigmoid \u4ee3\u8868\u7684\u5206\u5e03 P_\\theta(y \\vert \\mathbf{x}) P_\\theta(y \\vert \\mathbf{x}) \u5b9e\u5728\u662f\u592a\u5c40\u9650\u4e86\u3002 \u591a\u5206\u7c7b\u95ee\u9898 \u00b6 \u5404\u79cd\u6559\u6750\u4e2d\uff0c\u591a\u5206\u7c7b\u95ee\u9898\u603b\u662f\u7ea0\u7ed3\u5728 ''\u4e00\u5bf9\u4e00\u7b56\u7565'' \u548c ''\u4e00\u5bf9\u591a\u7b56\u7565''\uff0c\u5176\u5b9e\u5c31\u662f\u94bb\u4e86\u725b\u89d2\u5c16\uff0c\u60f3\u7528\u7ebf\u6027\u51fd\u6570\u6765\u89e3\u51b3\u591a\u5206\u7c7b\u95ee\u9898\u3002 \u867d\u7136\u8fd9\u79cd\u65b9\u6cd5\u5728\u7406\u8bba\u5206\u6790\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u642c\u7528\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u5206\u6790\u7ed3\u679c\uff0c\u4f46\u662f\u5b9e\u9645\u4e2d\u662f\u975e\u5e38\u5c40\u9650\uff0c\u6211\u76f8\u4fe1\u73b0\u5728\u7edd\u5927\u591a\u6570\u4eba\u6ca1\u6709\u7528\u7ebf\u6027\u51fd\u6570\u6765\u89e3\u51b3\u591a\u5206\u7c7b\u95ee\u9898\u4e86\u3002\u5f88\u591a\u4eba\u60ca\u8bb6\u795e\u7ecf\u7f51\u7edc\u7684\u9ad8\u6548\uff0c\u6211\u60ca\u8bb6\u7684\u662f\uff0c\u5f53\u5e74\u4eba\u4eec\u4f1a\u7528\u8d85\u5e73\u9762\u89e3\u51b3\u591a\u5206\u7c7b\u95ee\u9898\u3002 \u5bf9\u4e8ek\u5206\u7c7b\u95ee\u9898\uff0c\u6211\u4eec\u66f4\u5e0c\u671b\u4f7f\u7528\u67d0\u4e2a\u51fd\u6570 f: \\mathbf{x} \\rightarrow \\pmb{\\mathcal{P}} f: \\mathbf{x} \\rightarrow \\pmb{\\mathcal{P}} , \u5176\u4e2d \\pmb{\\mathcal{P}} \\pmb{\\mathcal{P}} \u662f\u4e00\u4e2a\u79bb\u6563\u6982\u7387\u5206\u5e03\uff0c\u5373 \\pmb{\\mathcal{P}} \\in \\mathbb{R}^{k} \\pmb{\\mathcal{P}} \\in \\mathbb{R}^{k} , \\pmb{\\mathcal{P}} \\succeq \\pmb{0} \\pmb{\\mathcal{P}} \\succeq \\pmb{0} \u5e76\u4e14 \\sum^{k}_{i=1} \\mathcal{P}_i = 1 \\sum^{k}_{i=1} \\mathcal{P}_i = 1 \u3002\u90a3\u4e48\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u5c31\u53d8\u6210\u4e86: \\tag{8} \\label{khypothesis} \\mathcal{H} = \\left\\{ P_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. \\tag{8} \\label{khypothesis} \\mathcal{H} = \\left\\{ P_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. \u8fd9\u4e2a\u5047\u8bbe\u96c6\u5c31\u76f8\u5f53\u5408\u7406\u4e86\u3002 \u6211\u4eec\u4f9d\u65e7\u53ef\u4ee5\u7528 KL \u8ddd\u79bb\u6765\u6784\u9020\u4e00\u4e2a\u635f\u5931\u51fd\u6570: \\tag{9} \\label{ktrueloss} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{P_{\\mathcal{D}}(y \\vert \\mathbf{x})} \\left[ \\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})} \\right]. \\right\\} \\tag{9} \\label{ktrueloss} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{P_{\\mathcal{D}}(y \\vert \\mathbf{x})} \\left[ \\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})} \\right]. \\right\\} \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a: \\tag{10} \\label{kempiricalloss} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \\tag{10} \\label{kempiricalloss} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\uff0c\u4e00\u822c\u7684\u8f93\u51fa\u4e3a \\{z_1, z_2, \\ldots, z_k\\} \\{z_1, z_2, \\ldots, z_k\\} \u5e76\u4e0d\u6ee1\u8db3\u6982\u7387\u5206\u5e03\u7684\u8981\u6c42\u3002 \u8fd9\u91cc\u6700\u76f4\u89c9\u7684\u65b9\u6cd5\u662f\uff1a\u6211\u4eec\u9884\u6d4b y = {\\arg\\max}_i z_i y = {\\arg\\max}_i z_i \uff0c \u8fd9\u79cd\u65b9\u6cd5\u76f8\u5f53\u4e8e\u628a\u5047\u8bbe\u96c6\u53c8\u7b80\u5316\u6210\u4e86\u786e\u5b9a\u6027\u5206\u7c7b\u51fd\u6570\u7684\u96c6\u5408\uff0c \u4e00\u65b9\u9762\u964d\u4f4e\u4e86\u5b83\u7684\u8868\u8fbe\u80fd\u529b, \u53e6\u4e00\u65b9\u9762\u5f53\u6211\u4eec\u505a\u51fa\u9519\u8bef\u9884\u6d4b\u65f6\uff0c P_{\\theta} = 0 P_{\\theta} = 0 , \u6211\u4eec\u65e0\u6cd5\u518d\u4f7f\u7528 \\eqref{kempiricalloss} \\eqref{kempiricalloss} \u5f0f\u4f5c\u4e3a\u6211\u4eec\u7684\u635f\u5931\u51fd\u6570\u3002 \u901a\u5e38\u6211\u4eec\u901a\u8fc7\u4e00\u5c42 Softmax \u5c42 \u5b9e\u73b0\u5f52\u4e00\u5316\uff1a \\tag{11} \\label{sigmoid} p(y = i \\vert \\mathbf{x}) = \\frac{exp(z_i)}{\\sum^{k}_{j=1} exp(z_j) }. \\tag{11} \\label{sigmoid} p(y = i \\vert \\mathbf{x}) = \\frac{exp(z_i)}{\\sum^{k}_{j=1} exp(z_j) }. \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u8bb2\u4e00\u4e0b {\\arg\\max}_i z_i {\\arg\\max}_i z_i \u548c Softmax \u7684\u8054\u7cfb\u3002 \u9996\u5148\u6211\u4eec\u4ece\u53e6\u4e00\u4e2a\u89d2\u5ea6\u6765\u7406\u89e3\u4e00\u4e0b {\\arg\\max}_i z_i {\\arg\\max}_i z_i \u64cd\u4f5c\u3002 \u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217 \\{z_1, z_2, \\ldots z_k\\} \\{z_1, z_2, \\ldots z_k\\} , \u6211\u4eec\u5b9e\u9645\u60f3\u4f18\u5316\uff1a \\tag{12} \\label{argmax} \\max_{P_\\theta(z)} \\mathbb{E}_{P_\\theta(z_i)}[z_i] = \\sum^{k}_{i=1} z_i P_{\\theta}(z_i). \\tag{12} \\label{argmax} \\max_{P_\\theta(z)} \\mathbb{E}_{P_\\theta(z_i)}[z_i] = \\sum^{k}_{i=1} z_i P_{\\theta}(z_i). \u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u81ea\u7136\u662f P_{\\theta}(z = \\max z_i) = 1 P_{\\theta}(z = \\max z_i) = 1 \u3002 \u90a3\u4e48\uff0cSoftmax \u5bf9\u5e94\u7684\u4f18\u5316\u95ee\u9898\u662f\u589e\u52a0\u4e86\u4e00\u4e2a\u71b5\u7684\u60e9\u7f5a\u9879\uff1a \\tag{13} \\label{softmax} \\max_{P_\\theta(z)} \\sum^{k}_{i=1} z_i P_{\\theta}(z_i) - \\alpha \\sum^{k}_{i=1} P_{\\theta}(z_i) \\ln P_{\\theta}(z_i). \\tag{13} \\label{softmax} \\max_{P_\\theta(z)} \\sum^{k}_{i=1} z_i P_{\\theta}(z_i) - \\alpha \\sum^{k}_{i=1} P_{\\theta}(z_i) \\ln P_{\\theta}(z_i). \u6216\u8005\u53ef\u4ee5\u5199\u6210 \\tag{14} \\label{softmax2} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i, \\quad \\forall i, P_i > 0, \\sum^{k}_{i=1} P_i = 1. \\tag{14} \\label{softmax2} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i, \\quad \\forall i, P_i > 0, \\sum^{k}_{i=1} P_i = 1. \u5199\u6210\u62c9\u683c\u6717\u65e5\u5bf9\u5076\u5f62\u5f0f\u53ef\u5f97 \\tag{15} \\label{softmax3} \\max_{\\mathbf{P}} \\min_{\\lambda \\ne 0} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right), \\tag{15} \\label{softmax3} \\max_{\\mathbf{P}} \\min_{\\lambda \\ne 0} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right), \u5bf9\u5e94\u7684\u5bf9\u5076\u5f62\u5f0f\u662f \\tag{16} \\label{softmax4} \\min_{\\lambda \\ne 0} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right). \\tag{16} \\label{softmax4} \\min_{\\lambda \\ne 0} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right). \u9996\u5148\u5bf9\u5185\u90e8\u5b50\u95ee\u9898\u8fdb\u884c\u4f18\u5316\u53ef\u5f97\uff1a \\tag{17} \\label{softmax5} \\alpha \\ln P^*_i = z_i - \\alpha + \\lambda \\Rightarrow P^*_i = \\exp \\left\\{ \\frac{z_i - \\alpha + \\lambda}{\\alpha} \\right\\}. \\tag{17} \\label{softmax5} \\alpha \\ln P^*_i = z_i - \\alpha + \\lambda \\Rightarrow P^*_i = \\exp \\left\\{ \\frac{z_i - \\alpha + \\lambda}{\\alpha} \\right\\}. \u5047\u8bbe\u6211\u4eec\u83b7\u5f97\u4e86 \\lambda^* \\lambda^* \uff0c\u90a3\u4e48\u6839\u636e\u6982\u7387\u7684\u6027\u8d28\u53ef\u5f97\uff1a \\tag{18} \\label{softmax6} \\sum^{k}_{i = 1} \\exp\\left\\{ \\frac{z_i - \\alpha + \\lambda^*}{\\alpha} \\right\\} = \\sum^{k}_{i=1} P^*_i = 1, \\\\ \\Rightarrow exp \\left\\{ \\frac{-\\alpha + \\lambda^*}{\\alpha} \\right\\} = \\frac{1}{\\sum^{k}_{i=1}exp \\left\\{ z_i / \\alpha \\right\\}}. \\tag{18} \\label{softmax6} \\sum^{k}_{i = 1} \\exp\\left\\{ \\frac{z_i - \\alpha + \\lambda^*}{\\alpha} \\right\\} = \\sum^{k}_{i=1} P^*_i = 1, \\\\ \\Rightarrow exp \\left\\{ \\frac{-\\alpha + \\lambda^*}{\\alpha} \\right\\} = \\frac{1}{\\sum^{k}_{i=1}exp \\left\\{ z_i / \\alpha \\right\\}}. \u5e26\u5165\u5230 \\eqref{softmax5} \\eqref{softmax5} \u5f0f\uff0c\u6211\u4eec\u53ef\u5f97\uff1a \\tag{19} \\label{softmax7} P^*_i = \\frac{exp(z_i/\\alpha)}{\\sum^{k}_{i=1}exp(z_i/\\alpha)}. \\tag{19} \\label{softmax7} P^*_i = \\frac{exp(z_i/\\alpha)}{\\sum^{k}_{i=1}exp(z_i/\\alpha)}. \u56e0\u5b50 \\alpha \\alpha \u53ef\u4ee5\u5305\u542b\u5230\u795e\u7ecf\u7f51\u7edc\u7684\u524d\u9762\u5c42\u4e2d\uff0c\u6240\u4ee5 Softmax \u5c42\u56fa\u5b9a \\alpha=1 \\alpha=1 \u3002","title":"Classification"},{"location":"ML/08-Classification/#_1","text":"","title":"\u5206\u7c7b\u95ee\u9898"},{"location":"ML/08-Classification/#_2","text":"\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m) \\right\\} \u3002 \u5176\u4e2d \\mathbf{x} \\in \\mathbb{R}^d \\mathbf{x} \\in \\mathbb{R}^d \u5e76\u4e14 y y \u5c5e\u4e8e\u67d0\u4e2a\u6709\u9650\u7684\u79bb\u6563\u96c6\u5408\uff0c\u4f8b\u5982\uff1a y \\in \\{0, 1\\} y \\in \\{0, 1\\} , y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \u6216\u8005 y \\in \\{1, 2, 3, \\ldots, k\\} y \\in \\{1, 2, 3, \\ldots, k\\} \u3002\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03, \u5373 (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} \u3002\u6211\u4eec\u5e0c\u671b\u5f97\u5230\u5bf9\u5e94\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}} (y \\vert \\mathbf{x}) P_{\\mathcal{D}} (y \\vert \\mathbf{x}) , \u7528\u6765\u6307\u5bfc\u6211\u4eec\u5728\u77e5\u9053 \\mathbf{x} \\mathbf{x} \u7684\u60c5\u51b5\u4e0b\u9884\u6d4b y y \u503c\u3002\u5982\u679c y y \u6240\u5728\u96c6\u5408\u7684\u5927\u5c0f\u4e3a2\uff0c\u90a3\u6211\u4eec\u5c31\u79f0\u8fd9\u4e2a\u95ee\u9898\u4e3a\u4e8c\u5206\u7c7b\u95ee\u9898\u3002 \u901a\u5e38\u6211\u4eec\u4f1a\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6\uff1a \\tag{1} \\label{hypothesis1} \\mathcal{H} = \\left\\{ p_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. \\tag{1} \\label{hypothesis1} \\mathcal{H} = \\left\\{ p_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. SVM \u5c31\u662f\u7528\u6765\u89e3\u51b3\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u65b9\u6cd5\uff0c\u5b83\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u4e3a \\tag{2} \\label{svmhypothesis} \\mathcal{H}_{\\theta} = \\left\\{ h(\\mathbf{x}) = sign(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}) \\right\\}, \\tag{2} \\label{svmhypothesis} \\mathcal{H}_{\\theta} = \\left\\{ h(\\mathbf{x}) = sign(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}) \\right\\}, \u8fd9\u91cc\u5bf9\u5e94\u7684\u5206\u5e03\u662f P\\{y = h(\\mathbf{x}) \\} = 1 P\\{y = h(\\mathbf{x}) \\} = 1 \u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"ML/08-Classification/#_3","text":"\u903b\u8f91\u56de\u5f52\u89e3\u51b3\u7684\u95ee\u9898\u662f y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} . \u5b83\u4f7f\u7528\u7684\u5047\u8bbe\u96c6\u590d\u5408\u4e86\u7ebf\u6027\u51fd\u6570\u4e0esigmoid\u51fd\u6570: \\tag{3} \\label{logichypothesis} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(y = 1 \\vert \\mathbf{x}) = \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\right\\}. \\tag{3} \\label{logichypothesis} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(y = 1 \\vert \\mathbf{x}) = \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\right\\}. \u6211\u4eec\u4f9d\u65e7\u7528KL\u8ddd\u79bb\u6765\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u4e4b\u95f4\u7684\u8ddd\u79bb\uff1a \\tag{4} \\label{trueLossOfLogic} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{P_{\\mathcal{D}}(\\mathbf{x})}\\left\\{\\mathbb{E}_{P_\\mathcal{D}(y \\vert \\mathbf{x})}\\left[\\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})}\\right]\\right\\}. \\tag{4} \\label{trueLossOfLogic} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{P_{\\mathcal{D}}(\\mathbf{x})}\\left\\{\\mathbb{E}_{P_\\mathcal{D}(y \\vert \\mathbf{x})}\\left[\\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})}\\right]\\right\\}. \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570: \\tag{5} \\label{empiricalLossOfLogic} L_{S}(\\theta) = - \\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \\tag{5} \\label{empiricalLossOfLogic} L_{S}(\\theta) = - \\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \u56e0\u4e3asigmoid\u51fd\u6570\u6709\u4e00\u4e2a\u7279\u522b\u7684\u6027\u8d28\uff0c\u6240\u4ee5\u6bd4\u8f83\u6d41\u884c\u5427\uff1a \\begin{align*} &P_{\\theta}(y = -1 \\vert \\mathbf{x}) \\\\ =& 1 - \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{1}{1 + exp[-(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]}\\\\ \\tag{6} \\end{align*} \\begin{align*} &P_{\\theta}(y = -1 \\vert \\mathbf{x}) \\\\ =& 1 - \\frac{1}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)}{1 + exp(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)} \\\\ =& \\frac{1}{1 + exp[-(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]}\\\\ \\tag{6} \\end{align*} \u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u6539\u5199\u6210\uff1a \\tag{7} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} \\ln \\{1 + exp[y(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]\\}. \\tag{7} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} \\ln \\{1 + exp[y(\\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta)]\\}. \u6211\u8fd9\u91cc\u4e0d\u7ea0\u7ed3\u6b63\u8d1f\u53f7\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u4e0d\u6d89\u53ca\u672c\u8d28\u3002\u6211\u8981\u5410\u69fd\u7684\u662f\uff0c\u53ea\u662f\u56e0\u4e3a Sigmoid \u51fd\u6570\u7684\u7279\u522b\u6027\uff0c\u800c\u4e14\u53ea\u662f\u80fd\u591f\u7b80\u5316\u635f\u5931\u51fd\u6570\uff0c\u5c31\u53d7\u5230\u5f88\u591a\u7684\u5173\u6ce8\uff0c\u8fd9\u79cd\u4e8b\u60c5\u5c31\u5f88\u79bb\u8c31\u3002\u5bf9\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u7ebf\u6027\u51fd\u6570\u52a0 Sigmoid \u4ee3\u8868\u7684\u5206\u5e03 P_\\theta(y \\vert \\mathbf{x}) P_\\theta(y \\vert \\mathbf{x}) \u5b9e\u5728\u662f\u592a\u5c40\u9650\u4e86\u3002","title":"\u903b\u8f91\u56de\u5f52"},{"location":"ML/08-Classification/#_4","text":"\u5404\u79cd\u6559\u6750\u4e2d\uff0c\u591a\u5206\u7c7b\u95ee\u9898\u603b\u662f\u7ea0\u7ed3\u5728 ''\u4e00\u5bf9\u4e00\u7b56\u7565'' \u548c ''\u4e00\u5bf9\u591a\u7b56\u7565''\uff0c\u5176\u5b9e\u5c31\u662f\u94bb\u4e86\u725b\u89d2\u5c16\uff0c\u60f3\u7528\u7ebf\u6027\u51fd\u6570\u6765\u89e3\u51b3\u591a\u5206\u7c7b\u95ee\u9898\u3002 \u867d\u7136\u8fd9\u79cd\u65b9\u6cd5\u5728\u7406\u8bba\u5206\u6790\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u642c\u7528\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u5206\u6790\u7ed3\u679c\uff0c\u4f46\u662f\u5b9e\u9645\u4e2d\u662f\u975e\u5e38\u5c40\u9650\uff0c\u6211\u76f8\u4fe1\u73b0\u5728\u7edd\u5927\u591a\u6570\u4eba\u6ca1\u6709\u7528\u7ebf\u6027\u51fd\u6570\u6765\u89e3\u51b3\u591a\u5206\u7c7b\u95ee\u9898\u4e86\u3002\u5f88\u591a\u4eba\u60ca\u8bb6\u795e\u7ecf\u7f51\u7edc\u7684\u9ad8\u6548\uff0c\u6211\u60ca\u8bb6\u7684\u662f\uff0c\u5f53\u5e74\u4eba\u4eec\u4f1a\u7528\u8d85\u5e73\u9762\u89e3\u51b3\u591a\u5206\u7c7b\u95ee\u9898\u3002 \u5bf9\u4e8ek\u5206\u7c7b\u95ee\u9898\uff0c\u6211\u4eec\u66f4\u5e0c\u671b\u4f7f\u7528\u67d0\u4e2a\u51fd\u6570 f: \\mathbf{x} \\rightarrow \\pmb{\\mathcal{P}} f: \\mathbf{x} \\rightarrow \\pmb{\\mathcal{P}} , \u5176\u4e2d \\pmb{\\mathcal{P}} \\pmb{\\mathcal{P}} \u662f\u4e00\u4e2a\u79bb\u6563\u6982\u7387\u5206\u5e03\uff0c\u5373 \\pmb{\\mathcal{P}} \\in \\mathbb{R}^{k} \\pmb{\\mathcal{P}} \\in \\mathbb{R}^{k} , \\pmb{\\mathcal{P}} \\succeq \\pmb{0} \\pmb{\\mathcal{P}} \\succeq \\pmb{0} \u5e76\u4e14 \\sum^{k}_{i=1} \\mathcal{P}_i = 1 \\sum^{k}_{i=1} \\mathcal{P}_i = 1 \u3002\u90a3\u4e48\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u5c31\u53d8\u6210\u4e86: \\tag{8} \\label{khypothesis} \\mathcal{H} = \\left\\{ P_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. \\tag{8} \\label{khypothesis} \\mathcal{H} = \\left\\{ P_{\\theta}(y \\vert \\mathbf{x}) \\right\\}. \u8fd9\u4e2a\u5047\u8bbe\u96c6\u5c31\u76f8\u5f53\u5408\u7406\u4e86\u3002 \u6211\u4eec\u4f9d\u65e7\u53ef\u4ee5\u7528 KL \u8ddd\u79bb\u6765\u6784\u9020\u4e00\u4e2a\u635f\u5931\u51fd\u6570: \\tag{9} \\label{ktrueloss} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{P_{\\mathcal{D}}(y \\vert \\mathbf{x})} \\left[ \\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})} \\right]. \\right\\} \\tag{9} \\label{ktrueloss} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{P_{\\mathcal{D}}(y \\vert \\mathbf{x})} \\left[ \\ln \\frac{P_{\\mathcal{D}}(y \\vert \\mathbf{x})}{P_{\\theta}(y \\vert \\mathbf{x})} \\right]. \\right\\} \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a: \\tag{10} \\label{kempiricalloss} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \\tag{10} \\label{kempiricalloss} L_{S}(\\theta) = -\\frac{1}{m} \\sum^{m}_{i=1} \\ln P_{\\theta}(y_i \\vert \\mathbf{x}_i). \u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\uff0c\u4e00\u822c\u7684\u8f93\u51fa\u4e3a \\{z_1, z_2, \\ldots, z_k\\} \\{z_1, z_2, \\ldots, z_k\\} \u5e76\u4e0d\u6ee1\u8db3\u6982\u7387\u5206\u5e03\u7684\u8981\u6c42\u3002 \u8fd9\u91cc\u6700\u76f4\u89c9\u7684\u65b9\u6cd5\u662f\uff1a\u6211\u4eec\u9884\u6d4b y = {\\arg\\max}_i z_i y = {\\arg\\max}_i z_i \uff0c \u8fd9\u79cd\u65b9\u6cd5\u76f8\u5f53\u4e8e\u628a\u5047\u8bbe\u96c6\u53c8\u7b80\u5316\u6210\u4e86\u786e\u5b9a\u6027\u5206\u7c7b\u51fd\u6570\u7684\u96c6\u5408\uff0c \u4e00\u65b9\u9762\u964d\u4f4e\u4e86\u5b83\u7684\u8868\u8fbe\u80fd\u529b, \u53e6\u4e00\u65b9\u9762\u5f53\u6211\u4eec\u505a\u51fa\u9519\u8bef\u9884\u6d4b\u65f6\uff0c P_{\\theta} = 0 P_{\\theta} = 0 , \u6211\u4eec\u65e0\u6cd5\u518d\u4f7f\u7528 \\eqref{kempiricalloss} \\eqref{kempiricalloss} \u5f0f\u4f5c\u4e3a\u6211\u4eec\u7684\u635f\u5931\u51fd\u6570\u3002 \u901a\u5e38\u6211\u4eec\u901a\u8fc7\u4e00\u5c42 Softmax \u5c42 \u5b9e\u73b0\u5f52\u4e00\u5316\uff1a \\tag{11} \\label{sigmoid} p(y = i \\vert \\mathbf{x}) = \\frac{exp(z_i)}{\\sum^{k}_{j=1} exp(z_j) }. \\tag{11} \\label{sigmoid} p(y = i \\vert \\mathbf{x}) = \\frac{exp(z_i)}{\\sum^{k}_{j=1} exp(z_j) }. \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u8bb2\u4e00\u4e0b {\\arg\\max}_i z_i {\\arg\\max}_i z_i \u548c Softmax \u7684\u8054\u7cfb\u3002 \u9996\u5148\u6211\u4eec\u4ece\u53e6\u4e00\u4e2a\u89d2\u5ea6\u6765\u7406\u89e3\u4e00\u4e0b {\\arg\\max}_i z_i {\\arg\\max}_i z_i \u64cd\u4f5c\u3002 \u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217 \\{z_1, z_2, \\ldots z_k\\} \\{z_1, z_2, \\ldots z_k\\} , \u6211\u4eec\u5b9e\u9645\u60f3\u4f18\u5316\uff1a \\tag{12} \\label{argmax} \\max_{P_\\theta(z)} \\mathbb{E}_{P_\\theta(z_i)}[z_i] = \\sum^{k}_{i=1} z_i P_{\\theta}(z_i). \\tag{12} \\label{argmax} \\max_{P_\\theta(z)} \\mathbb{E}_{P_\\theta(z_i)}[z_i] = \\sum^{k}_{i=1} z_i P_{\\theta}(z_i). \u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u81ea\u7136\u662f P_{\\theta}(z = \\max z_i) = 1 P_{\\theta}(z = \\max z_i) = 1 \u3002 \u90a3\u4e48\uff0cSoftmax \u5bf9\u5e94\u7684\u4f18\u5316\u95ee\u9898\u662f\u589e\u52a0\u4e86\u4e00\u4e2a\u71b5\u7684\u60e9\u7f5a\u9879\uff1a \\tag{13} \\label{softmax} \\max_{P_\\theta(z)} \\sum^{k}_{i=1} z_i P_{\\theta}(z_i) - \\alpha \\sum^{k}_{i=1} P_{\\theta}(z_i) \\ln P_{\\theta}(z_i). \\tag{13} \\label{softmax} \\max_{P_\\theta(z)} \\sum^{k}_{i=1} z_i P_{\\theta}(z_i) - \\alpha \\sum^{k}_{i=1} P_{\\theta}(z_i) \\ln P_{\\theta}(z_i). \u6216\u8005\u53ef\u4ee5\u5199\u6210 \\tag{14} \\label{softmax2} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i, \\quad \\forall i, P_i > 0, \\sum^{k}_{i=1} P_i = 1. \\tag{14} \\label{softmax2} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i, \\quad \\forall i, P_i > 0, \\sum^{k}_{i=1} P_i = 1. \u5199\u6210\u62c9\u683c\u6717\u65e5\u5bf9\u5076\u5f62\u5f0f\u53ef\u5f97 \\tag{15} \\label{softmax3} \\max_{\\mathbf{P}} \\min_{\\lambda \\ne 0} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right), \\tag{15} \\label{softmax3} \\max_{\\mathbf{P}} \\min_{\\lambda \\ne 0} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right), \u5bf9\u5e94\u7684\u5bf9\u5076\u5f62\u5f0f\u662f \\tag{16} \\label{softmax4} \\min_{\\lambda \\ne 0} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right). \\tag{16} \\label{softmax4} \\min_{\\lambda \\ne 0} \\max_{\\mathbf{P}} \\sum^{k}_{i=1} z_i P_i - \\alpha \\sum^{k}_{i=1} P_i \\ln P_i + \\lambda \\left(\\sum^{k}_{i=1} P_i - 1\\right). \u9996\u5148\u5bf9\u5185\u90e8\u5b50\u95ee\u9898\u8fdb\u884c\u4f18\u5316\u53ef\u5f97\uff1a \\tag{17} \\label{softmax5} \\alpha \\ln P^*_i = z_i - \\alpha + \\lambda \\Rightarrow P^*_i = \\exp \\left\\{ \\frac{z_i - \\alpha + \\lambda}{\\alpha} \\right\\}. \\tag{17} \\label{softmax5} \\alpha \\ln P^*_i = z_i - \\alpha + \\lambda \\Rightarrow P^*_i = \\exp \\left\\{ \\frac{z_i - \\alpha + \\lambda}{\\alpha} \\right\\}. \u5047\u8bbe\u6211\u4eec\u83b7\u5f97\u4e86 \\lambda^* \\lambda^* \uff0c\u90a3\u4e48\u6839\u636e\u6982\u7387\u7684\u6027\u8d28\u53ef\u5f97\uff1a \\tag{18} \\label{softmax6} \\sum^{k}_{i = 1} \\exp\\left\\{ \\frac{z_i - \\alpha + \\lambda^*}{\\alpha} \\right\\} = \\sum^{k}_{i=1} P^*_i = 1, \\\\ \\Rightarrow exp \\left\\{ \\frac{-\\alpha + \\lambda^*}{\\alpha} \\right\\} = \\frac{1}{\\sum^{k}_{i=1}exp \\left\\{ z_i / \\alpha \\right\\}}. \\tag{18} \\label{softmax6} \\sum^{k}_{i = 1} \\exp\\left\\{ \\frac{z_i - \\alpha + \\lambda^*}{\\alpha} \\right\\} = \\sum^{k}_{i=1} P^*_i = 1, \\\\ \\Rightarrow exp \\left\\{ \\frac{-\\alpha + \\lambda^*}{\\alpha} \\right\\} = \\frac{1}{\\sum^{k}_{i=1}exp \\left\\{ z_i / \\alpha \\right\\}}. \u5e26\u5165\u5230 \\eqref{softmax5} \\eqref{softmax5} \u5f0f\uff0c\u6211\u4eec\u53ef\u5f97\uff1a \\tag{19} \\label{softmax7} P^*_i = \\frac{exp(z_i/\\alpha)}{\\sum^{k}_{i=1}exp(z_i/\\alpha)}. \\tag{19} \\label{softmax7} P^*_i = \\frac{exp(z_i/\\alpha)}{\\sum^{k}_{i=1}exp(z_i/\\alpha)}. \u56e0\u5b50 \\alpha \\alpha \u53ef\u4ee5\u5305\u542b\u5230\u795e\u7ecf\u7f51\u7edc\u7684\u524d\u9762\u5c42\u4e2d\uff0c\u6240\u4ee5 Softmax \u5c42\u56fa\u5b9a \\alpha=1 \\alpha=1 \u3002","title":"\u591a\u5206\u7c7b\u95ee\u9898"},{"location":"ML/09-PCA/","text":"PAC Learning Framework \u00b6 \u6982\u7387\u6027\u5730\u8fd1\u4f3c\u5730\u6b63\u786e\u7684(PAC, Probably Approximately Correct)\u5b66\u4e60\u6846\u67b6\u662f\u975e\u5e38\u91cd\u8981\u7684\u6846\u67b6\uff0c \u5b83\u5c1d\u8bd5\u89e3\u51b3\u4e00\u4e9b\u672c\u8d28\u6027\u7684\u95ee\u9898\uff1a\u4ec0\u4e48\u5b66\u4e60\u662f\u6709\u6548\u7684\uff1f\u4ec0\u4e48\u5b66\u4e60\u662f\u56f0\u96be\u7684\uff1f\u6211\u4eec\u9700\u8981\u591a\u5c11\u7684\u6837\u672c\uff1f\u6709\u6ca1\u6709\u666e\u904d\u9002\u7528\u7684\u6a21\u578b\uff1f \u5f88\u591a\u4eba\u7c97\u66b4\u5730\u628a\u8fd9\u4e9b\u5f52\u7ed3\u4e3a''\u5927\u6570\u5b9a\u7406''\uff0c\u5176\u5b9e\u4e5f\u6ca1\u4ec0\u4e48\u4e0d\u5bf9\uff0c\u4e0d\u8fc7\u6211\u4eec\u5e0c\u671b\u6380\u5f00''\u5927\u6570\u5b9a\u7406''\u7684\u5e18\u5b50\uff0c\u518d\u8fdb\u4e00\u6b65\u5206\u6790\u4e00\u4e0b\u3002 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u9996\u5148\u5b9a\u4e49\u6837\u672c\u7a7a\u95f4 \\{\\mathcal{X}, \\mathcal{Y}, \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y}\\} \\{\\mathcal{X}, \\mathcal{Y}, \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y}\\} , \u6211\u4eec\u901a\u5e38\u8ba4\u4e3a\u6837\u672c\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u5206\u5e03\uff0c\u5373 \\mathcal{Z} \\sim \\mathcal{D} \\mathcal{Z} \\sim \\mathcal{D} \u3002\u76d1\u7763\u5b66\u4e60\u7684\u5927\u90e8\u5206\u95ee\u9898\u6b63\u662f\u6c42\u89e3\u5bf9\u5e94\u7684\u4e00\u4e2a\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \u3002\u5f53\u6211\u4eec\u5df2\u77e5 \\mathbf{x} \\mathbf{x} , \u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u63a8\u65ad \\mathbf{y} \\mathbf{y} \u7684\u503c\u3002\u6211\u4eec\u7528\u7b26\u53f7 \\mathcal{Z}_{\\mathcal{D}} \\mathcal{Z}_{\\mathcal{D}} \u6765\u4ee3\u8868\u6837\u672c\u7a7a\u95f4 \\mathcal{Z} \\mathcal{Z} \u52a0\u4e0a\u6982\u7387\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u6211\u4eec\u5c31\u79f0\u5b83\u4e3a \u6837\u672c\u6d4b\u5ea6\u7a7a\u95f4 \u3002 \u5728\u7edf\u8ba1\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u53ea\u80fd\u591f\u91c7\u6837\u6765\u7aa5\u89c6\u6837\u672c\u6d4b\u5ea6\u7a7a\u95f4 \\mathcal{Z}_{\\mathcal{D}} \\mathcal{Z}_{\\mathcal{D}} \u7684\u6837\u5b50, \u6211\u4eec\u901a\u5e38\u628a\u72ec\u7acb\u540c\u5206\u5e03\u7684\u6837\u672c\u7ec4\u6210\u7684\u5408\u96c6\u79f0\u4e3a\u6837\u672c\u96c6: \\tag{1} \\label{samples} \\mathcal{S} = \\{(\\mathbf{x}_1, \\mathbf{y}_1), (\\mathbf{x}_2, \\mathbf{y}_2), \\ldots, (\\mathbf{x}_m, \\mathbf{y}_m)\\}. \\tag{1} \\label{samples} \\mathcal{S} = \\{(\\mathbf{x}_1, \\mathbf{y}_1), (\\mathbf{x}_2, \\mathbf{y}_2), \\ldots, (\\mathbf{x}_m, \\mathbf{y}_m)\\}. \u4e3a\u4e86\u6c42\u89e3 P_{\\mathcal{D}}(\\mathbf{y}\\vert \\mathbf{x}) P_{\\mathcal{D}}(\\mathbf{y}\\vert \\mathbf{x}) \uff0c\u6211\u4eec\u4f1a\u5148\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6: \\tag{2} \\label{hypothesisSet} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) \\right\\}. \\tag{2} \\label{hypothesisSet} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) \\right\\}. \u8fd9\u4e2a\u5047\u8bbe\u96c6\u5305\u542b\u4e86\u6211\u4eec\u7684\u5148\u9a8c\u77e5\u8bc6\uff0c\u5e76\u4e14\u53ef\u4ee5\u7528\u6570\u5b66\u516c\u5f0f\u8868\u793a\uff0c\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u7528\u6570\u5b66\u5de5\u5177\u6765\u6c42\u89e3\u3002 \u63a5\u7740\uff0c\u6211\u4eec\u4f1a\u518d\u4f7f\u7528\u4e00\u4e9b\u5ea6\u91cf\u6982\u7387\u5206\u5e03\u4e4b\u95f4\u8ddd\u79bb\u7684\u51fd\u6570\u6765\u6784\u9020\u635f\u5931\u51fd\u6570\uff0c\u90a3\u4e48\u7edd\u5927\u90e8\u5206\u76d1\u7763\u5b66\u4e60\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u4e2a\u6570\u5b66\u95ee\u9898\uff1a \\tag{3} \\label{generalObjective} \\min_{\\theta} Distance(p_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \\Vert p_{\\theta}(\\mathbf{y} \\vert \\mathbf{x})). \\tag{3} \\label{generalObjective} \\min_{\\theta} Distance(p_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \\Vert p_{\\theta}(\\mathbf{y} \\vert \\mathbf{x})). \u6bd4\u5982\uff0c\u5f53\u6837\u672c\u7a7a\u95f4 \\mathcal{Y} = \\{0, 1\\} \\mathcal{Y} = \\{0, 1\\} \u65f6\uff0c\u6211\u4eec\u79f0\u8fd9\u4e2a\u95ee\u9898\u4e3a \u4e8c\u5206\u7c7b\u95ee\u9898 \uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 KL \u8ddd\u79bb\u6765\u5ea6\u91cf\u4e24\u4e2a\u5206\u5e03\u7684\u5dee\u522b\uff1a \\tag{4} \\label{classificationObjective} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ \\ln \\left( \\frac{P_{\\mathcal{D}}({y}\\vert \\mathbf{x})}{P_{\\theta}({y}\\vert \\mathbf{x})} \\right) \\right] \\right\\}. \\tag{4} \\label{classificationObjective} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ \\ln \\left( \\frac{P_{\\mathcal{D}}({y}\\vert \\mathbf{x})}{P_{\\theta}({y}\\vert \\mathbf{x})} \\right) \\right] \\right\\}. \u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u8981\u6c42 P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) \u5728 y = 0 y = 0 \u548c y = 1 y = 1 \u4e0a\u7684\u6982\u7387\u90fd\u5927\u4e8e0\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 Softmax \u51fd\u6570\u6765\u4fdd\u8bc1\u3002 \u6211\u4eec\u4e5f\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u66f4\u7b80\u5355\u7684\u5047\u8bbe\u96c6\uff0c\u53ea\u4f7f\u7528\u9000\u5316\u7684\u6982\u7387\u5206\u5e03\uff0c\u5373 P_{\\theta}(y = 1 \\vert \\mathbf{x}) = 1 P_{\\theta}(y = 1 \\vert \\mathbf{x}) = 1 \u6216\u8005 P_{\\theta}(y = 0 \\vert \\mathbf{x}) = 1 P_{\\theta}(y = 0 \\vert \\mathbf{x}) = 1 \uff0c\u6211\u4eec\u8868\u793a\u4e3a \\mathcal{H}_{\\theta} = \\left\\{ h_{\\theta}(\\mathbf{x}) \\right\\} \\mathcal{H}_{\\theta} = \\left\\{ h_{\\theta}(\\mathbf{x}) \\right\\} \uff0c\u8fd9\u91cc\u7684 h_\\theta(\\mathbf{x}) h_\\theta(\\mathbf{x}) \u8868\u793a\u6982\u7387\u4e3a1\u7684 y y \u503c\u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528 Wasserstein \u8ddd\u79bb\u6765\u8861\u91cf\u6765\u6784\u9020\u635f\u5931\u51fd\u6570\uff0c\u5176\u4e2d\u82b1\u8d39\u51fd\u6570\u4e3a c(a, b) = \\pmb{1}_{\\left\\{ a \\ne b \\right\\}} c(a, b) = \\pmb{1}_{\\left\\{ a \\ne b \\right\\}} : \\tag{5} \\label{classificationObjective2} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ c(y, h(\\mathbf{x}) \\right] \\right\\}. \\tag{5} \\label{classificationObjective2} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ c(y, h(\\mathbf{x}) \\right] \\right\\}. \u6211\u4eec\u5f88\u5bb9\u6613\u53ef\u4ee5\u5f97\u5230\u5316\u7b80\u7684\u635f\u5931\u51fd\u6570 L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}[c(y, h(\\mathbf{x})] L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}[c(y, h(\\mathbf{x})] \u3002 \u518d\u56de\u5230\u672c\u5c0f\u8282\u5f00\u5934\u6211\u4eec\u8bf4\u7684\uff0c\u6211\u4eec\u53ea\u80fd\u83b7\u5f97\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, {y}_m)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, {y}_m)\\} , \u6240\u4ee5\u6211\u4eec\u4e5f\u53ea\u80fd\u4f18\u5316\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\uff1a \\tag{6} \\label{classificationEmpiricalLoss} \\min_{\\theta} L_{\\mathcal{S}}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} c(y_i, h_{\\theta}(\\mathbf{x}_i)). \\tag{6} \\label{classificationEmpiricalLoss} \\min_{\\theta} L_{\\mathcal{S}}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} c(y_i, h_{\\theta}(\\mathbf{x}_i)). \u53e6\u5916\uff0c\u6211\u4eec\u628a\u6700\u5c0f\u5316\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u7684\u539f\u5219\u79f0\u4e3a \u7ecf\u9a8c\u98ce\u9669\u6700\u5c0f\u5316 (ERM, Empirical Risk Minimization)\u3002 \u7ec8\u4e8e\u8fdb\u5165\u6211\u4eec\u5173\u5fc3\u7684\u95ee\u9898\uff0cERM\u5b66\u51fa\u6765\u7684 h_S h_S \u7a76\u7adf\u6709\u591a\u597d\uff1f\u80fd\u4e0d\u80fd\u5b9a\u91cf\u5206\u6790\u5462\uff1f PAC \u00b6 \u5b9a\u4e491 ( PAC Learnability ). \u5982\u679c\u5047\u8bbe\u96c6\u662fPAC Learnable\u7684\uff0c\u5219\u8868\u793a\u5b58\u5728\u51fd\u6570 m_{\\mathcal{H}}(\\epsilon, \\delta) m_{\\mathcal{H}}(\\epsilon, \\delta) , \u548c\u67d0\u4e2a\u5b66\u4e60\u7b97\u6cd5 A A \u6ee1\u8db3\uff1a \u5f53\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \u5927\u5c0f\u5927\u4e8e m_{\\mathcal{H}}(\\epsilon, \\delta) m_{\\mathcal{H}}(\\epsilon, \\delta) \u65f6\uff0c \\tag{7} \\label{pacLearnability} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ L_{\\mathcal{D}}(A(\\mathcal{S})) \\le \\min_{\\theta} L_{\\mathcal{D}}(\\theta) + \\epsilon \\right\\} \\ge 1 - \\delta. \\tag{7} \\label{pacLearnability} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ L_{\\mathcal{D}}(A(\\mathcal{S})) \\le \\min_{\\theta} L_{\\mathcal{D}}(\\theta) + \\epsilon \\right\\} \\ge 1 - \\delta. \u5176\u4e2d \\epsilon \\epsilon \u8868\u793a\u7cbe\u5ea6\uff0c \\delta \\delta \u8868\u793a\u7f6e\u4fe1\u5ea6\u3002 \u9700\u8981\u5907\u6ce8\u7684\u662f\uff1a L_{\\mathcal{D}}(\\theta) L_{\\mathcal{D}}(\\theta) \u5927\u4e8e\u7b49\u4e8e0\uff1b \u5982\u679c \\min_{\\theta} L_{\\mathcal{D}}(\\theta) > 0 \\min_{\\theta} L_{\\mathcal{D}}(\\theta) > 0 \uff0c\u90a3\u4e48\u6211\u4eec\u79f0 \\mathcal{H} \\mathcal{H} \u662f Agnostic PAC Learnable \u7684\u3002 Agnostic \u8fd9\u4e2a\u8bcd\u662f\u60f3\u8bf4\uff0c\u6211\u4eec\u6784\u9020\u7684\u5047\u8bbe\u96c6\u4e0d\u591f\u5145\u5206\uff0c\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u8d85\u51fa\u4e86 \\mathcal{H} \\mathcal{H} \u7684\u8ba4\u77e5\u3002 \u6211\u4eec\u53ef\u4ee5\u5148\u5728\u4e00\u4e2a\u975e\u5e38\u975e\u5e38\u7279\u6b8a\u7684\u4f8b\u5b50\u505a\u5206\u6790\u3002 \u5bf9\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u5047\u8bbe\u96c6\u662f \\mathcal{H}_{\\theta} = \\{h_{\\theta_1}(\\mathbf{x}), h_{\\theta_2}(\\mathbf{x}), \\ldots, h_{\\theta_n}(\\mathbf{x})\\} \\mathcal{H}_{\\theta} = \\{h_{\\theta_1}(\\mathbf{x}), h_{\\theta_2}(\\mathbf{x}), \\ldots, h_{\\theta_n}(\\mathbf{x})\\} \uff0c\u5e76\u4e14\u5b58\u5728 h_{\\theta^*} h_{\\theta^*} \u6ee1\u8db3 L_{\\mathcal{D}}(\\theta^*) = 0 L_{\\mathcal{D}}(\\theta^*) = 0 (The Realizability Assumption)\u3002\u90a3\u4e48\uff0c\u4efb\u610f\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u81f3\u5c11\u6709\u4e00\u4e2a h_i(\\theta_i) h_i(\\theta_i) \u6ee1\u8db3 L_{\\mathcal{S}}(\\theta_i) = 0 L_{\\mathcal{S}}(\\theta_i) = 0 \uff0c\u5e76\u4e14\u6211\u4eec\u53ea\u4f1a\u4ece\u4e2d\u968f\u4fbf\u6311\u9009\u4e00\u4e2a\u5206\u7c7b\u51fd\u6570\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u5c31\u8981\u8bc1\u660e\uff0c\u968f\u4fbf\u6311\uff0c\u6311\u5230''\u6700\u5dee''\u7684\u4e5f\u6ca1\u5173\u7cfb\u3002 \u9996\u5148\u4ece\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u4e2d\u5206\u79bb\u51fa\u4e00\u4e2a\u574f\u5b50\u96c6 \\mathcal{H}_{bad} = \\{h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) > \\epsilon\\} \\mathcal{H}_{bad} = \\{h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) > \\epsilon\\} \u3002 \u6211\u4eec\u518d\u4ecb\u7ecd\u4e00\u4e2a\u574f\u7684\u6837\u672c\u96c6\u7684\u96c6\u5408 M_{bad} = \\{S \\sim \\mathcal{D}: \\exists h \\in \\mathcal{H}_{bad}, L_{S}(h) = 0\\} = \\cup_{h\\in\\mathcal{H}_{bad}} \\{ \\mathcal{S}: L_{\\mathcal{S}}(h) = 0 \\} M_{bad} = \\{S \\sim \\mathcal{D}: \\exists h \\in \\mathcal{H}_{bad}, L_{S}(h) = 0\\} = \\cup_{h\\in\\mathcal{H}_{bad}} \\{ \\mathcal{S}: L_{\\mathcal{S}}(h) = 0 \\} \u3002\u90a3\u4e48\uff0c \\tag{8} \\label{step1} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\}) \\le \\mathcal{P}_{S\\sim\\mathcal{D}}(M_{bad}) \\le \\sum^{}_{h \\in \\mathcal{H}_{bad}} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\}). \\tag{8} \\label{step1} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\}) \\le \\mathcal{P}_{S\\sim\\mathcal{D}}(M_{bad}) \\le \\sum^{}_{h \\in \\mathcal{H}_{bad}} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\}). \u5bf9\u4e8e\u4efb\u610f\u7684 h \\in \\mathcal{H}_{bad} h \\in \\mathcal{H}_{bad} \uff0c\u6211\u4eec\u53ef\u5f97 \\begin{align*} \\tag{9} \\label{step2} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ =& \\prod^{m}_{i=1} \\mathcal{P}_{(\\mathbf{x}_i, y_i)\\sim\\mathcal{D}}(c(y_i, h(\\mathbf{x}_i)))\\\\ \\le& (1 - \\epsilon)^{m} \\le e^{-\\epsilon m}. \\end{align*} \\begin{align*} \\tag{9} \\label{step2} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ =& \\prod^{m}_{i=1} \\mathcal{P}_{(\\mathbf{x}_i, y_i)\\sim\\mathcal{D}}(c(y_i, h(\\mathbf{x}_i)))\\\\ \\le& (1 - \\epsilon)^{m} \\le e^{-\\epsilon m}. \\end{align*} \u5e26\u5165 \\eqref{step1} \\eqref{step1} \u53ef\u5f97 \\begin{align*} \\tag{10} \\label{step3} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\})\\\\ \\le& \\vert \\mathcal{H}_{B} \\vert \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ \\le& \\vert \\mathcal{H} \\vert e^{-\\epsilon m} = n e^{-\\epsilon m}. \\end{align*} \\begin{align*} \\tag{10} \\label{step3} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\})\\\\ \\le& \\vert \\mathcal{H}_{B} \\vert \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ \\le& \\vert \\mathcal{H} \\vert e^{-\\epsilon m} = n e^{-\\epsilon m}. \\end{align*} \u6362\u53e5\u8bdd\u8bf4\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0c\u91c7\u6837\u590d\u6742\u5ea6\u4e3a m \\ge \\frac{\\ln(n/\\delta)}{\\epsilon} m \\ge \\frac{\\ln(n/\\delta)}{\\epsilon} \u3002 Note ( Bayes Optimal Predictor ). \u5bf9\u4e8e\u4e0a\u6587\u63d0\u5230\u7684\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u662f\u5b58\u5728\u6700\u4f18\u7684deterministc\u5206\u7c7b\u5668\uff0c\u6211\u4eec\u53eb\u5b83\u8d1d\u53f6\u65af\u6700\u4f18\u5206\u7c7b\u5668\uff1a f_{\\mathcal{D}}(\\mathbf{x}) = \\begin{cases} 1, &\\mathcal{P}_{D}[y = 1 \\vert \\mathbf{x}] \\ge 1/2;\\\\ 0, &otherwise. \\end{cases} f_{\\mathcal{D}}(\\mathbf{x}) = \\begin{cases} 1, &\\mathcal{P}_{D}[y = 1 \\vert \\mathbf{x}] \\ge 1/2;\\\\ 0, &otherwise. \\end{cases} Uniform Convergence \u00b6 \u5b9a\u4e492 ( \\pmb{\\epsilon} \\pmb{\\epsilon} - representative sample ). \u6211\u4eec\u8bc4\u4ef7\u4e00\u4e2a\u6837\u672c\u96c6\u662f \\epsilon \\epsilon -representative sample\uff0c \u6307\u7684\u662f\uff1a \\tag{11} \\label{representative} \\forall h \\in \\mathcal{H}, \\vert L_{S}(h) - L_{\\mathcal{D}}(h) \\vert \\le \\epsilon. \\tag{11} \\label{representative} \\forall h \\in \\mathcal{H}, \\vert L_{S}(h) - L_{\\mathcal{D}}(h) \\vert \\le \\epsilon. \u51ed\u76f4\u89c9\uff0c\u6837\u672c\u591f\u591a\u7684\u65f6\u5019\uff0c\u603b\u80fd\u6210\u4e3a \\epsilon \\epsilon -representative \u6837\u672c. \u5f53\u6837\u672c\u662f \\epsilon/2 \\epsilon/2 -representative\uff0c\u90a3\u4e48 \\tag{12} L_{\\mathcal{D}}(ERM(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + \\epsilon. \\tag{12} L_{\\mathcal{D}}(ERM(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + \\epsilon. \u8bc1\u660e\u5f88\u7b80\u5355\uff1a \u5bf9\u4e8e\u4efb\u610f\u7684 h \\in \\mathcal{H} h \\in \\mathcal{H} \uff0c \\tag{13} L_{\\mathcal{D}}(ERM(S)) \\le L_{S}(ERM(S)) + \\epsilon/2 \\le L_{S}(h) + \\epsilon/2 \\le L_{\\mathcal{D}}(h) + \\epsilon. \\tag{13} L_{\\mathcal{D}}(ERM(S)) \\le L_{S}(ERM(S)) + \\epsilon/2 \\le L_{S}(h) + \\epsilon/2 \\le L_{\\mathcal{D}}(h) + \\epsilon. \u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u4ecb\u7ecd Uniform Convergence \u4e86\u3002 \u5b9a\u4e493 ( Uniform Convergence ). \u6211\u4eec\u5f62\u5bb9\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u6709 Uniform Convergence \u6027\u8d28\uff0c\u8868\u793a\u5b58\u5728\u51fd\u6570 m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) \uff0c\u6ee1\u8db3\u5f53\u6837\u672c\u6570\u5927\u4e8e m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) \u65f6\uff0c \\tag{14} \\label{uniformConvergence} \\mathcal{P}_{S \\sim \\mathcal{D}} \\left\\{ S\\ is\\ \\epsilon\\ representative \\right\\} \\ge 1 - \\delta. \\tag{14} \\label{uniformConvergence} \\mathcal{P}_{S \\sim \\mathcal{D}} \\left\\{ S\\ is\\ \\epsilon\\ representative \\right\\} \\ge 1 - \\delta. \u5f88\u5bb9\u6613\uff0c\u6211\u4eec\u77e5\u9053PCA learnable\u7684\u91c7\u6837\u590d\u6742\u5ea6\u51fd\u6570\u6ee1\u8db3 m^{PCA}_{\\mathcal{H}}(\\delta, \\epsilon) \\le m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon/2) m^{PCA}_{\\mathcal{H}}(\\delta, \\epsilon) \\le m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon/2) \u3002 \u5b9a\u74061 ( Hoeffding's Inequality ) \u5bf9\u4e8e m m \u4e2a\u968f\u673a\u53d8\u91cf \\mathcal{X}_1 \\in [a_1, b_1], \\mathcal{X}_2 \\in [a_2, b_2], \\ldots, \\mathcal{X}_{m} \\in [a_m, b_m] \\mathcal{X}_1 \\in [a_1, b_1], \\mathcal{X}_2 \\in [a_2, b_2], \\ldots, \\mathcal{X}_{m} \\in [a_m, b_m] , \u5b83\u4eec\u7684\u5747\u503c\u968f\u673a\u53d8\u91cf \\bar{\\mathcal{X}} \\bar{\\mathcal{X}} \u6ee1\u8db3: \\tag{15} \\label{Hoeffding} \\mathcal{P}\\left\\{ \\vert \\bar{\\mathcal{X}} - \\mathbb{E} \\bar{\\mathcal{X}} \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ - \\frac{2 m^2 \\epsilon^2}{\\sum^{m}_{i=1}(b_i - a_i)^2} \\right\\}. \\tag{15} \\label{Hoeffding} \\mathcal{P}\\left\\{ \\vert \\bar{\\mathcal{X}} - \\mathbb{E} \\bar{\\mathcal{X}} \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ - \\frac{2 m^2 \\epsilon^2}{\\sum^{m}_{i=1}(b_i - a_i)^2} \\right\\}. \u6211\u4eec\u53d1\u73b0\u5728\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u635f\u5931\u51fd\u6570 \\eqref{classificationEmpiricalLoss} \\eqref{classificationEmpiricalLoss} \u4e2d\uff0c c(y, h(\\mathbf{x})) \\in [0, 1] c(y, h(\\mathbf{x})) \\in [0, 1] \u53ef\u4ee5\u770b\u6210\u968f\u673a\u53d8\u91cf\uff0c \u90a3\u4e48 L_{S}(h) L_{S}(h) \u5c31\u662f m m \u4e2a\u968f\u673a\u53d8\u91cf\u7684\u5747\u503c\uff0c\u5e76\u4e14 L_{\\mathcal{D}}(h) L_{\\mathcal{D}}(h) \u662f L_{S}(h) L_{S}(h) \u7684\u671f\u671b\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5e26\u5165\u970d\u592b\u542c\u4e0d\u7b49\u5f0f\uff0c\u53ef\u5f97\uff1a \\tag{16} \\forall h \\in \\mathcal{H}, \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ \\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \\tag{16} \\forall h \\in \\mathcal{H}, \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ \\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \u90a3\u4e48\uff0c\u53ef\u5f97 \\tag{17} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{\\exists h \\in \\mathcal{H},\\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\vert \\mathcal{H} \\vert \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \\tag{17} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{\\exists h \\in \\mathcal{H},\\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\vert \\mathcal{H} \\vert \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \u8fd9\u4e2a\u7ed3\u8bba\u6709\u4e00\u5b9a\u7684\u6cdb\u5316\u6027\uff0c\u5728\u5f88\u591a\u5176\u4ed6\u95ee\u9898\u4e2d\uff0c\u53ea\u8981\u635f\u5931\u51fd\u6570\u5bf9\u5e94\u4e8e c(y, h(\\mathbf{x})) c(y, h(\\mathbf{x})) \u7684\u9879\u90fd\u5728 [0, 1] [0, 1] \u8303\u56f4\u5185\uff0c\u90fd\u53ef\u4ee5\u6ee1\u8db3\u4e0a\u9762\u7684\u7ed3\u679c\u3002 \u6574\u7406\u4e00\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u5b9a\u7406\uff1a \u5b9a\u74062 \u5047\u8bbe\u96c6\u6709\u9650\u7684\u8bdd\uff0c\u5b83\u4e00\u5b9a\u662f agnostic PAC learnable \uff0c\u5e76\u4e14 \\tag{18} m^{UC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{2\\epsilon^2} \\right\\rceil, \\quad m^{PAC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{2\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{\\epsilon^2} \\right\\rceil. \\tag{18} m^{UC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{2\\epsilon^2} \\right\\rceil, \\quad m^{PAC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{2\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{\\epsilon^2} \\right\\rceil.","title":"PCA"},{"location":"ML/09-PCA/#pac-learning-framework","text":"\u6982\u7387\u6027\u5730\u8fd1\u4f3c\u5730\u6b63\u786e\u7684(PAC, Probably Approximately Correct)\u5b66\u4e60\u6846\u67b6\u662f\u975e\u5e38\u91cd\u8981\u7684\u6846\u67b6\uff0c \u5b83\u5c1d\u8bd5\u89e3\u51b3\u4e00\u4e9b\u672c\u8d28\u6027\u7684\u95ee\u9898\uff1a\u4ec0\u4e48\u5b66\u4e60\u662f\u6709\u6548\u7684\uff1f\u4ec0\u4e48\u5b66\u4e60\u662f\u56f0\u96be\u7684\uff1f\u6211\u4eec\u9700\u8981\u591a\u5c11\u7684\u6837\u672c\uff1f\u6709\u6ca1\u6709\u666e\u904d\u9002\u7528\u7684\u6a21\u578b\uff1f \u5f88\u591a\u4eba\u7c97\u66b4\u5730\u628a\u8fd9\u4e9b\u5f52\u7ed3\u4e3a''\u5927\u6570\u5b9a\u7406''\uff0c\u5176\u5b9e\u4e5f\u6ca1\u4ec0\u4e48\u4e0d\u5bf9\uff0c\u4e0d\u8fc7\u6211\u4eec\u5e0c\u671b\u6380\u5f00''\u5927\u6570\u5b9a\u7406''\u7684\u5e18\u5b50\uff0c\u518d\u8fdb\u4e00\u6b65\u5206\u6790\u4e00\u4e0b\u3002","title":"PAC Learning Framework"},{"location":"ML/09-PCA/#_1","text":"\u9996\u5148\u5b9a\u4e49\u6837\u672c\u7a7a\u95f4 \\{\\mathcal{X}, \\mathcal{Y}, \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y}\\} \\{\\mathcal{X}, \\mathcal{Y}, \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y}\\} , \u6211\u4eec\u901a\u5e38\u8ba4\u4e3a\u6837\u672c\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u5206\u5e03\uff0c\u5373 \\mathcal{Z} \\sim \\mathcal{D} \\mathcal{Z} \\sim \\mathcal{D} \u3002\u76d1\u7763\u5b66\u4e60\u7684\u5927\u90e8\u5206\u95ee\u9898\u6b63\u662f\u6c42\u89e3\u5bf9\u5e94\u7684\u4e00\u4e2a\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \u3002\u5f53\u6211\u4eec\u5df2\u77e5 \\mathbf{x} \\mathbf{x} , \u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) P_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u63a8\u65ad \\mathbf{y} \\mathbf{y} \u7684\u503c\u3002\u6211\u4eec\u7528\u7b26\u53f7 \\mathcal{Z}_{\\mathcal{D}} \\mathcal{Z}_{\\mathcal{D}} \u6765\u4ee3\u8868\u6837\u672c\u7a7a\u95f4 \\mathcal{Z} \\mathcal{Z} \u52a0\u4e0a\u6982\u7387\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u6211\u4eec\u5c31\u79f0\u5b83\u4e3a \u6837\u672c\u6d4b\u5ea6\u7a7a\u95f4 \u3002 \u5728\u7edf\u8ba1\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u53ea\u80fd\u591f\u91c7\u6837\u6765\u7aa5\u89c6\u6837\u672c\u6d4b\u5ea6\u7a7a\u95f4 \\mathcal{Z}_{\\mathcal{D}} \\mathcal{Z}_{\\mathcal{D}} \u7684\u6837\u5b50, \u6211\u4eec\u901a\u5e38\u628a\u72ec\u7acb\u540c\u5206\u5e03\u7684\u6837\u672c\u7ec4\u6210\u7684\u5408\u96c6\u79f0\u4e3a\u6837\u672c\u96c6: \\tag{1} \\label{samples} \\mathcal{S} = \\{(\\mathbf{x}_1, \\mathbf{y}_1), (\\mathbf{x}_2, \\mathbf{y}_2), \\ldots, (\\mathbf{x}_m, \\mathbf{y}_m)\\}. \\tag{1} \\label{samples} \\mathcal{S} = \\{(\\mathbf{x}_1, \\mathbf{y}_1), (\\mathbf{x}_2, \\mathbf{y}_2), \\ldots, (\\mathbf{x}_m, \\mathbf{y}_m)\\}. \u4e3a\u4e86\u6c42\u89e3 P_{\\mathcal{D}}(\\mathbf{y}\\vert \\mathbf{x}) P_{\\mathcal{D}}(\\mathbf{y}\\vert \\mathbf{x}) \uff0c\u6211\u4eec\u4f1a\u5148\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6: \\tag{2} \\label{hypothesisSet} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) \\right\\}. \\tag{2} \\label{hypothesisSet} \\mathcal{H}_{\\theta} = \\left\\{ P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) \\right\\}. \u8fd9\u4e2a\u5047\u8bbe\u96c6\u5305\u542b\u4e86\u6211\u4eec\u7684\u5148\u9a8c\u77e5\u8bc6\uff0c\u5e76\u4e14\u53ef\u4ee5\u7528\u6570\u5b66\u516c\u5f0f\u8868\u793a\uff0c\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u7528\u6570\u5b66\u5de5\u5177\u6765\u6c42\u89e3\u3002 \u63a5\u7740\uff0c\u6211\u4eec\u4f1a\u518d\u4f7f\u7528\u4e00\u4e9b\u5ea6\u91cf\u6982\u7387\u5206\u5e03\u4e4b\u95f4\u8ddd\u79bb\u7684\u51fd\u6570\u6765\u6784\u9020\u635f\u5931\u51fd\u6570\uff0c\u90a3\u4e48\u7edd\u5927\u90e8\u5206\u76d1\u7763\u5b66\u4e60\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u4e2a\u6570\u5b66\u95ee\u9898\uff1a \\tag{3} \\label{generalObjective} \\min_{\\theta} Distance(p_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \\Vert p_{\\theta}(\\mathbf{y} \\vert \\mathbf{x})). \\tag{3} \\label{generalObjective} \\min_{\\theta} Distance(p_{\\mathcal{D}}(\\mathbf{y} \\vert \\mathbf{x}) \\Vert p_{\\theta}(\\mathbf{y} \\vert \\mathbf{x})). \u6bd4\u5982\uff0c\u5f53\u6837\u672c\u7a7a\u95f4 \\mathcal{Y} = \\{0, 1\\} \\mathcal{Y} = \\{0, 1\\} \u65f6\uff0c\u6211\u4eec\u79f0\u8fd9\u4e2a\u95ee\u9898\u4e3a \u4e8c\u5206\u7c7b\u95ee\u9898 \uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 KL \u8ddd\u79bb\u6765\u5ea6\u91cf\u4e24\u4e2a\u5206\u5e03\u7684\u5dee\u522b\uff1a \\tag{4} \\label{classificationObjective} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ \\ln \\left( \\frac{P_{\\mathcal{D}}({y}\\vert \\mathbf{x})}{P_{\\theta}({y}\\vert \\mathbf{x})} \\right) \\right] \\right\\}. \\tag{4} \\label{classificationObjective} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ \\ln \\left( \\frac{P_{\\mathcal{D}}({y}\\vert \\mathbf{x})}{P_{\\theta}({y}\\vert \\mathbf{x})} \\right) \\right] \\right\\}. \u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u8981\u6c42 P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) P_{\\theta}(\\mathbf{y} \\vert \\mathbf{x}) \u5728 y = 0 y = 0 \u548c y = 1 y = 1 \u4e0a\u7684\u6982\u7387\u90fd\u5927\u4e8e0\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 Softmax \u51fd\u6570\u6765\u4fdd\u8bc1\u3002 \u6211\u4eec\u4e5f\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u66f4\u7b80\u5355\u7684\u5047\u8bbe\u96c6\uff0c\u53ea\u4f7f\u7528\u9000\u5316\u7684\u6982\u7387\u5206\u5e03\uff0c\u5373 P_{\\theta}(y = 1 \\vert \\mathbf{x}) = 1 P_{\\theta}(y = 1 \\vert \\mathbf{x}) = 1 \u6216\u8005 P_{\\theta}(y = 0 \\vert \\mathbf{x}) = 1 P_{\\theta}(y = 0 \\vert \\mathbf{x}) = 1 \uff0c\u6211\u4eec\u8868\u793a\u4e3a \\mathcal{H}_{\\theta} = \\left\\{ h_{\\theta}(\\mathbf{x}) \\right\\} \\mathcal{H}_{\\theta} = \\left\\{ h_{\\theta}(\\mathbf{x}) \\right\\} \uff0c\u8fd9\u91cc\u7684 h_\\theta(\\mathbf{x}) h_\\theta(\\mathbf{x}) \u8868\u793a\u6982\u7387\u4e3a1\u7684 y y \u503c\u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528 Wasserstein \u8ddd\u79bb\u6765\u8861\u91cf\u6765\u6784\u9020\u635f\u5931\u51fd\u6570\uff0c\u5176\u4e2d\u82b1\u8d39\u51fd\u6570\u4e3a c(a, b) = \\pmb{1}_{\\left\\{ a \\ne b \\right\\}} c(a, b) = \\pmb{1}_{\\left\\{ a \\ne b \\right\\}} : \\tag{5} \\label{classificationObjective2} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ c(y, h(\\mathbf{x}) \\right] \\right\\}. \\tag{5} \\label{classificationObjective2} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{\\mathbf{x} \\sim p_{\\mathcal{D}}(\\mathbf{x})} \\left\\{ \\mathbb{E}_{{y} \\sim P_{\\mathcal{D}}({y} \\vert \\mathbf{x})} \\left[ c(y, h(\\mathbf{x}) \\right] \\right\\}. \u6211\u4eec\u5f88\u5bb9\u6613\u53ef\u4ee5\u5f97\u5230\u5316\u7b80\u7684\u635f\u5931\u51fd\u6570 L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}[c(y, h(\\mathbf{x})] L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}[c(y, h(\\mathbf{x})] \u3002 \u518d\u56de\u5230\u672c\u5c0f\u8282\u5f00\u5934\u6211\u4eec\u8bf4\u7684\uff0c\u6211\u4eec\u53ea\u80fd\u83b7\u5f97\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, {y}_m)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, {y}_m)\\} , \u6240\u4ee5\u6211\u4eec\u4e5f\u53ea\u80fd\u4f18\u5316\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\uff1a \\tag{6} \\label{classificationEmpiricalLoss} \\min_{\\theta} L_{\\mathcal{S}}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} c(y_i, h_{\\theta}(\\mathbf{x}_i)). \\tag{6} \\label{classificationEmpiricalLoss} \\min_{\\theta} L_{\\mathcal{S}}(\\theta) = \\frac{1}{m} \\sum^{m}_{i=1} c(y_i, h_{\\theta}(\\mathbf{x}_i)). \u53e6\u5916\uff0c\u6211\u4eec\u628a\u6700\u5c0f\u5316\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u7684\u539f\u5219\u79f0\u4e3a \u7ecf\u9a8c\u98ce\u9669\u6700\u5c0f\u5316 (ERM, Empirical Risk Minimization)\u3002 \u7ec8\u4e8e\u8fdb\u5165\u6211\u4eec\u5173\u5fc3\u7684\u95ee\u9898\uff0cERM\u5b66\u51fa\u6765\u7684 h_S h_S \u7a76\u7adf\u6709\u591a\u597d\uff1f\u80fd\u4e0d\u80fd\u5b9a\u91cf\u5206\u6790\u5462\uff1f","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"ML/09-PCA/#pac","text":"\u5b9a\u4e491 ( PAC Learnability ). \u5982\u679c\u5047\u8bbe\u96c6\u662fPAC Learnable\u7684\uff0c\u5219\u8868\u793a\u5b58\u5728\u51fd\u6570 m_{\\mathcal{H}}(\\epsilon, \\delta) m_{\\mathcal{H}}(\\epsilon, \\delta) , \u548c\u67d0\u4e2a\u5b66\u4e60\u7b97\u6cd5 A A \u6ee1\u8db3\uff1a \u5f53\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \u5927\u5c0f\u5927\u4e8e m_{\\mathcal{H}}(\\epsilon, \\delta) m_{\\mathcal{H}}(\\epsilon, \\delta) \u65f6\uff0c \\tag{7} \\label{pacLearnability} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ L_{\\mathcal{D}}(A(\\mathcal{S})) \\le \\min_{\\theta} L_{\\mathcal{D}}(\\theta) + \\epsilon \\right\\} \\ge 1 - \\delta. \\tag{7} \\label{pacLearnability} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ L_{\\mathcal{D}}(A(\\mathcal{S})) \\le \\min_{\\theta} L_{\\mathcal{D}}(\\theta) + \\epsilon \\right\\} \\ge 1 - \\delta. \u5176\u4e2d \\epsilon \\epsilon \u8868\u793a\u7cbe\u5ea6\uff0c \\delta \\delta \u8868\u793a\u7f6e\u4fe1\u5ea6\u3002 \u9700\u8981\u5907\u6ce8\u7684\u662f\uff1a L_{\\mathcal{D}}(\\theta) L_{\\mathcal{D}}(\\theta) \u5927\u4e8e\u7b49\u4e8e0\uff1b \u5982\u679c \\min_{\\theta} L_{\\mathcal{D}}(\\theta) > 0 \\min_{\\theta} L_{\\mathcal{D}}(\\theta) > 0 \uff0c\u90a3\u4e48\u6211\u4eec\u79f0 \\mathcal{H} \\mathcal{H} \u662f Agnostic PAC Learnable \u7684\u3002 Agnostic \u8fd9\u4e2a\u8bcd\u662f\u60f3\u8bf4\uff0c\u6211\u4eec\u6784\u9020\u7684\u5047\u8bbe\u96c6\u4e0d\u591f\u5145\u5206\uff0c\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u8d85\u51fa\u4e86 \\mathcal{H} \\mathcal{H} \u7684\u8ba4\u77e5\u3002 \u6211\u4eec\u53ef\u4ee5\u5148\u5728\u4e00\u4e2a\u975e\u5e38\u975e\u5e38\u7279\u6b8a\u7684\u4f8b\u5b50\u505a\u5206\u6790\u3002 \u5bf9\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u5047\u8bbe\u96c6\u662f \\mathcal{H}_{\\theta} = \\{h_{\\theta_1}(\\mathbf{x}), h_{\\theta_2}(\\mathbf{x}), \\ldots, h_{\\theta_n}(\\mathbf{x})\\} \\mathcal{H}_{\\theta} = \\{h_{\\theta_1}(\\mathbf{x}), h_{\\theta_2}(\\mathbf{x}), \\ldots, h_{\\theta_n}(\\mathbf{x})\\} \uff0c\u5e76\u4e14\u5b58\u5728 h_{\\theta^*} h_{\\theta^*} \u6ee1\u8db3 L_{\\mathcal{D}}(\\theta^*) = 0 L_{\\mathcal{D}}(\\theta^*) = 0 (The Realizability Assumption)\u3002\u90a3\u4e48\uff0c\u4efb\u610f\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u81f3\u5c11\u6709\u4e00\u4e2a h_i(\\theta_i) h_i(\\theta_i) \u6ee1\u8db3 L_{\\mathcal{S}}(\\theta_i) = 0 L_{\\mathcal{S}}(\\theta_i) = 0 \uff0c\u5e76\u4e14\u6211\u4eec\u53ea\u4f1a\u4ece\u4e2d\u968f\u4fbf\u6311\u9009\u4e00\u4e2a\u5206\u7c7b\u51fd\u6570\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u5c31\u8981\u8bc1\u660e\uff0c\u968f\u4fbf\u6311\uff0c\u6311\u5230''\u6700\u5dee''\u7684\u4e5f\u6ca1\u5173\u7cfb\u3002 \u9996\u5148\u4ece\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u4e2d\u5206\u79bb\u51fa\u4e00\u4e2a\u574f\u5b50\u96c6 \\mathcal{H}_{bad} = \\{h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) > \\epsilon\\} \\mathcal{H}_{bad} = \\{h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) > \\epsilon\\} \u3002 \u6211\u4eec\u518d\u4ecb\u7ecd\u4e00\u4e2a\u574f\u7684\u6837\u672c\u96c6\u7684\u96c6\u5408 M_{bad} = \\{S \\sim \\mathcal{D}: \\exists h \\in \\mathcal{H}_{bad}, L_{S}(h) = 0\\} = \\cup_{h\\in\\mathcal{H}_{bad}} \\{ \\mathcal{S}: L_{\\mathcal{S}}(h) = 0 \\} M_{bad} = \\{S \\sim \\mathcal{D}: \\exists h \\in \\mathcal{H}_{bad}, L_{S}(h) = 0\\} = \\cup_{h\\in\\mathcal{H}_{bad}} \\{ \\mathcal{S}: L_{\\mathcal{S}}(h) = 0 \\} \u3002\u90a3\u4e48\uff0c \\tag{8} \\label{step1} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\}) \\le \\mathcal{P}_{S\\sim\\mathcal{D}}(M_{bad}) \\le \\sum^{}_{h \\in \\mathcal{H}_{bad}} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\}). \\tag{8} \\label{step1} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\}) \\le \\mathcal{P}_{S\\sim\\mathcal{D}}(M_{bad}) \\le \\sum^{}_{h \\in \\mathcal{H}_{bad}} \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\}). \u5bf9\u4e8e\u4efb\u610f\u7684 h \\in \\mathcal{H}_{bad} h \\in \\mathcal{H}_{bad} \uff0c\u6211\u4eec\u53ef\u5f97 \\begin{align*} \\tag{9} \\label{step2} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ =& \\prod^{m}_{i=1} \\mathcal{P}_{(\\mathbf{x}_i, y_i)\\sim\\mathcal{D}}(c(y_i, h(\\mathbf{x}_i)))\\\\ \\le& (1 - \\epsilon)^{m} \\le e^{-\\epsilon m}. \\end{align*} \\begin{align*} \\tag{9} \\label{step2} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ =& \\prod^{m}_{i=1} \\mathcal{P}_{(\\mathbf{x}_i, y_i)\\sim\\mathcal{D}}(c(y_i, h(\\mathbf{x}_i)))\\\\ \\le& (1 - \\epsilon)^{m} \\le e^{-\\epsilon m}. \\end{align*} \u5e26\u5165 \\eqref{step1} \\eqref{step1} \u53ef\u5f97 \\begin{align*} \\tag{10} \\label{step3} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\})\\\\ \\le& \\vert \\mathcal{H}_{B} \\vert \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ \\le& \\vert \\mathcal{H} \\vert e^{-\\epsilon m} = n e^{-\\epsilon m}. \\end{align*} \\begin{align*} \\tag{10} \\label{step3} &\\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{\\mathcal{D}}(h_S) \\ge \\epsilon\\})\\\\ \\le& \\vert \\mathcal{H}_{B} \\vert \\mathcal{P}_{S\\sim\\mathcal{D}}(\\{S: L_{S}(h) = 0\\})\\\\ \\le& \\vert \\mathcal{H} \\vert e^{-\\epsilon m} = n e^{-\\epsilon m}. \\end{align*} \u6362\u53e5\u8bdd\u8bf4\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0c\u91c7\u6837\u590d\u6742\u5ea6\u4e3a m \\ge \\frac{\\ln(n/\\delta)}{\\epsilon} m \\ge \\frac{\\ln(n/\\delta)}{\\epsilon} \u3002 Note ( Bayes Optimal Predictor ). \u5bf9\u4e8e\u4e0a\u6587\u63d0\u5230\u7684\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u662f\u5b58\u5728\u6700\u4f18\u7684deterministc\u5206\u7c7b\u5668\uff0c\u6211\u4eec\u53eb\u5b83\u8d1d\u53f6\u65af\u6700\u4f18\u5206\u7c7b\u5668\uff1a f_{\\mathcal{D}}(\\mathbf{x}) = \\begin{cases} 1, &\\mathcal{P}_{D}[y = 1 \\vert \\mathbf{x}] \\ge 1/2;\\\\ 0, &otherwise. \\end{cases} f_{\\mathcal{D}}(\\mathbf{x}) = \\begin{cases} 1, &\\mathcal{P}_{D}[y = 1 \\vert \\mathbf{x}] \\ge 1/2;\\\\ 0, &otherwise. \\end{cases}","title":"PAC"},{"location":"ML/09-PCA/#uniform-convergence","text":"\u5b9a\u4e492 ( \\pmb{\\epsilon} \\pmb{\\epsilon} - representative sample ). \u6211\u4eec\u8bc4\u4ef7\u4e00\u4e2a\u6837\u672c\u96c6\u662f \\epsilon \\epsilon -representative sample\uff0c \u6307\u7684\u662f\uff1a \\tag{11} \\label{representative} \\forall h \\in \\mathcal{H}, \\vert L_{S}(h) - L_{\\mathcal{D}}(h) \\vert \\le \\epsilon. \\tag{11} \\label{representative} \\forall h \\in \\mathcal{H}, \\vert L_{S}(h) - L_{\\mathcal{D}}(h) \\vert \\le \\epsilon. \u51ed\u76f4\u89c9\uff0c\u6837\u672c\u591f\u591a\u7684\u65f6\u5019\uff0c\u603b\u80fd\u6210\u4e3a \\epsilon \\epsilon -representative \u6837\u672c. \u5f53\u6837\u672c\u662f \\epsilon/2 \\epsilon/2 -representative\uff0c\u90a3\u4e48 \\tag{12} L_{\\mathcal{D}}(ERM(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + \\epsilon. \\tag{12} L_{\\mathcal{D}}(ERM(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + \\epsilon. \u8bc1\u660e\u5f88\u7b80\u5355\uff1a \u5bf9\u4e8e\u4efb\u610f\u7684 h \\in \\mathcal{H} h \\in \\mathcal{H} \uff0c \\tag{13} L_{\\mathcal{D}}(ERM(S)) \\le L_{S}(ERM(S)) + \\epsilon/2 \\le L_{S}(h) + \\epsilon/2 \\le L_{\\mathcal{D}}(h) + \\epsilon. \\tag{13} L_{\\mathcal{D}}(ERM(S)) \\le L_{S}(ERM(S)) + \\epsilon/2 \\le L_{S}(h) + \\epsilon/2 \\le L_{\\mathcal{D}}(h) + \\epsilon. \u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u4ecb\u7ecd Uniform Convergence \u4e86\u3002 \u5b9a\u4e493 ( Uniform Convergence ). \u6211\u4eec\u5f62\u5bb9\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u6709 Uniform Convergence \u6027\u8d28\uff0c\u8868\u793a\u5b58\u5728\u51fd\u6570 m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) \uff0c\u6ee1\u8db3\u5f53\u6837\u672c\u6570\u5927\u4e8e m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon) \u65f6\uff0c \\tag{14} \\label{uniformConvergence} \\mathcal{P}_{S \\sim \\mathcal{D}} \\left\\{ S\\ is\\ \\epsilon\\ representative \\right\\} \\ge 1 - \\delta. \\tag{14} \\label{uniformConvergence} \\mathcal{P}_{S \\sim \\mathcal{D}} \\left\\{ S\\ is\\ \\epsilon\\ representative \\right\\} \\ge 1 - \\delta. \u5f88\u5bb9\u6613\uff0c\u6211\u4eec\u77e5\u9053PCA learnable\u7684\u91c7\u6837\u590d\u6742\u5ea6\u51fd\u6570\u6ee1\u8db3 m^{PCA}_{\\mathcal{H}}(\\delta, \\epsilon) \\le m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon/2) m^{PCA}_{\\mathcal{H}}(\\delta, \\epsilon) \\le m^{UC}_{\\mathcal{H}}(\\delta, \\epsilon/2) \u3002 \u5b9a\u74061 ( Hoeffding's Inequality ) \u5bf9\u4e8e m m \u4e2a\u968f\u673a\u53d8\u91cf \\mathcal{X}_1 \\in [a_1, b_1], \\mathcal{X}_2 \\in [a_2, b_2], \\ldots, \\mathcal{X}_{m} \\in [a_m, b_m] \\mathcal{X}_1 \\in [a_1, b_1], \\mathcal{X}_2 \\in [a_2, b_2], \\ldots, \\mathcal{X}_{m} \\in [a_m, b_m] , \u5b83\u4eec\u7684\u5747\u503c\u968f\u673a\u53d8\u91cf \\bar{\\mathcal{X}} \\bar{\\mathcal{X}} \u6ee1\u8db3: \\tag{15} \\label{Hoeffding} \\mathcal{P}\\left\\{ \\vert \\bar{\\mathcal{X}} - \\mathbb{E} \\bar{\\mathcal{X}} \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ - \\frac{2 m^2 \\epsilon^2}{\\sum^{m}_{i=1}(b_i - a_i)^2} \\right\\}. \\tag{15} \\label{Hoeffding} \\mathcal{P}\\left\\{ \\vert \\bar{\\mathcal{X}} - \\mathbb{E} \\bar{\\mathcal{X}} \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ - \\frac{2 m^2 \\epsilon^2}{\\sum^{m}_{i=1}(b_i - a_i)^2} \\right\\}. \u6211\u4eec\u53d1\u73b0\u5728\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u635f\u5931\u51fd\u6570 \\eqref{classificationEmpiricalLoss} \\eqref{classificationEmpiricalLoss} \u4e2d\uff0c c(y, h(\\mathbf{x})) \\in [0, 1] c(y, h(\\mathbf{x})) \\in [0, 1] \u53ef\u4ee5\u770b\u6210\u968f\u673a\u53d8\u91cf\uff0c \u90a3\u4e48 L_{S}(h) L_{S}(h) \u5c31\u662f m m \u4e2a\u968f\u673a\u53d8\u91cf\u7684\u5747\u503c\uff0c\u5e76\u4e14 L_{\\mathcal{D}}(h) L_{\\mathcal{D}}(h) \u662f L_{S}(h) L_{S}(h) \u7684\u671f\u671b\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5e26\u5165\u970d\u592b\u542c\u4e0d\u7b49\u5f0f\uff0c\u53ef\u5f97\uff1a \\tag{16} \\forall h \\in \\mathcal{H}, \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ \\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \\tag{16} \\forall h \\in \\mathcal{H}, \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{ \\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \u90a3\u4e48\uff0c\u53ef\u5f97 \\tag{17} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{\\exists h \\in \\mathcal{H},\\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\vert \\mathcal{H} \\vert \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \\tag{17} \\mathcal{P}_{\\mathcal{S} \\sim \\mathcal{D}} \\left\\{\\exists h \\in \\mathcal{H},\\vert L_{\\mathcal{D}}(h) - L_{S}(h) \\vert \\ge \\epsilon \\right\\} \\le 2 \\vert \\mathcal{H} \\vert \\exp\\left\\{ {-2 m \\epsilon^2} \\right\\}. \u8fd9\u4e2a\u7ed3\u8bba\u6709\u4e00\u5b9a\u7684\u6cdb\u5316\u6027\uff0c\u5728\u5f88\u591a\u5176\u4ed6\u95ee\u9898\u4e2d\uff0c\u53ea\u8981\u635f\u5931\u51fd\u6570\u5bf9\u5e94\u4e8e c(y, h(\\mathbf{x})) c(y, h(\\mathbf{x})) \u7684\u9879\u90fd\u5728 [0, 1] [0, 1] \u8303\u56f4\u5185\uff0c\u90fd\u53ef\u4ee5\u6ee1\u8db3\u4e0a\u9762\u7684\u7ed3\u679c\u3002 \u6574\u7406\u4e00\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u5b9a\u7406\uff1a \u5b9a\u74062 \u5047\u8bbe\u96c6\u6709\u9650\u7684\u8bdd\uff0c\u5b83\u4e00\u5b9a\u662f agnostic PAC learnable \uff0c\u5e76\u4e14 \\tag{18} m^{UC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{2\\epsilon^2} \\right\\rceil, \\quad m^{PAC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{2\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{\\epsilon^2} \\right\\rceil. \\tag{18} m^{UC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{2\\epsilon^2} \\right\\rceil, \\quad m^{PAC}_{\\mathcal{H}} (\\epsilon, \\delta) \\le \\left\\lceil \\frac{2\\log(2\\vert\\mathcal{H}\\vert / \\delta)}{\\epsilon^2} \\right\\rceil.","title":"Uniform Convergence"},{"location":"ML/10-NoFreeLunch/","text":"No Free Lunch \u00b6 \u6ca1\u6709\u514d\u8d39\u5348\u9910\u662f\u673a\u5668\u5b66\u4e60\u91cc\u7684\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u7ed3\u8bba\uff0c\u90a3\u4e48\uff0c\u5b83\u7a76\u7adf\u6307\u7684\u662f\u4ec0\u4e48\u5462\uff1f \u6211\u4eec\u7a0d\u5fae\u4e25\u8c28\u5730\u8ba8\u8bba\u4e00\u4e0b\u3002 \u9996\u5148\u6211\u4eec\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a\u6709\u6ca1\u6709\u4e00\u4e2a\u4e07\u80fd\u7684\u5b66\u4e60\u65b9\u6cd5\uff0c\u5bf9\u6240\u6709\u540c\u7c7b\u578b\u7684\u95ee\u9898\u90fd\u80fd\u89e3\u7684\u6700\u597d\u5462\uff1f \u6211\u4eec\u5728\u89e3\u51b3\u4e00\u4e2a\u673a\u5668\u5b66\u4e60\u95ee\u9898\u7684\u65f6\u5019\uff0c \u6211\u4eec\u9700\u8981\u901a\u8fc7\u4e00\u4e2a\u5148\u9a8c\u77e5\u8bc6\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6\uff0c\u7136\u540e\u4ece\u5047\u8bbe\u96c6\u91cc\u6311\u51fa\u4e00\u4e2a\u6700\u63a5\u8fd1\u771f\u5b9e\u76ee\u6807\u5206\u5e03\u7684\u8fd1\u4f3c\u5206\u5e03\u6765\u3002\u90a3\u4e48\uff0c\u5982\u679c\u8fd9\u4e2a\u4e07\u80fd\u7684\u5b66\u4e60\u65b9\u6cd5\u5b58\u5728\uff0c\u5219\u610f\u5473\u7740\u8fd9\u4e2a\u5047\u8bbe\u96c6\u975e\u5e38\u5927\uff0c\u5305\u542b\u6240\u6709\u53ef\u80fd\u7684\u5206\u5e03\u3002 \u4e0a\u9762\u8fd9\u6bb5\u8bdd\u6bd4\u8f83\u62bd\u8c61\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bb2\u89e3\uff1a\u73b0\u5728\u6211\u4eec\u8981\u89e3\u51b3\u7684\u662f\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c \\mathbf{x}\\in\\mathbb{R}^d \\mathbf{x}\\in\\mathbb{R}^d \u5e76\u4e14 y \\in \\{0, 1\\} y \\in \\{0, 1\\} \u3002 P(y \\vert \\mathbf{x}) P(y \\vert \\mathbf{x}) \u5bf9\u5e94\u67d0\u4e2a\u672a\u77e5\u7684\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002\u90a3\u4e48\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u4e07\u80fd\u7684\u5b66\u4e60\u65b9\u6cd5\uff0c\u65e0\u8bba \\mathcal{D} \\mathcal{D} \u662f\u4ec0\u4e48\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u6982\u7387\u6e10\u8fdb\u6b63\u786e(PAC)\u7684\u3002 \u6ca1\u6709\u514d\u8d39\u5348\u9910 \u5b9a\u7406\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u6837\u672c\u518d\u591a\u4e5f\u4e0d\u53ef\u80fd\u3002 \u5b9a\u7406\u7684\u8bc1\u660e\uff0c\u4e14\u4e0d\u8bf4 \\mathcal{D} \\mathcal{D} \u662f\u4efb\u610f\u7684\u5206\u5e03\uff0c P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u662fdeterministic\u5206\u5e03\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\uff0c\u4e5f\u662f\u4e0d\u53ef\u80fd\u7684\u3002 deterministic \u5206\u5e03\u6307\u7684\u662f P_{\\mathcal{D}}(y = 1 \\vert \\mathbf{x}) = 1 P_{\\mathcal{D}}(y = 1 \\vert \\mathbf{x}) = 1 \u6216\u8005 P_{\\mathcal{D}}(y = 0 \\vert \\mathbf{x}) = 1 P_{\\mathcal{D}}(y = 0 \\vert \\mathbf{x}) = 1 \u3002 \u6211\u4eec\u9650\u5b9a\u6240\u9762\u5bf9\u7684\u4e8c\u5206\u7c7b\u673a\u5668\u5b66\u4e60\u95ee\u9898\u4e2d\uff0c P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u662f deterministic \u5206\u5e03, \u5e76\u4e14 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u662f\u5747\u5300\u5206\u5e03\u3002\u6211\u4eec\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u4e5f\u662f\u6240\u6709 deterministic deterministic \u5206\u5e03\u7684\u96c6\u5408\u3002\u90a3\u4e48 P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \\in \\mathcal{H} P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \\in \\mathcal{H} \u3002 \u63a5\u4e0b\u6765\u6211\u8981\u8bc1\u660e\uff0c\u65e0\u8bba\u6837\u672c\u6709\u591a\u5c11\u4e2a\uff0c\u6211\u4eec\u90fd\u4f1a\u5b58\u5728\u8fc7\u62df\u5408\u7684\u98ce\u9669\u3002 \u9996\u5148\uff0c\u6211\u4eec\u8ba8\u8bba\u4e00\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u8ba4\u4e3a\u771f\u5b9e\u6570\u636e\u96c6\u5408\u4e3a\u6709\u9650\u96c6\u5408 \\mathcal{Z} \\mathcal{Z} , \u5176\u4e2d \\vert \\mathcal{Z} \\vert = 2m \\vert \\mathcal{Z} \\vert = 2m \uff0c\u6211\u4eec\u4ece\u4e2d\u91c7\u96c6m\u4e2a\u6837\u672c \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u8fd9\u91cc\u8bbe\u6837\u672c\u96c6\u4e00\u5171\u53ef\u80fd\u6709 K K \u79cd\u3002\u53e6\u5916\uff0c\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u4f1a\u6709 T = 2^{2m} T = 2^{2m} \u79cd, \u5373 \\mathcal{D} \\in \\{\\mathcal{D}_1, \\mathcal{D}_2, \\ldots, \\mathcal{D}_{T}\\} \\mathcal{D} \\in \\{\\mathcal{D}_1, \\mathcal{D}_2, \\ldots, \\mathcal{D}_{T}\\} \u3002 \u8fd9\u91cc\u6211\u4eec\u7528 0-1 0-1 \u8bef\u5dee\u51fd\u6570\u6765\u8861\u91cf\u5206\u7c7b\u51fd\u6570\u3002 \u5173\u952e\u7684\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u5c06\u8981\u8bc1\u660e: \u5bf9\u4e8e\u4efb\u610f\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5 A A , \\tag{1} \\label{step1} \\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{4}. \\tag{1} \\label{step1} \\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{4}. \u8bc1\u660e \u63d0\u9192\uff0c\u5bf9\u4e8e\u6709\u9650\u96c6\u5408 \\mathcal{Z} \\mathcal{Z} , \u771f\u5b9e\u7684 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u662f\u5747\u5300\u5206\u5e03\u3002\u53e6\u5916\u5b9a\u4e49\uff1a\u5927\u5c0f\u4e3a m \u7684\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \u4e00\u5171\u53ef\u80fd\u6709 K K \u79cd\u3002 \\begin{align*} \\tag{2} \\label{step2} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\\\ =& \\max_{i} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\frac{1}{T} \\sum^{T}_{i=1} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{K} \\sum^{K}_{j=1} \\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\min_{j}\\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)). \\end{align*} \\begin{align*} \\tag{2} \\label{step2} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\\\ =& \\max_{i} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\frac{1}{T} \\sum^{T}_{i=1} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{K} \\sum^{K}_{j=1} \\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\min_{j}\\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)). \\end{align*} \u56e0\u4e3a\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \u4f1a\u6709\u91cd\u590d\u7684\u5143\u7d20\uff0c\u6211\u4eec\u5b9a\u4e49\u6ca1\u6709\u51fa\u73b0\u5728\u6837\u672c\u96c6\u4e2d\u7684\u5143\u7d20\u5bf9\u5e94\u7684\u96c6\u5408\u662f \\mathcal{Z}' = \\{(\\mathbf{x}_1, y_1), \\ldots, (\\mathbf{x}_p, y_p)\\} \\mathcal{Z}' = \\{(\\mathbf{x}_1, y_1), \\ldots, (\\mathbf{x}_p, y_p)\\} \uff0c\u5176\u4e2d p \\ge m p \\ge m \u3002\u6211\u4eec\u53ef\u5f97 \\begin{align*} \\tag{3} \\label{step3} &L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{2m} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}\\\\ \\ge& \\frac{1}{2p} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\\\ \\ge& \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}. \\end{align*} \\begin{align*} \\tag{3} \\label{step3} &L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{2m} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}\\\\ \\ge& \\frac{1}{2p} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\\\ \\ge& \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}. \\end{align*} \u6211\u4eec\u5e26\u5165 \\eqref{step2} \\eqref{step2} , \u53ef\u5f97 \\forall A \\forall A , \\begin{align*} \\tag{4} \\label{step4} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} \\frac{1}{T} \\sum^{T}_{i=1}1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\ge \\frac{1}{4}. \\end{align*} \\begin{align*} \\tag{4} \\label{step4} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} \\frac{1}{T} \\sum^{T}_{i=1}1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\ge \\frac{1}{4}. \\end{align*} \u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f\u53ca\u5176\u53d8\u79cd \u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f\u662f\uff1a P[Z \\ge a] \\le \\mathbb{E}[Z] / a. P[Z \\ge a] \\le \\mathbb{E}[Z] / a. \u5e76\u4e14\uff0c\u5982\u679c Z\\in[0,1] Z\\in[0,1] \\mathbb{E}[Z]=\\mu \\mathbb{E}[Z]=\\mu , \u90a3\u4e48 \\forall a \\in (0, 1) \\forall a \\in (0, 1) \uff0c P[Z>1-a]=1-\\mathbb{P}[Z\\le 1-a]=1-P[{1-a\\ge Z}] \\ge1-\\frac{\\mathbb{E}[1-Z]}{a}=1-\\frac{1-\\mu}{a}. P[Z>1-a]=1-\\mathbb{P}[Z\\le 1-a]=1-P[{1-a\\ge Z}] \\ge1-\\frac{\\mathbb{E}[1-Z]}{a}=1-\\frac{1-\\mu}{a}. \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u5f97\uff1a \\exists \\mathcal{D} \\exists \\mathcal{D} , \u6ee1\u8db3 \\tag{5} P_{S \\sim \\mathcal{D}}\\left[L_{\\mathcal{D}}(A(S)) \\ge \\frac{1}{8}\\right] \\ge \\frac{1}{7}. \\tag{5} P_{S \\sim \\mathcal{D}}\\left[L_{\\mathcal{D}}(A(S)) \\ge \\frac{1}{8}\\right] \\ge \\frac{1}{7}. \u8fdb\u4e00\u6b65\u6269\u5c55\u5730\u8bf4\uff0c\u5982\u679c \\mathcal{Z} \\mathcal{Z} \u4e2d\u7684 \\mathbf{x} \\mathbf{x} \u7a7a\u95f4\u662f\u8fde\u7eed\u7684, \u4e0d\u518d\u662f\u6709\u9650\u7684\uff0c\u90a3\u4e48\u6837\u672c m m \u518d\u5927\uff0c\u6211\u4eec\u4e5f\u4e0d\u53ef\u80fd\u6210\u529f\u5730\u5b66\u4e60\u3002","title":"No Free Lunch"},{"location":"ML/10-NoFreeLunch/#no-free-lunch","text":"\u6ca1\u6709\u514d\u8d39\u5348\u9910\u662f\u673a\u5668\u5b66\u4e60\u91cc\u7684\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u7ed3\u8bba\uff0c\u90a3\u4e48\uff0c\u5b83\u7a76\u7adf\u6307\u7684\u662f\u4ec0\u4e48\u5462\uff1f \u6211\u4eec\u7a0d\u5fae\u4e25\u8c28\u5730\u8ba8\u8bba\u4e00\u4e0b\u3002 \u9996\u5148\u6211\u4eec\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a\u6709\u6ca1\u6709\u4e00\u4e2a\u4e07\u80fd\u7684\u5b66\u4e60\u65b9\u6cd5\uff0c\u5bf9\u6240\u6709\u540c\u7c7b\u578b\u7684\u95ee\u9898\u90fd\u80fd\u89e3\u7684\u6700\u597d\u5462\uff1f \u6211\u4eec\u5728\u89e3\u51b3\u4e00\u4e2a\u673a\u5668\u5b66\u4e60\u95ee\u9898\u7684\u65f6\u5019\uff0c \u6211\u4eec\u9700\u8981\u901a\u8fc7\u4e00\u4e2a\u5148\u9a8c\u77e5\u8bc6\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6\uff0c\u7136\u540e\u4ece\u5047\u8bbe\u96c6\u91cc\u6311\u51fa\u4e00\u4e2a\u6700\u63a5\u8fd1\u771f\u5b9e\u76ee\u6807\u5206\u5e03\u7684\u8fd1\u4f3c\u5206\u5e03\u6765\u3002\u90a3\u4e48\uff0c\u5982\u679c\u8fd9\u4e2a\u4e07\u80fd\u7684\u5b66\u4e60\u65b9\u6cd5\u5b58\u5728\uff0c\u5219\u610f\u5473\u7740\u8fd9\u4e2a\u5047\u8bbe\u96c6\u975e\u5e38\u5927\uff0c\u5305\u542b\u6240\u6709\u53ef\u80fd\u7684\u5206\u5e03\u3002 \u4e0a\u9762\u8fd9\u6bb5\u8bdd\u6bd4\u8f83\u62bd\u8c61\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bb2\u89e3\uff1a\u73b0\u5728\u6211\u4eec\u8981\u89e3\u51b3\u7684\u662f\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c \\mathbf{x}\\in\\mathbb{R}^d \\mathbf{x}\\in\\mathbb{R}^d \u5e76\u4e14 y \\in \\{0, 1\\} y \\in \\{0, 1\\} \u3002 P(y \\vert \\mathbf{x}) P(y \\vert \\mathbf{x}) \u5bf9\u5e94\u67d0\u4e2a\u672a\u77e5\u7684\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002\u90a3\u4e48\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u4e07\u80fd\u7684\u5b66\u4e60\u65b9\u6cd5\uff0c\u65e0\u8bba \\mathcal{D} \\mathcal{D} \u662f\u4ec0\u4e48\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u6982\u7387\u6e10\u8fdb\u6b63\u786e(PAC)\u7684\u3002 \u6ca1\u6709\u514d\u8d39\u5348\u9910 \u5b9a\u7406\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u6837\u672c\u518d\u591a\u4e5f\u4e0d\u53ef\u80fd\u3002 \u5b9a\u7406\u7684\u8bc1\u660e\uff0c\u4e14\u4e0d\u8bf4 \\mathcal{D} \\mathcal{D} \u662f\u4efb\u610f\u7684\u5206\u5e03\uff0c P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u662fdeterministic\u5206\u5e03\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\uff0c\u4e5f\u662f\u4e0d\u53ef\u80fd\u7684\u3002 deterministic \u5206\u5e03\u6307\u7684\u662f P_{\\mathcal{D}}(y = 1 \\vert \\mathbf{x}) = 1 P_{\\mathcal{D}}(y = 1 \\vert \\mathbf{x}) = 1 \u6216\u8005 P_{\\mathcal{D}}(y = 0 \\vert \\mathbf{x}) = 1 P_{\\mathcal{D}}(y = 0 \\vert \\mathbf{x}) = 1 \u3002 \u6211\u4eec\u9650\u5b9a\u6240\u9762\u5bf9\u7684\u4e8c\u5206\u7c7b\u673a\u5668\u5b66\u4e60\u95ee\u9898\u4e2d\uff0c P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u662f deterministic \u5206\u5e03, \u5e76\u4e14 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u662f\u5747\u5300\u5206\u5e03\u3002\u6211\u4eec\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u4e5f\u662f\u6240\u6709 deterministic deterministic \u5206\u5e03\u7684\u96c6\u5408\u3002\u90a3\u4e48 P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \\in \\mathcal{H} P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \\in \\mathcal{H} \u3002 \u63a5\u4e0b\u6765\u6211\u8981\u8bc1\u660e\uff0c\u65e0\u8bba\u6837\u672c\u6709\u591a\u5c11\u4e2a\uff0c\u6211\u4eec\u90fd\u4f1a\u5b58\u5728\u8fc7\u62df\u5408\u7684\u98ce\u9669\u3002 \u9996\u5148\uff0c\u6211\u4eec\u8ba8\u8bba\u4e00\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u8ba4\u4e3a\u771f\u5b9e\u6570\u636e\u96c6\u5408\u4e3a\u6709\u9650\u96c6\u5408 \\mathcal{Z} \\mathcal{Z} , \u5176\u4e2d \\vert \\mathcal{Z} \\vert = 2m \\vert \\mathcal{Z} \\vert = 2m \uff0c\u6211\u4eec\u4ece\u4e2d\u91c7\u96c6m\u4e2a\u6837\u672c \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u8fd9\u91cc\u8bbe\u6837\u672c\u96c6\u4e00\u5171\u53ef\u80fd\u6709 K K \u79cd\u3002\u53e6\u5916\uff0c\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u4f1a\u6709 T = 2^{2m} T = 2^{2m} \u79cd, \u5373 \\mathcal{D} \\in \\{\\mathcal{D}_1, \\mathcal{D}_2, \\ldots, \\mathcal{D}_{T}\\} \\mathcal{D} \\in \\{\\mathcal{D}_1, \\mathcal{D}_2, \\ldots, \\mathcal{D}_{T}\\} \u3002 \u8fd9\u91cc\u6211\u4eec\u7528 0-1 0-1 \u8bef\u5dee\u51fd\u6570\u6765\u8861\u91cf\u5206\u7c7b\u51fd\u6570\u3002 \u5173\u952e\u7684\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u5c06\u8981\u8bc1\u660e: \u5bf9\u4e8e\u4efb\u610f\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5 A A , \\tag{1} \\label{step1} \\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{4}. \\tag{1} \\label{step1} \\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{4}. \u8bc1\u660e \u63d0\u9192\uff0c\u5bf9\u4e8e\u6709\u9650\u96c6\u5408 \\mathcal{Z} \\mathcal{Z} , \u771f\u5b9e\u7684 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u662f\u5747\u5300\u5206\u5e03\u3002\u53e6\u5916\u5b9a\u4e49\uff1a\u5927\u5c0f\u4e3a m \u7684\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \u4e00\u5171\u53ef\u80fd\u6709 K K \u79cd\u3002 \\begin{align*} \\tag{2} \\label{step2} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\\\ =& \\max_{i} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\frac{1}{T} \\sum^{T}_{i=1} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{K} \\sum^{K}_{j=1} \\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\min_{j}\\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)). \\end{align*} \\begin{align*} \\tag{2} \\label{step2} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\\\ =& \\max_{i} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\frac{1}{T} \\sum^{T}_{i=1} \\frac{1}{K} \\sum^{K}_{j=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{K} \\sum^{K}_{j=1} \\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ \\ge& \\min_{j}\\frac{1}{T} \\sum^{T}_{i=1} L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)). \\end{align*} \u56e0\u4e3a\u6837\u672c\u96c6 \\mathcal{S} \\mathcal{S} \u4f1a\u6709\u91cd\u590d\u7684\u5143\u7d20\uff0c\u6211\u4eec\u5b9a\u4e49\u6ca1\u6709\u51fa\u73b0\u5728\u6837\u672c\u96c6\u4e2d\u7684\u5143\u7d20\u5bf9\u5e94\u7684\u96c6\u5408\u662f \\mathcal{Z}' = \\{(\\mathbf{x}_1, y_1), \\ldots, (\\mathbf{x}_p, y_p)\\} \\mathcal{Z}' = \\{(\\mathbf{x}_1, y_1), \\ldots, (\\mathbf{x}_p, y_p)\\} \uff0c\u5176\u4e2d p \\ge m p \\ge m \u3002\u6211\u4eec\u53ef\u5f97 \\begin{align*} \\tag{3} \\label{step3} &L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{2m} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}\\\\ \\ge& \\frac{1}{2p} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\\\ \\ge& \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}. \\end{align*} \\begin{align*} \\tag{3} \\label{step3} &L_{\\mathcal{D}_i}(A(\\mathcal{S}_j)) \\\\ =& \\frac{1}{2m} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}\\\\ \\ge& \\frac{1}{2p} \\sum^{}_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\\\ \\ge& \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} 1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\}. \\end{align*} \u6211\u4eec\u5e26\u5165 \\eqref{step2} \\eqref{step2} , \u53ef\u5f97 \\forall A \\forall A , \\begin{align*} \\tag{4} \\label{step4} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} \\frac{1}{T} \\sum^{T}_{i=1}1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\ge \\frac{1}{4}. \\end{align*} \\begin{align*} \\tag{4} \\label{step4} &\\max_{i} \\mathbb{E}_{\\mathcal{S} \\sim \\mathcal{D}_i} [L_{\\mathcal{D}_i}(A(\\mathcal{S})] \\ge \\frac{1}{2} \\min_{(\\mathbf{x}, y) \\in \\mathcal{Z}'} \\frac{1}{T} \\sum^{T}_{i=1}1 \\{A(\\mathcal{S}_j)(\\mathbf{x}) \\ne y\\} \\ge \\frac{1}{4}. \\end{align*} \u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f\u53ca\u5176\u53d8\u79cd \u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f\u662f\uff1a P[Z \\ge a] \\le \\mathbb{E}[Z] / a. P[Z \\ge a] \\le \\mathbb{E}[Z] / a. \u5e76\u4e14\uff0c\u5982\u679c Z\\in[0,1] Z\\in[0,1] \\mathbb{E}[Z]=\\mu \\mathbb{E}[Z]=\\mu , \u90a3\u4e48 \\forall a \\in (0, 1) \\forall a \\in (0, 1) \uff0c P[Z>1-a]=1-\\mathbb{P}[Z\\le 1-a]=1-P[{1-a\\ge Z}] \\ge1-\\frac{\\mathbb{E}[1-Z]}{a}=1-\\frac{1-\\mu}{a}. P[Z>1-a]=1-\\mathbb{P}[Z\\le 1-a]=1-P[{1-a\\ge Z}] \\ge1-\\frac{\\mathbb{E}[1-Z]}{a}=1-\\frac{1-\\mu}{a}. \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u5f97\uff1a \\exists \\mathcal{D} \\exists \\mathcal{D} , \u6ee1\u8db3 \\tag{5} P_{S \\sim \\mathcal{D}}\\left[L_{\\mathcal{D}}(A(S)) \\ge \\frac{1}{8}\\right] \\ge \\frac{1}{7}. \\tag{5} P_{S \\sim \\mathcal{D}}\\left[L_{\\mathcal{D}}(A(S)) \\ge \\frac{1}{8}\\right] \\ge \\frac{1}{7}. \u8fdb\u4e00\u6b65\u6269\u5c55\u5730\u8bf4\uff0c\u5982\u679c \\mathcal{Z} \\mathcal{Z} \u4e2d\u7684 \\mathbf{x} \\mathbf{x} \u7a7a\u95f4\u662f\u8fde\u7eed\u7684, \u4e0d\u518d\u662f\u6709\u9650\u7684\uff0c\u90a3\u4e48\u6837\u672c m m \u518d\u5927\uff0c\u6211\u4eec\u4e5f\u4e0d\u53ef\u80fd\u6210\u529f\u5730\u5b66\u4e60\u3002","title":"No Free Lunch"},{"location":"ML/11-VCDimension/","text":"VC Dimension \u00b6 \u4ece \u6ca1\u6709\u514d\u8d39\u5348\u9910 \u5f97\u5230\u542f\u793a\uff1a\u5bf9\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u6211\u4eec\u5982\u679c\u4f7f\u7528\u67d0\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u5047\u8bbe\u96c6\uff0c\u90a3\u4e48\u5b66\u51fa\u6765\u7684\u5206\u7c7b\u5668\u5e76\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49\u3002\u90a3\u4e48\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u6211\u4eec\u7684\u5047\u8bbe\u96c6\u5e94\u8be5\u6ee1\u8db3\u4ec0\u4e48\u6027\u8d28\u624d\u80fd\u4fdd\u8bc1\u7b97\u6cd5\u662fPAC\u53ef\u5b66\u7684\u5462\uff1f\u8fd9\u91cc\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e2a\u6982\u5ff5\uff0cVC\u7ef4(\u7531Vladimir Vapnik \u548c Alexey Chervonenkis \u63d0\u51fa)\u3002 \u8fd9\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u628a\u95ee\u9898\u9650\u5236\u5728\u4e8c\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u5373\u6837\u672c\u7a7a\u95f4 \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y} \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y} , \u5176\u4e2d \\mathcal{Y} = \\{-1, 1\\} \\mathcal{Y} = \\{-1, 1\\} \u3002\u5e76\u4e14\uff0c\u6211\u4eec\u6784\u9020\u7684\u5047\u8bbe\u96c6 \\mathcal{H} = \\{ h(\\mathbf{x}) \\} \\mathcal{H} = \\{ h(\\mathbf{x}) \\} \u662fdeterministc\u5206\u5e03\u7684\u96c6\u5408\u3002 \u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = (\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m) \\mathcal{S} = (\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m) \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u7ed3\u5408 \\mathcal{S} \\mathcal{S} \u548c \u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\uff1a \\tag{1} \\label{restriction} \\mathcal{H}_{\\mathcal{S}} = \\{(h(\\mathbf{x}_1), h(\\mathbf{x}_2), \\ldots, h(\\mathbf{x}_m)), h \\in \\mathcal{H}, \\mathbf{x}_i \\in \\mathcal{S}\\}. \\tag{1} \\label{restriction} \\mathcal{H}_{\\mathcal{S}} = \\{(h(\\mathbf{x}_1), h(\\mathbf{x}_2), \\ldots, h(\\mathbf{x}_m)), h \\in \\mathcal{H}, \\mathbf{x}_i \\in \\mathcal{S}\\}. \u8fd9\u4e2a\u96c6\u5408\u662f \\mathcal{S} \\mathcal{S} \u4e0a\u7684\u4e00\u4e2a\u5047\u8bbe\u96c6\uff0c\u5e76\u4e14\u662f\u6709\u9650\u7684\uff0c \\vert \\mathcal{H}_{\\mathcal{S}} \\vert \\le 2^{m} \\vert \\mathcal{H}_{\\mathcal{S}} \\vert \\le 2^{m} \u3002\u5982\u679c \\vert \\mathcal{H}_{\\mathcal{S}} \\vert = 2^{m} \\vert \\mathcal{H}_{\\mathcal{S}} \\vert = 2^{m} , \u6211\u4eec\u79f0 \\mathcal{H} \\mathcal{H} shatters \\mathcal{S} \\mathcal{S} \u3002 \u5b9a\u4e49 ( VC Dimension ) \u7ed9\u5b9a\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \uff0c\u5b83\u7684VC\u7ef4\u662f $$ \\max \\vert \\mathcal{S} \\vert, \\quad \\vert \\mathcal{H}_{\\mathcal{S}} \\vert = 2 ^{\\vert \\mathcal{S} \\vert}. $$","title":"VC Dimension"},{"location":"ML/11-VCDimension/#vc-dimension","text":"\u4ece \u6ca1\u6709\u514d\u8d39\u5348\u9910 \u5f97\u5230\u542f\u793a\uff1a\u5bf9\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u6211\u4eec\u5982\u679c\u4f7f\u7528\u67d0\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u5047\u8bbe\u96c6\uff0c\u90a3\u4e48\u5b66\u51fa\u6765\u7684\u5206\u7c7b\u5668\u5e76\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49\u3002\u90a3\u4e48\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u6211\u4eec\u7684\u5047\u8bbe\u96c6\u5e94\u8be5\u6ee1\u8db3\u4ec0\u4e48\u6027\u8d28\u624d\u80fd\u4fdd\u8bc1\u7b97\u6cd5\u662fPAC\u53ef\u5b66\u7684\u5462\uff1f\u8fd9\u91cc\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e2a\u6982\u5ff5\uff0cVC\u7ef4(\u7531Vladimir Vapnik \u548c Alexey Chervonenkis \u63d0\u51fa)\u3002 \u8fd9\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u628a\u95ee\u9898\u9650\u5236\u5728\u4e8c\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u5373\u6837\u672c\u7a7a\u95f4 \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y} \\mathcal{Z} = \\mathcal{X} \\times \\mathcal{Y} , \u5176\u4e2d \\mathcal{Y} = \\{-1, 1\\} \\mathcal{Y} = \\{-1, 1\\} \u3002\u5e76\u4e14\uff0c\u6211\u4eec\u6784\u9020\u7684\u5047\u8bbe\u96c6 \\mathcal{H} = \\{ h(\\mathbf{x}) \\} \\mathcal{H} = \\{ h(\\mathbf{x}) \\} \u662fdeterministc\u5206\u5e03\u7684\u96c6\u5408\u3002 \u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = (\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m) \\mathcal{S} = (\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m) \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u7ed3\u5408 \\mathcal{S} \\mathcal{S} \u548c \u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\uff1a \\tag{1} \\label{restriction} \\mathcal{H}_{\\mathcal{S}} = \\{(h(\\mathbf{x}_1), h(\\mathbf{x}_2), \\ldots, h(\\mathbf{x}_m)), h \\in \\mathcal{H}, \\mathbf{x}_i \\in \\mathcal{S}\\}. \\tag{1} \\label{restriction} \\mathcal{H}_{\\mathcal{S}} = \\{(h(\\mathbf{x}_1), h(\\mathbf{x}_2), \\ldots, h(\\mathbf{x}_m)), h \\in \\mathcal{H}, \\mathbf{x}_i \\in \\mathcal{S}\\}. \u8fd9\u4e2a\u96c6\u5408\u662f \\mathcal{S} \\mathcal{S} \u4e0a\u7684\u4e00\u4e2a\u5047\u8bbe\u96c6\uff0c\u5e76\u4e14\u662f\u6709\u9650\u7684\uff0c \\vert \\mathcal{H}_{\\mathcal{S}} \\vert \\le 2^{m} \\vert \\mathcal{H}_{\\mathcal{S}} \\vert \\le 2^{m} \u3002\u5982\u679c \\vert \\mathcal{H}_{\\mathcal{S}} \\vert = 2^{m} \\vert \\mathcal{H}_{\\mathcal{S}} \\vert = 2^{m} , \u6211\u4eec\u79f0 \\mathcal{H} \\mathcal{H} shatters \\mathcal{S} \\mathcal{S} \u3002 \u5b9a\u4e49 ( VC Dimension ) \u7ed9\u5b9a\u5047\u8bbe\u96c6 \\mathcal{H} \\mathcal{H} \uff0c\u5b83\u7684VC\u7ef4\u662f $$ \\max \\vert \\mathcal{S} \\vert, \\quad \\vert \\mathcal{H}_{\\mathcal{S}} \\vert = 2 ^{\\vert \\mathcal{S} \\vert}. $$","title":"VC Dimension"},{"location":"RL/01-MarkovChains/","text":"\u9a6c\u5c14\u79d1\u592b\u94fe \u00b6 \u9a6c\u5c14\u53ef\u592b\u94fe\u662f\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u968f\u673a\u8fc7\u7a0b\u4e2d\u7684\u6570\u5b66\u6a21\u578b\u3002 \u5b83\u975e\u5e38\u7b80\u6d01\u3001\u7b26\u5408\u76f4\u89c9\u6027\u4ee5\u53ca\u8db3\u591f\u5f3a\u5927\uff0c\u8ba9\u4eba\u4e00\u5ea6\u89c9\u5f97\u5b83\u53ef\u4ee5\u63cf\u8ff0\u6574\u4e2a\u4e16\u754c\u7684\u4e8b\u4ef6\u3002 \u8fd9\u91cc\u5927\u5bb6\u5e94\u8be5\u80fd\u60f3\u5230\u5f53\u5e74\u7ecf\u5178\u529b\u5b66\u53d1\u5c55\u5230\u9876\u5cf0\u7684\u65f6\u5019\uff0c\u4eba\u4eec\u4e00\u5ea6\u4ee5\u4e3a\uff1a \u53ea\u8981\u5bf9\u73b0\u6709\u4e16\u754c\u5efa\u6a21\u591f\u51c6\uff0c\u5c31\u80fd\u591f\u7cbe\u51c6\u5730\u9884\u6d4b\u672a\u6765\u3002 \u6b63\u5982\u7ecf\u5178\u529b\u5b66\u5730\u5c40\u9650\u6027\uff0c\u9a6c\u5c14\u79d1\u592b\u94fe\u4e5f\u4e0d\u662f\u4e00\u4e2a\u4e07\u80fd\u7684\u968f\u673a\u8fc7\u7a0b\u6a21\u578b\u3002 \u4f46\u662f\uff0c\u6211\u4eec\u4eba\u7c7b\u7684\u5927\u8111\u662f\u600e\u4e48\u5efa\u6a21\u8fd9\u4e2a\u4e16\u754c\u7684\u5462\uff1f \u5982\u679c\u6211\u4eec\u7684\u5927\u8111\u5c31\u662f\u628a\u8fd9\u4e2a\u4e16\u754c\u7b80\u5316\u6210\u9a6c\u5c14\u53ef\u592b\u94fe\u5462\uff1f \u90a3\u4e48\u662f\u4e0d\u662f\u610f\u5473\u7740\u667a\u80fd\u8db3\u591f\u5728\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\u5efa\u6a21\u5f97\u4e16\u754c\u4e0a\u4ea7\u751f\uff1f \u8fd9\u4e2a\u5047\u8bbe\u9f13\u52b1\u4e86\u6211\u4eec\u5bf9\u5f3a\u5316\u5b66\u4e60\u7684\u7814\u7a76,\u6211\u76f8\u4fe1\u5f3a\u5316\u5b66\u4e60\u662f\u4eba\u5de5\u667a\u80fd\u7684\u91cd\u8981\u4e00\u73af\u3002 \u5b9a\u4e49 \u00b6 \u6211\u4eec\u76ee\u524d\u53ea\u6d89\u53ca\u79bb\u6563\u7684\u968f\u673a\u8fc7\u7a0b\uff0c\u65f6\u95f4\u88ab\u5206\u5272\u6210\u81ea\u7136\u6570\u5e8f\u5217 [0, 1, 2, \\ldots] [0, 1, 2, \\ldots] \uff0c \u6bcf\u4e2a\u65f6\u95f4\u70b9\u6709\u4e00\u4e2a\u968f\u673a\u53d8\u91cf S_t S_t , \u90a3\u4e48\u56e0\u4e3a\u65f6\u95f4\u7ef4\u5ea6\u7684\u7279\u6b8a\u6027\uff0c \u8fd9\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u8fc7\u7a0b (S_0, S_1, S_2, \\ldots) (S_0, S_1, S_2, \\ldots) \u3002 \u8fd9\u4e2a\u968f\u673a\u8fc7\u7a0b\u7684\u6837\u672c\u7a7a\u95f4\u662f\u4e00\u4e2a\u6982\u7387\u7a7a\u95f4\uff0c\u5373\u6bcf\u4e2a\u6837\u672c\u670d\u4ece\u67d0\u4e2a\u6982\u7387\u5206\u5e03 (s_0, s_1, s_2, \\ldots) \\sim p (s_0, s_1, s_2, \\ldots) \\sim p \u3002 \u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u628a\u6bcf\u4e2a\u6837\u672c\u5f20\u6210\u4e00\u4e2a\u7ef4\u5ea6\u975e\u5e38\u9ad8\u7684\u5411\u91cf\uff0c\u9000\u5316\u6210\u67d0\u79cd\u76d1\u7763\u5b66\u4e60\u6216\u8005\u65e0\u76d1\u7763\u5b66\u4e60\u7684\u95ee\u9898\u3002 \u4f46\u662f\uff0c\u5f53\u6211\u4eec\u5148\u9a8c\u6027\u5730\u7ed9\u6570\u636e\u8d4b\u4e88 \u8fc7\u7a0b \u8fd9\u79cd\u5148\u9a8c\u7ed3\u6784\u4fe1\u606f\uff0c\u6211\u4eec\u4e5f\u5c31\u589e\u52a0\u4e86\u66f4\u591a\u7684\u64cd\u4f5c\u7a7a\u95f4\u3002 \u8fc7\u7a0b \u5c31\u662f\u67d0\u79cd\u6982\u7387\u56fe\uff0c\u6982\u7387\u9010\u5c42\u4f20\u9012\uff0c\u5373\u6211\u4eec\u8ba4\u4e3a S_t S_t \u7684\u968f\u673a\u53d8\u91cf\u7531 (S_0, S_1, \\ldots, S_{t-1}) (S_0, S_1, \\ldots, S_{t-1}) \u51b3\u5b9a\uff1a \\tag{1} p(S_t) = p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}). \\tag{1} p(S_t) = p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}). \u800c\u9a6c\u5c14\u53ef\u592b\u94fe\u5c31\u662f\u66f4\u8fdb\u4e00\u6b65\u7b80\u5316\u7248\u7684\u968f\u673a\u8fc7\u7a0b\u3002 \u5b9a\u4e49 ( \u9a6c\u5c14\u79d1\u592b\u94fe ). \u79bb\u6563\u968f\u673a\u8fc7\u7a0b\u53eb\u505a\u9a6c\u5c14\u53ef\u592b\u94fe\uff0c\u8868\u793a\uff1a \\tag{2} p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}) = p(S_t \\vert S_{t-1} = s_{t-1}). \\tag{2} p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}) = p(S_t \\vert S_{t-1} = s_{t-1}). \u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u524d\u65f6\u523b\u7684\u968f\u673a\u53d8\u91cf\u53ea\u4e0e\u524d\u4e00\u65f6\u523b\u7684\u968f\u673a\u53d8\u91cf\u6709\u5173\u3002 \u6211\u4eec\u5047\u8bbe S_t S_t \u968f\u673a\u53d8\u91cf\u90fd\u662f\u5728\u96c6\u5408 \\mathcal{S} \\mathcal{S} \u4e0a\uff0c\u90a3\u4e48\u9a6c\u5c14\u53ef\u592b\u94fe\u5c31\u662f\u4e00\u4e2a\u6d4b\u5ea6\u7a7a\u95f4\uff0c \\tag{3} \\mathcal{MC} = \\{\\Omega = \\{\\tau = (s_0, s_1, \\ldots, s_t, \\ldots) \\vert s_t \\in \\mathcal{S}\\}, \\sigma(\\Omega), \\mu\\}, \\tag{3} \\mathcal{MC} = \\{\\Omega = \\{\\tau = (s_0, s_1, \\ldots, s_t, \\ldots) \\vert s_t \\in \\mathcal{S}\\}, \\sigma(\\Omega), \\mu\\}, \u5176\u4e2d \\mu(\\tau) = p_0(s_0) \\prod^{\\infty}_{t = 0}p(s_{t+1} \\vert s_t) \\mu(\\tau) = p_0(s_0) \\prod^{\\infty}_{t = 0}p(s_{t+1} \\vert s_t) \u3002 \u6240\u4ee5\uff0c\u8868\u793a\u4e00\u4e2a\u9a6c\u5c14\u79d1\u592b\u94fe\u53ef\u4ee5\u7b80\u5316\u4e3a \\tag{4} \\mathcal{MC} = (\\mathcal{S}, p_0, p). \\tag{4} \\mathcal{MC} = (\\mathcal{S}, p_0, p). \u5982\u679c \\mathcal{S} \\mathcal{S} \u662f\u53ef\u6570\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635 \\mathbf{P} \\mathbf{P} : \\begin{equation*} \\tag{5} \\mathbf{P} = \\begin{bmatrix} p(s1 \\vert s1) & p(s2 \\vert s1) & \\cdots & p(sn \\vert s1) & \\cdots \\\\ p(s1 \\vert s2) & p(s2 \\vert s2) & \\cdots & p(sn \\vert s2) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\\\ p(sn \\vert sn) & p(s2 \\vert sn) & \\cdots & p(sn \\vert sn) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\end{bmatrix}, \\end{equation*} \\begin{equation*} \\tag{5} \\mathbf{P} = \\begin{bmatrix} p(s1 \\vert s1) & p(s2 \\vert s1) & \\cdots & p(sn \\vert s1) & \\cdots \\\\ p(s1 \\vert s2) & p(s2 \\vert s2) & \\cdots & p(sn \\vert s2) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\\\ p(sn \\vert sn) & p(s2 \\vert sn) & \\cdots & p(sn \\vert sn) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\end{bmatrix}, \\end{equation*} \u6ce8\u610f \\mathbf{P} \\pmb{1} = \\pmb{1} \\mathbf{P} \\pmb{1} = \\pmb{1} \u3002 \u7a33\u5b9a\u5206\u5e03(Stationary Distribution) \u00b6 \u5728\u8fd9\u4e00\u8282\uff0c\u6211\u4eec\u5206\u4eab\u4e00\u4e2a\u9a6c\u5c14\u79d1\u592b\u94fe\u4e2d\u7684\u91cd\u8981\u7ed3\u8bba\u3002 \u5b9a\u7406 ( Perron-Frobenius theorem ) If a matrix \\mathbf{A} \\mathbf{A} is irreducible 1 , then \\mathbf{A} \\mathbf{A} has a positive real eigenvalue \\lambda_{\\max} \\lambda_{\\max} such that all other eigenvalues of \\mathbf{A} \\mathbf{A} satisfy \\vert \\lambda \\vert < \\lambda_{\\max} \\vert \\lambda \\vert < \\lambda_{\\max} . Furthermore, \\lambda_{\\max} \\lambda_{\\max} has algebraic 2 and geometric 3 multiplicity one, and has an eigenvector \\mathbf{x} \\mathbf{x} with \\mathbf{x} \\succ 0 \\mathbf{x} \\succ 0 . Any nonnegative eigenvector is a multiper of \\mathbf{x} \\mathbf{x} . \u56e0\u4e3a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635 \\mathbf{P} \\mathbf{1} = \\mathbf{1} \\mathbf{P} \\mathbf{1} = \\mathbf{1} \u3002 \u5982\u679c\u9a6c\u5c14\u79d1\u592b\u94fe\u662f irreducible irreducible \u4ee5\u53ca aperiodical aperiodical \u7684\uff08\u6ee1\u8db3\u4e0a\u9762\u5b9a\u7406\u7684\u8981\u6c42\uff09\uff0c\u90a3\u4e48 1 \u662f \\mathbf{P} \\mathbf{P} \u7684\u7279\u5f81\u503c\u3002 \u63a5\u4e0b\u6765\u6211\u4eec\u8981\u8bc1\u660e\u5b83\u7684\u6700\u5927\u7279\u5f81\u503c\u662f1\u3002 \u9996\u5148\u5b83\u7684\u7279\u5f81\u503c \\lambda \\lambda \u6ee1\u8db3 \\mathbf{P} \\mathbf{z} = \\lambda \\mathbf{z}, \\mathbf{P} \\mathbf{z} = \\lambda \\mathbf{z}, \u90a3\u4e48 \\sum^{}_{j} p_{kj} z_j = \\lambda z_k, \\sum^{}_{j} p_{kj} z_j = \\lambda z_k, \u5176\u4e2d z_k z_k \u662f \\mathbf{z} \\mathbf{z} \u4e2d\u7684\u6700\u5927\u5206\u91cf\u3002 \u6240\u4ee5 \\vert \\lambda z_k \\vert = \\vert \\sum^{}_{j} p_{kj} z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_k \\vert \\le \\vert z_k \\vert, \\vert \\lambda z_k \\vert = \\vert \\sum^{}_{j} p_{kj} z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_k \\vert \\le \\vert z_k \\vert, \u6240\u4ee5 \\vert \\lambda \\vert \\le 1 \\vert \\lambda \\vert \\le 1 \u3002 \u56e0\u4e3a \\mathbf{P}^T \\mathbf{P}^T \u7684\u7279\u5f81\u503c\u548c \\mathbf{P} \\mathbf{P} \u76f8\u540c, \u6240\u4ee5 \\mathbf{P}^T \\mathbf{P}^T \u7684\u6700\u5927\u7279\u5f81\u503c\u662f1, \u5b83\u4e5f\u5b58\u5728\u552f\u4e00\u7684\u7279\u5f81\u503c \\mathbf{\\pi} \\mathbf{\\pi} \u6ee1\u8db3 \\mathbf{P}^T \\mathbf{\\pi} = \\mathbf{\\pi} \\mathbf{P}^T \\mathbf{\\pi} = \\mathbf{\\pi} \u3002 \u6211\u4eec\u79f0 \\mathbf{\\pi} \\mathbf{\\pi} \u662f\u9a6c\u5c14\u53ef\u592b\u94fe\u7684**\u7a33\u5b9a\u5206\u5e03**\u3002\u6211\u4eec\u4e3a\u4ec0\u4e48\u53eb\u5b83\u662f\u7a33\u5b9a\u5206\u5e03\u5462\uff1f \u56e0\u4e3a\u5bf9\u4e8e\u4efb\u610f\u7684\u521d\u59cb\u5206\u5e03 \\mathbf{p}_0 \\mathbf{p}_0 , \u6211\u4eec\u5b9a\u4e49 \\mathbf{p}_{\\infty} = \\lim_{k \\rightarrow \\infty} (\\mathbf{P}^T)^k \\mathbf{p}_0 \\mathbf{p}_{\\infty} = \\lim_{k \\rightarrow \\infty} (\\mathbf{P}^T)^k \\mathbf{p}_0 , \u90a3\u4e48 \\mathbf{p}_{\\infty} = \\mathbf{P}^T \\mathbf{p}_{\\infty} \\mathbf{p}_{\\infty} = \\mathbf{P}^T \\mathbf{p}_{\\infty} \u3002 \u56e0\u4e3a\u7279\u5f81\u503c\u7684\u552f\u4e00\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\mathbf{p}_{\\infty} = \\mathbf{\\pi} \\mathbf{p}_{\\infty} = \\mathbf{\\pi} \u3002 \\mathbf{A} \\mathbf{A} is called irreducible if for any i, j there is k_{ij} k_{ij} such that (\\mathbf{A}^k)_{ij} > 0 (\\mathbf{A}^k)_{ij} > 0 . \u21a9 Algebraic multiplicity is the number of times an eigenvalue appears in a characteristic polynomial of a matrix. \u21a9 Geometric multiplicity is the nullity of \\mathbf{I} - \\lambda \\mathbf{A} \\mathbf{I} - \\lambda \\mathbf{A} . \u21a9","title":"Markov Chains"},{"location":"RL/01-MarkovChains/#_1","text":"\u9a6c\u5c14\u53ef\u592b\u94fe\u662f\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u968f\u673a\u8fc7\u7a0b\u4e2d\u7684\u6570\u5b66\u6a21\u578b\u3002 \u5b83\u975e\u5e38\u7b80\u6d01\u3001\u7b26\u5408\u76f4\u89c9\u6027\u4ee5\u53ca\u8db3\u591f\u5f3a\u5927\uff0c\u8ba9\u4eba\u4e00\u5ea6\u89c9\u5f97\u5b83\u53ef\u4ee5\u63cf\u8ff0\u6574\u4e2a\u4e16\u754c\u7684\u4e8b\u4ef6\u3002 \u8fd9\u91cc\u5927\u5bb6\u5e94\u8be5\u80fd\u60f3\u5230\u5f53\u5e74\u7ecf\u5178\u529b\u5b66\u53d1\u5c55\u5230\u9876\u5cf0\u7684\u65f6\u5019\uff0c\u4eba\u4eec\u4e00\u5ea6\u4ee5\u4e3a\uff1a \u53ea\u8981\u5bf9\u73b0\u6709\u4e16\u754c\u5efa\u6a21\u591f\u51c6\uff0c\u5c31\u80fd\u591f\u7cbe\u51c6\u5730\u9884\u6d4b\u672a\u6765\u3002 \u6b63\u5982\u7ecf\u5178\u529b\u5b66\u5730\u5c40\u9650\u6027\uff0c\u9a6c\u5c14\u79d1\u592b\u94fe\u4e5f\u4e0d\u662f\u4e00\u4e2a\u4e07\u80fd\u7684\u968f\u673a\u8fc7\u7a0b\u6a21\u578b\u3002 \u4f46\u662f\uff0c\u6211\u4eec\u4eba\u7c7b\u7684\u5927\u8111\u662f\u600e\u4e48\u5efa\u6a21\u8fd9\u4e2a\u4e16\u754c\u7684\u5462\uff1f \u5982\u679c\u6211\u4eec\u7684\u5927\u8111\u5c31\u662f\u628a\u8fd9\u4e2a\u4e16\u754c\u7b80\u5316\u6210\u9a6c\u5c14\u53ef\u592b\u94fe\u5462\uff1f \u90a3\u4e48\u662f\u4e0d\u662f\u610f\u5473\u7740\u667a\u80fd\u8db3\u591f\u5728\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\u5efa\u6a21\u5f97\u4e16\u754c\u4e0a\u4ea7\u751f\uff1f \u8fd9\u4e2a\u5047\u8bbe\u9f13\u52b1\u4e86\u6211\u4eec\u5bf9\u5f3a\u5316\u5b66\u4e60\u7684\u7814\u7a76,\u6211\u76f8\u4fe1\u5f3a\u5316\u5b66\u4e60\u662f\u4eba\u5de5\u667a\u80fd\u7684\u91cd\u8981\u4e00\u73af\u3002","title":"\u9a6c\u5c14\u79d1\u592b\u94fe"},{"location":"RL/01-MarkovChains/#_2","text":"\u6211\u4eec\u76ee\u524d\u53ea\u6d89\u53ca\u79bb\u6563\u7684\u968f\u673a\u8fc7\u7a0b\uff0c\u65f6\u95f4\u88ab\u5206\u5272\u6210\u81ea\u7136\u6570\u5e8f\u5217 [0, 1, 2, \\ldots] [0, 1, 2, \\ldots] \uff0c \u6bcf\u4e2a\u65f6\u95f4\u70b9\u6709\u4e00\u4e2a\u968f\u673a\u53d8\u91cf S_t S_t , \u90a3\u4e48\u56e0\u4e3a\u65f6\u95f4\u7ef4\u5ea6\u7684\u7279\u6b8a\u6027\uff0c \u8fd9\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u8fc7\u7a0b (S_0, S_1, S_2, \\ldots) (S_0, S_1, S_2, \\ldots) \u3002 \u8fd9\u4e2a\u968f\u673a\u8fc7\u7a0b\u7684\u6837\u672c\u7a7a\u95f4\u662f\u4e00\u4e2a\u6982\u7387\u7a7a\u95f4\uff0c\u5373\u6bcf\u4e2a\u6837\u672c\u670d\u4ece\u67d0\u4e2a\u6982\u7387\u5206\u5e03 (s_0, s_1, s_2, \\ldots) \\sim p (s_0, s_1, s_2, \\ldots) \\sim p \u3002 \u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u628a\u6bcf\u4e2a\u6837\u672c\u5f20\u6210\u4e00\u4e2a\u7ef4\u5ea6\u975e\u5e38\u9ad8\u7684\u5411\u91cf\uff0c\u9000\u5316\u6210\u67d0\u79cd\u76d1\u7763\u5b66\u4e60\u6216\u8005\u65e0\u76d1\u7763\u5b66\u4e60\u7684\u95ee\u9898\u3002 \u4f46\u662f\uff0c\u5f53\u6211\u4eec\u5148\u9a8c\u6027\u5730\u7ed9\u6570\u636e\u8d4b\u4e88 \u8fc7\u7a0b \u8fd9\u79cd\u5148\u9a8c\u7ed3\u6784\u4fe1\u606f\uff0c\u6211\u4eec\u4e5f\u5c31\u589e\u52a0\u4e86\u66f4\u591a\u7684\u64cd\u4f5c\u7a7a\u95f4\u3002 \u8fc7\u7a0b \u5c31\u662f\u67d0\u79cd\u6982\u7387\u56fe\uff0c\u6982\u7387\u9010\u5c42\u4f20\u9012\uff0c\u5373\u6211\u4eec\u8ba4\u4e3a S_t S_t \u7684\u968f\u673a\u53d8\u91cf\u7531 (S_0, S_1, \\ldots, S_{t-1}) (S_0, S_1, \\ldots, S_{t-1}) \u51b3\u5b9a\uff1a \\tag{1} p(S_t) = p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}). \\tag{1} p(S_t) = p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}). \u800c\u9a6c\u5c14\u53ef\u592b\u94fe\u5c31\u662f\u66f4\u8fdb\u4e00\u6b65\u7b80\u5316\u7248\u7684\u968f\u673a\u8fc7\u7a0b\u3002 \u5b9a\u4e49 ( \u9a6c\u5c14\u79d1\u592b\u94fe ). \u79bb\u6563\u968f\u673a\u8fc7\u7a0b\u53eb\u505a\u9a6c\u5c14\u53ef\u592b\u94fe\uff0c\u8868\u793a\uff1a \\tag{2} p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}) = p(S_t \\vert S_{t-1} = s_{t-1}). \\tag{2} p(S_t \\vert S_{t-1} = s_{t-1}\uff0c S_{t-2} = s_{t-2}, \\ldots, S_{0} = s_{0}) = p(S_t \\vert S_{t-1} = s_{t-1}). \u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u524d\u65f6\u523b\u7684\u968f\u673a\u53d8\u91cf\u53ea\u4e0e\u524d\u4e00\u65f6\u523b\u7684\u968f\u673a\u53d8\u91cf\u6709\u5173\u3002 \u6211\u4eec\u5047\u8bbe S_t S_t \u968f\u673a\u53d8\u91cf\u90fd\u662f\u5728\u96c6\u5408 \\mathcal{S} \\mathcal{S} \u4e0a\uff0c\u90a3\u4e48\u9a6c\u5c14\u53ef\u592b\u94fe\u5c31\u662f\u4e00\u4e2a\u6d4b\u5ea6\u7a7a\u95f4\uff0c \\tag{3} \\mathcal{MC} = \\{\\Omega = \\{\\tau = (s_0, s_1, \\ldots, s_t, \\ldots) \\vert s_t \\in \\mathcal{S}\\}, \\sigma(\\Omega), \\mu\\}, \\tag{3} \\mathcal{MC} = \\{\\Omega = \\{\\tau = (s_0, s_1, \\ldots, s_t, \\ldots) \\vert s_t \\in \\mathcal{S}\\}, \\sigma(\\Omega), \\mu\\}, \u5176\u4e2d \\mu(\\tau) = p_0(s_0) \\prod^{\\infty}_{t = 0}p(s_{t+1} \\vert s_t) \\mu(\\tau) = p_0(s_0) \\prod^{\\infty}_{t = 0}p(s_{t+1} \\vert s_t) \u3002 \u6240\u4ee5\uff0c\u8868\u793a\u4e00\u4e2a\u9a6c\u5c14\u79d1\u592b\u94fe\u53ef\u4ee5\u7b80\u5316\u4e3a \\tag{4} \\mathcal{MC} = (\\mathcal{S}, p_0, p). \\tag{4} \\mathcal{MC} = (\\mathcal{S}, p_0, p). \u5982\u679c \\mathcal{S} \\mathcal{S} \u662f\u53ef\u6570\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635 \\mathbf{P} \\mathbf{P} : \\begin{equation*} \\tag{5} \\mathbf{P} = \\begin{bmatrix} p(s1 \\vert s1) & p(s2 \\vert s1) & \\cdots & p(sn \\vert s1) & \\cdots \\\\ p(s1 \\vert s2) & p(s2 \\vert s2) & \\cdots & p(sn \\vert s2) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\\\ p(sn \\vert sn) & p(s2 \\vert sn) & \\cdots & p(sn \\vert sn) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\end{bmatrix}, \\end{equation*} \\begin{equation*} \\tag{5} \\mathbf{P} = \\begin{bmatrix} p(s1 \\vert s1) & p(s2 \\vert s1) & \\cdots & p(sn \\vert s1) & \\cdots \\\\ p(s1 \\vert s2) & p(s2 \\vert s2) & \\cdots & p(sn \\vert s2) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\\\ p(sn \\vert sn) & p(s2 \\vert sn) & \\cdots & p(sn \\vert sn) & \\cdots \\\\ \\vdots & \\vdots & \\ddots & \\vdots & \\ddots \\end{bmatrix}, \\end{equation*} \u6ce8\u610f \\mathbf{P} \\pmb{1} = \\pmb{1} \\mathbf{P} \\pmb{1} = \\pmb{1} \u3002","title":"\u5b9a\u4e49"},{"location":"RL/01-MarkovChains/#stationary-distribution","text":"\u5728\u8fd9\u4e00\u8282\uff0c\u6211\u4eec\u5206\u4eab\u4e00\u4e2a\u9a6c\u5c14\u79d1\u592b\u94fe\u4e2d\u7684\u91cd\u8981\u7ed3\u8bba\u3002 \u5b9a\u7406 ( Perron-Frobenius theorem ) If a matrix \\mathbf{A} \\mathbf{A} is irreducible 1 , then \\mathbf{A} \\mathbf{A} has a positive real eigenvalue \\lambda_{\\max} \\lambda_{\\max} such that all other eigenvalues of \\mathbf{A} \\mathbf{A} satisfy \\vert \\lambda \\vert < \\lambda_{\\max} \\vert \\lambda \\vert < \\lambda_{\\max} . Furthermore, \\lambda_{\\max} \\lambda_{\\max} has algebraic 2 and geometric 3 multiplicity one, and has an eigenvector \\mathbf{x} \\mathbf{x} with \\mathbf{x} \\succ 0 \\mathbf{x} \\succ 0 . Any nonnegative eigenvector is a multiper of \\mathbf{x} \\mathbf{x} . \u56e0\u4e3a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635 \\mathbf{P} \\mathbf{1} = \\mathbf{1} \\mathbf{P} \\mathbf{1} = \\mathbf{1} \u3002 \u5982\u679c\u9a6c\u5c14\u79d1\u592b\u94fe\u662f irreducible irreducible \u4ee5\u53ca aperiodical aperiodical \u7684\uff08\u6ee1\u8db3\u4e0a\u9762\u5b9a\u7406\u7684\u8981\u6c42\uff09\uff0c\u90a3\u4e48 1 \u662f \\mathbf{P} \\mathbf{P} \u7684\u7279\u5f81\u503c\u3002 \u63a5\u4e0b\u6765\u6211\u4eec\u8981\u8bc1\u660e\u5b83\u7684\u6700\u5927\u7279\u5f81\u503c\u662f1\u3002 \u9996\u5148\u5b83\u7684\u7279\u5f81\u503c \\lambda \\lambda \u6ee1\u8db3 \\mathbf{P} \\mathbf{z} = \\lambda \\mathbf{z}, \\mathbf{P} \\mathbf{z} = \\lambda \\mathbf{z}, \u90a3\u4e48 \\sum^{}_{j} p_{kj} z_j = \\lambda z_k, \\sum^{}_{j} p_{kj} z_j = \\lambda z_k, \u5176\u4e2d z_k z_k \u662f \\mathbf{z} \\mathbf{z} \u4e2d\u7684\u6700\u5927\u5206\u91cf\u3002 \u6240\u4ee5 \\vert \\lambda z_k \\vert = \\vert \\sum^{}_{j} p_{kj} z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_k \\vert \\le \\vert z_k \\vert, \\vert \\lambda z_k \\vert = \\vert \\sum^{}_{j} p_{kj} z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_j \\vert \\le \\sum^{}_{j} p_{kj} \\vert z_k \\vert \\le \\vert z_k \\vert, \u6240\u4ee5 \\vert \\lambda \\vert \\le 1 \\vert \\lambda \\vert \\le 1 \u3002 \u56e0\u4e3a \\mathbf{P}^T \\mathbf{P}^T \u7684\u7279\u5f81\u503c\u548c \\mathbf{P} \\mathbf{P} \u76f8\u540c, \u6240\u4ee5 \\mathbf{P}^T \\mathbf{P}^T \u7684\u6700\u5927\u7279\u5f81\u503c\u662f1, \u5b83\u4e5f\u5b58\u5728\u552f\u4e00\u7684\u7279\u5f81\u503c \\mathbf{\\pi} \\mathbf{\\pi} \u6ee1\u8db3 \\mathbf{P}^T \\mathbf{\\pi} = \\mathbf{\\pi} \\mathbf{P}^T \\mathbf{\\pi} = \\mathbf{\\pi} \u3002 \u6211\u4eec\u79f0 \\mathbf{\\pi} \\mathbf{\\pi} \u662f\u9a6c\u5c14\u53ef\u592b\u94fe\u7684**\u7a33\u5b9a\u5206\u5e03**\u3002\u6211\u4eec\u4e3a\u4ec0\u4e48\u53eb\u5b83\u662f\u7a33\u5b9a\u5206\u5e03\u5462\uff1f \u56e0\u4e3a\u5bf9\u4e8e\u4efb\u610f\u7684\u521d\u59cb\u5206\u5e03 \\mathbf{p}_0 \\mathbf{p}_0 , \u6211\u4eec\u5b9a\u4e49 \\mathbf{p}_{\\infty} = \\lim_{k \\rightarrow \\infty} (\\mathbf{P}^T)^k \\mathbf{p}_0 \\mathbf{p}_{\\infty} = \\lim_{k \\rightarrow \\infty} (\\mathbf{P}^T)^k \\mathbf{p}_0 , \u90a3\u4e48 \\mathbf{p}_{\\infty} = \\mathbf{P}^T \\mathbf{p}_{\\infty} \\mathbf{p}_{\\infty} = \\mathbf{P}^T \\mathbf{p}_{\\infty} \u3002 \u56e0\u4e3a\u7279\u5f81\u503c\u7684\u552f\u4e00\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\mathbf{p}_{\\infty} = \\mathbf{\\pi} \\mathbf{p}_{\\infty} = \\mathbf{\\pi} \u3002 \\mathbf{A} \\mathbf{A} is called irreducible if for any i, j there is k_{ij} k_{ij} such that (\\mathbf{A}^k)_{ij} > 0 (\\mathbf{A}^k)_{ij} > 0 . \u21a9 Algebraic multiplicity is the number of times an eigenvalue appears in a characteristic polynomial of a matrix. \u21a9 Geometric multiplicity is the nullity of \\mathbf{I} - \\lambda \\mathbf{A} \\mathbf{I} - \\lambda \\mathbf{A} . \u21a9","title":"\u7a33\u5b9a\u5206\u5e03(Stationary Distribution)"}]}