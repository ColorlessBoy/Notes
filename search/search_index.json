{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u6b22\u8fce\u6765\u5230\u6211\u7684\u7b14\u8bb0\u672c \u00b6 \u8fd9\u4e2a\u7b14\u8bb0\u672c\u662f\u7531MkDocs\u5de5\u5177\u751f\u6210\u7684\u3002 \u6211\u5b8c\u5168\u4e0d\u61c2\u524d\u7aef\u77e5\u8bc6\uff0c\u53ea\u662f\u627e\u4e00\u4e2a\u5730\u65b9\u653e\u6211\u7684\u7b14\u8bb0\u3002 \u6211\u7528\u4e86\u597d\u591a\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff1aJekyll, Hexo \u548c Hugo\uff0c \u5b83\u4eec\u7684\u4e3b\u9898\u90fd\u4e0d\u5408\u6211\u610f\uff0c\u800c\u4e14\u751f\u6210\u7684\u9879\u76ee\u7ed3\u6784\u590d\u6742\uff08\u8d85\u8fc7\u4e24\u4e2a\u6587\u4ef6\u5939\uff09\uff0c\u8ba9\u6211\u5fc3\u70e6\u610f\u4e71\u3002 \u770b\u6765\u770b\u53bb\uff0c\u53d1\u73b0\u8fd8\u662f McDocs \u6700\u5408\u6211\u610f: \u5982\u679c\u6211\u8981\u5199\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u6211\u5c31\u5199\u6210\u8fd9\u4e2a\u6837\u5b50\u3002","title":"\u4ecb\u7ecd"},{"location":"#_1","text":"\u8fd9\u4e2a\u7b14\u8bb0\u672c\u662f\u7531MkDocs\u5de5\u5177\u751f\u6210\u7684\u3002 \u6211\u5b8c\u5168\u4e0d\u61c2\u524d\u7aef\u77e5\u8bc6\uff0c\u53ea\u662f\u627e\u4e00\u4e2a\u5730\u65b9\u653e\u6211\u7684\u7b14\u8bb0\u3002 \u6211\u7528\u4e86\u597d\u591a\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff1aJekyll, Hexo \u548c Hugo\uff0c \u5b83\u4eec\u7684\u4e3b\u9898\u90fd\u4e0d\u5408\u6211\u610f\uff0c\u800c\u4e14\u751f\u6210\u7684\u9879\u76ee\u7ed3\u6784\u590d\u6742\uff08\u8d85\u8fc7\u4e24\u4e2a\u6587\u4ef6\u5939\uff09\uff0c\u8ba9\u6211\u5fc3\u70e6\u610f\u4e71\u3002 \u770b\u6765\u770b\u53bb\uff0c\u53d1\u73b0\u8fd8\u662f McDocs \u6700\u5408\u6211\u610f: \u5982\u679c\u6211\u8981\u5199\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u6211\u5c31\u5199\u6210\u8fd9\u4e2a\u6837\u5b50\u3002","title":"\u6b22\u8fce\u6765\u5230\u6211\u7684\u7b14\u8bb0\u672c"},{"location":"ML/01-EM/","text":"EM \u7b97\u6cd5 \u00b6 \u901a\u5e38\u4ecb\u7ecdEM\u7b97\u6cd5\u90fd\u4f1a\u5148\u4ecb\u7ecd\u4e00\u4e2a\u7279\u6b8a\u7684\u95ee\u9898\uff1a\u5982\u4f55\u5c06\u4e00\u5806\u6837\u672c\u62df\u5408\u6210\u67d0\u4e2a\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09\u3002\u56e0\u4e3a\u76f4\u63a5\u8bb2EM\u7b97\u6cd5\u6240\u89e3\u51b3\u7684\u62bd\u8c61\u95ee\u9898\uff0c\u521d\u5b66\u8005\u4f1a\u975e\u5e38\u5947\u602a\uff0c\u73b0\u5b9e\u4e2d\u600e\u4e48\u4f1a\u6709\u8fd9\u79cd\u5f62\u5f0f\u7684\u95ee\u9898\u3002\u4f46\u662f\u6211\u89c9\u5f97\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u5f88\u4f18\u96c5\uff0c\u6240\u4ee5\u6211\u5c31\u5e72\u8106\u5148\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u3002 \u76ee\u6807\u95ee\u9898 \u00b6 \u9996\u5148\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \u3002 \u73b0\u5728\u7ed9\u6211\u4eec\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u4e2d\u72ec\u7acb\u91c7\u96c6\u4e00\u5806\u6837\u672c \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \uff0c \u6211\u4eec\u5e0c\u671b\u786e\u5b9a\u54ea\u4e2a \\mathcal{P}_{\\theta}(x) \\mathcal{P}_{\\theta}(x) \u66f4\u63a5\u8fd1\u8fd9\u7ec4\u6570\u636e\u7684\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u6839\u636e\u6781\u5927\u4f3c\u7136\u7406\u8bba\u6784\u9020\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff1a L_{\\mathcal{S}}(\\theta) = -\\ln \\prod^{m}_{i=1} \\mathcal{P}_{\\theta}(x_i) = -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} L_{\\mathcal{S}}(\\theta) = -\\ln \\prod^{m}_{i=1} \\mathcal{P}_{\\theta}(x_i) = -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} \u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff08\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff09\uff0c \\mathcal{P}_\\theta(x) \\mathcal{P}_\\theta(x) \u8fd8\u548c\u53e6\u4e00\u4e2a \u9690\u968f\u673a\u53d8\u91cf \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \u6709\u5173\uff1a \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \u5f53\u6211\u4eec\u88ab\u9650\u5236\u53ea\u80fd\u83b7\u5f97 \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u548c \\mathcal{P}_\\theta(x \\vert z_j) \\mathcal{P}_\\theta(x \\vert z_j) \u65f6\uff0c \u76ee\u6807\u51fd\u6570\u7684\u4f18\u5316\u5c31\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u4e86: L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} \u8fd9\u91cc \u6982\u7387 \u8fd8\u662f \u6982\u7387\u5bc6\u5ea6 \u5728\u5f88\u591a\u8d44\u6599\u91cc\u975e\u5e38\u5bb9\u6613\u641e\u6df7\u3002 EM\u7b97\u6cd5 \u00b6 \u6211\u4eec\u5148\u4ecb\u7ecd\u53e6\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff0c\u4e4d\u4e00\u770b\u548c\u524d\u9762\u95ee\u9898\u6beb\u65e0\u5173\u7cfb\uff0c \u5176\u5b9e\u6709\u975e\u5e38\u5de7\u5999\u7684\u8054\u7cfb: G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} EM\u7b97\u6cd5\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \u8981\u4e86\u89e3 G_{\\mathcal{S}}(Q, \\theta) G_{\\mathcal{S}}(Q, \\theta) \u4e0e L_{\\mathcal{S}}(\\theta) L_{\\mathcal{S}}(\\theta) \u6211\u4eec\u9700\u8981\u7814\u7a76\u4f18\u5316\u8fc7\u7a0b\u4e2d\u7684\u7b2c\u4e00\u6b65\u3002 \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \u5f53 Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) \u65f6\uff0c \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \u7efc\u4e0a\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u7b2c\u4e00\u6b65\u4f18\u5316\u5b58\u5728\u95ed\u89e3\uff1a Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) , \u5e76\u4e14 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) . \u8fd9\u4e00\u6b65\u662f\u6c42\u671f\u671b\uff0c\u6240\u4ee5\u88ab\u79f0\u4e3a Expectation Step \u3002 \u8fd9\u4e00\u6b65\u540c\u65f6\u9700\u8981\u7528\u5230\u8d1d\u53f6\u65af\u516c\u5f0f Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. \u53c8\u56e0\u4e3a\u7b2c\u4e8c\u6b65\uff08 Maximization Step \uff09\u6700\u5c0f\u5316 \\theta \\theta \u65f6\u4fdd\u8bc1 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) , \u6240\u4ee5\u6211\u4eec\u53ef\u5f97 L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}). L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}). \u9ad8\u65af\u6df7\u5408\u6a21\u578b \u00b6 k\u4e2a\u9ad8\u65af\u5206\u5e03\u7684\u6df7\u5408\u6a21\u578b\u5bf9\u5e94\u7684hypothesis\u96c6\u5982\u4e0b\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \u53ef\u4ee5\u7b80\u5316 \\mathcal{P}_{\\theta}(z_j) = \\pi_j \\mathcal{P}_{\\theta}(z_j) = \\pi_j , \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) , \u90a3\u4e48hypothesis\u96c6\u5c31\u53d8\u6210\u6211\u4eec\u6bd4\u8f83\u5e38\u89c1\u7684\u5f62\u5f0f\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \u4ece\u8fd9\u4e2a\u7279\u4f8b\u6211\u4eec\u53ef\u4ee5\u611f\u53d7\u5230\uff1a \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u5f88\u5bb9\u6613\u83b7\u5f97; \u8fd9\u91cc\u7684 x x \u662f\u8fde\u7eed\u51fd\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u5f88\u5bb9\u6613\u83b7\u5f97\u6761\u4ef6\u6982\u7387\u5bc6\u5ea6\u51fd\u6570 p_{\\theta}(x \\vert z) p_{\\theta}(x \\vert z) \uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6781\u5c0f\u503c\u91cf \\Delta x \\Delta x \uff0c\u90a3\u4e48 \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x . \u9996\u5148\u662f Expectation Step : Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. \u90a3\u4e48\uff0c Maximumization Step \u9700\u8981\u6c42\u89e3\u7684\u95ee\u9898\u662f\uff1a \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \u9996\u5148\u663e\u7136 \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} , \u5176\u6b21 \u56e0\u4e3a \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \u6240\u4ee5\u4e5f\u663e\u7136\u53ef\u5f97 \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \u3002 \u6709\u70b9\u590d\u6742\u7684\u662f\u6c42\u89e3 \\Sigma_j \\Sigma_j : \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \u6211\u4eec\u9700\u8981\u7528\u5230\u4e24\u4e2a\u77e9\u9635\u5bfc\u6570 \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \u548c \\frac{\\partial}{\\partial A}Tr(A^T B) = B \\frac{\\partial}{\\partial A}Tr(A^T B) = B \uff0c\u5148\u5bf9 \\Sigma^{-1} \\Sigma^{-1} \u6c42\u5bfc\u53ef\u5f97\uff1a \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T . \u975e\u5e38\u6709\u610f\u601d\u7684\u662f\uff0cK-means\u7b97\u6cd5\u53ef\u4ee5\u770b\u6210GMM\u7b97\u6cd5\u9650\u5236\u5728 \\Sigma \\rightarrow 0 \\Sigma \\rightarrow 0 \u7684\u7b97\u6cd5\u3002","title":"EM"},{"location":"ML/01-EM/#em","text":"\u901a\u5e38\u4ecb\u7ecdEM\u7b97\u6cd5\u90fd\u4f1a\u5148\u4ecb\u7ecd\u4e00\u4e2a\u7279\u6b8a\u7684\u95ee\u9898\uff1a\u5982\u4f55\u5c06\u4e00\u5806\u6837\u672c\u62df\u5408\u6210\u67d0\u4e2a\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09\u3002\u56e0\u4e3a\u76f4\u63a5\u8bb2EM\u7b97\u6cd5\u6240\u89e3\u51b3\u7684\u62bd\u8c61\u95ee\u9898\uff0c\u521d\u5b66\u8005\u4f1a\u975e\u5e38\u5947\u602a\uff0c\u73b0\u5b9e\u4e2d\u600e\u4e48\u4f1a\u6709\u8fd9\u79cd\u5f62\u5f0f\u7684\u95ee\u9898\u3002\u4f46\u662f\u6211\u89c9\u5f97\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u5f88\u4f18\u96c5\uff0c\u6240\u4ee5\u6211\u5c31\u5e72\u8106\u5148\u4ece\u62bd\u8c61\u7684\u95ee\u9898\u8bb2\u8d77\u3002","title":"EM \u7b97\u6cd5"},{"location":"ML/01-EM/#_1","text":"\u9996\u5148\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \\mathcal{H}=\\{\\mathcal{P}_{\\theta}(x)\\} \u3002 \u73b0\u5728\u7ed9\u6211\u4eec\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u4e2d\u72ec\u7acb\u91c7\u96c6\u4e00\u5806\u6837\u672c \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \\mathcal{S} = \\{x_1, x_2, \\ldots, x_m\\} \uff0c \u6211\u4eec\u5e0c\u671b\u786e\u5b9a\u54ea\u4e2a \\mathcal{P}_{\\theta}(x) \\mathcal{P}_{\\theta}(x) \u66f4\u63a5\u8fd1\u8fd9\u7ec4\u6570\u636e\u7684\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u6839\u636e\u6781\u5927\u4f3c\u7136\u7406\u8bba\u6784\u9020\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff1a L_{\\mathcal{S}}(\\theta) = -\\ln \\prod^{m}_{i=1} \\mathcal{P}_{\\theta}(x_i) = -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} L_{\\mathcal{S}}(\\theta) = -\\ln \\prod^{m}_{i=1} \\mathcal{P}_{\\theta}(x_i) = -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i). \\tag{1} \u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff08\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff09\uff0c \\mathcal{P}_\\theta(x) \\mathcal{P}_\\theta(x) \u8fd8\u548c\u53e6\u4e00\u4e2a \u9690\u968f\u673a\u53d8\u91cf \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \\mathcal{Z} = \\{z_1, z_2, \\ldots, z_k\\} \u6709\u5173\uff1a \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \\mathcal{P}_\\theta(x) = \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(z_j)} \\mathcal{P}_\\theta(x \\vert z_j) =\\sum^k_{j=1} \\mathcal{P}_\\theta(x, z_j). \\tag{2} \u5f53\u6211\u4eec\u88ab\u9650\u5236\u53ea\u80fd\u83b7\u5f97 \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u548c \\mathcal{P}_\\theta(x \\vert z_j) \\mathcal{P}_\\theta(x \\vert z_j) \u65f6\uff0c \u76ee\u6807\u51fd\u6570\u7684\u4f18\u5316\u5c31\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u4e86: L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} L_{\\mathcal{S}}(\\theta) = -\\sum^{m}_{i=1} \\ln \\sum^{k}_{j=1} \\mathcal{P_{\\theta}(x, z_j)}. \\tag{3} \u8fd9\u91cc \u6982\u7387 \u8fd8\u662f \u6982\u7387\u5bc6\u5ea6 \u5728\u5f88\u591a\u8d44\u6599\u91cc\u975e\u5e38\u5bb9\u6613\u641e\u6df7\u3002","title":"\u76ee\u6807\u95ee\u9898"},{"location":"ML/01-EM/#em_1","text":"\u6211\u4eec\u5148\u4ecb\u7ecd\u53e6\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff0c\u4e4d\u4e00\u770b\u548c\u524d\u9762\u95ee\u9898\u6beb\u65e0\u5173\u7cfb\uff0c \u5176\u5b9e\u6709\u975e\u5e38\u5de7\u5999\u7684\u8054\u7cfb: G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} G_{\\mathcal{S}}(Q, \\theta) = \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln Q_{i, j} - \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i, j} \\log[ \\mathcal{P}_{\\theta}(x_i, z_j)]. \\tag{4} EM\u7b97\u6cd5\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \\begin{cases} \\tag{5} Q^{(t+1)} = \\min_{Q} G_{\\mathcal{S}}(Q, \\theta^{(t)}), \\\\ \\theta^{(t+1)} = \\min_{\\theta} G_{\\mathcal{S}}(Q^{(t+1)}, \\theta). \\end{cases} \u8981\u4e86\u89e3 G_{\\mathcal{S}}(Q, \\theta) G_{\\mathcal{S}}(Q, \\theta) \u4e0e L_{\\mathcal{S}}(\\theta) L_{\\mathcal{S}}(\\theta) \u6211\u4eec\u9700\u8981\u7814\u7a76\u4f18\u5316\u8fc7\u7a0b\u4e2d\u7684\u7b2c\u4e00\u6b65\u3002 \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \\begin{aligned} & G_{S}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ \\ge& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} Q_{i, j} \\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{Q_{i, j}}\\right\\} \\\\ =& -\\sum^{m}_{i=1}\\ln \\left\\{\\sum^{k}_{j=1} \\mathcal{P}_{\\theta}(x_i, z_j)\\right\\} \\\\ =&L_{\\mathcal{S}}(\\theta) \\end{aligned} \u5f53 Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) Q_{i, j} = \\mathcal{P}_{\\theta}(z_j \\vert x_i) \u65f6\uff0c \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \\begin{aligned} &G_{\\mathcal{S}}(Q, \\theta) \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\left\\{\\frac{\\mathcal{P}_{\\theta}(x_i, z_j)}{\\mathcal{P}_{\\theta}(z_j \\vert x_i)}\\right\\} \\\\ =& -\\sum^{m}_{i=1} \\sum^{k}_{j=1} \\mathcal{P_{\\theta}}(z_j \\vert x_i) \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& -\\sum^{m}_{i=1} \\ln \\mathcal{P}_{\\theta}(x_i) \\\\ =& L_{\\mathcal{S}}(\\theta). \\end{aligned} \u7efc\u4e0a\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u7b2c\u4e00\u6b65\u4f18\u5316\u5b58\u5728\u95ed\u89e3\uff1a Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) Q_{i,j}^{(t+1)} = \\mathcal{P}_{\\theta^{(t)}}(z_j \\vert x_i) , \u5e76\u4e14 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}) . \u8fd9\u4e00\u6b65\u662f\u6c42\u671f\u671b\uff0c\u6240\u4ee5\u88ab\u79f0\u4e3a Expectation Step \u3002 \u8fd9\u4e00\u6b65\u540c\u65f6\u9700\u8981\u7528\u5230\u8d1d\u53f6\u65af\u516c\u5f0f Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. Q^{(t+1)}_{i, j} = \\frac{\\mathcal{P}_{\\theta^{(t)}}(z_j) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_j)}{\\sum^{k}_{j'=1}\\mathcal{P}_{\\theta^{(t)}}(z_{j'}) \\mathcal{P}_{\\theta^{(t)}}(x_i \\vert z_{j'})}. \u53c8\u56e0\u4e3a\u7b2c\u4e8c\u6b65\uff08 Maximization Step \uff09\u6700\u5c0f\u5316 \\theta \\theta \u65f6\u4fdd\u8bc1 G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) , \u6240\u4ee5\u6211\u4eec\u53ef\u5f97 L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}). L_{\\mathcal{S}}(\\theta^{(t+1)}) = G_{\\mathcal{S}}(Q^{(t+2)}, \\theta^{(t+1)}) \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t+1)}) \\\\ \\le G_{\\mathcal{S}}(Q^{(t+1)}, \\theta^{(t)}) = L_{\\mathcal{S}}(\\theta^{(t)}).","title":"EM\u7b97\u6cd5"},{"location":"ML/01-EM/#_2","text":"k\u4e2a\u9ad8\u65af\u5206\u5e03\u7684\u6df7\u5408\u6a21\u578b\u5bf9\u5e94\u7684hypothesis\u96c6\u5982\u4e0b\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\mathcal{P}_{\\theta}(z_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) \\right\\}. \u53ef\u4ee5\u7b80\u5316 \\mathcal{P}_{\\theta}(z_j) = \\pi_j \\mathcal{P}_{\\theta}(z_j) = \\pi_j , \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) \\mathcal{N}_{z_j}(\\mu_{\\theta}, \\Sigma_{\\theta}) = \\mathcal{N}(\\mu_j, \\Sigma_j) , \u90a3\u4e48hypothesis\u96c6\u5c31\u53d8\u6210\u6211\u4eec\u6bd4\u8f83\u5e38\u89c1\u7684\u5f62\u5f0f\uff1a \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \\mathcal{H} = \\left\\{ \\mathcal{P}_{\\theta}(x) = \\sum^{k}_{j = 1} \\pi_j \\mathcal{N}(\\mu_{j}, \\Sigma_{j}) \\right\\}. \u4ece\u8fd9\u4e2a\u7279\u4f8b\u6211\u4eec\u53ef\u4ee5\u611f\u53d7\u5230\uff1a \\mathcal{P}_{\\theta}(z) \\mathcal{P}_{\\theta}(z) \u5f88\u5bb9\u6613\u83b7\u5f97; \u8fd9\u91cc\u7684 x x \u662f\u8fde\u7eed\u51fd\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u5f88\u5bb9\u6613\u83b7\u5f97\u6761\u4ef6\u6982\u7387\u5bc6\u5ea6\u51fd\u6570 p_{\\theta}(x \\vert z) p_{\\theta}(x \\vert z) \uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6781\u5c0f\u503c\u91cf \\Delta x \\Delta x \uff0c\u90a3\u4e48 \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x \\mathcal{P}_{\\theta}(x\\vert z) = p_{\\theta}(x \\vert z) \\Delta x . \u9996\u5148\u662f Expectation Step : Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. Q_{i, j} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j) \\Delta x} = \\frac{\\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}{\\sum^{k}_{j' = 1} \\pi_j \\mathcal{N}(\\mu_j, \\Sigma_j)}. \u90a3\u4e48\uff0c Maximumization Step \u9700\u8981\u6c42\u89e3\u7684\u95ee\u9898\u662f\uff1a \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \\begin{aligned} &\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} \\ln \\mathcal{P}(x_i, z_j) \\\\ =&\\max_{\\theta} \\sum^{m}_{i=1} \\sum^{k}_{j=1} Q_{i,j} [\\ln \\pi_j + \\ln \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) + \\ln \\Delta x] \\\\ \\end{aligned} \u9996\u5148\u663e\u7136 \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} \\pi^*_j = \\frac{1}{m}\\sum_{i=1}^{m} Q_{i,j} , \u5176\u6b21 \u56e0\u4e3a \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \\mathcal{N}(x_i, \\mu_j, \\Sigma_j) = \\frac{1}{(2\\pi)^{D/2}}\\frac{1}{\\vert \\Sigma \\vert^{1/2}} \\exp\\left\\{-\\frac{1}{2} (x_i - \\mu_j)^T \\Sigma_j^{-1} (x_i - \\mu_j)\\right\\}, \u6240\u4ee5\u4e5f\u663e\u7136\u53ef\u5f97 \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \\mu^*_j = \\frac{\\sum^{m}_{i=1} Q_{i, j} x_i}{\\sum^{m}_{i=1} Q_{i, j}} \u3002 \u6709\u70b9\u590d\u6742\u7684\u662f\u6c42\u89e3 \\Sigma_j \\Sigma_j : \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \\max_{\\Sigma_j} \\sum^{m}_{i=1}\\sum^{k}_{j=1} Q_{i, j} \\left[\\frac{1}{2} \\ln\\vert \\Sigma^{-1} \\vert - \\frac{1}{2}(x_i - \\mu^*_j)^T \\Sigma^{-1}_{j} (x_i - \\mu^*_j)\\right]. \u6211\u4eec\u9700\u8981\u7528\u5230\u4e24\u4e2a\u77e9\u9635\u5bfc\u6570 \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \\frac{\\partial}{\\partial A}\\ln \\vert A \\vert = (A^{-1})^T \u548c \\frac{\\partial}{\\partial A}Tr(A^T B) = B \\frac{\\partial}{\\partial A}Tr(A^T B) = B \uff0c\u5148\u5bf9 \\Sigma^{-1} \\Sigma^{-1} \u6c42\u5bfc\u53ef\u5f97\uff1a \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T \\Sigma_j = \\frac{1}{\\sum^{m}_{i=1} Q_{i, j}}\\sum_{i=1}^m Q_{i, j} (x_i - \\mu^*_j)(x_i - \\mu^*_j)^T . \u975e\u5e38\u6709\u610f\u601d\u7684\u662f\uff0cK-means\u7b97\u6cd5\u53ef\u4ee5\u770b\u6210GMM\u7b97\u6cd5\u9650\u5236\u5728 \\Sigma \\rightarrow 0 \\Sigma \\rightarrow 0 \u7684\u7b97\u6cd5\u3002","title":"\u9ad8\u65af\u6df7\u5408\u6a21\u578b"},{"location":"ML/02-SVM/","text":"SVM\u7b97\u6cd5 \u00b6 SVM\u7b97\u6cd5\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u56e0\u4e3a\u5f88\u591a\u6269\u5c55\u800c\u53d8\u5f97\u590d\u6742\u8d77\u6765\u3002 \u5b66\u8fc7\u4f18\u5316\u7684\u8bdd\u5c31\u5f88\u597d\u7406\u89e3\u4e86\uff1a SVM\u7b97\u6cd5\u672c\u8d28\u662f\u5c06\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\u5efa\u6a21\u6210\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u5b83\u521a\u597d\u53c8\u95ed\u89e3\uff0c\u95ed\u89e3\u7684\u63a8\u5bfc\u5e94\u8be5\u662f\u5c5e\u4e8e\u4f18\u5316\u7684\u9886\u57df\u3002 \u76ee\u6807\u95ee\u9898 \u00b6 \u5728\u4e00\u5207\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u8981\u5148\u786e\u5b9a\u4e00\u4e2ahypothesis\u96c6 \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \u3002 \u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \uff0c\u5176\u4e2d \\mathbf{x} \\in \\mathbb{R}^{d} \\mathbf{x} \\in \\mathbb{R}^{d} \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \u3002\u6211\u4eec\u5e0c\u671b\u5728 \\mathcal{H} \\mathcal{H} \u4e2d\u627e\u5230\u4e00\u4e2a\u5206\u7c7b\u51fd\u6570 h_\\theta(\\mathbf{x}) h_\\theta(\\mathbf{x}) \u80fd\u628a\u6837\u672c \\mathcal{S} \\mathcal{S} \u5206\u5f97\u6700\u5f00\u3002 \u4ec0\u4e48\u53eb\u505a\u5206\u5f97\u6700\u5f00\u5462\uff1f\u6211\u4eec\u8fd9\u91cc\u7528\u6837\u672c\u4e0e\u5206\u7c7b\u9762\u7684\u8ddd\u79bb\u6765\u8bc4\u4ef7\u5206\u5f00\u7684\u7a0b\u5ea6\u3002 \u6211\u4eec\u6784\u5efa\u7684hypothesis\u96c6\u662f\u7ebf\u6027\u51fd\u6570\u7684\u96c6\u5408\uff1a \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \u90a3\u4e48\uff0c\u6837\u672c\u70b9 (\\mathbf{x}, y) (\\mathbf{x}, y) \u4e0e\u8d85\u5e73\u9762\u7684\u6b27\u5f0f\u8ddd\u79bb\u6709\u95ed\u89e3\uff1a d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} \u90a3\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u635f\u5931\u51fd\u6570\u662f\uff1a L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} \u5f53\u6709\u5206\u7c7b\u9519\u7684\u70b9\uff0c\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u4e3a\u6b63\uff0c\u9519\u8bef\u70b9\u8ddd\u79bb\u8d85\u5e73\u9762\u8fdc\uff0c\u9519\u5f97\u8d8a\u79bb\u8c31\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5927\u3002\u5f53\u5206\u7c7b\u5168\u90e8\u6b63\u786e\u65f6\uff0c\u8d85\u5e73\u9762\u5c06\u70b9\u5206\u5f97\u8d8a\u5f00\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5c0f\u3002 \u8fd9\u91cc\u6211\u4eec\u7528\u8ddd\u79bb\u7684\u4e0b\u754c\u6765\u5f53\u4f5c\u635f\u5931\u51fd\u6570\uff0c\u76f8\u5f53\u4e8e\u5168\u6c11\u5954\u5c0f\u5eb7\u3002\u5982\u679c\u7528\u5e73\u5747\u8ddd\u79bb\uff0c\u4f1a\u5bfc\u81f4\u5206\u7c7b\u9519\u8bef\u7387\u9ad8\uff0c\u4f46\u662f\u5e73\u5747\u8ddd\u79bb\u5c0f\u7684\u5206\u7c7b\u5668\u88ab\u9009\u62e9\uff0c\u76f8\u5f53\u4e8e\u52a3\u5e01\u9a71\u9010\u826f\u5e01\u3002\u6211\u4eec\u5b66\u4e60\u5206\u7c7b\u5668\u7684\u672c\u8d28\u8fd8\u662f\u7528\u6765\u5206\u7c7b\u7684\uff0c\u4e0d\u80fd\u5fd8\u4e86\u521d\u5fc3\u3002 Hard SVM\u7b97\u6cd5 \u00b6 \u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u4e0a\u9762\u7684\u635f\u5931\u51fd\u6570\u4e0d\u5bb9\u8bb8\u4efb\u4f55\u4e00\u4e2a\u70b9\u5206\u7c7b\u9519\u8bef\uff0c\u6240\u4ee5\u5bf9\u5e94\u7684\u7b97\u6cd5\u53eb\u505a Hard SVM\u7b97\u6cd5\u3002 \u9996\u5148\u6211\u4eec\u5199\u51fa\u6211\u4eec\u4f18\u5316\u76ee\u6807\uff1a \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u6709\u65e0\u9650\u591a\u7ec4\uff1a\u5982\u679c (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) \u662f\u89e3\uff0c\u90a3\u4e48\u5bf9\u4efb\u610f k > 0 k > 0 , (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) \u90fd\u662f\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u3002 \u6211\u4eec\u53ea\u60f3\u6c42\u5230\u4e00\u4e2a\u89e3\u5c31\u597d\u4e86:\u5982\u679c\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u6bcd\u4e0a \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 , \u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86: \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \u8fd9\u4e2a\u95ee\u9898\u7b49\u4ef7\u7684\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u5f88\u96be\u89e3\uff1a \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u7b49\u4ef7\u7684\u539f\u56e0\u662f\uff1a\u5982\u679c \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \uff0c\u90a3\u4e48\u5185\u5c42\u7684\u4f18\u5316 \\min_{\\alpha \\ne 0} \\min_{\\alpha \\ne 0} \u5c31\u4f1a\u7b49\u4e8e\u65e0\u7a77\u5c0f\uff0c\u5373 \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \u662f\u65e0\u7a77\u5c0f\uff0c\u80af\u5b9a\u5c0f\u4e8e \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \u7684\u503c\u3002 \u8fd9\u91cc\u5c31\u8981\u7528\u5230\u8fd9\u4e00\u5c0f\u8282\u5f00\u5934\u7684\u5047\u8bbe\uff0c\u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u5b50\u4e0a\uff0c\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86\uff1a \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \u8fd9\u91cc\u7684\u53d8\u5f62\u5c31\u5dee\u6700\u540e\u4e00\u6b65\u4e86\uff0c\u6211\u4eec\u60f3\u53bb\u6389 \\min_{i\\in[1,m]} \\min_{i\\in[1,m]} \u64cd\u4f5c\uff0c\u5373\u628a\u4f18\u5316\u76ee\u6807\u8fd8\u53ef\u4ee5\u7b80\u5316\u6210\uff1a \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \u8fd9\u4e00\u6b65\u7684\u7b49\u4ef7\u539f\u56e0\u662f\uff1a \u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u7684\u6700\u4f18\u89e3 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u5bfc\u81f4 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 , \u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u89e3 (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) \u6bd4 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u66f4\u4f18\u3002 \u5bf9\u5e94\u7684\u65e0\u7ea6\u675f\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u662f \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \u73b0\u5728\u6765\u6c42\u89e3\u4e00\u4e0b\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\u3002 \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \u5176\u4e2d \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \uff0c \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \u56e0\u6b64\u53ef\u5f97\uff1a \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \u5176\u4e2d \\mathbf{b}^*_\\theta \\mathbf{b}^*_\\theta \u6d89\u53ca\u5230support\u96c6 \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \uff0c \u4e0d\u5728\u8fd9\u4e2a\u96c6\u5408\u4e0a\u7684\u70b9 (\\mathbf{x}_i, y_i) (\\mathbf{x}_i, y_i) \u6ee1\u8db3 \\alpha_i = 0 \\alpha_i = 0 \uff0c\u4e5f\u5c31\u662f\u8bf4 (\\mathbf{w}^*_\\theta, b^*) (\\mathbf{w}^*_\\theta, b^*) \u53ea\u662fsupport\u96c6\u5143\u7d20\u7684\u653e\u5c04\u7ec4\u5408\uff0c\u4e0e\u4e0d\u5728supoort\u96c6\u4e0a\u7684\u6837\u672c\u65e0\u5173\u3002 Soft SVM\u7b97\u6cd5 \u00b6 \u5728\u4e0a\u4e00\u5c0f\u8282\uff0c\u7b97\u6cd5\u7684\u8981\u6c42\u592a\u5f3a\u4e86\uff0c\u6837\u672c\u6570\u636e\u9700\u8981\u4e25\u683c\u7ebf\u6027\u53ef\u5206\u3002 \u6211\u4eec\u53ef\u4ee5\u5f15\u5165\u4e00\u4e2a\u677e\u5f1b\u56e0\u5b50 \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} , \u5c06\u4f18\u5316\u76ee\u6807\u4fee\u6539\u6210\uff1a \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \u8fd9\u91cc \\xi_i \\xi_i \u53ef\u4ee5\u89c2\u5bdf\u5f97\u5230\u6700\u5c0f\u503c\u4e3a \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \u3002 \u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \u56e0\u4e3a l_{hinge}(x) = max(0, 1- x) l_{hinge}(x) = max(0, 1- x) , \u6240\u4ee5\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u4e5f\u53ef\u4ee5\u770b\u6210\u662fhinge\u635f\u5931\u51fd\u6570\u52a0\u4e8c\u8303\u6570\u6b63\u5219\u9879\u3002 \u56de\u5230\u4f18\u5316\u95ee\u9898(10)\u3002 p=1 p=1 \u65f6\uff0c\u6211\u4eec\u5199\u51fa\u5b83\u7684\u7b49\u4ef7\u62c9\u683c\u6717\u65e5\u65e0\u7ea6\u675f\u5f62\u5f0f\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \u6574\u7406\u4e00\u4e0b\u53ef\u5f97\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898: \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} SMO\u4f18\u5316\u7b97\u6cd5\u6765\u6c42\u89e3\u8be5\u95ee\u9898\u3002","title":"SVM"},{"location":"ML/02-SVM/#svm","text":"SVM\u7b97\u6cd5\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u56e0\u4e3a\u5f88\u591a\u6269\u5c55\u800c\u53d8\u5f97\u590d\u6742\u8d77\u6765\u3002 \u5b66\u8fc7\u4f18\u5316\u7684\u8bdd\u5c31\u5f88\u597d\u7406\u89e3\u4e86\uff1a SVM\u7b97\u6cd5\u672c\u8d28\u662f\u5c06\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\u5efa\u6a21\u6210\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\u7684\u4f18\u5316\u95ee\u9898\uff0c \u5b83\u521a\u597d\u53c8\u95ed\u89e3\uff0c\u95ed\u89e3\u7684\u63a8\u5bfc\u5e94\u8be5\u662f\u5c5e\u4e8e\u4f18\u5316\u7684\u9886\u57df\u3002","title":"SVM\u7b97\u6cd5"},{"location":"ML/02-SVM/#_1","text":"\u5728\u4e00\u5207\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u8981\u5148\u786e\u5b9a\u4e00\u4e2ahypothesis\u96c6 \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \\mathcal{H}=\\{h_{\\theta}(\\mathbf{x})\\} \u3002 \u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u6837\u672c\u96c6 \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \\mathcal{S} = \\{(\\mathbf{x}_1, y), (\\mathbf{x}_2, y), \\ldots, (\\mathbf{x}_m, y)\\} \uff0c\u5176\u4e2d \\mathbf{x} \\in \\mathbb{R}^{d} \\mathbf{x} \\in \\mathbb{R}^{d} \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \u3002\u6211\u4eec\u5e0c\u671b\u5728 \\mathcal{H} \\mathcal{H} \u4e2d\u627e\u5230\u4e00\u4e2a\u5206\u7c7b\u51fd\u6570 h_\\theta(\\mathbf{x}) h_\\theta(\\mathbf{x}) \u80fd\u628a\u6837\u672c \\mathcal{S} \\mathcal{S} \u5206\u5f97\u6700\u5f00\u3002 \u4ec0\u4e48\u53eb\u505a\u5206\u5f97\u6700\u5f00\u5462\uff1f\u6211\u4eec\u8fd9\u91cc\u7528\u6837\u672c\u4e0e\u5206\u7c7b\u9762\u7684\u8ddd\u79bb\u6765\u8bc4\u4ef7\u5206\u5f00\u7684\u7a0b\u5ea6\u3002 \u6211\u4eec\u6784\u5efa\u7684hypothesis\u96c6\u662f\u7ebf\u6027\u51fd\u6570\u7684\u96c6\u5408\uff1a \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \\mathcal{H} = \\{h_{\\theta}(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta}\\}.\\tag{1} \u90a3\u4e48\uff0c\u6837\u672c\u70b9 (\\mathbf{x}, y) (\\mathbf{x}, y) \u4e0e\u8d85\u5e73\u9762\u7684\u6b27\u5f0f\u8ddd\u79bb\u6709\u95ed\u89e3\uff1a d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} d(h_{\\theta}, (\\mathbf{x}, y)) = \\frac{\\vert \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_{\\theta} \\vert}{\\Vert \\mathbf{w}_{\\theta} \\Vert}.\\tag{2} \u90a3\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u635f\u5931\u51fd\u6570\u662f\uff1a L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} L_{\\mathcal{S}} (\\theta) = \\min_{i \\in [1, m]} -\\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}. \\tag{3} \u5f53\u6709\u5206\u7c7b\u9519\u7684\u70b9\uff0c\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u4e3a\u6b63\uff0c\u9519\u8bef\u70b9\u8ddd\u79bb\u8d85\u5e73\u9762\u8fdc\uff0c\u9519\u5f97\u8d8a\u79bb\u8c31\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5927\u3002\u5f53\u5206\u7c7b\u5168\u90e8\u6b63\u786e\u65f6\uff0c\u8d85\u5e73\u9762\u5c06\u70b9\u5206\u5f97\u8d8a\u5f00\uff0c\u635f\u5931\u51fd\u6570\u8d8a\u5c0f\u3002 \u8fd9\u91cc\u6211\u4eec\u7528\u8ddd\u79bb\u7684\u4e0b\u754c\u6765\u5f53\u4f5c\u635f\u5931\u51fd\u6570\uff0c\u76f8\u5f53\u4e8e\u5168\u6c11\u5954\u5c0f\u5eb7\u3002\u5982\u679c\u7528\u5e73\u5747\u8ddd\u79bb\uff0c\u4f1a\u5bfc\u81f4\u5206\u7c7b\u9519\u8bef\u7387\u9ad8\uff0c\u4f46\u662f\u5e73\u5747\u8ddd\u79bb\u5c0f\u7684\u5206\u7c7b\u5668\u88ab\u9009\u62e9\uff0c\u76f8\u5f53\u4e8e\u52a3\u5e01\u9a71\u9010\u826f\u5e01\u3002\u6211\u4eec\u5b66\u4e60\u5206\u7c7b\u5668\u7684\u672c\u8d28\u8fd8\u662f\u7528\u6765\u5206\u7c7b\u7684\uff0c\u4e0d\u80fd\u5fd8\u4e86\u521d\u5fc3\u3002","title":"\u76ee\u6807\u95ee\u9898"},{"location":"ML/02-SVM/#hard-svm","text":"\u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u4e0a\u9762\u7684\u635f\u5931\u51fd\u6570\u4e0d\u5bb9\u8bb8\u4efb\u4f55\u4e00\u4e2a\u70b9\u5206\u7c7b\u9519\u8bef\uff0c\u6240\u4ee5\u5bf9\u5e94\u7684\u7b97\u6cd5\u53eb\u505a Hard SVM\u7b97\u6cd5\u3002 \u9996\u5148\u6211\u4eec\u5199\u51fa\u6211\u4eec\u4f18\u5316\u76ee\u6807\uff1a \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \\max_{\\theta} \\min_{i\\in[1, m]} \\frac{y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})}{\\Vert \\mathbf{w}_{\\theta} \\Vert}, \\tag{4} \u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u6709\u65e0\u9650\u591a\u7ec4\uff1a\u5982\u679c (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) (\\mathbf{w}^*_{\\theta}, b^*_{\\theta}) \u662f\u89e3\uff0c\u90a3\u4e48\u5bf9\u4efb\u610f k > 0 k > 0 , (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) (k \\mathbf{w}^*_{\\theta}, k b^*_{\\theta}) \u90fd\u662f\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u7684\u89e3\u3002 \u6211\u4eec\u53ea\u60f3\u6c42\u5230\u4e00\u4e2a\u89e3\u5c31\u597d\u4e86:\u5982\u679c\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u6bcd\u4e0a \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 \\Vert\\mathbf{w}_{\\theta}\\Vert = 1 , \u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86: \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \\max_{\\theta} \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}), \\quad s.t. \\quad \\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1. \\tag{5} \u8fd9\u4e2a\u95ee\u9898\u7b49\u4ef7\u7684\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u5f88\u96be\u89e3\uff1a \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \\max_{\\theta} min_{\\pmb{\\alpha} \\ne 0} \\left[\\pmb{\\alpha}(\\Vert \\mathbf{w}_{\\theta} \\Vert^2 - 1) + \\min_{i\\in[1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\right], \u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u7b49\u4ef7\u7684\u539f\u56e0\u662f\uff1a\u5982\u679c \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1 \uff0c\u90a3\u4e48\u5185\u5c42\u7684\u4f18\u5316 \\min_{\\alpha \\ne 0} \\min_{\\alpha \\ne 0} \u5c31\u4f1a\u7b49\u4e8e\u65e0\u7a77\u5c0f\uff0c\u5373 \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 \\ne 1} \u662f\u65e0\u7a77\u5c0f\uff0c\u80af\u5b9a\u5c0f\u4e8e \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \\max_{\\theta,\\Vert \\mathbf{w}_{\\theta} \\Vert^2 = 1} \u7684\u503c\u3002 \u8fd9\u91cc\u5c31\u8981\u7528\u5230\u8fd9\u4e00\u5c0f\u8282\u5f00\u5934\u7684\u5047\u8bbe\uff0c\u8fd9\u4e00\u5c0f\u8282\u7684\u7b97\u6cd5\u5047\u8bbe \\mathcal{H} \\mathcal{H} \u91cc\u5b58\u5728\u7ecf\u9a8c\u8bef\u5dee\u7b49\u4e8e0\u7684\u5206\u7c7b\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u9650\u5236\u5230\u5206\u5b50\u4e0a\uff0c\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86\uff1a \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \\max_{\\theta} \\frac{1}{\\Vert \\mathbf{w}_\\theta \\Vert} \\quad s.t.\\quad \\min_{i \\in [1, m]} y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) = 1. \\tag{6} \u8fd9\u91cc\u7684\u53d8\u5f62\u5c31\u5dee\u6700\u540e\u4e00\u6b65\u4e86\uff0c\u6211\u4eec\u60f3\u53bb\u6389 \\min_{i\\in[1,m]} \\min_{i\\in[1,m]} \u64cd\u4f5c\uff0c\u5373\u628a\u4f18\u5316\u76ee\u6807\u8fd8\u53ef\u4ee5\u7b80\u5316\u6210\uff1a \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 \\quad s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1. \\tag{7} \u8fd9\u4e00\u6b65\u7684\u7b49\u4ef7\u539f\u56e0\u662f\uff1a \u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u7684\u6700\u4f18\u89e3 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u5bfc\u81f4 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 \\min_{i \\in [1, m]} y_i(\\mathbf{w^*}^T_{\\theta} \\mathbf{x}_i + b^*_{\\theta}) = \\gamma > 1 , \u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u89e3 (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) (\\mathbf{w}^*_\\theta/\\gamma, b^*_{\\theta}/\\gamma) \u6bd4 (\\mathbf{w}^*_\\theta, b^*_{\\theta}) (\\mathbf{w}^*_\\theta, b^*_{\\theta}) \u66f4\u4f18\u3002 \u5bf9\u5e94\u7684\u65e0\u7ea6\u675f\u62c9\u683c\u6717\u65e5\u5f62\u5f0f\u662f \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})]. \\tag{8} \u73b0\u5728\u6765\u6c42\u89e3\u4e00\u4e0b\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\u3002 \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \\begin{align*} &\\min_{\\theta} \\max_{\\pmb{\\alpha} \\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0}\\min_{\\theta} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1}\\alpha_i [1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1}\\alpha_i y_i \\mathbf{x}_i,\\quad \\sum^{m}_{i=1} \\alpha_i y_i = 0.)\\\\ =& \\max_{\\pmb{\\alpha} \\succeq 0} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^m_{i=1} \\sum^{m}_{j=1} \\alpha_i\\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j \\\\ =& \\max_{\\pmb{\\alpha}\\succeq 0} \\mathbf{1}^T \\pmb{\\alpha} - \\frac{1}{2} \\mathbf{\\alpha}^T \\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y \\pmb{\\alpha}. \\tag{9} \\end{align*} \u5176\u4e2d \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \\mathbf{D}_y=diag(y_1, y_2, \\ldots, y_m) \uff0c \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \u56e0\u6b64\u53ef\u5f97\uff1a \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \\begin{cases} \\pmb{\\alpha}^* = (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1}, \\\\ \\mathbf{w}^*_{\\theta} = \\mathbf{X}\\mathbf{D}_y \\pmb{\\alpha}^*, \\\\ \\mathbf{b}^*_{\\theta} = y_i - \\sum^{m}_{i=1} \\alpha_j y_j \\mathbf{x}^T_j \\mathbf{x}_i \\quad (\\alpha_i \\ne 0 \\overset{KKT}{\\Rightarrow} \\mathbf{w^*}^T_\\theta \\mathbf{x}_i + \\mathbf{b}^*_\\theta = y_i), \\\\ \\Vert \\mathbf{w}^*_\\theta\\Vert = \\Vert \\mathbf{X D}_y \\pmb{\\alpha}^* \\Vert^2 = \\mathbf{1}^T (\\mathbf{D}_y \\mathbf{X}^T \\mathbf{X} \\mathbf{D}_y)^{-1} \\mathbf{1} = \\Vert \\pmb{\\alpha}^* \\Vert_1. \\end{cases} \u5176\u4e2d \\mathbf{b}^*_\\theta \\mathbf{b}^*_\\theta \u6d89\u53ca\u5230support\u96c6 \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \\{(\\mathbf{x}, y):\\mathbf{w^*}_\\theta^T \\mathbf{x} + b^*_{\\theta} = y \\} \uff0c \u4e0d\u5728\u8fd9\u4e2a\u96c6\u5408\u4e0a\u7684\u70b9 (\\mathbf{x}_i, y_i) (\\mathbf{x}_i, y_i) \u6ee1\u8db3 \\alpha_i = 0 \\alpha_i = 0 \uff0c\u4e5f\u5c31\u662f\u8bf4 (\\mathbf{w}^*_\\theta, b^*) (\\mathbf{w}^*_\\theta, b^*) \u53ea\u662fsupport\u96c6\u5143\u7d20\u7684\u653e\u5c04\u7ec4\u5408\uff0c\u4e0e\u4e0d\u5728supoort\u96c6\u4e0a\u7684\u6837\u672c\u65e0\u5173\u3002","title":"Hard SVM\u7b97\u6cd5"},{"location":"ML/02-SVM/#soft-svm","text":"\u5728\u4e0a\u4e00\u5c0f\u8282\uff0c\u7b97\u6cd5\u7684\u8981\u6c42\u592a\u5f3a\u4e86\uff0c\u6837\u672c\u6570\u636e\u9700\u8981\u4e25\u683c\u7ebf\u6027\u53ef\u5206\u3002 \u6211\u4eec\u53ef\u4ee5\u5f15\u5165\u4e00\u4e2a\u677e\u5f1b\u56e0\u5b50 \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} \\pmb{\\xi}\\in\\mathbb{R}^{m}_{+} , \u5c06\u4f18\u5316\u76ee\u6807\u4fee\u6539\u6210\uff1a \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\Vert\\pmb{\\xi}\\Vert^p, \\\\ &\\ s.t.\\quad \\forall i \\in [1, m],\\quad y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta}) \\ge 1 - \\xi_i.\\tag{10} \\end{align*} \u8fd9\u91cc \\xi_i \\xi_i \u53ef\u4ee5\u89c2\u5bdf\u5f97\u5230\u6700\u5c0f\u503c\u4e3a \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\max(0, 1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \u3002 \u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \\begin{align*} &\\min_{\\theta} \\sum^m_{i=1} \\Vert \\max(0, 1- y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i + b_{\\theta})) \\Vert^p + \\frac{1}{2C} \\Vert \\mathbf{w}_\\theta \\Vert^2. \\\\ \\end{align*} \u56e0\u4e3a l_{hinge}(x) = max(0, 1- x) l_{hinge}(x) = max(0, 1- x) , \u6240\u4ee5\u8fd9\u4e2a\u4f18\u5316\u76ee\u6807\u4e5f\u53ef\u4ee5\u770b\u6210\u662fhinge\u635f\u5931\u51fd\u6570\u52a0\u4e8c\u8303\u6570\u6b63\u5219\u9879\u3002 \u56de\u5230\u4f18\u5316\u95ee\u9898(10)\u3002 p=1 p=1 \u65f6\uff0c\u6211\u4eec\u5199\u51fa\u5b83\u7684\u7b49\u4ef7\u62c9\u683c\u6717\u65e5\u65e0\u7ea6\u675f\u5f62\u5f0f\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + C \\sum^{m}_{i=1} {\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - \\xi_i - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] - \\sum^{m}_{i=1}\\beta_i \\xi_i. \u6574\u7406\u4e00\u4e0b\u53ef\u5f97\uff1a \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)]. \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898: \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} \\begin{align*} &\\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ =&\\max_{\\pmb{\\alpha}\\succeq \\pmb{0}, \\pmb{\\beta} \\succeq \\pmb{0}} \\min_{\\theta, \\pmb{\\xi}\\succeq 0} \\frac{1}{2} \\Vert \\mathbf{w}_\\theta \\Vert^2 + \\sum^{m}_{i=1} (C - \\alpha_i - \\beta_i){\\xi}_i + \\sum^m_{i=1}\\alpha_i[1 - y_i(\\mathbf{w}^T_{\\theta} \\mathbf{x}_i - b_\\theta)] \\\\ &(\\mathbf{w}^*_{\\theta} = \\sum^{m}_{i=1} \\alpha_i y_i \\mathbf{x}_i, \\sum^{m}_{i=1}\\alpha_i y_i = 0, C = \\alpha_i + \\beta_i) \\\\ =& \\max_{C \\succeq \\pmb{\\alpha}\\succeq \\pmb{0}} \\sum^{m}_{i=1} \\alpha_i - \\frac{1}{2} \\sum^{m}_{i=1, j=1} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}^T_i \\mathbf{x}_j\\quad(s.t. \\sum^{m}_{i=1} \\alpha_i y_i = 0). \\end{align*} SMO\u4f18\u5316\u7b97\u6cd5\u6765\u6c42\u89e3\u8be5\u95ee\u9898\u3002","title":"Soft SVM\u7b97\u6cd5"},{"location":"ML/03-Rademacher/","text":"Rademacher\u590d\u6742\u5ea6 \u00b6 \u524d\u7f6e\u77e5\u8bc6 \u00b6 \u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 $(x, y) \\sim \\mathcal{D} $\u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u6211\u4eec\u4eba\u4e3a\u5730\u6784\u9020\u67d0\u4e2a\u7279\u5b9a\u6761\u4ef6\u5206\u5e03\u7684\u96c6\u5408(Hypothesis Set): \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \uff0c\u8fd9\u4e9b\u6761\u4ef6\u5206\u5e03\u88ab \\theta \\theta \u53c2\u6570\u5316\u3002 \u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u76ee\u6807\u5c31\u662f\u6839\u636e\u6837\u672c\u4ece\u5019\u9009\u96c6\u4e2d\u9009\u62e9\u6700\u63a5\u8fd1\u771f\u5b9e\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u7684\u5206\u5e03 P_{\\theta}(y \\vert x) P_{\\theta}(y \\vert x) \u3002 \u8bb2\u5230\u8fd9\u91cc\u5c31\u592a\u62bd\u8c61\u4e86\uff0c\u5fc5\u987b\u8981\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u4e00\u4e0b\u4e86\u3002 \u4f8b\u5b501\uff1a\u4e00\u4e2a\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u4e2d\uff0c\u5047\u8bbe\u96c6\u662f\u67d0\u4e2a\u7a7a\u95f4\u8d85\u5e73\u9762\u7684\u96c6\u5408 \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} , \u8fd9\u91cc\u7684\u6761\u4ef6\u5206\u5e03\u5bf9\u5e94\u7684\u662f P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 \u3002\u6211\u4eec\u53ef\u4ee5\u9009\u53d6\u67d0\u4e2a\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u5dee\u5f02\u7684\u8ddd\u79bb\u6765\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u6c42\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u7684\u6700\u5c0f\u503c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5728\u8fd9\u4e2a\u8ddd\u79bb\u4e0b\uff0c\u6700\u63a5\u8fd1\u771f\u5b9e\u6761\u4ef6\u5206\u5e03\u7684\u53c2\u6570\u5316\u6761\u4ef6\u5206\u5e03, \u5373\u4f18\u5316\u76ee\u6807\u4e3a\uff1a \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \u8fd9\u91cc\u5982\u679c\u4f7f\u7528Wasserstein Distance, \u5e76\u4e14\u4f7f\u7528\u82b1\u8d39\u51fd\u6570 c(a, b) = \\Vert a - b\\Vert^2 c(a, b) = \\Vert a - b\\Vert^2 , \u90a3\u4e48\u5c31\u662f\u53ef\u4ee5\u5f97\u5230\u7ecf\u5178\u56de\u5f52\u95ee\u9898\u7684\u4f18\u5316\u76ee\u6807\uff1a \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \u5982\u679c y \\in \\{0, 1\\} y \\in \\{0, 1\\} , \u4e5f\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u4f18\u5316\u76ee\u6807\u7b49\u4ef7\u4e8e0-1\u635f\u5931\uff1a \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u90fd\u662f\u56f4\u7ed50-1\u5206\u7c7b\u95ee\u9898\u800c\u8fdb\u884c\u7684\u3002\u975e\u5e38\u4e0d\u5e78\u7684\u662f\uff0c\u4e0a\u9762\u63d0\u5230\u7684\u771f\u5b9e\u635f\u5931\u51fd\u6570\u6211\u4eec\u90fd\u6ca1\u529e\u6cd5\u76f4\u63a5\u8fdb\u884c\u4f18\u5316\uff0c\u6211\u4eec\u80fd\u505a\u7684\u662f\u4f18\u5316\u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\uff1a \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \u5176\u4e2d l^{0-1}(h(x), y) = 1_{h(x) = y} l^{0-1}(h(x), y) = 1_{h(x) = y} . \u4e0a\u9762\u8fd9\u79cd\u4f18\u5316\u76ee\u6807\u6709\u4e00\u4e2a\u540d\u5b57\u53eb\u505a\u7ecf\u9a8c\u98ce\u9669\u6700\u5c0f\u5316(Empirical Risk Minimization, ERM)\uff0c(4)\u5f0f\u5bf9\u5e94\u7684\u6700\u4f18\u5206\u7c7b\u5668 h^* h^* \u53ef\u4ee5\u5199\u6210 ERM_{\\mathcal{H}}(S) ERM_{\\mathcal{H}}(S) \u3002 Representativeness \u00b6 \u9996\u5148\u5f15\u5165\u4e00\u4e2a\u8bc4\u4ef7\u6837\u672c\u7684\u6807\u51c6: \u5b9a\u4e491\uff1a \\mathcal{S} \\mathcal{S} \u88ab\u79f0\u4e3a \\epsilon-representative \\epsilon-representative \uff0c\u5982\u679c \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \u5982\u679c \u6837\u672c S S \u662f \\epsilon-representative \\epsilon-representative \uff0c \u90a3\u4e48 \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \u5373 L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u901a\u8fc7ERM\u6807\u51c6\u6c42\u5230\u7684\u5206\u7c7b\u5668\u662f\u80fd\u591f\u63a5\u8fd1\u6700\u4f18\u503c\u7684\uff0c\u5e76\u4e14 \\epsilon \\epsilon \u80fd\u591f\u4f53\u73b0\u4e24\u8005\u7684\u63a5\u8fd1\u7a0b\u5ea6\u3002\u5982\u679c \\epsilon \\epsilon \u8db3\u591f\u5c0f\uff0c\u90a3\u4e48 S S \u8db3\u4ee5\u4ee3\u8868\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u63a5\u4e0b\u6765\u540c\u6837\u662f\u7eaf\u6570\u5b66\u7684\u4e1c\u897f\u3002\u6211\u4eec\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff1a\u7ed9\u5b9a\u4efb\u610f\u4e00\u4e2a\u6837\u672c S S , \u6211\u4eec\u8981\u4f30\u8ba1\u5b83\u7684\u4ee3\u8868\u7a0b\u5ea6(representiveness)\u3002 \u4e3a\u4e86\u8ba8\u8bba\u65b9\u4fbf\uff0c\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u96c6\u5408: \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \u8fd9\u6837\uff0c\u771f\u5b9e\u8bef\u5dee\u53ef\u5199\u6210 L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] \uff0c\u7ecf\u9a8c\u8bef\u5dee\u53ef\u4ee5\u5199\u6210 L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) \u3002\u90a3\u4e48\u6837\u672c S S \u7684\u4ee3\u8868\u6027\u53ef\u4ee5\u91cd\u65b0\u5199\u6210 Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} \u5176\u5b9e(6)\u5f0f\u53ea\u662f\u5b9a\u4e491\u6362\u4e86\u4e00\u79cd\u5199\u6cd5\uff0c\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u771f\u7684\u8ba1\u7b97\u5b83\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b83\u5bf9\u5e94\u5730\u7ecf\u9a8c\u516c\u5f0f\uff0c\u4ee5\u53ca\u7ecf\u9a8c\u516c\u5f0f\u548c(6)\u5f0f\u7684gap\u3002 \u6837\u672c\u96c6\u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1: Rademacher\u590d\u6742\u5ea6 \u00b6 \u9996\u5148\u4ecb\u7ecd\u4e00\u4e2a\u76f4\u89c9\u4e0a\u7684\u7ecf\u9a8c\u4f30\u8ba1\uff1a\u5c06 S S \u5747\u5206\u6210\u4e24\u4e2a\u6837\u672c\u96c6 S_1 S_1 \u4e0e S_2 S_2 \u3002\u5747\u5206\u7684\u610f\u601d\u662f S S \u4e2d\u7684\u6837\u672c (x, y) (x, y) \u53ea\u4f1a\u51fa\u73b0\u5728 S_1 S_1 \u4e0e S_2 S_2 \u4e2d\u7684\u4e00\u4e2a, \u800c\u4e14\u4e00\u5b9a\u4f1a\u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u4e2a\u6837\u672c\u96c6\u4e2d\u3002 \u90a3\u4e48\uff0c S S \u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1\u662f\uff1a \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \u8fd9\u4e2a\u7ecf\u9a8c\u4f30\u8ba1\u5e76\u4e0d\u662f\u7b26\u5408\u6240\u6709\u4eba\u7684\u76f4\u89c9\u7684\uff0c\u6240\u4ee5\u4f60\u5982\u679c\u611f\u89c9\u83ab\u540d\u5176\u5999\uff0c\u4e5f\u4e0d\u8981\u614c\uff0c\u8ddf\u7740\u6211\u7ee7\u7eed\u3002 \u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u968f\u673a\u53d8\u91cf \\sigma \\in \\{-1, 1\\} \\sigma \\in \\{-1, 1\\} \uff0c\u5b83\u67090.5\u7684\u6982\u7387\u53d6 1 1 , \u67090.5\u7684\u6982\u7387\u53d6 -1 -1 \uff0c\u90a3\u4e48\u4e00\u4e2a\u66f4\u597d\u7684\u7ecf\u9a8c\u4f30\u8ba1\u53ef\u4ee5\u5199\u6210 R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53eb\u505a Rademacher\u590d\u6742\u5ea6\u3002\u8fd9\u4e2a\u4f30\u8ba1\u6bd4(7)\u5f0f\u590d\u6742\u5f97\u591a\uff0c\u662f 2^m 2^m \u6307\u6570\u500d\uff0c\u8ba1\u7b97\u590d\u6742\u7684\u95ee\u9898\u6211\u4eec\u653e\u5230\u540e\u9762\u89e3\u51b3\u3002\u6211\u4eec\u5148\u6765\u89e3\u51b3\u4e00\u4e0b\u8fd9\u4e2aRademacher\u590d\u6742\u5ea6\u548c\u6837\u672c\u8868\u8fbe\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u5b9a\u74061\uff1a \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \u8bc1\u660e\u5f88\u5de7\u5999\uff0c\u4e66\u4e0a\u6709\u3002 \u6839\u636e\u5b9a\u74061\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u51e0\u4e2a\u5f15\u7406\uff1a \u9996\u5148 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ; \u5176\u6b21 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ,\u5176\u4e2d h^* = \\min L_{\\mathcal{D}}(h) h^* = \\min L_{\\mathcal{D}}(h) ; \u6700\u540e P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta \u3002(\u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f) \u4e3a\u4e86\u63a5\u4e0b\u6765\u7684\u5206\u6790\uff0c\u9700\u8981\u5148\u4ecb\u7ecd\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff1aMcDiarmid's Inequality\u3002 \u5b9a\u74062\uff1a(McDiarmid's Inequality)\u3002 \u5982\u679c i \\in [1, m] i \\in [1, m] , \u5e76\u4e14 f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], \u90a3\u4e48 P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. \u5b9a\u74063\uff1a(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \u5bf9\u4e8em\u4e2a\u968f\u673a\u53d8\u91cf X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] , \u5b83\u4eec\u5747\u503c\u7684\u968f\u673a\u53d8\u91cf \\bar X \\bar X \u6ee1\u8db3 P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). \u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e0e\u6570\u636e\u76f4\u63a5\u6709\u5173\u7684\u8fb9\u754c\uff0c\u800c\u4e0d\u53ea\u662f\u671f\u671b\u3002 \u5b9a\u74064\uff1a(\u6570\u636e\u76f8\u5173\u754c)\u3002\u5982\u679c l(h(x), y) \\in [a, b] l(h(x), y) \\in [a, b] \uff0c\u90a3\u4e48 P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta \u8bc1\u660e\uff1a \u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff0c\u76f4\u63a5\u4f7f\u7528McDiarmid's Inequality, \u6ce8\u610f\u5bf9\u5e94\u7684\u4e0d\u662f l(h(x), y) l(h(x), y) \u7684\u754c\u800c\u662f\u662f [(a - b)/m, (b - a)/m] [(a - b)/m, (b - a)/m] \uff1b \u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u5f0f\uff0c \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u4e0d\u7b49\u5f0f, \u9996\u5148\u5b9a\u4e49 h_S = ERM_{\\mathcal{H}}(S) h_S = ERM_{\\mathcal{H}}(S) \uff0c \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \u8fd9\u4e09\u4e2a\u4e0d\u7b49\u5f0f\u5c42\u5c42\u9012\u8fdb\uff0c\u5176\u4e2d\u7b2c\u4e09\u4e2a\u7b49\u5f0f\u662f\u6211\u4eec\u6700\u60f3\u5f97\u5230\u7684\u7ed3\u679c\u3002 \u8ba1\u7b97Rademacher\u590d\u6742\u5ea6 \u00b6 \u5bf9\u4e8eRademacher\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u62bd\u8c61\u7684\u8ba4\u4e3a\u662f\u8861\u91cf\u4e00\u4e2a\u5411\u91cf\u96c6\u5408\u7684\u590d\u6742\u5ea6\u7684\uff1a A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} \u5f15\u74061\uff1a\u5bf9\u4e8e\u96c6\u5408 A A , \u5e38\u6570 c c \u548c \u67d0\u4e2a\u5411\u91cf \\mathbf{a}_0 \\mathbf{a}_0 \uff0c\u90a3\u4e48 R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). \u5f15\u74062\uff1a\u5bf9\u4e8e\u96c6\u5408A\uff0c\u5bf9\u5e94\u7684\u4e00\u4e2a\u96c6\u5408 A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} , \u90a3\u4e48 R(A') = R(A) R(A') = R(A) \u3002 \u5f15\u74063\uff1a(Massart Lemma). \u5982\u679c A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} \uff0c\u5b9a\u4e49 \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i , \u90a3\u4e48 R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. \u8bc1\u660e\uff1a\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe \\bar{\\mathbf{a}} = 0 \\bar{\\mathbf{a}} = 0 , \u5e76\u4e14 A' = \\lambda A(\\lambda > 0) A' = \\lambda A(\\lambda > 0) , \u90a3\u4e48 \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \u53c8\u56e0\u4e3a R(A') = \\lambda R(A) R(A') = \\lambda R(A) , \u6240\u4ee5 mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. \u5f15\u74064\uff1a\u6536\u7f29\u6027\u3002 \u4ee4 \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) , \u5e76\u4e14 \\phi_i \\phi_i \u90fd\u662f \\rho \\rho -Lipshcitz \u8fde\u7eed\u51fd\u6570\uff0c\u90a3\u4e48 R(\\phi\\circ A) \\le \\rho R(A) R(\\phi\\circ A) \\le \\rho R(A) . \u7ebf\u6027\u5047\u8bbe\u96c6\u7684Rademacher\u590d\u6742\u5ea6 \u00b6 \u4f8b2\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} \u8bc1\u660e\uff1a \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \u4f8b3\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. \u8fd9\u4e2a\u8bc1\u660e\u6709\u70b9\u5de7\u5999\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u6709\u70b9\u7ed5\uff0c\u5927\u5bb6\u5c0f\u5fc3\u4e86\u3002 \u8bc1\u660e\uff1a \u9996\u5148\u6784\u9020\u96c6\u5408 V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} . \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*} \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*} SVM\u7b97\u6cd5\u7684\u754c \u00b6 \u5b9a\u74065\uff1a\u5bf9\u4e8eSVM\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u6211\u4eec\u589e\u52a0\u9650\u5b9a \\Vert \\mathbf{x} \\Vert_2 \\le R \\Vert \\mathbf{x} \\Vert_2 \\le R \u4ee5\u53ca\u5047\u8bbe\u96c6\u7684\u9650\u5b9a \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} , \u6837\u672c\u70b9\u635f\u5931\u51fd\u6570 l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} , l(a, y) l(a, y) \u5173\u4e8ea\u662f \\rho \\rho -Lipschitz\u8fde\u7eed\uff0c\u5e76\u4e14 l(a, y)\\in[0, c] l(a, y)\\in[0, c] , \u90a3\u4e48 P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. \u8bc1\u660e\uff1a \u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} \u3002\u524d\u9762\u7684\u6bd4\u4f8b\u4e0d\u53d8\u6027\u3001\u4f8b\u5b502\u8bc1\u660e\u4e86\u8fd9\u4e9b\u4e8b\u60c5\u3002 \u53ef\u4ee5\u5c06 \\mathbf{x} \\mathbf{x} \u7ef4\u5ea6\u589e\u52a0\u4e00\u7ef4\uff0c\u90a3\u4e48Hard-SVM\u95ee\u9898\u53ef\u4ee5\u7b80\u5316\u6210 \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \u5982\u679c\u5b58\u5728\u4e00\u4e2a \\mathbf{w}_0 \\mathbf{w}_0 \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 , \u5e76\u4e14 \\Vert \\mathbf{x} \\Vert \\le R \\Vert \\mathbf{x} \\Vert \\le R \uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7\u7ecf\u9a8c\u8bef\u5dee\u6700\u5c0f\u5316\u6c42\u5f97\u7684 \\mathbf{w}_S \\mathbf{w}_S \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} \u4e0a\u9762\u8fd9\u4e2a\u754c\u8fd8\u9700\u8981\u77e5\u9053 \\mathbf{w}_0 \\mathbf{w}_0 , \u6700\u597d\u80fd\u77e5\u9053\u771f\u5b9e\u7684\u6700\u4f18\u5206\u7c7b\u5668 \\mathbf{w}^* \\mathbf{w}^* \u4f46\u662f\u8fd9\u4e9b\u90fd\u662f\u4e0d\u80fd\u5f97\u5230\u7684\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u65b0\u7684\u754c\u3002\u8fd9\u4e2a\u754c\u7528\u5230\u4e86\u7ed3\u6784\u98ce\u9669\u6700\u5c0f\u5316\u7684\u601d\u60f3\u3002 \u5bf9\u4e8e\u6b63\u6574\u6570i\uff0c\u6784\u9020 B_i = 2^8 B_i = 2^8 , \u4ee5\u53ca\u5bf9\u5e94\u5047\u8bbe\u96c6 \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} , \u5e76\u4e14 \\delta_i = \\frac{\\delta}{2 i^2} \\delta_i = \\frac{\\delta}{2 i^2} \u3002\u90a3\u4e48\uff0c\u6709 P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. \u90a3\u4e48\uff0c\u548c\u4e8b\u4ef6\u7684\u6982\u7387\u662f 1 - \\delta 1 - \\delta \u3002 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a \\mathbf{w} \\mathbf{w} \uff0c\u5b83\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u7f16\u53f7\u662f i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil , B_i\\le 2\\Vert \\mathbf{w} \\Vert B_i\\le 2\\Vert \\mathbf{w} \\Vert , \u5e76\u4e14 \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} , \u90a3\u4e48 L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}. L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}.","title":"Rademacher"},{"location":"ML/03-Rademacher/#rademacher","text":"","title":"Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#_1","text":"\u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 $(x, y) \\sim \\mathcal{D} $\u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u6211\u4eec\u4eba\u4e3a\u5730\u6784\u9020\u67d0\u4e2a\u7279\u5b9a\u6761\u4ef6\u5206\u5e03\u7684\u96c6\u5408(Hypothesis Set): \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H} = \\{P_{\\theta}(y \\vert x)\\} \uff0c\u8fd9\u4e9b\u6761\u4ef6\u5206\u5e03\u88ab \\theta \\theta \u53c2\u6570\u5316\u3002 \u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u76ee\u6807\u5c31\u662f\u6839\u636e\u6837\u672c\u4ece\u5019\u9009\u96c6\u4e2d\u9009\u62e9\u6700\u63a5\u8fd1\u771f\u5b9e\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u7684\u5206\u5e03 P_{\\theta}(y \\vert x) P_{\\theta}(y \\vert x) \u3002 \u8bb2\u5230\u8fd9\u91cc\u5c31\u592a\u62bd\u8c61\u4e86\uff0c\u5fc5\u987b\u8981\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u4e00\u4e0b\u4e86\u3002 \u4f8b\u5b501\uff1a\u4e00\u4e2a\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u4e2d\uff0c\u5047\u8bbe\u96c6\u662f\u67d0\u4e2a\u7a7a\u95f4\u8d85\u5e73\u9762\u7684\u96c6\u5408 \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} \\mathcal{H}_{\\theta} = \\{h_\\theta(x) = w^T_{\\theta} x + b_{\\theta}\\} , \u8fd9\u91cc\u7684\u6761\u4ef6\u5206\u5e03\u5bf9\u5e94\u7684\u662f P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 P_{\\theta}\\{y = h_\\theta(x) \\vert x\\} = 1 \u3002\u6211\u4eec\u53ef\u4ee5\u9009\u53d6\u67d0\u4e2a\u8861\u91cf\u4e24\u4e2a\u5206\u5e03\u5dee\u5f02\u7684\u8ddd\u79bb\u6765\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u6c42\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u7684\u6700\u5c0f\u503c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5728\u8fd9\u4e2a\u8ddd\u79bb\u4e0b\uff0c\u6700\u63a5\u8fd1\u771f\u5b9e\u6761\u4ef6\u5206\u5e03\u7684\u53c2\u6570\u5316\u6761\u4ef6\u5206\u5e03, \u5373\u4f18\u5316\u76ee\u6807\u4e3a\uff1a \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} \\mathbb{E}_{x \\sim P_{\\mathcal{D}}(x)} [ Dist(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \u8fd9\u91cc\u5982\u679c\u4f7f\u7528Wasserstein Distance, \u5e76\u4e14\u4f7f\u7528\u82b1\u8d39\u51fd\u6570 c(a, b) = \\Vert a - b\\Vert^2 c(a, b) = \\Vert a - b\\Vert^2 , \u90a3\u4e48\u5c31\u662f\u53ef\u4ee5\u5f97\u5230\u7ecf\u5178\u56de\u5f52\u95ee\u9898\u7684\u4f18\u5316\u76ee\u6807\uff1a \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \\min_{\\theta} \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\Vert h_{\\theta}(x) - y \\Vert^2]. \\tag{2} \u5982\u679c y \\in \\{0, 1\\} y \\in \\{0, 1\\} , \u4e5f\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u4f18\u5316\u76ee\u6807\u7b49\u4ef7\u4e8e0-1\u635f\u5931\uff1a \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [\\mathbb{1}_{h(x) \\ne y}] = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [y \\cdot h(x)]. \\tag{3} \u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u90fd\u662f\u56f4\u7ed50-1\u5206\u7c7b\u95ee\u9898\u800c\u8fdb\u884c\u7684\u3002\u975e\u5e38\u4e0d\u5e78\u7684\u662f\uff0c\u4e0a\u9762\u63d0\u5230\u7684\u771f\u5b9e\u635f\u5931\u51fd\u6570\u6211\u4eec\u90fd\u6ca1\u529e\u6cd5\u76f4\u63a5\u8fdb\u884c\u4f18\u5316\uff0c\u6211\u4eec\u80fd\u505a\u7684\u662f\u4f18\u5316\u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\uff1a \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \\min_{h \\in \\mathcal{H}} \\mathbb{E}_{(x, y) \\sim \\mathcal{S}} [\\mathbb{1}_{h(x) \\ne y}] = \\frac{1}{m} \\sum^{m}_{i=1} l^{0-1}(h(x), y), \\tag{4} \u5176\u4e2d l^{0-1}(h(x), y) = 1_{h(x) = y} l^{0-1}(h(x), y) = 1_{h(x) = y} . \u4e0a\u9762\u8fd9\u79cd\u4f18\u5316\u76ee\u6807\u6709\u4e00\u4e2a\u540d\u5b57\u53eb\u505a\u7ecf\u9a8c\u98ce\u9669\u6700\u5c0f\u5316(Empirical Risk Minimization, ERM)\uff0c(4)\u5f0f\u5bf9\u5e94\u7684\u6700\u4f18\u5206\u7c7b\u5668 h^* h^* \u53ef\u4ee5\u5199\u6210 ERM_{\\mathcal{H}}(S) ERM_{\\mathcal{H}}(S) \u3002","title":"\u524d\u7f6e\u77e5\u8bc6"},{"location":"ML/03-Rademacher/#representativeness","text":"\u9996\u5148\u5f15\u5165\u4e00\u4e2a\u8bc4\u4ef7\u6837\u672c\u7684\u6807\u51c6: \u5b9a\u4e491\uff1a \\mathcal{S} \\mathcal{S} \u88ab\u79f0\u4e3a \\epsilon-representative \\epsilon-representative \uff0c\u5982\u679c \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \\sup_{h \\in \\mathcal{H}} \\vert L_\\mathcal{D}(h) - L_{\\mathcal{S}}(h) \\vert \\le \\epsilon. \u5982\u679c \u6837\u672c S S \u662f \\epsilon-representative \\epsilon-representative \uff0c \u90a3\u4e48 \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) \\le L_{\\mathcal S}(ERM_{\\mathcal{H}}(S)) + \\epsilon \\\\ \\le L_S(h) + \\epsilon \\le L_{\\mathcal{D}}(h) + 2 \\epsilon, \u5373 L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon L_\\mathcal{D}(ERM_{\\mathcal{H}}(S)) \\le \\min_{h \\in \\mathcal{H}} L_{\\mathcal{D}}(h) + 2 \\epsilon \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u901a\u8fc7ERM\u6807\u51c6\u6c42\u5230\u7684\u5206\u7c7b\u5668\u662f\u80fd\u591f\u63a5\u8fd1\u6700\u4f18\u503c\u7684\uff0c\u5e76\u4e14 \\epsilon \\epsilon \u80fd\u591f\u4f53\u73b0\u4e24\u8005\u7684\u63a5\u8fd1\u7a0b\u5ea6\u3002\u5982\u679c \\epsilon \\epsilon \u8db3\u591f\u5c0f\uff0c\u90a3\u4e48 S S \u8db3\u4ee5\u4ee3\u8868\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u63a5\u4e0b\u6765\u540c\u6837\u662f\u7eaf\u6570\u5b66\u7684\u4e1c\u897f\u3002\u6211\u4eec\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff1a\u7ed9\u5b9a\u4efb\u610f\u4e00\u4e2a\u6837\u672c S S , \u6211\u4eec\u8981\u4f30\u8ba1\u5b83\u7684\u4ee3\u8868\u7a0b\u5ea6(representiveness)\u3002 \u4e3a\u4e86\u8ba8\u8bba\u65b9\u4fbf\uff0c\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u96c6\u5408: \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \\mathcal{F} = l \\circ \\mathcal{H} = \\{f_h(x, y) = l(h(x), y): h \\in \\mathcal{H}\\}, \\tag{5} \u8fd9\u6837\uff0c\u771f\u5b9e\u8bef\u5dee\u53ef\u5199\u6210 L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] L_\\mathcal{D}(f) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}} [ f(x, y)] \uff0c\u7ecf\u9a8c\u8bef\u5dee\u53ef\u4ee5\u5199\u6210 L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) L_S(f) = \\frac{1}{m} \\sum^{m}_{i=1} f(z_i) \u3002\u90a3\u4e48\u6837\u672c S S \u7684\u4ee3\u8868\u6027\u53ef\u4ee5\u91cd\u65b0\u5199\u6210 Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} Rep_{\\mathcal{D}}(\\mathcal{H}, S) = \\sup_{f \\in \\mathcal{F}} (L_{\\mathcal{D}}(f) - L_{S}(f)). \\tag{6} \u5176\u5b9e(6)\u5f0f\u53ea\u662f\u5b9a\u4e491\u6362\u4e86\u4e00\u79cd\u5199\u6cd5\uff0c\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u771f\u7684\u8ba1\u7b97\u5b83\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b83\u5bf9\u5e94\u5730\u7ecf\u9a8c\u516c\u5f0f\uff0c\u4ee5\u53ca\u7ecf\u9a8c\u516c\u5f0f\u548c(6)\u5f0f\u7684gap\u3002","title":"Representativeness"},{"location":"ML/03-Rademacher/#rademacher_1","text":"\u9996\u5148\u4ecb\u7ecd\u4e00\u4e2a\u76f4\u89c9\u4e0a\u7684\u7ecf\u9a8c\u4f30\u8ba1\uff1a\u5c06 S S \u5747\u5206\u6210\u4e24\u4e2a\u6837\u672c\u96c6 S_1 S_1 \u4e0e S_2 S_2 \u3002\u5747\u5206\u7684\u610f\u601d\u662f S S \u4e2d\u7684\u6837\u672c (x, y) (x, y) \u53ea\u4f1a\u51fa\u73b0\u5728 S_1 S_1 \u4e0e S_2 S_2 \u4e2d\u7684\u4e00\u4e2a, \u800c\u4e14\u4e00\u5b9a\u4f1a\u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u4e2a\u6837\u672c\u96c6\u4e2d\u3002 \u90a3\u4e48\uff0c S S \u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1\u662f\uff1a \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \\sup_{f \\in \\mathcal{F}} (L_{S_1}(f) - L_{S_2}(f)). \\tag{7} \u8fd9\u4e2a\u7ecf\u9a8c\u4f30\u8ba1\u5e76\u4e0d\u662f\u7b26\u5408\u6240\u6709\u4eba\u7684\u76f4\u89c9\u7684\uff0c\u6240\u4ee5\u4f60\u5982\u679c\u611f\u89c9\u83ab\u540d\u5176\u5999\uff0c\u4e5f\u4e0d\u8981\u614c\uff0c\u8ddf\u7740\u6211\u7ee7\u7eed\u3002 \u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u968f\u673a\u53d8\u91cf \\sigma \\in \\{-1, 1\\} \\sigma \\in \\{-1, 1\\} \uff0c\u5b83\u67090.5\u7684\u6982\u7387\u53d6 1 1 , \u67090.5\u7684\u6982\u7387\u53d6 -1 -1 \uff0c\u90a3\u4e48\u4e00\u4e2a\u66f4\u597d\u7684\u7ecf\u9a8c\u4f30\u8ba1\u53ef\u4ee5\u5199\u6210 R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} R(\\mathcal{F} \\circ S) = \\frac{1}{m} \\mathbb{E}_{\\sigma_i \\sim U(\\{-1, 1\\})} \\left[ \\sup_{f \\in \\mathcal{F}} \\sum^{m}_{i = 1} \\sigma_i f(z_i) \\right], \\tag{8} \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53eb\u505a Rademacher\u590d\u6742\u5ea6\u3002\u8fd9\u4e2a\u4f30\u8ba1\u6bd4(7)\u5f0f\u590d\u6742\u5f97\u591a\uff0c\u662f 2^m 2^m \u6307\u6570\u500d\uff0c\u8ba1\u7b97\u590d\u6742\u7684\u95ee\u9898\u6211\u4eec\u653e\u5230\u540e\u9762\u89e3\u51b3\u3002\u6211\u4eec\u5148\u6765\u89e3\u51b3\u4e00\u4e0b\u8fd9\u4e2aRademacher\u590d\u6742\u5ea6\u548c\u6837\u672c\u8868\u8fbe\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u5b9a\u74061\uff1a \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \\mathbb{E}_{S\\sim\\mathcal{D}^m} [Rep_{\\mathcal{D}}(\\mathcal{F}, S)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m}[R(\\mathcal{F} \\circ S)]. \u8bc1\u660e\u5f88\u5de7\u5999\uff0c\u4e66\u4e0a\u6709\u3002 \u6839\u636e\u5b9a\u74061\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u51e0\u4e2a\u5f15\u7406\uff1a \u9996\u5148 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(ERM_{\\mathcal{H}}(S))] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ; \u5176\u6b21 \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\mathbb{E}_{S\\sim\\mathcal{D}^m} [L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*)] \\le 2 \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) ,\u5176\u4e2d h^* = \\min L_{\\mathcal{D}}(h) h^* = \\min L_{\\mathcal{D}}(h) ; \u6700\u540e P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta P \\left\\{ L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_{S}(h^*) \\le \\frac{2}{\\delta} \\mathbb{E}_{S \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S) \\right\\} \\le \\delta \u3002(\u9a6c\u5c14\u53ef\u592b\u4e0d\u7b49\u5f0f) \u4e3a\u4e86\u63a5\u4e0b\u6765\u7684\u5206\u6790\uff0c\u9700\u8981\u5148\u4ecb\u7ecd\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff1aMcDiarmid's Inequality\u3002 \u5b9a\u74062\uff1a(McDiarmid's Inequality)\u3002 \u5982\u679c i \\in [1, m] i \\in [1, m] , \u5e76\u4e14 f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], f(x_1, \\ldots, x_m) - f(\\ldots, x_{i-1}, x'_i, x_{i+1},...) \\in [a_i, b_i], \u90a3\u4e48 P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\ge \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\{f - \\mathbb{E} f \\le \\epsilon\\} \\le exp\\left(\\frac{-2 \\epsilon^2}{\\sum^m_{i = 1}(a_i - b_i)^2}\\right), P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{f - \\mathbb{E} f \\le (b - a) \\sqrt{\\frac{m}{2} \\log(1/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le \\sqrt{\\frac{1}{2} \\sum^m_{i=1}(a_i - b_i)^2 \\log(2/\\delta)}\\right\\} \\ge 1 - \\delta, P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. P\\left\\{\\vert f - \\mathbb{E} f\\vert \\le (b - a) \\sqrt{\\frac{m}{2} \\sum^m_{i=1}\\log(2/\\delta)}\\right\\} \\ge 1 - \\delta. \u5b9a\u74063\uff1a(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \u5bf9\u4e8em\u4e2a\u968f\u673a\u53d8\u91cf X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] X_1 \\in [a_1, b_1], X_2 \\in [a_2, b_2], \\ldots, X_m \\in [a_m, b_m] , \u5b83\u4eec\u5747\u503c\u7684\u968f\u673a\u53d8\u91cf \\bar X \\bar X \u6ee1\u8db3 P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). P(\\bar X - \\mathbb{E}[\\bar X] \\ge \\epsilon) \\le exp\\left( -\\frac{2\\epsilon^2 m^2}{ \\sum^m_{i=1} (b_i - a_i)^2} \\right). \u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u4e0e\u6570\u636e\u76f4\u63a5\u6709\u5173\u7684\u8fb9\u754c\uff0c\u800c\u4e0d\u53ea\u662f\u671f\u671b\u3002 \u5b9a\u74064\uff1a(\u6570\u636e\u76f8\u5173\u754c)\u3002\u5982\u679c l(h(x), y) \\in [a, b] l(h(x), y) \\in [a, b] \uff0c\u90a3\u4e48 P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_{S}(h) \\le 2 \\mathbb{E}_{S' \\sim \\mathcal{D}^m} R(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2 \\ln(1/\\delta) / m}\\}. P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(h) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 3(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta P_{S\\sim\\mathcal{D}^m} \\left\\{\\forall h \\in \\mathcal{H}, L_{\\mathcal{D}}(ERM_{\\mathcal{H}}(S)) - L_S(h) \\le 2 R(l \\circ \\mathcal{H} \\circ S) + 4(b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta \u8bc1\u660e\uff1a \u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u5f0f\uff0c\u76f4\u63a5\u4f7f\u7528McDiarmid's Inequality, \u6ce8\u610f\u5bf9\u5e94\u7684\u4e0d\u662f l(h(x), y) l(h(x), y) \u7684\u754c\u800c\u662f\u662f [(a - b)/m, (b - a)/m] [(a - b)/m, (b - a)/m] \uff1b \u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u5f0f\uff0c \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \\begin{cases} P_{S \\sim \\mathcal{D}^m} \\left\\{Rep_{\\mathcal{D}}(\\mathcal{F}, S) \\le \\mathbb{E}_{S'} Rep_{\\mathcal{D}}(l \\circ \\mathcal{H} \\circ S') + (b - a) \\sqrt{2\\ln(2/\\delta)/m}\\right\\} \\ge 1 - \\delta/2;\\\\ \\mathbb{E}_{S \\sim \\mathcal{D}^m} Rep_\\mathcal{D} (\\mathcal{F}, S) \\le 2 \\mathbb{E}_{s' \\sim \\mathcal{D}^m}R(l \\circ \\mathcal{H} \\circ S'); \\\\ P_{S \\sim \\mathcal{D}^m} \\left\\{E_{S'} R(l \\circ \\mathcal{H} \\circ S' \\le R(l \\circ \\mathcal{H} \\circ S) + (b - a) \\sqrt{2 \\ln(2/\\delta) / m}\\right\\} \\ge 1 - \\delta/2; \\end{cases} \u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u4e0d\u7b49\u5f0f, \u9996\u5148\u5b9a\u4e49 h_S = ERM_{\\mathcal{H}}(S) h_S = ERM_{\\mathcal{H}}(S) \uff0c \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \\begin{cases} \\forall h \\in \\mathcal{H}, L_\\mathcal{D}(h_S) - L_{\\mathcal{D}}(h) \\le L_\\mathcal{D}(h_S) - L_{S}(h_S) + L_S(h) - L_\\mathcal{D}(h);\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h_S) - L_S(h_S) \\le 2R(l\\circ \\mathcal{H} \\circ S) + 3(b-a) \\sqrt{2\\ln(3/\\delta)/m}\\right\\} \\ge 1 - 2\\delta/3;\\\\ P_{S\\sim\\mathcal{D}^m}\\left\\{L_{\\mathcal{D}}(h) - L_S(h) \\le (b-a) \\sqrt{\\ln(3/\\delta)/(2m)}\\right\\} \\ge 1 - 1\\delta/3;(\u970d\u592b\u542c\u4e0d\u7b49\u5f0f) \\end{cases} \u8fd9\u4e09\u4e2a\u4e0d\u7b49\u5f0f\u5c42\u5c42\u9012\u8fdb\uff0c\u5176\u4e2d\u7b2c\u4e09\u4e2a\u7b49\u5f0f\u662f\u6211\u4eec\u6700\u60f3\u5f97\u5230\u7684\u7ed3\u679c\u3002","title":"\u6837\u672c\u96c6\u4ee3\u8868\u6027\u7684\u7ecf\u9a8c\u4f30\u8ba1: Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#rademacher_2","text":"\u5bf9\u4e8eRademacher\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u62bd\u8c61\u7684\u8ba4\u4e3a\u662f\u8861\u91cf\u4e00\u4e2a\u5411\u91cf\u96c6\u5408\u7684\u590d\u6742\u5ea6\u7684\uff1a A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} A \\subset \\mathbb{R}^m, R(A) = \\frac{1}{m} \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\pmb{a} \\in A} \\sum^m_{i=1} \\sigma_i a_i \\right). \\tag{9} \u5f15\u74061\uff1a\u5bf9\u4e8e\u96c6\u5408 A A , \u5e38\u6570 c c \u548c \u67d0\u4e2a\u5411\u91cf \\mathbf{a}_0 \\mathbf{a}_0 \uff0c\u90a3\u4e48 R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). R(\\{c \\mathbf{a} + \\mathbf{a}_0:\\mathbf{a} \\in A\\}) = \\vert c \\vert R(A). \u5f15\u74062\uff1a\u5bf9\u4e8e\u96c6\u5408A\uff0c\u5bf9\u5e94\u7684\u4e00\u4e2a\u96c6\u5408 A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} A' = \\{\\sum^{N}_{j=1} \\alpha_i \\mathbf{a}^{(j)}: N \\in \\mathbb{N}, \\forall j, \\mathbf{a}^{(j)} \\in A, \\alpha_j \\ge 0, \\Vert \\mathbf{\\alpha} \\Vert_1 = 1\\} , \u90a3\u4e48 R(A') = R(A) R(A') = R(A) \u3002 \u5f15\u74063\uff1a(Massart Lemma). \u5982\u679c A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} A = \\{\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_n : \\mathbf{a} \\in \\mathbb{R}^m\\} \uff0c\u5b9a\u4e49 \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i \\bar{\\mathbf{a}} = \\frac{1}{n} \\sum^{n}_{i=1} \\mathbf{a}_i , \u90a3\u4e48 R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. R(A) \\le \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a} - \\bar{\\mathbf{a}}\\Vert_2 \\frac{\\sqrt{2\\ln(n)}}{m}. \u8bc1\u660e\uff1a\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe \\bar{\\mathbf{a}} = 0 \\bar{\\mathbf{a}} = 0 , \u5e76\u4e14 A' = \\lambda A(\\lambda > 0) A' = \\lambda A(\\lambda > 0) , \u90a3\u4e48 \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \\begin{align*} &m R(A') = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\max_{\\mathbf{a} \\in A'} \\mathbf{\\sigma}^T \\mathbf{a} \\right] = \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\max_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ \\le& \\mathbb{E}_{\\pmb{\\sigma}} \\left[ \\ln \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right] \\le \\ln\\left[ \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sum_{\\mathbf{a} \\in A'} e^{\\pmb{\\sigma}^T \\mathbf{a}} \\right) \\right]\\\\ =& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\mathbb{E}_{\\sigma_i}e^{\\sigma_i a_i} = \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} \\frac{1}{2}(e^{a_i} + e^{-a_i}) \\\\ \\le& \\ln \\sum_{\\mathbf{a} \\in A'} \\prod^{m}_{i=1} e^{a^2_i/2} = \\ln \\sum_{\\mathcal{a} \\in A'} e^{\\Vert \\mathbf{a}\\Vert^2/2} \\le \\ln \\left( n \\max_{\\mathbf{a} \\in A'}e^{\\Vert \\mathbf{a}\\Vert^2/2} \\right)\\\\ =& \\ln n + \\max_{\\mathbf{a} \\in A'} {\\Vert \\mathbf{a}\\Vert^2/2} \\end{align*} \u53c8\u56e0\u4e3a R(A') = \\lambda R(A) R(A') = \\lambda R(A) , \u6240\u4ee5 mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. mR(A) \\le \\frac{1}{\\lambda} \\left( \\ln n + \\max_{\\mathbf{a} \\in A} {\\Vert \\lambda\\mathbf{a}\\Vert^2/2} \\right) \\le \\sqrt{2 \\ln n \\cdot \\max_{\\mathbf{a} \\in A} \\Vert \\mathbf{a}\\Vert^2}. \u5f15\u74064\uff1a\u6536\u7f29\u6027\u3002 \u4ee4 \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) \\phi(\\mathbf{a}) = (\\phi_1(a_1), \\phi_2(a_2), \\ldots, \\phi_m(a_m)) , \u5e76\u4e14 \\phi_i \\phi_i \u90fd\u662f \\rho \\rho -Lipshcitz \u8fde\u7eed\u51fd\u6570\uff0c\u90a3\u4e48 R(\\phi\\circ A) \\le \\rho R(A) R(\\phi\\circ A) \\le \\rho R(A) .","title":"\u8ba1\u7b97Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#rademacher_3","text":"\u4f8b2\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \\mathcal{H}_2 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_2 \\le 1\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} R(\\mathcal{H}_2 \\circ S) \\le \\frac{\\sqrt{ \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}}{m}\\le\\max_i \\frac{\\Vert \\mathbf{x_i} \\Vert_2}{\\sqrt{m}} \u8bc1\u660e\uff1a \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \\begin{align*} &m R(\\mathcal{H} \\circ S) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\sup_{\\mathbf{w}, \\Vert \\mathbf{w} \\Vert_2 \\le 1} \\sum^{m}_{i=1} \\sigma_i \\mathbf{w}^T \\mathbf{x}_i\\right) \\\\ =& \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_2 \\right) \\le \\left( \\mathbb{E}_{\\pmb{\\sigma}} \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert^2_2 \\right)^{1/2} \\\\ =& \\left( \\sum_{i \\ne j} \\mathbb{E}[\\sigma_i \\sigma_j] \\mathbf{x}^T_i \\mathbf{x}_j + \\sum_{i} \\mathbb{\\mathbf{\\sigma}^2_i}\\Vert \\mathbf{x}_i \\Vert^2_2 \\right)^{1/2} \\\\ =& \\sqrt{\\sum^m_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2}. \\end{align*} \u4f8b3\uff1a\u5047\u8bbe\u96c6 \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \\mathcal{H}_1 = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}:\\Vert \\mathbf{w} \\Vert_1 \\le 1, \\mathbf{x} \\in \\mathbb{R}^n\\} \u7684Rademacher\u590d\u6742\u5ea6\u6ee1\u8db3 R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. R(\\mathcal{H}_1 \\circ S) \\le \\max_i \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{2 \\ln(2n)}{m}. \u8fd9\u4e2a\u8bc1\u660e\u6709\u70b9\u5de7\u5999\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u6709\u70b9\u7ed5\uff0c\u5927\u5bb6\u5c0f\u5fc3\u4e86\u3002 \u8bc1\u660e\uff1a \u9996\u5148\u6784\u9020\u96c6\u5408 V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} V = \\{\\mathbf{v}_1, \\mathbf{v}_2, \\ldots, \\mathbf{v}_n, -\\mathbf{v}_1, -\\mathbf{v}_2, \\ldots, -\\mathbf{v}_n: \\mathbf{v}_i = (x_{1,i}, x_{2, i}, \\ldots, x_{m, i}) \\in \\mathbb{R}^m\\} . \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*} \\begin{align*} &R(\\mathcal{H}_1\\circ S) \\le \\mathbb{E}_{\\pmb{\\sigma}} \\left( \\big\\Vert \\sum^m_{i=1} \\sigma_i \\mathbf{x}_i \\big\\Vert_\\infty \\right)\\\\ =& \\mathbb{E}_{\\pmb{\\sigma}}\\left( \\sup_j \\vert \\mathbf{v}^T_j \\sigma \\vert \\right) = m R(V)\\\\ \\le& m \\max_j \\Vert \\mathbf{v}_j \\Vert_2 \\frac{\\sqrt{2\\ln(2n)}}{m}\\\\ \\le& m \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\frac{\\sqrt {2\\ln(2n)}}{m}\\\\ =& \\max_{i} \\Vert \\mathbf{x}_i \\Vert_\\infty \\sqrt\\frac{ {2\\ln(2n)}}{m}\\\\ \\end{align*}","title":"\u7ebf\u6027\u5047\u8bbe\u96c6\u7684Rademacher\u590d\u6742\u5ea6"},{"location":"ML/03-Rademacher/#svm","text":"\u5b9a\u74065\uff1a\u5bf9\u4e8eSVM\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u6211\u4eec\u589e\u52a0\u9650\u5b9a \\Vert \\mathbf{x} \\Vert_2 \\le R \\Vert \\mathbf{x} \\Vert_2 \\le R \u4ee5\u53ca\u5047\u8bbe\u96c6\u7684\u9650\u5b9a \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} \\mathcal{H} = \\{\\mathbf{w}: \\Vert\\mathbf{w}\\Vert \\le B\\} , \u6837\u672c\u70b9\u635f\u5931\u51fd\u6570 l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} l:\\mathcal{H} \\times Z \\rightarrow \\mathbb{R} , l(a, y) l(a, y) \u5173\u4e8ea\u662f \\rho \\rho -Lipschitz\u8fde\u7eed\uff0c\u5e76\u4e14 l(a, y)\\in[0, c] l(a, y)\\in[0, c] , \u90a3\u4e48 P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. P\\left\\{\\forall \\mathbf{w} \\in \\mathcal{H}, L_\\mathcal{D}(\\mathbf{w}) \\le L_{S}(\\mathcal{w}) + \\frac{2 \\rho BR}{\\sqrt{m}} + c \\sqrt\\frac{2 \\ln(1 / \\delta)}{m} \\right\\} \\ge 1 - \\delta. \u8bc1\u660e\uff1a \u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} R(l \\circ \\mathcal{H}) \\le \\rho BR/\\sqrt{m} \u3002\u524d\u9762\u7684\u6bd4\u4f8b\u4e0d\u53d8\u6027\u3001\u4f8b\u5b502\u8bc1\u660e\u4e86\u8fd9\u4e9b\u4e8b\u60c5\u3002 \u53ef\u4ee5\u5c06 \\mathbf{x} \\mathbf{x} \u7ef4\u5ea6\u589e\u52a0\u4e00\u7ef4\uff0c\u90a3\u4e48Hard-SVM\u95ee\u9898\u53ef\u4ee5\u7b80\u5316\u6210 \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \\arg\\min_{\\mathbf{w}} \\Vert\\mathbf{w}\\Vert^2_2, \\quad s.t. \\quad \\forall i, y_i \\left\\langle \\mathbf{w}, \\mathbf{x}_i \\right\\rangle \\ge 1. \u5982\u679c\u5b58\u5728\u4e00\u4e2a \\mathbf{w}_0 \\mathbf{w}_0 \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\{y \\left\\langle \\mathbf{w}_0, \\mathbf{x} \\right\\rangle \\ge 1\\} = 1 , \u5e76\u4e14 \\Vert \\mathbf{x} \\Vert \\le R \\Vert \\mathbf{x} \\Vert \\le R \uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7\u7ecf\u9a8c\u8bef\u5dee\u6700\u5c0f\u5316\u6c42\u5f97\u7684 \\mathbf{w}_S \\mathbf{w}_S \u6ee1\u8db3 P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [y \\ne sign(\\mathbf{w}_S^T \\mathbf{x})] \\le P_{(\\mathbf{x}, y) \\sim \\mathcal{D}} [l^{ramp}(\\mathbf{w}^T_S \\mathbf{x}, y)]\\\\ \\le \\frac{2R\\Vert \\mathbf{w}_0 \\Vert_2}{\\sqrt{m}} + (1 + R\\Vert\\mathbf{w}_0\\Vert_2) \\sqrt{\\frac{2\\ln(1/\\delta)}{m}}. \\tag{10} \u4e0a\u9762\u8fd9\u4e2a\u754c\u8fd8\u9700\u8981\u77e5\u9053 \\mathbf{w}_0 \\mathbf{w}_0 , \u6700\u597d\u80fd\u77e5\u9053\u771f\u5b9e\u7684\u6700\u4f18\u5206\u7c7b\u5668 \\mathbf{w}^* \\mathbf{w}^* \u4f46\u662f\u8fd9\u4e9b\u90fd\u662f\u4e0d\u80fd\u5f97\u5230\u7684\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u65b0\u7684\u754c\u3002\u8fd9\u4e2a\u754c\u7528\u5230\u4e86\u7ed3\u6784\u98ce\u9669\u6700\u5c0f\u5316\u7684\u601d\u60f3\u3002 \u5bf9\u4e8e\u6b63\u6574\u6570i\uff0c\u6784\u9020 B_i = 2^8 B_i = 2^8 , \u4ee5\u53ca\u5bf9\u5e94\u5047\u8bbe\u96c6 \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} \\mathcal{H}_i = \\{\\mathbf{w}: \\Vert \\mathbf{w} \\Vert \\le B_i\\} , \u5e76\u4e14 \\delta_i = \\frac{\\delta}{2 i^2} \\delta_i = \\frac{\\delta}{2 i^2} \u3002\u90a3\u4e48\uff0c\u6709 P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. P \\left\\{\\forall \\mathbf{w}\\in \\mathcal{H}_i, L_ \\mathcal{D}( \\mathbf{w}) \\le L_S( \\mathbf{w}) + \\frac{2 B_i R}{\\sqrt{m}} + \\sqrt\\frac{2 \\ln(2 /\\delta_i)}{m}\\right\\} \\ge 1 - \\delta_i. \u90a3\u4e48\uff0c\u548c\u4e8b\u4ef6\u7684\u6982\u7387\u662f 1 - \\delta 1 - \\delta \u3002 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a \\mathbf{w} \\mathbf{w} \uff0c\u5b83\u5bf9\u5e94\u7684\u5047\u8bbe\u96c6\u7f16\u53f7\u662f i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil i = \\lceil \\log_2(\\Vert \\mathbf{w} \\Vert)\\rceil , B_i\\le 2\\Vert \\mathbf{w} \\Vert B_i\\le 2\\Vert \\mathbf{w} \\Vert , \u5e76\u4e14 \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} \\frac{2}{\\delta_i} = \\frac{(2i)^2}{\\delta} \\le \\frac{(4 \\log_2(\\Vert \\mathbf{w} \\Vert))^2}{\\delta} , \u90a3\u4e48 L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}. L_\\mathcal{D}(\\mathbf{w}) \\le L_S(\\mathbf{w}) + \\frac{4 \\Vert \\mathbf{w} \\Vert R}{\\sqrt{m}} + \\sqrt\\frac{4[\\ln(4\\log_2(\\Vert \\mathbf{w} \\Vert)) + \\ln(1 / \\delta)]}{m}.","title":"SVM\u7b97\u6cd5\u7684\u754c"},{"location":"ML/04-Regression/","text":"\u7ebf\u6027\u56de\u5f52\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 (x, y) \\sim \\mathcal{D} (x, y) \\sim \\mathcal{D} \u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u5982\u679c y \\in \\mathbb{R} y \\in \\mathbb{R} , \u90a3\u4e48\u6c42\u89e3 P_\\mathcal{D}(y\\vert x) P_\\mathcal{D}(y\\vert x) \u7684\u95ee\u9898\u4e5f\u53eb\u505a\u56de\u5f52\u95ee\u9898\u3002 \u901a\u5e38\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} , \u6211\u4eec\u4ece\u5047\u8bbe\u96c6\u4e2d\u9009\u4e00\u4e2a\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u96c6\u5408 P_{\\theta^*}(y \\vert x) P_{\\theta^*}(y \\vert x) \u3002\u5bf9\u5e94\u7684\u4f18\u5316\u76ee\u6807\u662f \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \u786e\u5b9a\u6027\u7684\u7ebf\u6027\u56de\u5f52 \u00b6 \u6211\u4eec\u53ef\u4ee5\u7b80\u5316\u8fd9\u4e2a\u95ee\u9898\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u503c\u540e\uff0c\u7ed9\u5b9a\u4e00\u4e2a x x , \u6211\u4eec\u901a\u5e38\u9884\u6d4b y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u9700\u8981\u6c42\u89e3\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u6761\u4ef6\u5206\u5e03\uff0c\u6211\u4eec\u53ef\u4ee5\u8f6c\u800c\u6c42\u89e3\u5206\u5e03\u6ee1\u8db3 \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u66f4\u6fc0\u8fdb\u7684\u5019\u9009\u96c6\u6765\u7b80\u5316\u95ee\u9898: \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \u6211\u4eec\u4f7f\u7528Wasserstein\u8ddd\u79bb(\u8f93\u8fd0\u82b1\u8d39\u51fd\u6570\u4e3a c(a, b) c(a, b) )\uff0c\u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \u5982\u679c c(a, b) = \\Vert a - b \\Vert^2_2 c(a, b) = \\Vert a - b \\Vert^2_2 , \u90a3\u4e48\u5c31\u662f\u5927\u5bb6\u719f\u77e5\u7684\u5e73\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} \u6ce8\u610f\uff1a\u6211\u6ca1\u6709\u63d0\u5230\u9ad8\u65af\u5206\u5e03\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u63d0\u5230\u9ad8\u65af\u5206\u5e03\u7684\u5047\u8bbe\u3002 \u968f\u673a\u6027\u7684\u7ebf\u6027\u56de\u5f52 \u00b6 \u5982\u679c\u6211\u4eec\u5e0c\u671b\u4e0d\u8981\u90a3\u4e48\u6fc0\u8fdb\uff0c\u90a3\u4e48\u53ef\u4ee5\u6784\u9020\u5176\u4ed6\u5047\u8bbe\u96c6, \u4f8b\u5982\uff1a \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \u8fd9\u4e2a\u96c6\u5408\u600e\u4e48\u6765\u7684\u5462\uff1f\u5176\u5b9e\u548c\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u6709\u5173\u7cfb\u3002\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u5c31\u662f\u7ed9\u53c2\u6570 \\mathbf{w} \\mathbf{w} (b\u88ab\u5305\u542b\u5728 \\mathbf{w} \\mathbf{w} \u4e2d)\u6dfb\u52a0\u4e00\u4e2a\u5148\u9a8c\u5206\u5e03\uff0c\u901a\u5e38\u7ed9 \\mathbf{w} \\mathbf{w} \u5148\u9a8c\u5206\u5e03\u4e3a\u67d0\u4e2a\u53c2\u6570\u5316\u7684\u9ad8\u65af\u5206\u5e03 \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \uff0c\u5373\u5047\u8bbe\u96c6\u4e3a \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \u90a3\u4e48\uff0c \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} , \u5e76\u4e14 Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} \u3002 \u8fd9\u65f6\uff0c\u635f\u5931\u51fd\u6570\u662f\u6709\u70b9\u9ebb\u70e6\u4e86: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ec0\u4e48\u8ddd\u79bb\u51fd\u6570\u53ef\u4ee5\u6c42\u5462\uff1f\u90a3\u5c31\u662fKullback-Leibler\u8ddd\u79bb\uff1a L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} \u6211\u4eec\u7565\u53bb\u4e0e \\theta \\theta \u65e0\u5173\u7684\u9879\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u7b80\u5316\u8fc7\u7684\u635f\u5931\u51fd\u6570\u5c31\u662f\u4ea4\u53c9\u71b5\uff1a L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} \u5e26\u5165\u9ad8\u65af\u5206\u5e03\u7684\u6982\u7387\u5bc6\u5ea6\u516c\u5f0f\u53ef\u5f97\uff1a \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \u7ecf\u9a8c\u516c\u5f0f\u4e5f\u53ef\u4ee5\u5199\u6210 L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. \u6c42\u89e3\uff1a \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*} \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*} \u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52 \u00b6 \u6211\u4eec\u5728\u8d1d\u53f6\u65af\u56de\u5f52\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u505a\u4ec0\u4e48\uff1f \u4ee4 \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T \u3002 p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) p(\\hat{\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) p(\\hat{\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) \u5176\u4e2d \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \uff0c \u5e76\u4e14 \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \u3002 \u8fd9\u4e00\u5957\u4e1c\u897f\u5e76\u6ca1\u6709\u51fa\u73b0\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u8fd9\u91cc\u5047\u8bbe p_{\\mathcal{D}}({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\pmb{\\Sigma}_1), p_{\\mathcal{D}}({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\pmb{\\Sigma}_1), \u90a3\u4e48\u5728 p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) \u4e2d\uff0c \u5176\u4e2d \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\pmb{\\Sigma}_1\\mathbf{X}^T)^{-1} \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\pmb{\\Sigma}_1\\mathbf{X}^T)^{-1} \uff0c \u5e76\u4e14 \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X} \\pmb{\\Sigma}_1^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X} \\pmb{\\Sigma}_1^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \u3002 \u8fd9\u4e2a\u5047\u8bbe\u8ba9\u6211\u5f88\u4e0d\u8212\u670d\uff0c\u548c\u524d\u9762\u7684\u8ba8\u8bba\u5e76\u4e0d\u7edf\u4e00\u3002","title":"Regression"},{"location":"ML/04-Regression/#_1","text":"","title":"\u7ebf\u6027\u56de\u5f52\u95ee\u9898"},{"location":"ML/04-Regression/#_2","text":"\u5728\u5b9e\u9645\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u80fd\u83b7\u5f97\u4e00\u7cfb\u5217\u7684\u6837\u672c \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \\mathcal{S} = \\left\\{ (x_1, y_1), (x_2, y_2), \\dots, (x_m, y_m) \\right\\} \u3002\u5176\u4e2d \u6837\u672c\u5c5e\u4e8e\u67d0\u4e2a\u96c6\u5408 z = (x, y) \\in Z = X \\times Y z = (x, y) \\in Z = X \\times Y , \u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e9b\u6837\u672c\u662f\u670d\u4ece\u67d0\u4e2a\u672a\u77e5\u7684\u8054\u5408\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c\u5373 (x, y) \\sim \\mathcal{D} (x, y) \\sim \\mathcal{D} \u3002 \u4e0e\u4e4b\u76f8\u5173\u7684\u672a\u77e5\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert x) P_{\\mathcal{D}}(y \\vert x) \u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u7684\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 x x \u7684\u503c\uff0c\u6211\u4eec\u5c31\u80fd\u77e5\u9053 y y \u7684\u503c\u6700\u53ef\u80fd\u662f\u591a\u5c11\u3002 \u5982\u679c y \\in \\mathbb{R} y \\in \\mathbb{R} , \u90a3\u4e48\u6c42\u89e3 P_\\mathcal{D}(y\\vert x) P_\\mathcal{D}(y\\vert x) \u7684\u95ee\u9898\u4e5f\u53eb\u505a\u56de\u5f52\u95ee\u9898\u3002 \u901a\u5e38\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u5047\u8bbe\u96c6 \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} \\mathcal{H}_{\\theta} = \\{P_{\\theta}(y \\vert x)\\} , \u6211\u4eec\u4ece\u5047\u8bbe\u96c6\u4e2d\u9009\u4e00\u4e2a\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u96c6\u5408 P_{\\theta^*}(y \\vert x) P_{\\theta^*}(y \\vert x) \u3002\u5bf9\u5e94\u7684\u4f18\u5316\u76ee\u6807\u662f \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1} \\min_{\\theta} L_{\\mathcal{D}}(P_{\\theta}) = \\mathbb{E}_{ P_{\\mathcal{D}}(x)} [Distance(P_{\\mathcal{D}}(\\cdot \\vert x) \\Vert P_{\\theta}(\\cdot \\vert x))]. \\tag{1}","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"ML/04-Regression/#_3","text":"\u6211\u4eec\u53ef\u4ee5\u7b80\u5316\u8fd9\u4e2a\u95ee\u9898\uff1a\u5f53\u6211\u4eec\u77e5\u9053\u4e86 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u503c\u540e\uff0c\u7ed9\u5b9a\u4e00\u4e2a x x , \u6211\u4eec\u901a\u5e38\u9884\u6d4b y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) y \\in \\arg\\max_{y} P_{\\mathcal{D}}(y \\vert x) \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u9700\u8981\u6c42\u89e3\u6700\u63a5\u8fd1 P_\\mathcal{D}(y \\vert x) P_\\mathcal{D}(y \\vert x) \u7684\u6761\u4ef6\u5206\u5e03\uff0c\u6211\u4eec\u53ef\u4ee5\u8f6c\u800c\u6c42\u89e3\u5206\u5e03\u6ee1\u8db3 \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \\arg\\max_{y} P_{\\theta}(y \\vert x) \\subset \\arg\\max_y P_{\\mathcal{D}}(y \\vert x) \u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u66f4\u6fc0\u8fdb\u7684\u5019\u9009\u96c6\u6765\u7b80\u5316\u95ee\u9898: \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \\mathcal{H}_\\theta = \\{P_{\\theta}(y \\vert \\mathbf{x}) = \\mathbf{1}_{\\{y = h_{\\theta}(\\mathbf{x})\\}}, h_\\theta(\\mathbf{x}) = \\mathbf{w}^T_{\\theta} \\mathbf{x} + b_\\theta\\}. \\tag{2} \u6211\u4eec\u4f7f\u7528Wasserstein\u8ddd\u79bb(\u8f93\u8fd0\u82b1\u8d39\u51fd\u6570\u4e3a c(a, b) c(a, b) )\uff0c\u90a3\u4e48\u4f18\u5316\u76ee\u6807\u5c31\u53d8\u6210\u4e86 \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \\min_{\\theta} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[c(h_{\\theta}(\\mathbf{x}), y)]. \\tag{3} \u5982\u679c c(a, b) = \\Vert a - b \\Vert^2_2 c(a, b) = \\Vert a - b \\Vert^2_2 , \u90a3\u4e48\u5c31\u662f\u5927\u5bb6\u719f\u77e5\u7684\u5e73\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{(x, y) \\sim \\mathcal{D}}[\\Vert h_{\\theta}(\\mathbf{x}) - y \\Vert^2_2]. \\tag{4} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} L_{S}(\\theta) = \\frac{1}{m} \\sum^{m}_{i = 1} \\Vert h_{\\theta}(\\mathbf{x}_i) - y_i \\Vert^2_2. \\tag{5} \u6ce8\u610f\uff1a\u6211\u6ca1\u6709\u63d0\u5230\u9ad8\u65af\u5206\u5e03\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u63d0\u5230\u9ad8\u65af\u5206\u5e03\u7684\u5047\u8bbe\u3002","title":"\u786e\u5b9a\u6027\u7684\u7ebf\u6027\u56de\u5f52"},{"location":"ML/04-Regression/#_4","text":"\u5982\u679c\u6211\u4eec\u5e0c\u671b\u4e0d\u8981\u90a3\u4e48\u6fc0\u8fdb\uff0c\u90a3\u4e48\u53ef\u4ee5\u6784\u9020\u5176\u4ed6\u5047\u8bbe\u96c6, \u4f8b\u5982\uff1a \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \\mathcal{H}_{\\theta} = \\{p_{\\theta}(y \\vert \\mathbf{x}) \\sim \\mathcal{N}(\\pmb{\\mu}^T_{\\theta} \\mathbf{x}, \\mathbf{x}^T\\pmb{\\Sigma}_{\\theta}\\mathbf{x})\\}. \\tag{6} \u8fd9\u4e2a\u96c6\u5408\u600e\u4e48\u6765\u7684\u5462\uff1f\u5176\u5b9e\u548c\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u6709\u5173\u7cfb\u3002\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u5c31\u662f\u7ed9\u53c2\u6570 \\mathbf{w} \\mathbf{w} (b\u88ab\u5305\u542b\u5728 \\mathbf{w} \\mathbf{w} \u4e2d)\u6dfb\u52a0\u4e00\u4e2a\u5148\u9a8c\u5206\u5e03\uff0c\u901a\u5e38\u7ed9 \\mathbf{w} \\mathbf{w} \u5148\u9a8c\u5206\u5e03\u4e3a\u67d0\u4e2a\u53c2\u6570\u5316\u7684\u9ad8\u65af\u5206\u5e03 \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \\mathcal{N}(\\pmb{\\mu}_\\theta, \\pmb{\\Sigma}_{\\theta}) \uff0c\u5373\u5047\u8bbe\u96c6\u4e3a \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \\mathcal{H}_{\\theta} = \\{h(\\mathbf{x}) = \\mathbf{w}^T \\mathbf{x}, \\mathbf{w} \\sim \\mathcal{N}(\\pmb{\\mu}_{\\theta}, \\pmb{\\Sigma}_{\\theta})\\}.\\tag{7} \u90a3\u4e48\uff0c \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} \\mathbb{E}_{\\mathbf{w}}[h(\\mathbf{x})] = \\mathbf{w}^T \\pmb{\\mu}_{\\theta} , \u5e76\u4e14 Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} Var_{\\mathbf{w}}(h(\\mathbf{x})) = \\mathbf{x}^T \\pmb{\\Sigma_{\\theta}} \\mathbf{x} \u3002 \u8fd9\u65f6\uff0c\u635f\u5931\u51fd\u6570\u662f\u6709\u70b9\u9ebb\u70e6\u4e86: L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}[Distance(p_{\\mathcal{D}}(\\cdot \\vert \\mathbf{x})\\Vert p_{\\theta}(\\cdot \\Vert \\mathbf{x}))]. \\tag{8} \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ec0\u4e48\u8ddd\u79bb\u51fd\u6570\u53ef\u4ee5\u6c42\u5462\uff1f\u90a3\u5c31\u662fKullback-Leibler\u8ddd\u79bb\uff1a L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} L_{\\mathcal{D}}(\\theta) = \\mathbb{E}_{p_{\\mathcal{D}}(\\mathbf{x})}\\mathbb{E}_{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}\\left[\\ln\\frac{p_{\\mathcal{D}}(y \\vert \\mathbf{x})}{p_{\\theta}(y \\vert \\mathbf{x})}\\right], \\tag{9} \u6211\u4eec\u7565\u53bb\u4e0e \\theta \\theta \u65e0\u5173\u7684\u9879\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u7b80\u5316\u8fc7\u7684\u635f\u5931\u51fd\u6570\u5c31\u662f\u4ea4\u53c9\u71b5\uff1a L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} L_{\\mathcal{D}}(\\theta) = -\\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathcal{D}}\\left[\\ln {p_{\\theta}(y \\vert \\mathbf{x})}\\right]. \\tag{9} \u5bf9\u4e8e\u6837\u672c\u96c6 S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} S = \\{(\\mathbf{x}_1, y_1), (\\mathbf{x}_2, y_2), \\ldots, (\\mathbf{x}_m, y_m)\\} , \u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} L_{S}(\\theta) = - \\sum^{m}_{i=1} \\ln p_{\\theta}(y_i \\vert \\mathbf{x}_i), \\tag{10} \u5e26\u5165\u9ad8\u65af\u5206\u5e03\u7684\u6982\u7387\u5bc6\u5ea6\u516c\u5f0f\u53ef\u5f97\uff1a \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \\begin{align*} &L_{S}(\\theta) = -\\sum^{m}_{i=1} \\ln\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma_i} \\exp\\left\\{-\\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2\\right\\}\\right)\\\\ =& \\sum^{m}_{i=1} \\ln \\sigma_i + \\frac{1}{2\\sigma_i^2} (y_i - \\bar{y}_i)^2 + const \\\\ =& \\sum^{m}_{i=1}\\left[ \\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu}_{\\theta})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma}_{\\theta} \\mathbf{x}_i}\\right] + const. \\end{align*} \u7ecf\u9a8c\u516c\u5f0f\u4e5f\u53ef\u4ee5\u5199\u6210 L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^{m}_{i=1} \\left[\\frac{1}{2}\\ln(\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i) + \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})^2}{2\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i}\\right]. \u6c42\u89e3\uff1a \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*} \\begin{align*} &\\nabla_{\\pmb{\\mu}} L_S(\\pmb{\\mu}, \\pmb{\\Sigma}) = \\sum^m_{i=1} \\frac{(y_i - \\mathbf{x}^T_i \\pmb{\\mu})\\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma} \\mathbf{x}_i} \\\\ \\Rightarrow& \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} = \\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i} \\pmb{\\mu}^* \\\\ \\Rightarrow& \\pmb{\\mu}^* = \\left(\\sum^m_{i=1} \\frac{\\mathbf{x}_i\\mathbf{x}^T_i }{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}\\right)^{-1} \\sum^m_{i=1} \\frac{y_i \\mathbf{x}_i}{\\mathbf{x}_i^T \\pmb{\\Sigma}^* \\mathbf{x}_i}. \\end{align*}","title":"\u968f\u673a\u6027\u7684\u7ebf\u6027\u56de\u5f52"},{"location":"ML/04-Regression/#_5","text":"\u6211\u4eec\u5728\u8d1d\u53f6\u65af\u56de\u5f52\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u505a\u4ec0\u4e48\uff1f \u4ee4 \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m] , \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T \\mathbf{y} = [y_1, y_2, \\ldots, y_m]^T \u3002 p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) p(\\mathbf{w}) = \\mathcal{N}(\\pmb{\\mu}_0, \\pmb{\\Sigma}_0) p(\\hat{\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) p(\\hat{\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}) p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) \u5176\u4e2d \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X}\\mathbf{X}^T)^{-1} \uff0c \u5e76\u4e14 \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X}(\\mathbf{X}^T \\pmb{\\Sigma}_0 \\mathbf{X})^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \u3002 \u8fd9\u4e00\u5957\u4e1c\u897f\u5e76\u6ca1\u6709\u51fa\u73b0\u771f\u5b9e\u5206\u5e03 \\mathcal{D} \\mathcal{D} \u3002 \u8fd9\u91cc\u5047\u8bbe p_{\\mathcal{D}}({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\pmb{\\Sigma}_1), p_{\\mathcal{D}}({\\mathbf{y}} \\vert \\mathbf{X}, \\mathbf{w}) = \\mathcal{N}(\\mathbf{X}^T \\mathbf{w}, \\pmb{\\Sigma}_1), \u90a3\u4e48\u5728 p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) p(\\mathbf{w} \\vert \\hat{\\mathbf{y}}, \\mathbf{X}) = \\mathcal{N}(\\pmb{\\mu}, \\pmb{\\Sigma}) \u4e2d\uff0c \u5176\u4e2d \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\pmb{\\Sigma}_1\\mathbf{X}^T)^{-1} \\pmb{\\Sigma} = (\\pmb{\\Sigma}_0 + \\mathbf{X} \\pmb{\\Sigma}_1\\mathbf{X}^T)^{-1} \uff0c \u5e76\u4e14 \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X} \\pmb{\\Sigma}_1^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \\pmb{\\mu} = \\pmb{\\Sigma} [\\mathbf{X} \\pmb{\\Sigma}_1^{-1} \\mathbf{y} + \\pmb{\\Sigma}_0^{-1} \\pmb{\\mu}_0] \u3002 \u8fd9\u4e2a\u5047\u8bbe\u8ba9\u6211\u5f88\u4e0d\u8212\u670d\uff0c\u548c\u524d\u9762\u7684\u8ba8\u8bba\u5e76\u4e0d\u7edf\u4e00\u3002","title":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52"},{"location":"ML/05-AdaBoost/","text":"Boosting \u00b6 \u5f31\u5206\u7c7b\u5668\u5230\u5f3a\u5206\u7c7b\u5668\uff0c\u8fd9\u91cc\u6709\u8da3\u7684\u4e1c\u897f\u53ef\u592a\u591a\u4e86\uff0c\u6211\u5148\u628a\u4e3b\u5e72\u7b97\u6cd5Adaboost\u6574\u7406\u4e00\u4e0b\u3002 Adaboost \u00b6 \u5b9a\u4e491\uff1a( Weak hypothesis class ). We call a hypothesis class is a weak hypothesis class of data (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} we means that \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \u8fd9\u91cc\u7684 \\mathbf{p}_k \\mathbf{p}_k \u662f\u5728\u6837\u672c\u4e0a\u7684\u67d0\u4e2a\u5206\u5e03\uff0c\u5728\u540e\u9762\u4f1a\u6709\u63d0\u5230, \u67d0\u4e00\u79cd\u8bbe\u5b9a\u65b9\u5f0f\u3002 \u8fd9\u91cc\u6307\u7684\u662f\u67d0\u4e00\u7c7b\u5206\u7c7b\u7b97\u6cd5\u7ed9\u51fa\u4efb\u610f\u7684\u8f93\u5165\u6837\u672c\uff0c \u53ea\u80fd\u8fd4\u56de\u4e00\u4e2a\u6bd4\u8f83\u5f31\u7684\u5206\u7c7b\u5668\u3002\u9519\u8bef\u7387\u5c0f\u4e8e50%\u3002 Adaboost \u5047\u8bbe\u6211\u4eec\u88ab\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668\u7684\u96c6\u5408 \\mathcal{H}_{weak} \\mathcal{H}_{weak} , \u6211\u4eec\u5c06\u4ece\u4e0b\u9762\u8fd9\u4e2a\u5047\u8bbe\u96c6\u4e2d\u5b66\u4e60\u4e00\u4e2a\u5f3a\u5206\u7c7b\u5668\uff1a \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} Adaboot\u89e3\u51b3\u7684\u95ee\u9898\u662f: \u6570\u636e\u5728 (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} , \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \uff0c h_i(\\mathbf{x}) \\in\\{-1, 1\\} h_i(\\mathbf{x}) \\in\\{-1, 1\\} \u3002 \u6211\u4eec\u8981\u4ece \\mathcal{H}_{ada} \\mathcal{H}_{ada} \u4e2d\u9009\u51fa\u4e00\u4e2a\u6700\u597d\u7684\u5206\u7c7b\u5668\uff0c\u80fd\u591f\u66f4\u597d\u5730\u62df\u5408\u771f\u5b9e\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u3002 \u8fd9\u91cc\u4f7f\u7528\u7684\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u5462\uff1f\u56e0\u4e3a\u5b83\u6709\u5f88\u597d\u7684\u6570\u5b66\u6027\u8d28\u3002 \u6211\u4eec\u53ef\u4ee5\u7528\u5750\u6807\u68af\u5ea6\u4e0b\u964d\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\uff0c\u5e76\u4e14\u8bbe\u5b9a\u6bcf\u4e00\u6b65\u7684\u6b65\u957f\u4e3a\u6700\u4f18\u6b65\u957f\u3002 \u4e5f\u5c31\u662f\u6bcf\u4e00\u6b65\u7684\u4f18\u5316\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u4e00\u4e2a\u5b50\u95ee\u9898\u6765\u6c42\u89e3\u5f53\u524d\u7684\u6700\u4f18\u6b65\u957f: \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \u4ee4 L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u67d0\u4e00\u4e2a\u6837\u672c\u96c6 S S \u4e0a\u7684\u5206\u5e03 \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} , \u6ee1\u8db3 \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u4ee5\u53ca \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \u90a3\u4e48 \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \u7efc\u4e0a\u6240\u8ff0\uff0cAdaboost\u7b97\u6cd5\u7684\u6d41\u7a0b\u662f\uff1a Step1: \u521d\u59cb\u5316 \\pmb{\\alpha} = \\pmb{0} \\pmb{\\alpha} = \\pmb{0} , k = 1 k = 1 , \\mathcal{H}_{weak} = \\{\\} \\mathcal{H}_{weak} = \\{\\} ; Step2: \u6c42\u89e3 \\mathbf{p}_{k}(S) \\mathbf{p}_{k}(S) , \u4ece\u6837\u672c \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \u4e2d\u5b66\u4e60\u51fa\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668 h_k h_k , \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} ; \u5f31\u5206\u7c7b\u5668\u7684\u5b66\u4e60\u65b9\u5f0f\u5f88\u91cd\u8981\uff0c\u8fd9\u4e2a\u5728\u8bc1\u660e\u91cc\u4f1a\u4f53\u73b0; Step3: \u6c42\u89e3 \\epsilon_k \\epsilon_k , \\eta_k \\eta_k ; Step4: \u66f4\u65b0 \\pmb{\\alpha} \\pmb{\\alpha} \u548c k k , \u8fd4\u56de\u5230\u7b2c\u4e8c\u6b65\u3002 \u8bef\u5dee\u5206\u6790 \u00b6 \u9996\u5148 \\epsilon_k \\le \\frac{1}{2} - \\gamma \\epsilon_k \\le \\frac{1}{2} - \\gamma , \u90a3\u4e48 \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \u5982\u679c\u53d6 \\pmb{\\alpha}_0 = \\pmb{0} \\pmb{\\alpha}_0 = \\pmb{0} \uff0c\u90a3\u4e48 L_{S}(\\pmb{\\alpha}_0) = 1 L_{S}(\\pmb{\\alpha}_0) = 1 \u3002 \u6240\u4ee5\uff0c L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) \u3002 \u6211\u4eec\u5f53\u7136\u6bd4\u8f83\u5173\u5fc3 0-1 0-1 \u8bef\u5dee\u51fd\u6570\uff1a l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} , \u5b83\u5c0f\u4e8e\u7b49\u4e8e\u8bef\u5dee\u51fd\u6570 l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) , \u6240\u4ee5 \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align} \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align}","title":"AdaBoost"},{"location":"ML/05-AdaBoost/#boosting","text":"\u5f31\u5206\u7c7b\u5668\u5230\u5f3a\u5206\u7c7b\u5668\uff0c\u8fd9\u91cc\u6709\u8da3\u7684\u4e1c\u897f\u53ef\u592a\u591a\u4e86\uff0c\u6211\u5148\u628a\u4e3b\u5e72\u7b97\u6cd5Adaboost\u6574\u7406\u4e00\u4e0b\u3002","title":"Boosting"},{"location":"ML/05-AdaBoost/#adaboost","text":"\u5b9a\u4e491\uff1a( Weak hypothesis class ). We call a hypothesis class is a weak hypothesis class of data (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} we means that \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \\begin{equation} \\mathcal{H}_{weak} = \\left\\{ h_1, h_2, \\ldots, h_N : \\forall k \\in [N], L_{(\\mathbf{x}_i, y_i) \\sim \\mathbf{p}_k}(h_k) \\le \\frac{1}{2} - \\gamma, (\\mathbf{x}_i, y_i) \\in S \\right\\}.\\tag{1} \\end{equation} \u8fd9\u91cc\u7684 \\mathbf{p}_k \\mathbf{p}_k \u662f\u5728\u6837\u672c\u4e0a\u7684\u67d0\u4e2a\u5206\u5e03\uff0c\u5728\u540e\u9762\u4f1a\u6709\u63d0\u5230, \u67d0\u4e00\u79cd\u8bbe\u5b9a\u65b9\u5f0f\u3002 \u8fd9\u91cc\u6307\u7684\u662f\u67d0\u4e00\u7c7b\u5206\u7c7b\u7b97\u6cd5\u7ed9\u51fa\u4efb\u610f\u7684\u8f93\u5165\u6837\u672c\uff0c \u53ea\u80fd\u8fd4\u56de\u4e00\u4e2a\u6bd4\u8f83\u5f31\u7684\u5206\u7c7b\u5668\u3002\u9519\u8bef\u7387\u5c0f\u4e8e50%\u3002 Adaboost \u5047\u8bbe\u6211\u4eec\u88ab\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668\u7684\u96c6\u5408 \\mathcal{H}_{weak} \\mathcal{H}_{weak} , \u6211\u4eec\u5c06\u4ece\u4e0b\u9762\u8fd9\u4e2a\u5047\u8bbe\u96c6\u4e2d\u5b66\u4e60\u4e00\u4e2a\u5f3a\u5206\u7c7b\u5668\uff1a \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} \\begin{equation} \\mathcal{H}_{ada} = \\left\\{ \\sum^{N}_{i=1} \\alpha_i h_i : \\alpha_i \\in \\mathbb{R} \\wedge h_i \\in \\mathcal{H}_{weak} \\right\\}.\\tag{2} \\end{equation} Adaboot\u89e3\u51b3\u7684\u95ee\u9898\u662f: \u6570\u636e\u5728 (\\mathbf{x}, y) \\sim \\mathcal{D} (\\mathbf{x}, y) \\sim \\mathcal{D} , \u5e76\u4e14 y \\in \\{-1, 1\\} y \\in \\{-1, 1\\} \uff0c h_i(\\mathbf{x}) \\in\\{-1, 1\\} h_i(\\mathbf{x}) \\in\\{-1, 1\\} \u3002 \u6211\u4eec\u8981\u4ece \\mathcal{H}_{ada} \\mathcal{H}_{ada} \u4e2d\u9009\u51fa\u4e00\u4e2a\u6700\u597d\u7684\u5206\u7c7b\u5668\uff0c\u80fd\u591f\u66f4\u597d\u5730\u62df\u5408\u771f\u5b9e\u6761\u4ef6\u5206\u5e03 P_{\\mathcal{D}}(y \\vert \\mathbf{x}) P_{\\mathcal{D}}(y \\vert \\mathbf{x}) \u3002 \u8fd9\u91cc\u4f7f\u7528\u7684\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \\begin{equation} {L}_{\\mathcal{D}}(h) = \\mathbb{E}_{\\mathcal{D}} \\left[ e^{- y h(\\mathbf{x})} \\right].\\tag{3} \\end{equation} \u5bf9\u5e94\u7684\u7ecf\u9a8c\u635f\u5931\u51fd\u6570\u4e3a \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \\begin{equation} {L}_{\\mathcal{S}}(h) = \\frac{1}{m} \\sum_{i=1}^{m} e^{-y_i h(\\mathbf{x}_i)}. \\tag{4} \\end{equation} \u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u5462\uff1f\u56e0\u4e3a\u5b83\u6709\u5f88\u597d\u7684\u6570\u5b66\u6027\u8d28\u3002 \u6211\u4eec\u53ef\u4ee5\u7528\u5750\u6807\u68af\u5ea6\u4e0b\u964d\u6765\u6c42\u89e3\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898\uff0c\u5e76\u4e14\u8bbe\u5b9a\u6bcf\u4e00\u6b65\u7684\u6b65\u957f\u4e3a\u6700\u4f18\u6b65\u957f\u3002 \u4e5f\u5c31\u662f\u6bcf\u4e00\u6b65\u7684\u4f18\u5316\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u4e00\u4e2a\u5b50\u95ee\u9898\u6765\u6c42\u89e3\u5f53\u524d\u7684\u6700\u4f18\u6b65\u957f: \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{equation} \\arg\\min_{\\eta} {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N})\\tag{5} \\end{equation} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \\begin{align} & m {L}_{\\mathcal{S}}(\\alpha_1, \\ldots, \\alpha_{k-1}, \\alpha_k + \\eta, \\alpha_{k+1}, \\ldots, \\alpha_{N}) \\\\ =& \\sum_{i=1}^{m} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) =& \\sum_{i = 1}^{m} -y_i h_k(\\mathbf{x}_i) exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - y_i h_{k}(\\mathbf{x}_i) \\eta\\right\\} \\\\ =& \\sum_{y_i \\ne h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) + \\eta\\right\\} \\\\ & - \\sum_{y_i = h_k(\\mathbf{x}_i)} exp\\left\\{- y_i \\sum_{j=1}^{N} \\alpha_{j} h_{j}(\\mathbf{x}_i) - \\eta\\right\\} \\end{align} \u4ee4 L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} L_S(\\pmb{\\alpha}) = Z = \\sum_{i=1}^{m} exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u67d0\u4e00\u4e2a\u6837\u672c\u96c6 S S \u4e0a\u7684\u5206\u5e03 \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} \\mathbf{p}_{k}(S) = \\left\\{ p_k(\\mathbf{x}_1, y_1), p_k(\\mathbf{x}_2, y_2), \\ldots, p_k(\\mathbf{x}_m, y_m)\\right\\} , \u6ee1\u8db3 \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} \\mathbf{p}_{k}(\\mathbf{x}_i, y_i) = \\frac{1}{Z}exp\\left\\{ -y_i \\sum_{j=1}^{N} \\alpha_j h_j(\\mathbf{x}_i) \\right\\} , \u4ee5\u53ca \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \\epsilon_k = \\mathbb{E}_{(\\mathbf{x}, y) \\sim \\mathbf{p}_k} \\left[ \\pmb{1}_{h_k(\\mathbf{x})\\ne y} \\right] \u90a3\u4e48 \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \\begin{align} \\frac{\\partial}{\\partial \\eta} {L}_{\\mathcal{S}}(\\eta) &= \\sum_{y_i \\ne h_k(\\mathbf{x}_i)}^{} p_{k}(\\mathbf{x}_i, y_i) \\exp(\\eta) - \\sum_{y_i = h_k(\\mathbf{x}_i)}^{} p^{k}(\\mathbf{x}_i, y_i) \\exp(-\\eta) \\\\ &= \\epsilon_k \\exp(\\eta) - (1 - \\epsilon_k) \\exp(-\\eta), \\\\ \\Rightarrow& \\eta^* = \\frac{1}{2} \\ln\\left( \\frac{1 - \\epsilon_k}{\\epsilon_k} \\right). \\end{align} \u7efc\u4e0a\u6240\u8ff0\uff0cAdaboost\u7b97\u6cd5\u7684\u6d41\u7a0b\u662f\uff1a Step1: \u521d\u59cb\u5316 \\pmb{\\alpha} = \\pmb{0} \\pmb{\\alpha} = \\pmb{0} , k = 1 k = 1 , \\mathcal{H}_{weak} = \\{\\} \\mathcal{H}_{weak} = \\{\\} ; Step2: \u6c42\u89e3 \\mathbf{p}_{k}(S) \\mathbf{p}_{k}(S) , \u4ece\u6837\u672c \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \\{(\\mathbf{x}, y)\\} \\sim \\mathbf{p}_{k} \u4e2d\u5b66\u4e60\u51fa\u4e00\u4e2a\u5f31\u5206\u7c7b\u5668 h_k h_k , \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} \\mathcal{H}_{weak} = \\mathcal{H} \\cup \\{h_k\\} ; \u5f31\u5206\u7c7b\u5668\u7684\u5b66\u4e60\u65b9\u5f0f\u5f88\u91cd\u8981\uff0c\u8fd9\u4e2a\u5728\u8bc1\u660e\u91cc\u4f1a\u4f53\u73b0; Step3: \u6c42\u89e3 \\epsilon_k \\epsilon_k , \\eta_k \\eta_k ; Step4: \u66f4\u65b0 \\pmb{\\alpha} \\pmb{\\alpha} \u548c k k , \u8fd4\u56de\u5230\u7b2c\u4e8c\u6b65\u3002","title":"Adaboost"},{"location":"ML/05-AdaBoost/#_1","text":"\u9996\u5148 \\epsilon_k \\le \\frac{1}{2} - \\gamma \\epsilon_k \\le \\frac{1}{2} - \\gamma , \u90a3\u4e48 \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \\begin{align} &\\frac{L_{S}(\\pmb{\\alpha} + \\eta \\pmb{\\epsilon}_k)}{L_{S}(\\pmb{\\alpha})} \\\\ =& (1 - \\epsilon_k) \\exp(-\\eta) + \\epsilon_k \\exp(\\eta) \\\\ =& 2 \\sqrt{\\epsilon_k(1 - \\epsilon_k)}\\\\ \\le& 2\\sqrt{\\left( \\frac{1}{2} - \\gamma \\right)\\left( \\frac{1}{2} + \\gamma \\right)} \\\\ \\le& \\sqrt{1 - 4\\gamma^2} \\le \\exp(-2\\gamma^2). \\end{align} \u5982\u679c\u53d6 \\pmb{\\alpha}_0 = \\pmb{0} \\pmb{\\alpha}_0 = \\pmb{0} \uff0c\u90a3\u4e48 L_{S}(\\pmb{\\alpha}_0) = 1 L_{S}(\\pmb{\\alpha}_0) = 1 \u3002 \u6240\u4ee5\uff0c L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) L_{S}(\\pmb{\\alpha}_T) \\le \\exp(-2\\gamma^2T) \u3002 \u6211\u4eec\u5f53\u7136\u6bd4\u8f83\u5173\u5fc3 0-1 0-1 \u8bef\u5dee\u51fd\u6570\uff1a l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} l^{0-1}(h, (\\mathbf{x}, y)) = sign\\{- y h(\\mathbf{x})\\} , \u5b83\u5c0f\u4e8e\u7b49\u4e8e\u8bef\u5dee\u51fd\u6570 l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) l^{exp}(h, (\\mathbf{x}, y)) = \\exp(-y h(\\mathbf{x})) , \u6240\u4ee5 \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align} \\begin{align} &{L}^{0-1}_{\\mathcal{D}}(h) \\le {L}_{\\mathcal{D}}^{\\exp}(h) \\\\ =& \\mathbb{E}_{S \\sim \\mathcal{D}^m} \\left[ {L}_{S}^{exp}(h) \\right] \\\\ \\le& \\exp(-2\\gamma^2 T). \\end{align}","title":"\u8bef\u5dee\u5206\u6790"},{"location":"ML/06-PAC/","text":"PAC: Principal Component Analysis \u00b6 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5728\u96c6\u5408 \\mathbb{R}^{d} \\mathbb{R}^{d} \u5b58\u5728\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} , \u5b83\u7684\u6837\u672c\u7528\u7b26\u53f7 \\mathbf{x} \\mathbf{x} \u8868\u793a\u3002 \u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u5728 \\mathbb{R}^{k} \\mathbb{R}^{k} \u4e0a\u7684\u5206\u5e03 p(\\mathbf{y}) p(\\mathbf{y}) \u6700\u63a5\u8fd1\u5206\u5e03 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \uff0c \u8fd9\u91cc\u7684\u6700\u63a5\u8fd1\uff0c\u6307\u7684\u662f p(\\mathbf{y}) p(\\mathbf{y}) \u5305\u542b\u6700\u591a p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u7684 \u4fe1\u606f \u3002 \u4ec0\u4e48\u53eb\u505a\u4fdd\u7559\u6700\u591a\u7684\u4fe1\u606f\u5462\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u7f16\u7801\u5668 E:\\mathbf{x} \\rightarrow \\mathbf{y} E:\\mathbf{x} \\rightarrow \\mathbf{y} (\u5176\u4e2d y \\in \\mathbb{R}^k y \\in \\mathbb{R}^k \u4ee5\u53ca k < d k < d ), \u4ee5\u53ca\u4e00\u4e2a\u89e3\u7801\u5668 D:\\mathbf{y} \\rightarrow \\mathbf{x} D:\\mathbf{y} \\rightarrow \\mathbf{x} , \u4f7f\u5f97 D(E(\\mathbf{x})) D(E(\\mathbf{x})) \u6700\u63a5\u8fd1 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) : \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \u8fd9\u4e2a\u95ee\u9898\u63cf\u8ff0\u8fd8\u4e0d\u662f\u5f88\u5408\u9002\uff0c\u6211\u9700\u8981\u518d\u601d\u8003\u4e00\u4e0b\u3002 PAC \u00b6 \u5bf9\u4e8e\u6837\u672c \\mathbf{x} \\in \\mathbb{R}^d \\mathbf{x} \\in \\mathbb{R}^d , \u670d\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c PAC\u7684\u4f18\u5316\u76ee\u6807\u662f \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \u5176\u4e2d \\mathbf{U} \\in \\mathbb{R}^{d\\times k} \\mathbf{U} \\in \\mathbb{R}^{d\\times k} , \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \u5e76\u4e14 k \\le d k \\le d \u3002 \u7ed9\u5b9a\u6837\u672c\u96c6 S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} \uff0c\u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. PAC\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u6c42\u89e3\u4e0a\u9762\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898 \\eqref{pac_empirical_loss} \\eqref{pac_empirical_loss} \uff0c\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u5c31\u662f\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u7684\u6c42\u89e3\u65b9\u6cd5\u3002 \u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635 \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \uff0c\u5e76\u4e14 \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \uff0c \u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u7684\u77e9\u9635 \\mathbf{U} \\mathbf{U} , \u6ee1\u8db3 \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \u3002 \u5e76\u4e14\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u5411\u91cf \\mathbf{x} \\mathbf{x} , \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \u7684\u6700\u4f18\u89e3\u4e3a \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \u3002 \u7efc\u5408\u4e0a\u9762\u8fd9\u4e24\u6761\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \u56e0\u4e3a \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \u662f\u5b9e\u5bf9\u79f0\u77e9\u9635\uff0c\u6240\u4ee5\u80fd\u591f\u6b63\u4ea4\u5206\u89e3\u4e3a \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e09\u4e2a\u77e9\u9635\u7684\u4e58\u79ef\uff0c\u5176\u4e2d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \u4ee5\u53ca \\mathbf{D} \\mathbf{D} \u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5e76\u4e14 D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} \u3002\u6240\u4ee5\u539f\u95ee\u9898\u7b49\u4ef7\u4e8e\u4f18\u5316\u4e0b\u9762\u8fd9\u4e2a\u95ee\u9898\uff1a \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \u63a5\u4e0b\u6765\u662f\u4e00\u4e2a\u77e9\u9635\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u6269\u5c55\u77e9\u9635 \\mathbf{H} \\mathbf{H} \u7684\u5217\uff0c\u5f62\u6210\u65b0\u7684\u77e9\u9635 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}} , \u6ee1\u8db3 \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \u3002\u90a3\u4e48 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d , \u5373 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \u3002\u518d\u6709\uff0c \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \u3002 \u7efc\u4e0a \\eqref{proof_step2} \\eqref{proof_step2} \u5f0f\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8f6c\u5316\u4e3a \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \u5f53 \\mathbf{E} \\mathbf{E} \u7531 \\mathbf{F} \\mathbf{F} \u524d k k \u5217\u7ec4\u6210\uff0c\u90a3\u4e48 \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \u5373\u95ee\u9898 \\eqref{proof_step2} \\eqref{proof_step2} \u7684\u6700\u503c\u4e3a \\sum^{k}_{i=1} D_{ii} \\sum^{k}_{i=1} D_{ii} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u53d1\u73b0 \\mathbf{E} \\mathbf{E} \u6070\u597d\u662f\u77e9\u9635 \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \u7684\u6700\u5927 k k \u4e2a\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\u3002\u7279\u5f81\u503c\u5927\uff0c\u5728 \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e2d\u5f71\u54cd\u4e5f\u5927\uff0c\u5373\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u539f\u77e9\u9635\u7684\u4e3b\u6210\u5206\u3002\u6240\u4ee5\u6211\u4eec\u4e5f\u53eb\u8fd9\u79cd\u65b9\u6cd5\u4e3a \u4e3b\u6210\u5206\u5206\u6790 \u3002","title":"PAC"},{"location":"ML/06-PAC/#pac-principal-component-analysis","text":"","title":"PAC: Principal Component Analysis"},{"location":"ML/06-PAC/#_1","text":"\u5728\u96c6\u5408 \\mathbb{R}^{d} \\mathbb{R}^{d} \u5b58\u5728\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} , \u5b83\u7684\u6837\u672c\u7528\u7b26\u53f7 \\mathbf{x} \\mathbf{x} \u8868\u793a\u3002 \u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u5728 \\mathbb{R}^{k} \\mathbb{R}^{k} \u4e0a\u7684\u5206\u5e03 p(\\mathbf{y}) p(\\mathbf{y}) \u6700\u63a5\u8fd1\u5206\u5e03 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \uff0c \u8fd9\u91cc\u7684\u6700\u63a5\u8fd1\uff0c\u6307\u7684\u662f p(\\mathbf{y}) p(\\mathbf{y}) \u5305\u542b\u6700\u591a p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) \u7684 \u4fe1\u606f \u3002 \u4ec0\u4e48\u53eb\u505a\u4fdd\u7559\u6700\u591a\u7684\u4fe1\u606f\u5462\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u7f16\u7801\u5668 E:\\mathbf{x} \\rightarrow \\mathbf{y} E:\\mathbf{x} \\rightarrow \\mathbf{y} (\u5176\u4e2d y \\in \\mathbb{R}^k y \\in \\mathbb{R}^k \u4ee5\u53ca k < d k < d ), \u4ee5\u53ca\u4e00\u4e2a\u89e3\u7801\u5668 D:\\mathbf{y} \\rightarrow \\mathbf{x} D:\\mathbf{y} \\rightarrow \\mathbf{x} , \u4f7f\u5f97 D(E(\\mathbf{x})) D(E(\\mathbf{x})) \u6700\u63a5\u8fd1 p_{\\mathcal{D}}(\\mathbf{x}) p_{\\mathcal{D}}(\\mathbf{x}) : \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \\tag{1} \\label{loss_1} \\min_{E, D} \\left\\{ Distance(p_{\\mathcal{D}}(\\mathbf{x}) \\Vert p(\\hat{\\mathbf{x}} = E(D(\\mathbf{x}))) \\right\\} \u8fd9\u4e2a\u95ee\u9898\u63cf\u8ff0\u8fd8\u4e0d\u662f\u5f88\u5408\u9002\uff0c\u6211\u9700\u8981\u518d\u601d\u8003\u4e00\u4e0b\u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"ML/06-PAC/#pac","text":"\u5bf9\u4e8e\u6837\u672c \\mathbf{x} \\in \\mathbb{R}^d \\mathbf{x} \\in \\mathbb{R}^d , \u670d\u4ece\u672a\u77e5\u5206\u5e03 \\mathcal{D} \\mathcal{D} \uff0c PAC\u7684\u4f18\u5316\u76ee\u6807\u662f \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \\tag{2} \\label{pac_true_loss} \\min_{\\mathbf{U}, \\mathbf{V}} L_{\\mathcal{D}}(\\mathbf{U}, \\mathbf{V}) = \\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{D}} \\left\\{\\Vert \\mathbf{x} - \\mathbf{U}\\mathbf{V}\\mathbf{x} \\Vert^2_2 \\right\\}, \u5176\u4e2d \\mathbf{U} \\in \\mathbb{R}^{d\\times k} \\mathbf{U} \\in \\mathbb{R}^{d\\times k} , \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \\mathbf{V} \\in \\mathbb{R}^{k \\times d} \u5e76\u4e14 k \\le d k \\le d \u3002 \u7ed9\u5b9a\u6837\u672c\u96c6 S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} S = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_m\\} \uff0c\u5bf9\u5e94\u7684\u7ecf\u9a8c\u8bef\u5dee\u51fd\u6570\u4e3a \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. \\tag{3} \\label{pac_empirical_loss} L_{S}(\\mathbf{U}, \\mathbf{V}) = \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{U}\\mathbf{V}\\mathbf{x}_i \\Vert^2_2. PAC\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u6c42\u89e3\u4e0a\u9762\u8fd9\u4e2a\u4f18\u5316\u95ee\u9898 \\eqref{pac_empirical_loss} \\eqref{pac_empirical_loss} \uff0c\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u5c31\u662f\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u7684\u6c42\u89e3\u65b9\u6cd5\u3002 \u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635 \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \\mathbf{E} \\in \\mathbb{R}^{d \\times k} \uff0c\u5e76\u4e14 \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \\mathbf{E}^T \\mathbf{E} = \\mathbf{I}^k \uff0c \u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u7684\u77e9\u9635 \\mathbf{U} \\mathbf{U} , \u6ee1\u8db3 \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \\{\\mathbf{U} \\mathbf{V} \\mathbf{x}: \\mathbf{x} \\in S\\} \\subset \\{\\mathbf{E} \\mathbf{y}: \\mathbf{y} \\in \\mathbb{R}^{k}\\} \u3002 \u5e76\u4e14\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u5411\u91cf \\mathbf{x} \\mathbf{x} , \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \\min_{\\mathbf{y}} \\Vert \\mathbf{E}\\mathbf{y} - \\mathbf{x} \\Vert^2_2 \u7684\u6700\u4f18\u89e3\u4e3a \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \\mathbf{y}^* = \\mathbf{E}^T \\mathbf{x} \u3002 \u7efc\u5408\u4e0a\u9762\u8fd9\u4e24\u6761\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \\begin{align*} &\\min_{\\mathbf{U}, \\mathbf{V}} L_{S}(\\mathbf{U}, \\mathbf{V})\\\\ \\ge& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\min_{\\mathbf{y}_i} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{y}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i - \\mathbf{E}\\mathbf{E}^T\\mathbf{x}_i \\Vert^2_2\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} (2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 \\mathbf{x}^T_i \\mathbf{E}\\mathbf{E}^{T}\\mathbf{x}_i)\\\\ =& \\min_{\\mathbf{E}} \\frac{1}{m} \\sum^{m}_{i=1} [2 \\Vert \\mathbf{x}_i \\Vert^2_2 - 2 trace(\\mathbf{E}^{T}\\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E})]\\\\ =& \\min_{\\mathbf{E}} \\frac{2}{m} \\sum^{m}_{i=1} \\Vert \\mathbf{x}_i \\Vert^2_2 - \\frac{2}{m} trace\\left(\\mathbf{E}^{T} \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i\\mathbf{E}\\right).\\\\ \\tag{4} \\label{proof_step1} \\end{align*} \u56e0\u4e3a \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \\sum^{m}_{i=1} \\mathbf{x}_i\\mathbf{x}^T_i \u662f\u5b9e\u5bf9\u79f0\u77e9\u9635\uff0c\u6240\u4ee5\u80fd\u591f\u6b63\u4ea4\u5206\u89e3\u4e3a \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e09\u4e2a\u77e9\u9635\u7684\u4e58\u79ef\uff0c\u5176\u4e2d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \\mathbf{F}^T \\mathbf{F} = \\mathbf{I}^d \u4ee5\u53ca \\mathbf{D} \\mathbf{D} \u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5e76\u4e14 D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} D_{11} \\ge D_{22} \\ge \\ldots \\ge D_{mm} \u3002\u6240\u4ee5\u539f\u95ee\u9898\u7b49\u4ef7\u4e8e\u4f18\u5316\u4e0b\u9762\u8fd9\u4e2a\u95ee\u9898\uff1a \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \\begin{align*} &\\max_{\\mathbf{E}, \\mathbf{F}} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} trace\\left( \\mathbf{H}^T \\mathbf{D} \\mathbf{H} \\right)\\\\ =& \\max_{\\mathbf{H}: \\mathbf{H}^T \\mathbf{H} = \\mathbf{I}^k} \\sum^{d}_{i=1} {D}_{ii} \\sum^{k}_{j=1} {H}^{2}_{ij}. \\tag{5} \\label{proof_step2} \\end{align*} \u63a5\u4e0b\u6765\u662f\u4e00\u4e2a\u77e9\u9635\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u6269\u5c55\u77e9\u9635 \\mathbf{H} \\mathbf{H} \u7684\u5217\uff0c\u5f62\u6210\u65b0\u7684\u77e9\u9635 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}} , \u6ee1\u8db3 \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \\tilde{\\mathbf{H}}^T \\tilde{\\mathbf{H}} = \\mathbf{I}^d \u3002\u90a3\u4e48 \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d \\tilde{\\mathbf{H}} \\tilde{\\mathbf{H}}^T = \\mathbf{I}^d , \u5373 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \\sum^{d}_{j=1} \\tilde{H}^2_{ij} = 1 \\Rightarrow \\sum^{k}_{j=1} H^2_{ij} \\le 1 \u3002\u518d\u6709\uff0c \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \\sum^{d}_{i=1}\\sum^{k}_{j=1} H_{ij} = k \u3002 \u7efc\u4e0a \\eqref{proof_step2} \\eqref{proof_step2} \u5f0f\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8f6c\u5316\u4e3a \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \\tag{6} \\label{proof_step3} \\eqref{proof_step2} \\le \\max_{\\pmb{0} \\preceq \\pmb{\\beta} \\preceq \\pmb{1}, \\Vert \\pmb{\\beta} \\Vert_1 = k} \\sum^{d}_{i=1} D_{ii} \\beta_{i} = \\sum^{k}_{i=1} D_{ii}. \u5f53 \\mathbf{E} \\mathbf{E} \u7531 \\mathbf{F} \\mathbf{F} \u524d k k \u5217\u7ec4\u6210\uff0c\u90a3\u4e48 \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \\tag{7} \\label{proof_step4} trace\\left( \\mathbf{E}^{T}\\mathbf{F} \\mathbf{D} \\mathbf{F}^{T} \\mathbf{E} \\right) = \\sum^{k}_{i=1} D_{ii}\uff0c \u5373\u95ee\u9898 \\eqref{proof_step2} \\eqref{proof_step2} \u7684\u6700\u503c\u4e3a \\sum^{k}_{i=1} D_{ii} \\sum^{k}_{i=1} D_{ii} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u53d1\u73b0 \\mathbf{E} \\mathbf{E} \u6070\u597d\u662f\u77e9\u9635 \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \\sum^{m}_{i=1}\\mathbf{x}^{T}_{i}\\mathbf{x}_{i} \u7684\u6700\u5927 k k \u4e2a\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\u3002\u7279\u5f81\u503c\u5927\uff0c\u5728 \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \\mathbf{F} \\mathbf{D} \\mathbf{F}^T \u4e2d\u5f71\u54cd\u4e5f\u5927\uff0c\u5373\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u539f\u77e9\u9635\u7684\u4e3b\u6210\u5206\u3002\u6240\u4ee5\u6211\u4eec\u4e5f\u53eb\u8fd9\u79cd\u65b9\u6cd5\u4e3a \u4e3b\u6210\u5206\u5206\u6790 \u3002","title":"PAC"},{"location":"algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/","text":"\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \u00b6 \u539f\u59cb\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u4e00\u4e2a\u6570\u7ec4 \\{x_0, x_1, \\ldots, x_n\\} \\{x_0, x_1, \\ldots, x_n\\} , \u6c42\u5b83\u7684\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \uff0c\u6ee1\u8db3 i_0 < i_1 < \\ldots i_k i_0 < i_1 < \\ldots i_k \u5e76\u4e14 x_{i_0} < x_{i_1} < \\ldots < x_{i_k} x_{i_0} < x_{i_1} < \\ldots < x_{i_k} \u3002 \u76ee\u6807 \uff1a\u52a8\u6001\u89c4\u5212\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6 O(n \\log n) O(n \\log n) \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 O(n) O(n) \u3002 \u5177\u4f53\u8be6\u60c5\u53ef\u4ee5\u53c2\u8003 LeetCode 300 \u3002 \u9996\u5148\uff0c\u7b80\u5355\u7684\u52a8\u6001\u89c4\u5212\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(n^2) O(n^2) \u3002 for ( int i = 1 ; i < n ; ++ i ) { for ( int j = 0 ; j < i ; ++ j ) { if ( dp [ i ] > dp [ j ]) { dp [ i ] = max ( dp [ i ], dp [ j ] + 1 ); } } } \u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684 O(n \\log n) O(n \\log n) \u7b97\u6cd5\u5c31\u6bd4\u8f83\u5f3a\u4e86\uff0c\u7528\u5230\u4e86\u8d2a\u5fc3\u6cd5\u548c\u4e8c\u5206\u67e5\u627e\u6765\u964d\u4f4e\u590d\u6742\u5ea6\u3002 \u5177\u4f53\u6d41\u7a0b\u53ef\u4ee5\u770b \u666e\u6797\u65af\u987f\u5927\u5b66\u7684\u7b97\u6cd5\u8bfe\u7a0b\u7684\u4e00\u4e2appt \u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u7ef4\u62a4\u51e0\u4e2a\u4e0b\u964d\u6808\uff08\u521a\u5f00\u59cb\u662f0\u4e2a\u4e0b\u964d\u6808\uff09\u3002\u4ece\u5de6\u5230\u53f3\u904d\u5386\u6570\u7ec4\uff0c\u6bcf\u4e2a\u6570\u5c3d\u91cf\u538b\u5165\u5de6\u8fb9\u7684\u6808\uff08\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7528\u4e8c\u5206\u6cd5\u627e\u80fd\u538b\u5165\u7684\u6808\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6808\u53ef\u538b\u5165\uff0c\u90a3\u5c31\u65b0\u5efa\u4e00\u4e2a\u6808\u3002 \u5f31\u5bf9\u5076 \uff1a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e\u6808\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u4efb\u4f55\u4e0a\u5347\u5b50\u5e8f\u5217\u6700\u591a\u53ea\u80fd\u5305\u542b\u6bcf\u4e2a\u4e0b\u964d\u6808\u91cc\u7684\u4e00\u4e2a\u5143\u7d20\u3002 \u5f3a\u5bf9\u5076 \uff1a\u6bcf\u4e2a\u6570\u8981\u4e48\u5728\u7b2c\u4e00\u4e2a\u6808\uff0c\u8981\u4e48\u5b83\u524d\u9762\u7684\u6808\u5df2\u7ecf\u5b58\u5728\u6bd4\u5b83\u5c0f\u7684\u6570\u3002\u90a3\u4e48\u5f52\u7eb3\u603b\u7ed3\u6cd5\u53ef\u5f97\uff0c\u6bcf\u4e2a\u6570\u90fd\u6709\u5230\u7b2c\u4e00\u4e2a\u6808\u7684''\u901a\u8def''\uff08\u5f62\u6210\u9012\u589e\u5b50\u5e8f\u5217\uff09\u3002\u90a3\u4e48\uff0c\u8fd9\u4e2a\u6808\u7ec4\u7684\u6570\u636e\u7ed3\u6784\u5b58\u5728\u4e00\u4e2a\u957f\u5ea6\u7b49\u4e8e\u6808\u4e2a\u6570\u7684\u9012\u589e\u5b50\u5e8f\u5217\u3002\u518d\u6839\u636e\u5f31\u5bf9\u5076\u53ef\u77e5\uff0c\u6808\u7684\u4e2a\u6570\u4e5f\u662f\u9012\u589e\u5b50\u5e8f\u5217\u7684\u4e0a\u754c\u3002 class Solution { public : int lengthOfLIS ( vector < int >& nums ) { vector < int > s ; //\u53ea\u9700\u8981\u4fdd\u5b58\u6808\u9876\u7684\u6570\u3002 int n = nums . size (); for ( int i = 0 ; i < n ; ++ i ) { int idx = binary_search_left_bound ( s , nums [ i ]); // \u67e5\u627e\u6700\u5de6\u8fb9\u53ef\u63d2\u5165\u7684\u4e0b\u964d\u6808 if ( idx == s . size ()) { s . push_back ( nums [ i ]); //\u589e\u52a0\u6808 } else { s [ idx ] = nums [ i ]; //\u538b\u5165\u6808 } } return s . size (); } private : int binary_search_left_bound ( vector < int > & s , int target ) { // \u6700\u5de6\u4fa7\u8fb9\u754c int l = 0 , r = s . size (); while ( l < r ) { int m = l + (( r - l ) >> 1 ); if ( s [ m ] >= target ) { r = m ; } else { l = m + 1 ; } } return l ; } }; Python\u4e2d\u6709\u4e00\u4e2a\u4e8c\u5206\u6cd5\u7684\u5b9e\u73b0\u6a21\u5757 bisect : bisect.bisect_left(a, num, lo=0, hi=len(a)) \u548c bisect.bisect_right(a, num, lo=0, hi=len(a)) \u3002 \u5b98\u65b9\u6587\u6863\u94fe\u63a5 \u53d8\u79cd\u95ee\u98981\uff1a\u4fc4\u7f57\u65af\u5957\u5a03\u4fe1\u5c01 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u6211\u4eec\u62e5\u6709\u4e00\u7cfb\u5217\u4fe1\u5c01 \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} , \u6211\u4eec\u9700\u8981\u627e\u4e00\u4e2a\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \uff0c\u6ee1\u8db3 w_{i_0} < w_{i_1} < \\ldots < w_{i_k} w_{i_0} < w_{i_1} < \\ldots < w_{i_k} \u5e76\u4e14 h_{i_0} < h_{i_1} < \\ldots < h_{i_k} h_{i_0} < h_{i_1} < \\ldots < h_{i_k} \uff0c\u5373\u5b50\u5e8f\u5217\u91cc\u7684\u4fe1\u5c01\u53ef\u4ee5\u4e00\u4e2a\u4e00\u4e2a\u5957\u8d77\u6765\u3002 \u5206\u6790 \uff1a\u8fd9\u4e2a\u95ee\u9898\u548c\u539f\u95ee\u9898\u7684\u5dee\u522b\u5728\u4e8e\uff0c\u5982\u679c\u5c06 h h \u770b\u6210\u539f\u95ee\u9898\u7684 x x , \u90a3\u4e48\u539f\u95ee\u9898\u7684\u4e0b\u6807\u7ea6\u675f\u6362\u6210\u4e86 w w \u7684\u7ea6\u675f\u3002\u4e3a\u4e86\u8f6c\u5316\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636e w w \u5bf9\u6570\u7ec4\u8fdb\u884c \u5347\u5e8f\u6392\u5e8f \u3002\u5f53\u7136\u6211\u4eec\u8fd8\u662f\u9700\u8981\u4e00\u4e2a\u5fae\u5999\u7684\u8c03\u6574\uff1a\u8fd9\u4e2a w w \u4e0d\u540c\u4e8e\u4e0b\u6807\uff0c\u5b83\u662f\u4f1a\u91cd\u590d\u7684\u3002\u5f53 w_i = w_j w_i = w_j \u65f6\uff0c (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u662f\u4e0d\u80fd\u5957\u5728\u4e00\u8d77\u7684\uff0c\u5373\u4e0d\u80fd\u51fa\u73b0\u5728\u540c\u4e00\u4e2a\u5b50\u5e8f\u5217\u4e2d\uff0c\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u4e2a\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u5bf9 (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u6839\u636e h h \u8fdb\u884c \u964d\u5e8f\u6392\u5e8f \u3002 \u6392\u5e8f\u5b8c\u6210\u540e\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u95ee\u9898\u4e86\u3002 \u5177\u4f53\u8be6\u60c5\u53ef\u4ee5\u53c2\u8003 LeetCode 354 \u3002 int maxEnvelopes ( vector < vector < int >>& envelopes ) { if ( envelopes . empty ()) return 0 ; int n = envelopes . size (); sort ( envelopes . begin (), envelopes . end (), []( vector < int >& a , vector < int >& b ) { if ( a [ 0 ] == b [ 0 ]) { return a [ 1 ] > b [ 1 ]; } return a [ 0 ] < b [ 0 ]; }); return lengthOfLIS ( envelopes ); }","title":"\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217"},{"location":"algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/#_1","text":"","title":"\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217"},{"location":"algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/#_2","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u4e00\u4e2a\u6570\u7ec4 \\{x_0, x_1, \\ldots, x_n\\} \\{x_0, x_1, \\ldots, x_n\\} , \u6c42\u5b83\u7684\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \\{x_{i_0}, x_{i_1}, \\ldots, x_{i_k}\\} \uff0c\u6ee1\u8db3 i_0 < i_1 < \\ldots i_k i_0 < i_1 < \\ldots i_k \u5e76\u4e14 x_{i_0} < x_{i_1} < \\ldots < x_{i_k} x_{i_0} < x_{i_1} < \\ldots < x_{i_k} \u3002 \u76ee\u6807 \uff1a\u52a8\u6001\u89c4\u5212\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6 O(n \\log n) O(n \\log n) \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 O(n) O(n) \u3002 \u5177\u4f53\u8be6\u60c5\u53ef\u4ee5\u53c2\u8003 LeetCode 300 \u3002 \u9996\u5148\uff0c\u7b80\u5355\u7684\u52a8\u6001\u89c4\u5212\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(n^2) O(n^2) \u3002 for ( int i = 1 ; i < n ; ++ i ) { for ( int j = 0 ; j < i ; ++ j ) { if ( dp [ i ] > dp [ j ]) { dp [ i ] = max ( dp [ i ], dp [ j ] + 1 ); } } } \u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684 O(n \\log n) O(n \\log n) \u7b97\u6cd5\u5c31\u6bd4\u8f83\u5f3a\u4e86\uff0c\u7528\u5230\u4e86\u8d2a\u5fc3\u6cd5\u548c\u4e8c\u5206\u67e5\u627e\u6765\u964d\u4f4e\u590d\u6742\u5ea6\u3002 \u5177\u4f53\u6d41\u7a0b\u53ef\u4ee5\u770b \u666e\u6797\u65af\u987f\u5927\u5b66\u7684\u7b97\u6cd5\u8bfe\u7a0b\u7684\u4e00\u4e2appt \u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u7ef4\u62a4\u51e0\u4e2a\u4e0b\u964d\u6808\uff08\u521a\u5f00\u59cb\u662f0\u4e2a\u4e0b\u964d\u6808\uff09\u3002\u4ece\u5de6\u5230\u53f3\u904d\u5386\u6570\u7ec4\uff0c\u6bcf\u4e2a\u6570\u5c3d\u91cf\u538b\u5165\u5de6\u8fb9\u7684\u6808\uff08\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7528\u4e8c\u5206\u6cd5\u627e\u80fd\u538b\u5165\u7684\u6808\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6808\u53ef\u538b\u5165\uff0c\u90a3\u5c31\u65b0\u5efa\u4e00\u4e2a\u6808\u3002 \u5f31\u5bf9\u5076 \uff1a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e\u6808\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u4efb\u4f55\u4e0a\u5347\u5b50\u5e8f\u5217\u6700\u591a\u53ea\u80fd\u5305\u542b\u6bcf\u4e2a\u4e0b\u964d\u6808\u91cc\u7684\u4e00\u4e2a\u5143\u7d20\u3002 \u5f3a\u5bf9\u5076 \uff1a\u6bcf\u4e2a\u6570\u8981\u4e48\u5728\u7b2c\u4e00\u4e2a\u6808\uff0c\u8981\u4e48\u5b83\u524d\u9762\u7684\u6808\u5df2\u7ecf\u5b58\u5728\u6bd4\u5b83\u5c0f\u7684\u6570\u3002\u90a3\u4e48\u5f52\u7eb3\u603b\u7ed3\u6cd5\u53ef\u5f97\uff0c\u6bcf\u4e2a\u6570\u90fd\u6709\u5230\u7b2c\u4e00\u4e2a\u6808\u7684''\u901a\u8def''\uff08\u5f62\u6210\u9012\u589e\u5b50\u5e8f\u5217\uff09\u3002\u90a3\u4e48\uff0c\u8fd9\u4e2a\u6808\u7ec4\u7684\u6570\u636e\u7ed3\u6784\u5b58\u5728\u4e00\u4e2a\u957f\u5ea6\u7b49\u4e8e\u6808\u4e2a\u6570\u7684\u9012\u589e\u5b50\u5e8f\u5217\u3002\u518d\u6839\u636e\u5f31\u5bf9\u5076\u53ef\u77e5\uff0c\u6808\u7684\u4e2a\u6570\u4e5f\u662f\u9012\u589e\u5b50\u5e8f\u5217\u7684\u4e0a\u754c\u3002 class Solution { public : int lengthOfLIS ( vector < int >& nums ) { vector < int > s ; //\u53ea\u9700\u8981\u4fdd\u5b58\u6808\u9876\u7684\u6570\u3002 int n = nums . size (); for ( int i = 0 ; i < n ; ++ i ) { int idx = binary_search_left_bound ( s , nums [ i ]); // \u67e5\u627e\u6700\u5de6\u8fb9\u53ef\u63d2\u5165\u7684\u4e0b\u964d\u6808 if ( idx == s . size ()) { s . push_back ( nums [ i ]); //\u589e\u52a0\u6808 } else { s [ idx ] = nums [ i ]; //\u538b\u5165\u6808 } } return s . size (); } private : int binary_search_left_bound ( vector < int > & s , int target ) { // \u6700\u5de6\u4fa7\u8fb9\u754c int l = 0 , r = s . size (); while ( l < r ) { int m = l + (( r - l ) >> 1 ); if ( s [ m ] >= target ) { r = m ; } else { l = m + 1 ; } } return l ; } }; Python\u4e2d\u6709\u4e00\u4e2a\u4e8c\u5206\u6cd5\u7684\u5b9e\u73b0\u6a21\u5757 bisect : bisect.bisect_left(a, num, lo=0, hi=len(a)) \u548c bisect.bisect_right(a, num, lo=0, hi=len(a)) \u3002 \u5b98\u65b9\u6587\u6863\u94fe\u63a5","title":"\u539f\u59cb\u95ee\u9898"},{"location":"algorithms/01-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/#1","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u6211\u4eec\u62e5\u6709\u4e00\u7cfb\u5217\u4fe1\u5c01 \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} \\{(w_0, h_0), (w_1, h_1), \\ldots, (w_n, h_n)\\} , \u6211\u4eec\u9700\u8981\u627e\u4e00\u4e2a\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217 \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \\{(w_{i_0}, h_{i_0}), (w_{i_1}, h_{i_1}), \\ldots, (w_{i_k}, h_{i_k})\\} \uff0c\u6ee1\u8db3 w_{i_0} < w_{i_1} < \\ldots < w_{i_k} w_{i_0} < w_{i_1} < \\ldots < w_{i_k} \u5e76\u4e14 h_{i_0} < h_{i_1} < \\ldots < h_{i_k} h_{i_0} < h_{i_1} < \\ldots < h_{i_k} \uff0c\u5373\u5b50\u5e8f\u5217\u91cc\u7684\u4fe1\u5c01\u53ef\u4ee5\u4e00\u4e2a\u4e00\u4e2a\u5957\u8d77\u6765\u3002 \u5206\u6790 \uff1a\u8fd9\u4e2a\u95ee\u9898\u548c\u539f\u95ee\u9898\u7684\u5dee\u522b\u5728\u4e8e\uff0c\u5982\u679c\u5c06 h h \u770b\u6210\u539f\u95ee\u9898\u7684 x x , \u90a3\u4e48\u539f\u95ee\u9898\u7684\u4e0b\u6807\u7ea6\u675f\u6362\u6210\u4e86 w w \u7684\u7ea6\u675f\u3002\u4e3a\u4e86\u8f6c\u5316\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636e w w \u5bf9\u6570\u7ec4\u8fdb\u884c \u5347\u5e8f\u6392\u5e8f \u3002\u5f53\u7136\u6211\u4eec\u8fd8\u662f\u9700\u8981\u4e00\u4e2a\u5fae\u5999\u7684\u8c03\u6574\uff1a\u8fd9\u4e2a w w \u4e0d\u540c\u4e8e\u4e0b\u6807\uff0c\u5b83\u662f\u4f1a\u91cd\u590d\u7684\u3002\u5f53 w_i = w_j w_i = w_j \u65f6\uff0c (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u662f\u4e0d\u80fd\u5957\u5728\u4e00\u8d77\u7684\uff0c\u5373\u4e0d\u80fd\u51fa\u73b0\u5728\u540c\u4e00\u4e2a\u5b50\u5e8f\u5217\u4e2d\uff0c\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u4e2a\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u5bf9 (w_i, h_i) (w_i, h_i) \u548c (w_j, h_j) (w_j, h_j) \u6839\u636e h h \u8fdb\u884c \u964d\u5e8f\u6392\u5e8f \u3002 \u6392\u5e8f\u5b8c\u6210\u540e\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u95ee\u9898\u4e86\u3002 \u5177\u4f53\u8be6\u60c5\u53ef\u4ee5\u53c2\u8003 LeetCode 354 \u3002 int maxEnvelopes ( vector < vector < int >>& envelopes ) { if ( envelopes . empty ()) return 0 ; int n = envelopes . size (); sort ( envelopes . begin (), envelopes . end (), []( vector < int >& a , vector < int >& b ) { if ( a [ 0 ] == b [ 0 ]) { return a [ 1 ] > b [ 1 ]; } return a [ 0 ] < b [ 0 ]; }); return lengthOfLIS ( envelopes ); }","title":"\u53d8\u79cd\u95ee\u98981\uff1a\u4fc4\u7f57\u65af\u5957\u5a03\u4fe1\u5c01"},{"location":"algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/","text":"\u533a\u95f4\u8c03\u5ea6\u95ee\u9898 \u00b6 \u539f\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u6709n\u9879\u5de5\u4f5c \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \uff0c\u5176\u4e2d s s \u8868\u793a\u8d77\u59cb\u8be5\u5de5\u4f5c\u7684\u8d77\u59cb\u65f6\u95f4\uff0c e e \u8868\u793a\u8be5\u5de5\u4f5c\u7684\u7ed3\u675f\u65f6\u95f4\u3002\u9009\u53d6\u4e00\u4e2a\u6700\u957f\u5b50\u5e8f\u5217 \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \uff0c\u6ee1\u8db3\u8fd9\u4e9b\u5de5\u4f5c\u7684\u65f6\u95f4\u4e92\u4e0d\u76f8\u4ea4\u3002 \u76ee\u6807 \uff1a\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217\u6765\u505a\uff0c\u4f46\u662f\u6709\u66f4\u5de7\u5999\u7684\u8d2a\u5fc3\u7b97\u6cd5\u3002\u9664\u53bb\u6392\u5e8f\u7684\u65f6\u95f4\u590d\u6742\u5ea6 O(n\\log n) O(n\\log n) \uff0c\u8d2a\u5fc3\u7b97\u6cd5\u53ef\u4ee5\u5230 O(n) O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u5c06\u8fd9\u4e9b\u5de5\u4f5c\u6309\u7167\u7ed3\u675f\u65f6\u95f4 e e \u505a\u5347\u5e8f\u6392\u5e8f\u3002\u4e0d\u65ad\u9009\u53d6\u5f53\u524d\u5269\u4f59\u5de5\u4f5c\u4e2d\uff0c\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u628a\u4e0e\u8fd9\u4e2a\u5de5\u4f5c\u51b2\u7a81\u7684\u5de5\u4f5c\u53bb\u6389\u3002 \u8bc1\u660e \uff1a \u9996\u5148\uff0c\u4ece\u7b97\u6cd5\u6d41\u7a0b\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u9009\u51fa\u6765\u7684\u5b50\u5e8f\u5217\u4e92\u4e0d\u51b2\u7a81\u3002 \u5176\u6b21\uff1a\u89c4\u5b9a\u8fd9\u4e2a\u8d2a\u5fc3\u6cd5\u6240\u6784\u9020\u7684\u7ed3\u679c\u4e3a \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \uff0c\u4ee5\u53ca\u6700\u4f18\u89e3\u4e3a \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u4efb\u610f\u7684 idx idx , \u6211\u4eec\u53ef\u5f97 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u5f97: idx = 0 idx = 0 \u6ee1\u8db3\u8981\u6c42\uff1b\u5f53 idx > 0 idx > 0 \u65f6\u5047\u8bbe e_{i_{idx - 1}} \\le e_{j_{idx - 1}} e_{i_{idx - 1}} \\le e_{j_{idx - 1}} \u90a3\u4e48 \u6700\u4f18\u89e3\u7684\u5269\u4f59\u53ef\u9009\u533a\u95f4 \u5c11\u4e8e \u8d2a\u5fc3\u6cd5\u7684\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\uff0c\u800c\u8d2a\u5fc3\u6cd5\u53c8\u662f\u5728\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\u4e2d\u9009\u62e9\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u533a\u95f4\uff0c\u90a3\u4e48 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u8bc1\u660e k = m k = m \u3002\u6211\u4eec\u7528\u53cd\u8bc1\u6cd5\uff0c\u5982\u679c k < m k < m \uff0c\u53c8\u7531\u4e8e e_{i_{k}} < e_{j_{k}} e_{i_{k}} < e_{j_{k}} , \u90a3\u4e48 e_{i_{k}} < s_{j_{k+1}} e_{i_{k}} < s_{j_{k+1}} \uff0c\u5373\u6700\u4f18\u89e3\u7684\u5269\u4f59\u533a\u95f4\u53ef\u4ee5\u7eed\u7ed9\u8d2a\u5fc3\u6cd5\u7684\u7ed3\u679c\uff0c\u8fd9\u5c31\u548c\u6211\u4eec\u8d2a\u5fc3\u6cd5\u7684\u6d41\u7a0b\u77db\u76fe\u4e86\u3002 \u66f4\u591a\u8be6\u60c5\u53c2\u8003 LeetCode435 \u3002 \u53d8\u79cd1\uff1a\u5c04\u6c14\u7403\u95ee\u9898 \u00b6 \u95ee\u9898\u63cf\u8ff0 \uff1a\u5927\u5c0f\u4e0d\u540c\u7684\u6c14\u7403\u6392\u5728\u540c\u4e00\u4e2a\u6c34\u5e73\u9762\u4e0a\uff08\u7403\u5fc3\u7684 z z \u5750\u6807\u76f8\u540c\uff09\uff0c\u90a3\u4e48\u5728 x-y x-y \u5e73\u9762\u6bcf\u4e2a\u6c14\u7403\u5c31\u662f\u4e00\u4e2a\u4e2a\u5927\u5c0f\u4e0d\u540c\u4e92\u4e0d\u76f8\u4ea4\u7684\u5706\u3002\u5982\u679c\u6211\u4eec\u5728 x x \u8f74\u4e0a\u5782\u76f4\u4e8e x x \u8f74\u5c04\u51fb\uff0c\u6bcf\u6b21\u5c04\u51fb\u65f6\uff0c\u76f4\u7ebf\u4e0a\u7a7f\u8fc7\u7684\u6c14\u7403\u90fd\u4f1a\u88ab\u5c04\u7206\uff0c\u90a3\u4e48\u6700\u591a\u9700\u8981\u5f00\u51e0\u67aa\u624d\u80fd\u628a\u6240\u6709\u6c14\u7403\u5c04\u7206\u3002 \u5206\u6790 \uff1a\u6bcf\u4e2a\u6c14\u7403\u5728 x x \u8f74\u4e0a\u7684\u6295\u5f71\u662f\u4e00\u4e2a\u533a\u95f4\uff0c\u6709\u91cd\u53e0\u533a\u95f4\u7684\u6c14\u7403\u53ea\u9700\u8981\u4e00\u67aa\u5c31\u53ef\u4ee5\u5168\u90e8\u5c04\u7206\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u662f\u6c42\u6700\u5927\u4e0d\u91cd\u53e0\u533a\u95f4\u7684\u4e2a\u6570\u3002 \u66f4\u591a\u8be6\u60c5\u53c2\u8003 LeetCode452 \u3002","title":"\u533a\u95f4\u8c03\u5ea6\u95ee\u9898"},{"location":"algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/#_1","text":"","title":"\u533a\u95f4\u8c03\u5ea6\u95ee\u9898"},{"location":"algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/#_2","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u6709n\u9879\u5de5\u4f5c \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \\{(s_0, e_0), (s_1, e_1), \\ldots, (s_n, e_n)\\} \uff0c\u5176\u4e2d s s \u8868\u793a\u8d77\u59cb\u8be5\u5de5\u4f5c\u7684\u8d77\u59cb\u65f6\u95f4\uff0c e e \u8868\u793a\u8be5\u5de5\u4f5c\u7684\u7ed3\u675f\u65f6\u95f4\u3002\u9009\u53d6\u4e00\u4e2a\u6700\u957f\u5b50\u5e8f\u5217 \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e{i_k})\\} \uff0c\u6ee1\u8db3\u8fd9\u4e9b\u5de5\u4f5c\u7684\u65f6\u95f4\u4e92\u4e0d\u76f8\u4ea4\u3002 \u76ee\u6807 \uff1a\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217\u6765\u505a\uff0c\u4f46\u662f\u6709\u66f4\u5de7\u5999\u7684\u8d2a\u5fc3\u7b97\u6cd5\u3002\u9664\u53bb\u6392\u5e8f\u7684\u65f6\u95f4\u590d\u6742\u5ea6 O(n\\log n) O(n\\log n) \uff0c\u8d2a\u5fc3\u7b97\u6cd5\u53ef\u4ee5\u5230 O(n) O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002 \u7b97\u6cd5\u6838\u5fc3\u601d\u60f3 \uff1a\u5c06\u8fd9\u4e9b\u5de5\u4f5c\u6309\u7167\u7ed3\u675f\u65f6\u95f4 e e \u505a\u5347\u5e8f\u6392\u5e8f\u3002\u4e0d\u65ad\u9009\u53d6\u5f53\u524d\u5269\u4f59\u5de5\u4f5c\u4e2d\uff0c\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u628a\u4e0e\u8fd9\u4e2a\u5de5\u4f5c\u51b2\u7a81\u7684\u5de5\u4f5c\u53bb\u6389\u3002 \u8bc1\u660e \uff1a \u9996\u5148\uff0c\u4ece\u7b97\u6cd5\u6d41\u7a0b\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u9009\u51fa\u6765\u7684\u5b50\u5e8f\u5217\u4e92\u4e0d\u51b2\u7a81\u3002 \u5176\u6b21\uff1a\u89c4\u5b9a\u8fd9\u4e2a\u8d2a\u5fc3\u6cd5\u6240\u6784\u9020\u7684\u7ed3\u679c\u4e3a \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \\{(s_{i_0}, e_{i_0}), (s_{i_1}, e_{i_1}), \\ldots, (s_{i_k}, e_{i_k})\\} \uff0c\u4ee5\u53ca\u6700\u4f18\u89e3\u4e3a \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \\{(s_{j_0}, e_{j_0}), (s_{j_1}, e_{j_1}), \\ldots, (s_{j_m}, e_{j_m})\\} \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u4efb\u610f\u7684 idx idx , \u6211\u4eec\u53ef\u5f97 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u5f97: idx = 0 idx = 0 \u6ee1\u8db3\u8981\u6c42\uff1b\u5f53 idx > 0 idx > 0 \u65f6\u5047\u8bbe e_{i_{idx - 1}} \\le e_{j_{idx - 1}} e_{i_{idx - 1}} \\le e_{j_{idx - 1}} \u90a3\u4e48 \u6700\u4f18\u89e3\u7684\u5269\u4f59\u53ef\u9009\u533a\u95f4 \u5c11\u4e8e \u8d2a\u5fc3\u6cd5\u7684\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\uff0c\u800c\u8d2a\u5fc3\u6cd5\u53c8\u662f\u5728\u5269\u4f59\u53ef\u9009\u7a7a\u95f4\u4e2d\u9009\u62e9\u7ed3\u675f\u65f6\u95f4\u6700\u65e9\u7684\u533a\u95f4\uff0c\u90a3\u4e48 e_{i_{idx}} \\le e_{j_{idx}} e_{i_{idx}} \\le e_{j_{idx}} \u3002 \u6700\u540e\uff0c\u6211\u4eec\u8bc1\u660e k = m k = m \u3002\u6211\u4eec\u7528\u53cd\u8bc1\u6cd5\uff0c\u5982\u679c k < m k < m \uff0c\u53c8\u7531\u4e8e e_{i_{k}} < e_{j_{k}} e_{i_{k}} < e_{j_{k}} , \u90a3\u4e48 e_{i_{k}} < s_{j_{k+1}} e_{i_{k}} < s_{j_{k+1}} \uff0c\u5373\u6700\u4f18\u89e3\u7684\u5269\u4f59\u533a\u95f4\u53ef\u4ee5\u7eed\u7ed9\u8d2a\u5fc3\u6cd5\u7684\u7ed3\u679c\uff0c\u8fd9\u5c31\u548c\u6211\u4eec\u8d2a\u5fc3\u6cd5\u7684\u6d41\u7a0b\u77db\u76fe\u4e86\u3002 \u66f4\u591a\u8be6\u60c5\u53c2\u8003 LeetCode435 \u3002","title":"\u539f\u95ee\u9898"},{"location":"algorithms/02-%E5%8C%BA%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98/#1","text":"\u95ee\u9898\u63cf\u8ff0 \uff1a\u5927\u5c0f\u4e0d\u540c\u7684\u6c14\u7403\u6392\u5728\u540c\u4e00\u4e2a\u6c34\u5e73\u9762\u4e0a\uff08\u7403\u5fc3\u7684 z z \u5750\u6807\u76f8\u540c\uff09\uff0c\u90a3\u4e48\u5728 x-y x-y \u5e73\u9762\u6bcf\u4e2a\u6c14\u7403\u5c31\u662f\u4e00\u4e2a\u4e2a\u5927\u5c0f\u4e0d\u540c\u4e92\u4e0d\u76f8\u4ea4\u7684\u5706\u3002\u5982\u679c\u6211\u4eec\u5728 x x \u8f74\u4e0a\u5782\u76f4\u4e8e x x \u8f74\u5c04\u51fb\uff0c\u6bcf\u6b21\u5c04\u51fb\u65f6\uff0c\u76f4\u7ebf\u4e0a\u7a7f\u8fc7\u7684\u6c14\u7403\u90fd\u4f1a\u88ab\u5c04\u7206\uff0c\u90a3\u4e48\u6700\u591a\u9700\u8981\u5f00\u51e0\u67aa\u624d\u80fd\u628a\u6240\u6709\u6c14\u7403\u5c04\u7206\u3002 \u5206\u6790 \uff1a\u6bcf\u4e2a\u6c14\u7403\u5728 x x \u8f74\u4e0a\u7684\u6295\u5f71\u662f\u4e00\u4e2a\u533a\u95f4\uff0c\u6709\u91cd\u53e0\u533a\u95f4\u7684\u6c14\u7403\u53ea\u9700\u8981\u4e00\u67aa\u5c31\u53ef\u4ee5\u5168\u90e8\u5c04\u7206\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u662f\u6c42\u6700\u5927\u4e0d\u91cd\u53e0\u533a\u95f4\u7684\u4e2a\u6570\u3002 \u66f4\u591a\u8be6\u60c5\u53c2\u8003 LeetCode452 \u3002","title":"\u53d8\u79cd1\uff1a\u5c04\u6c14\u7403\u95ee\u9898"}]}